<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Motr: Layout DB Functional Specification</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Motr
   &#160;<span id="projectnumber">M0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dd/d61/_layout-_d_b-fspec.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Layout DB Functional Specification </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Layout DB Module is used by the Layout module to make persistent records for the layout entries created and used.</p>
<p>This section describes the data structures exposed and the external interfaces of the Layout DB module and it briefly identifies the users of these interfaces so as to explain how to use this module.</p>
<ul>
<li><a class="el" href="../../dd/d61/_layout-_d_b-fspec.html#Layout-DB-fspec-ds">Data Structures</a></li>
<li><a class="el" href="../../dd/d61/_layout-_d_b-fspec.html#Layout-DB-fspec-sub">Subroutines</a></li>
<li><a class="el" href="../../dd/d61/_layout-_d_b-fspec.html#Layout-DB-fspec-usecases">Recipes</a></li>
<li><a class="el" href="../../d0/da2/group___layout_d_b_d_f_s.html">Detailed Functional Specification</a></li>
</ul>
<h1><a class="anchor" id="Layout-DB-fspec-ds"></a>
Data Structures</h1>
<ul>
<li>struct <a class="el" href="../../d4/d19/structm0__layout__rec.html">m0_layout_rec</a></li>
</ul>
<h1><a class="anchor" id="Layout-DB-fspec-sub"></a>
Subroutines</h1>
<ul>
<li>int m0_layout_lookup(struct m0_layout_domain *dom, uint64_t lid, struct m0_db_tx *tx, struct m0_db_pair *pair, struct m0_layout **out);</li>
<li>int <a class="el" href="../../d0/da2/group___layout_d_b_d_f_s.html#ga58b398d62d1e1fdd2e02104e579dd1ea">m0_layout_add(struct m0_layout *l, struct m0_db_tx *tx, struct m0_db_pair *pair)</a>;</li>
<li>int <a class="el" href="../../d0/da2/group___layout_d_b_d_f_s.html#ga41eeb702bda6b26afbe8782ac535a15b">m0_layout_update(struct m0_layout *l, struct m0_db_tx *tx, struct m0_db_pair *pair)</a>; int <a class="el" href="../../d0/da2/group___layout_d_b_d_f_s.html#ga2ac08c2c74db2388f863b4bfa7a5a0d6">m0_layout_delete(struct m0_layout *l, struct m0_db_tx *tx, struct m0_db_pair *pair)</a>;</li>
</ul>
<h2><a class="anchor" id="Layout-DB-fspec-sub-acc"></a>
Accessors and Invariants</h2>
<h1><a class="anchor" id="Layout-DB-fspec-usecases"></a>
Recipes</h1>
<p>A file layout is used by the client to perform IO against that file. For example, layout for a file may contain COB identifiers for all the COBs associated with that file. For example, the COB identifiers may be stored by the layout either in the form of a list or as a linear formula.</p>
<p>Example use case of reading a file:</p><ul>
<li>Reading a file involves reading basic file attributes from the basic file attributes table).</li>
<li>The layout id is obtained from the basic file attributes.</li>
<li>A query is sent to the Layout module to obtain layout for this layout id using the API <a class="el" href="../../d0/da2/group___layout_d_b_d_f_s.html#ga6c4bdca167e29cb8af224db83344a0ee">m0_layout_lookup()</a><ul>
<li><a class="el" href="../../d0/da2/group___layout_d_b_d_f_s.html#ga6c4bdca167e29cb8af224db83344a0ee">m0_layout_lookup()</a> returns the layout object if it is cached.</li>
<li>If the layout is not cached, <a class="el" href="../../d0/da2/group___layout_d_b_d_f_s.html#ga6c4bdca167e29cb8af224db83344a0ee">m0_layout_lookup()</a> return it by reading it from the layout DB and by keeping it in the cache.</li>
</ul>
</li>
<li><p class="startli">Reading a layout record from the layout DB involves the following for example:</p><ul>
<li>If the layout record is with the LINEAR enumeration, then the linear formula is obtained from the DB. Once the formula is available, the user can substitute the required parameters into the formula so as to obtain the list of COB identifiers to operate upon.</li>
<li>If the layout record is with the LIST enumeration, then the the list of COB identifiers is obtained from the layout DB itself.</li>
<li>If the layout record is of the COMPOSITE layout type, it means it constitutes of multiple sub-layouts. In this case, the sub-layouts are read from the layout DB. Those sub-layout records in turn could be of other layout types and with LINEAR or LIST enumeration for example. The sub-layout records are then read accordingly until the time the final list of all the COB identifiers is obtained.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="../../d0/da2/group___layout_d_b_d_f_s.html">Layout DB Detailed Functional Specification</a> </dd></dl>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d3/dd6/_d_l_d_i_x.html">Detailed Designs</a></li><li class="navelem"><a class="el" href="../../d8/de8/_layout-_d_b.html">Layout DB DLD</a></li>
    <li class="footer">Generated on Thu Apr 14 2022 14:03:25 for Motr by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
