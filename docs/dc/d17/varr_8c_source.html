<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Motr: lib/varr.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Motr
   &#160;<span id="projectnumber">M0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dc/d17/varr_8c_source.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">varr.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../dc/d17/varr_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* -*- C -*- */</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * Copyright (c) 2013-2020 Seagate Technology LLC and/or its Affiliates</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * you may not use this file except in compliance with the License.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * You may obtain a copy of the License at</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *     http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * See the License for the specific language governing permissions and</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * limitations under the License.</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * For any questions about this software or licensing,</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * please email opensource@seagate.com or cortx-questions@seagate.com.</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d91/bob_8h.html">lib/bob.h</a>&quot;</span>            <span class="comment">/* m0_bob_type */</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d18/memory_8h.html">lib/memory.h</a>&quot;</span>         <span class="comment">/* M0_ALLOC_ARR */</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d2a/lib_2misc_8h.html">lib/misc.h</a>&quot;</span>           <span class="comment">/* m0_forall */</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/dc2/errno_8h.html">lib/errno.h</a>&quot;</span>          <span class="comment">/* Includes appropriate errno header. */</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d49/types_8h.html">lib/types.h</a>&quot;</span>          <span class="comment">/* Includes appropriate types header. */</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/d66/string_8h.html">lib/string.h</a>&quot;</span>         <span class="comment">/* strcmp() */</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/dc9/finject_8h.html">lib/finject.h</a>&quot;</span>        <span class="comment">/* M0_FI_ENABLED() */</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d72/varr_8h.html">lib/varr.h</a>&quot;</span>           <span class="comment">/* m0_varr */</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d3f/varr__private_8h.html">lib/varr_private.h</a>&quot;</span>   <span class="comment">/* m0_varr_buf_alloc(), m0_varr_buf_free */</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#ifndef __KERNEL__</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;limits.h&gt;</span>             <span class="comment">/* CHAR_BIT */</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;linux/pagemap.h&gt;</span>      <span class="comment">/* PAGE_SIZE */</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &lt;linux/limits.h&gt;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="../../dc/d17/varr_8c.html#ae762ad8776496e788bf62e0fa1615b61">   39</a></span>&#160;<span class="preprocessor">#define M0_TRACE_SUBSYSTEM M0_TRACE_SUBSYS_LIB</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d1b/trace_8h.html">lib/trace.h</a>&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="../../dc/d17/varr_8c.html#aae28bf43b009a87b3092c80c073b3b52">   42</a></span>&#160;M0_INTERNAL <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../de/dcc/structm0__bob__type.html">m0_bob_type</a> <a class="code" href="../../dc/d17/varr_8c.html#aae28bf43b009a87b3092c80c073b3b52">varr_bobtype</a>;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<a class="code" href="../../dc/d17/varr_8c.html#a8c9e944c788a5c597a148fa6235a754e">M0_BOB_DEFINE</a>(M0_INTERNAL, &amp;<a class="code" href="../../dc/d17/varr_8c.html#aae28bf43b009a87b3092c80c073b3b52">varr_bobtype</a>, <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a>);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;M0_INTERNAL <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../de/dcc/structm0__bob__type.html">m0_bob_type</a> <a class="code" href="../../dc/d17/varr_8c.html#aae28bf43b009a87b3092c80c073b3b52">varr_bobtype</a> = {</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        .<a class="code" href="../../de/dcc/structm0__bob__type.html#ad5f763ba2b5ee51f9d88f64101eabf6f">bt_name</a>         = <span class="stringliteral">&quot;virtual_array&quot;</span>,</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        .bt_magix_offset = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#ad4a7496cd704df3829c87864e7dbd703">offsetof</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a>, va_magic),</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        .bt_magix        = <a class="code" href="../../dd/d08/magic_8h.html#a82bffe7189227eff068dab27a6040119ad193e8c84f1b0169764b4fea9977d28d">M0_LIB_GENARRAY_MAGIC</a>,</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        .bt_check        = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;};</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;M0_INTERNAL <span class="keywordtype">bool</span> <a class="code" href="../../dc/d17/varr_8c.html#a6f03808b645cb00e0dad3d80115e3200">varr_invariant</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;M0_INTERNAL <span class="keywordtype">int</span> <a class="code" href="../../dc/d17/varr_8c.html#a8b01ee449c16a7a3030adf3f8d8c356d">varr_buffers_alloc</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;M0_INTERNAL <span class="keywordtype">void</span> <a class="code" href="../../dc/d17/varr_8c.html#a49d76def8f99fe60f5cc203cf403bb35">varr_buffers_dealloc</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;M0_INTERNAL uint32_t <a class="code" href="../../dc/d17/varr_8c.html#acc4ac4f9d3862ba274c1df8fe5c3a230">depth_find</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr, uint64_t buff_nr);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;M0_INTERNAL uint32_t <a class="code" href="../../dc/d17/varr_8c.html#a432fd5e3f253276a17b6e284f4b874b3">index_within_level</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr,</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                                        uint64_t target_idx, uint32_t <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a>);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;M0_INTERNAL uint32_t <a class="code" href="../../dc/d17/varr_8c.html#a8b0dc9364932c66fef2e00ccf185f046">children_of_level</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr,</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                                       uint32_t <a class="code" href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a>);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;M0_INTERNAL <span class="keywordtype">void</span> *<a class="code" href="../../dc/d17/varr_8c.html#ad60ebf8a6d4dfaf9bd596898ed226294">cache_fetch</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr, uint64_t <a class="code" href="../../d7/d93/structindex.html">index</a>);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;M0_INTERNAL <span class="keywordtype">void</span> <a class="code" href="../../dc/d17/varr_8c.html#a2d0f0fec84deb254ed60eaeb12fb2b80">cache_update</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr, <span class="keywordtype">void</span> *holder,</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                              uint64_t start_index);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;M0_INTERNAL <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../dc/d17/varr_8c.html#a441fc36aecf8fc47d3c7aa1b762265a4">varr_obj_nr_in_buff</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;M0_INTERNAL uint64_t <a class="code" href="../../dc/d17/varr_8c.html#a19cb0f30f36fd78b7967c0137a456ce4">total_leaf_buffers</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a>,</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                                        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> obj_nr_in_1_cont,</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                                        uint8_t obj_nr_shift);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;M0_INTERNAL uint64_t <a class="code" href="../../dc/d17/varr_8c.html#aa78c1d6be1653ba5fefc1efd644cb2e4">max_idx_within_level</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../da/d8c/structm0__varr__cursor.html">m0_varr_cursor</a> *cursor,</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                                          uint32_t <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a>);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;M0_INTERNAL uint32_t <a class="code" href="../../dc/d17/varr_8c.html#a6c92dd465dc50928577a459ef40baf94">inc_to_idx_xlate</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../da/d8c/structm0__varr__cursor.html">m0_varr_cursor</a> *cursor,</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                                      uint64_t carry, uint32_t <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a>);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;M0_INTERNAL uint64_t <a class="code" href="../../dc/d17/varr_8c.html#aaf9cc9021aca7065056206a06724789f">inc_for_next_level</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../da/d8c/structm0__varr__cursor.html">m0_varr_cursor</a> *cursor,</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                        uint64_t carry, uint32_t <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a>);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;M0_INTERNAL uint8_t <a class="code" href="../../dc/d17/varr_8c.html#a0b8ffbde766e18b0e805e75ce936cba8">log_radix</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr, uint32_t <a class="code" href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a>);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;M0_INTERNAL uint8_t <a class="code" href="../../dc/d17/varr_8c.html#aba52909ef96b580abd22d2109f4d8a4c">nearest_power_of_two</a>(<span class="keywordtype">size_t</span> <a class="code" href="../../db/d9d/bulk__if_8c.html#a86cf672daa4e0ad11ad10efc894d19c8">num</a>);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;M0_INTERNAL uint64_t <a class="code" href="../../dc/d17/varr_8c.html#a67e8455d04cd07c25f5ee2287cae8105">last_nbits_set</a>(uint8_t <a class="code" href="../../d6/d69/rpc_2ut_2fops_8h.html#a27700a99892b7d9ae8741a462791ef78">n</a>);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;M0_INTERNAL <span class="keywordtype">void</span> *<a class="code" href="../../dc/d17/varr_8c.html#a9e751a5ea0dd1d59f4bb2db940dc44ba">buff_incr</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr, uint32_t <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a>,</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                            <span class="keywordtype">void</span> *buff, uint32_t inc);</div><div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="../../dc/d17/varr_8c.html#a6d73ddb09041cdd20e8c8653c70351a5">  106</a></span>&#160;<span class="preprocessor">#define safe_bitshift(num, shift, operator)                              \</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">({                                                                       \</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">        uint8_t     __shift = (shift);                                   \</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">        typeof(num) __num   = (num);                                     \</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">        M0_ASSERT(__shift &lt; CHAR_BIT * sizeof __num);                    \</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">        __num operator __shift;                                          \</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">})</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="../../d1/d85/group__varr.html#gab59e87c9fe2db4071082fb33fa79c655">  114</a></span>&#160;M0_INTERNAL <span class="keywordtype">int</span> <a class="code" href="../../d1/d85/group__varr.html#gab59e87c9fe2db4071082fb33fa79c655">m0_varr_init</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr, uint64_t <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a>, <span class="keywordtype">size_t</span> <a class="code" href="../../d4/d00/ut_2di_8c.html#a8629956d8c29c6159e411f38f24c140d">size</a>,</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                             <span class="keywordtype">size_t</span> bufsize)</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;{</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordtype">int</span>      <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> = 0;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(arr != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a> &gt; 0 &amp;&amp; <a class="code" href="../../d4/d00/ut_2di_8c.html#a8629956d8c29c6159e411f38f24c140d">size</a> &gt; 0 &amp;&amp; bufsize &gt; 0);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d4/d00/ut_2di_8c.html#a8629956d8c29c6159e411f38f24c140d">size</a> &lt;= bufsize);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">#ifdef __KERNEL__</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(bufsize &lt;= <a class="code" href="../../d2/d68/lnet__ut_8c.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a>);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#abdf39f5ccafeffeadaf1585a89b48954">va_nr</a>              = <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="comment">/* Can result into padding if object and buffer sizes are not integer</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">         * powers of two. */</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#aec0d74de8671b8a894aa2a745379174f">va_obj_shift</a>       = <a class="code" href="../../dc/d17/varr_8c.html#aba52909ef96b580abd22d2109f4d8a4c">nearest_power_of_two</a>(<a class="code" href="../../d4/d00/ut_2di_8c.html#a8629956d8c29c6159e411f38f24c140d">size</a>);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a3ad0908bfb0841de37ceeeecbc687431">va_obj_size</a>        = <a class="code" href="../../dc/d17/varr_8c.html#a6d73ddb09041cdd20e8c8653c70351a5">safe_bitshift</a>((<span class="keywordtype">size_t</span>) 1, arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#aec0d74de8671b8a894aa2a745379174f">va_obj_shift</a>,</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                                &lt;&lt;);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a5b5eb9a377d46880e84f98680857cbd5">va_buf_shift</a>       = <a class="code" href="../../dc/d17/varr_8c.html#aba52909ef96b580abd22d2109f4d8a4c">nearest_power_of_two</a>(bufsize);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a74a26be788b1d5e0e92bca308c97df00">va_bufsize</a>         = <a class="code" href="../../dc/d17/varr_8c.html#a6d73ddb09041cdd20e8c8653c70351a5">safe_bitshift</a>((<span class="keywordtype">size_t</span>) 1, arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a5b5eb9a377d46880e84f98680857cbd5">va_buf_shift</a>,</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                                                &lt;&lt;);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ab6a95545c9b7b95efcb4f811cd8787bf">va_bufptr_nr_shift</a> = arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a5b5eb9a377d46880e84f98680857cbd5">va_buf_shift</a> -</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                <a class="code" href="../../dc/d17/varr_8c.html#aba52909ef96b580abd22d2109f4d8a4c">nearest_power_of_two</a>(<a class="code" href="../../d1/d85/group__varr.html#gga17f37faba3c6a98134aabf4181cfa03da89b3ea0cc1526d1279c95203407bbaf4">M0_VA_TNODEPTR_SIZE</a>);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a919d554b2cfb20fbd48b7c87933f7c7a">va_bufptr_nr</a>       = <a class="code" href="../../dc/d17/varr_8c.html#a6d73ddb09041cdd20e8c8653c70351a5">safe_bitshift</a>((uint64_t) 1,</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                                                arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ab6a95545c9b7b95efcb4f811cd8787bf">va_bufptr_nr_shift</a>, &lt;&lt;);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        m0_varr_bob_init(arr);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#af4005d4ec13ddaec06244724b2bfdbf9">va_failure_depth</a>   = 0;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <a class="code" href="../../d7/ded/group__memory.html#ga2dd26426583fa272fa2061075e2dcf57">M0_ALLOC_PTR</a>(arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a713009eeb6d8752d67b6665f124439de">va_cache</a>);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">if</span> (arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a713009eeb6d8752d67b6665f124439de">va_cache</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a9ac0103192044e65358843cfa137c372">va_buff_nr</a> = <a class="code" href="../../dc/d17/varr_8c.html#a19cb0f30f36fd78b7967c0137a456ce4">total_leaf_buffers</a>(arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#abdf39f5ccafeffeadaf1585a89b48954">va_nr</a>,</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                                     <a class="code" href="../../dc/d17/varr_8c.html#a441fc36aecf8fc47d3c7aa1b762265a4">varr_obj_nr_in_buff</a>(arr),</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                                     arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a5b5eb9a377d46880e84f98680857cbd5">va_buf_shift</a> -</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                                                     arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#aec0d74de8671b8a894aa2a745379174f">va_obj_shift</a>);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ad8ae8e7db19fb11cc359c0ebce6f183f">va_depth</a> = <a class="code" href="../../dc/d17/varr_8c.html#acc4ac4f9d3862ba274c1df8fe5c3a230">depth_find</a>(arr, arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a9ac0103192044e65358843cfa137c372">va_buff_nr</a>);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> = <a class="code" href="../../dc/d17/varr_8c.html#a8b01ee449c16a7a3030adf3f8d8c356d">varr_buffers_alloc</a>(arr);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        } <span class="keywordflow">else</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> = -ENOMEM;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> != 0)</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                <a class="code" href="../../d1/d85/group__varr.html#ga6f8bba2108de618eb1951ec19286b101">m0_varr_fini</a>(arr);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a2e1de306397a5d1345d541dbe2fa7544">M0_POST_EX</a>(<a class="code" href="../../df/d2a/lib_2misc_8h.html#a7f75ab6839d468f4d23480a9c65724c5">ergo</a>(<a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> == 0, <a class="code" href="../../dc/d17/varr_8c.html#a6f03808b645cb00e0dad3d80115e3200">varr_invariant</a>(arr)));</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a9a02a790ad457506f9f3bc12121e6079">M0_RC</a>(<a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a>);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="../../dc/d17/varr_8c.html#aba52909ef96b580abd22d2109f4d8a4c">  157</a></span>&#160;M0_INTERNAL uint8_t <a class="code" href="../../dc/d17/varr_8c.html#aba52909ef96b580abd22d2109f4d8a4c">nearest_power_of_two</a>(<span class="keywordtype">size_t</span> <a class="code" href="../../db/d9d/bulk__if_8c.html#a86cf672daa4e0ad11ad10efc894d19c8">num</a>)</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;{</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordtype">size_t</span>  aligned_num  = 1;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        uint8_t aligned_shift = 0;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../db/d9d/bulk__if_8c.html#a86cf672daa4e0ad11ad10efc894d19c8">num</a> &gt; 0);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordflow">while</span> (<a class="code" href="../../db/d9d/bulk__if_8c.html#a86cf672daa4e0ad11ad10efc894d19c8">num</a> &gt; aligned_num) {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                aligned_num = <a class="code" href="../../dc/d17/varr_8c.html#a6d73ddb09041cdd20e8c8653c70351a5">safe_bitshift</a>(aligned_num, 1, &lt;&lt;);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                ++aligned_shift;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">return</span> aligned_shift;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;}</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="../../dc/d17/varr_8c.html#a441fc36aecf8fc47d3c7aa1b762265a4">  171</a></span>&#160;M0_INTERNAL <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../dc/d17/varr_8c.html#a441fc36aecf8fc47d3c7aa1b762265a4">varr_obj_nr_in_buff</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr)</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;{</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(arr != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">return</span>  <a class="code" href="../../dc/d17/varr_8c.html#a6d73ddb09041cdd20e8c8653c70351a5">safe_bitshift</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) 1,</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                              (arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a5b5eb9a377d46880e84f98680857cbd5">va_buf_shift</a> - arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#aec0d74de8671b8a894aa2a745379174f">va_obj_shift</a>), &lt;&lt;);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;}</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="../../dc/d17/varr_8c.html#a19cb0f30f36fd78b7967c0137a456ce4">  178</a></span>&#160;M0_INTERNAL uint64_t <a class="code" href="../../dc/d17/varr_8c.html#a19cb0f30f36fd78b7967c0137a456ce4">total_leaf_buffers</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a>,</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> obj_nr_in_1_cont,</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                        uint8_t obj_nr_shift)</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;{</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        uint64_t buff_nr;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(obj_nr_in_1_cont &gt; 0);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        buff_nr  = <a class="code" href="../../dc/d17/varr_8c.html#a6d73ddb09041cdd20e8c8653c70351a5">safe_bitshift</a>(<a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a>, obj_nr_shift, &gt;&gt;);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        buff_nr += (<a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a> &amp; (obj_nr_in_1_cont - 1)) == 0 ? 0 : 1;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordflow">return</span> buff_nr;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;}</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">/* All trees that hold objects will have same depth. This depth is a many to</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"> * one function of total number of objects to be stored in the array.</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"> * For example, suppose one buffer can hold k objects, then an array of k</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"> * objects can fit into a single leaf node of a tree. Then in order to store an</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"> * array with k + 1 objects, instead of using a tree with depth 2, we use two</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"> * trees each having depth one. Thus, if total number of available trees is</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"> * M0_VA_TNODE_NR then for *all* arrays with total objects less than or equal to</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"> * k * M0_VA_TNODE_NR, depth of trees holding object(s) will be one.</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"> * When total objects in an array exceed k * M0_VA_TNODE_NR, we increase</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"> * depth by one. If buf_size represents size of a buffer, * ptr_size represents</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"> * size of a pointer and obj_size represents size of an object, then following</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"> * table summarizes mapping between total number of objects and depth of trees</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"> * holding objects.</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"> * @verbatim</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">  _______________________________________________________________________</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"> | Max. number of objects                                     | Depth   |</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"> |____________________________________________________________|_________|</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"> | M0_VA_TNODE_NR * (bufsize/obj_size)                        |   1     |</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"> |____________________________________________________________|_________|</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"> | M0_VA_TNODE_NR * (buffsize/ptr_size)  * (buf_size/obj_size)|   2     |</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"> |____________________________________________________________|_________|</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"> | M0_VA_TNODE_NR * (bufsize/ptr_size)^2 * (buf_size/obj_size)|   3     |</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"> |____________________________________________________________|_________|</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"> * @endverbatim</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"> * The current implementation treats the structure virtual array not as a</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"> * collection of trees with same depth, but as a single tree encompassing</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment"> * entire data-structure. Following function returns depth of this tree. For</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"> * each case in the table above, this tree has depth one more than the one</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment"> * mentioned in the table above.</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="../../dc/d17/varr_8c.html#acc4ac4f9d3862ba274c1df8fe5c3a230">  220</a></span>&#160;M0_INTERNAL uint32_t <a class="code" href="../../dc/d17/varr_8c.html#acc4ac4f9d3862ba274c1df8fe5c3a230">depth_find</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr,</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                uint64_t total_leaves)</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;{</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        uint32_t <a class="code" href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a>;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(arr != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(total_leaves &gt; 0);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a> = 1;; ++<a class="code" href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a>)</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                <span class="keywordflow">if</span> (total_leaves &lt;= <a class="code" href="../../dc/d17/varr_8c.html#a6d73ddb09041cdd20e8c8653c70351a5">safe_bitshift</a>((uint64_t) 1,</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                                  arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ab6a95545c9b7b95efcb4f811cd8787bf">va_bufptr_nr_shift</a> *</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                                                  (<a class="code" href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a> - 1) +</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                                                  <a class="code" href="../../d1/d85/group__varr.html#gga17f37faba3c6a98134aabf4181cfa03dac378c947b9d927cb8aea5096574527a7">M0_VA_TNODE_NR_SHIFT</a>, &lt;&lt;))</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a> + 1;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;}</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="../../dc/d17/varr_8c.html#a8b01ee449c16a7a3030adf3f8d8c356d">  237</a></span>&#160;M0_INTERNAL <span class="keywordtype">int</span> <a class="code" href="../../dc/d17/varr_8c.html#a8b01ee449c16a7a3030adf3f8d8c356d">varr_buffers_alloc</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr)</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;{</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../da/d8c/structm0__varr__cursor.html">m0_varr_cursor</a> cursor;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordtype">int</span>                   <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> = 0;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordtype">void</span>                 *holder;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        uint32_t              <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> = 1; <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> &lt; arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ad8ae8e7db19fb11cc359c0ebce6f183f">va_depth</a>; ++<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>) {</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> = <a class="code" href="../../d1/d85/group__varr.html#gaba6dd984f2871e99fe6e83b031d54eeb">m0_varr_cursor_init</a>(&amp;cursor, arr, <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> != 0)</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                        <span class="keywordflow">goto</span> end;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                <span class="keywordflow">do</span> {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                        holder = <a class="code" href="../../d5/d0f/linux__kernel_2varr_8c.html#ae766224f83e4861543fd9b46d527632b">m0_varr_buf_alloc</a>(arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a74a26be788b1d5e0e92bca308c97df00">va_bufsize</a>);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                        <span class="keywordflow">if</span> (holder == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                                <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> = -ENOMEM;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                                arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#af4005d4ec13ddaec06244724b2bfdbf9">va_failure_depth</a> = cursor.<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a707d606a68b751eabb9b1199acd19bf2">vc_done</a> == 0 ?</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                 cursor.<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a7c429f6a5d97719fc029f4f8ba0688cf">vc_depth</a> : cursor.<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a7c429f6a5d97719fc029f4f8ba0688cf">vc_depth</a> + 1;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                                <span class="keywordflow">goto</span> end;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                        }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                        *(<span class="keywordtype">void</span> **)<a class="code" href="../../d1/d85/group__varr.html#gaaf9634624e2f4b37f6e0f21707da2666">m0_varr_cursor_get</a>(&amp;cursor) = holder;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                } <span class="keywordflow">while</span> (<a class="code" href="../../d1/d85/group__varr.html#ga7781025454c6e790a421c43545b4e839">m0_varr_cursor_next</a>(&amp;cursor));</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;end:</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a9a02a790ad457506f9f3bc12121e6079">M0_RC</a>(<a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a>);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;}</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="../../d1/d85/group__varr.html#gaba6dd984f2871e99fe6e83b031d54eeb">  263</a></span>&#160;M0_INTERNAL <span class="keywordtype">int</span> <a class="code" href="../../d1/d85/group__varr.html#gaba6dd984f2871e99fe6e83b031d54eeb">m0_varr_cursor_init</a>(<span class="keyword">struct</span> <a class="code" href="../../da/d8c/structm0__varr__cursor.html">m0_varr_cursor</a> *cursor,</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                                    <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr,</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                                    uint32_t <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a>)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;{</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d3/deb/structm0__varr__path__element.html">m0_varr_path_element</a> *pe;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keywordtype">void</span>                        *<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a4b9218d5c001301e593c59b2f36f9d17">buf</a>;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordtype">void</span>                        *<a class="code" href="../../d7/d48/ut_2note_8c.html#acb740041b3f31283d9739c5c97bcf93a">root</a>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(cursor != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(arr != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(depth &lt;= arr-&gt;va_depth);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a3c8257d30a15c8a8035c89e13bac487d">vc_arr</a>   = (<span class="keyword">struct </span><a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *)arr;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a7c429f6a5d97719fc029f4f8ba0688cf">vc_depth</a> = 0;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a707d606a68b751eabb9b1199acd19bf2">vc_done</a>  = 0;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        pe               = &amp;cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#aeee1820bf8f11c842f249c6f515256ef">vc_path</a>[0];</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        pe-&gt;<a class="code" href="../../d3/deb/structm0__varr__path__element.html#a2fcc7bd22fccff0d73e24ecd9eea2779">vp_idx</a>       = 0;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <a class="code" href="../../d7/d48/ut_2note_8c.html#acb740041b3f31283d9739c5c97bcf93a">root</a>             = (<span class="keywordtype">void</span> *)arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a155015ca581bc3c2c0c8bc57b25a7292">va_tree</a>;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="comment">/* Note that we will never dereference pe-&gt;vp_buf at depth == 0 outside</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">         * the scope of this function */</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        pe-&gt;<a class="code" href="../../d3/deb/structm0__varr__path__element.html#a9a3cb08906e48d45d91bf618b753ea34">vp_buf</a>       = (<span class="keywordtype">void</span> *)&amp;<a class="code" href="../../d7/d48/ut_2note_8c.html#acb740041b3f31283d9739c5c97bcf93a">root</a>;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        pe-&gt;<a class="code" href="../../d3/deb/structm0__varr__path__element.html#a1228115bdcbdfc6426d2937db6a98f97">vp_width</a>     = 1;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keywordflow">while</span> (cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a7c429f6a5d97719fc029f4f8ba0688cf">vc_depth</a> &lt; <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a>) {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                <a class="code" href="../../d9/dd0/structbuf.html">buf</a> = pe-&gt;<a class="code" href="../../d3/deb/structm0__varr__path__element.html#a9a3cb08906e48d45d91bf618b753ea34">vp_buf</a>;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d9/dd0/structbuf.html">buf</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                        ++pe;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                        ++cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a7c429f6a5d97719fc029f4f8ba0688cf">vc_depth</a>;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                        pe-&gt;<a class="code" href="../../d3/deb/structm0__varr__path__element.html#a9a3cb08906e48d45d91bf618b753ea34">vp_buf</a>   = *(<span class="keywordtype">void</span> **)<a class="code" href="../../d9/dd0/structbuf.html">buf</a>;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                        pe-&gt;<a class="code" href="../../d3/deb/structm0__varr__path__element.html#a2fcc7bd22fccff0d73e24ecd9eea2779">vp_idx</a>   = 0;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                        pe-&gt;<a class="code" href="../../d3/deb/structm0__varr__path__element.html#a1228115bdcbdfc6426d2937db6a98f97">vp_width</a> = <a class="code" href="../../dc/d17/varr_8c.html#a8b0dc9364932c66fef2e00ccf185f046">children_of_level</a>(arr,</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                                                         cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a7c429f6a5d97719fc029f4f8ba0688cf">vc_depth</a>);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                } <span class="keywordflow">else</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EINVAL);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;}</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="../../dc/d17/varr_8c.html#a8b0dc9364932c66fef2e00ccf185f046">  301</a></span>&#160;M0_INTERNAL uint32_t <a class="code" href="../../dc/d17/varr_8c.html#a8b0dc9364932c66fef2e00ccf185f046">children_of_level</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr,</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                       uint32_t <a class="code" href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a>)</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;{</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(arr != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(level &lt;= arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ad8ae8e7db19fb11cc359c0ebce6f183f">va_depth</a>);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a> &lt;= 1)</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a> == 1 ? <a class="code" href="../../d1/d85/group__varr.html#gga17f37faba3c6a98134aabf4181cfa03dae55463aacfcb4f929c9b11d66aee0248">M0_VA_TNODE_NR</a> : 1;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a> == arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ad8ae8e7db19fb11cc359c0ebce6f183f">va_depth</a> ?</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                        <a class="code" href="../../dc/d17/varr_8c.html#a6d73ddb09041cdd20e8c8653c70351a5">safe_bitshift</a>((uint32_t) 1,</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                                      arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a5b5eb9a377d46880e84f98680857cbd5">va_buf_shift</a> - arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#aec0d74de8671b8a894aa2a745379174f">va_obj_shift</a>,</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                                      &lt;&lt;) : arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a919d554b2cfb20fbd48b7c87933f7c7a">va_bufptr_nr</a>;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;}</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="../../d1/d85/group__varr.html#gaaf9634624e2f4b37f6e0f21707da2666">  316</a></span>&#160;M0_INTERNAL <span class="keywordtype">void</span>* <a class="code" href="../../d1/d85/group__varr.html#gaaf9634624e2f4b37f6e0f21707da2666">m0_varr_cursor_get</a>(<span class="keyword">struct</span> <a class="code" href="../../da/d8c/structm0__varr__cursor.html">m0_varr_cursor</a> *cursor)</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;{</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(cursor != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keywordflow">return</span> cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#aeee1820bf8f11c842f249c6f515256ef">vc_path</a>[cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a7c429f6a5d97719fc029f4f8ba0688cf">vc_depth</a>].<a class="code" href="../../d3/deb/structm0__varr__path__element.html#a9a3cb08906e48d45d91bf618b753ea34">vp_buf</a>;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;}</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="../../d1/d85/group__varr.html#ga7781025454c6e790a421c43545b4e839">  322</a></span>&#160;M0_INTERNAL <span class="keywordtype">int</span> <a class="code" href="../../d1/d85/group__varr.html#ga7781025454c6e790a421c43545b4e839">m0_varr_cursor_next</a>(<span class="keyword">struct</span> <a class="code" href="../../da/d8c/structm0__varr__cursor.html">m0_varr_cursor</a> *cursor)</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;{</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d1/d85/group__varr.html#gaac38f6ce41cbd8a973baf00d3ecdb917">m0_varr_cursor_move</a>(cursor, 1);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;}</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="../../d1/d85/group__varr.html#gaac38f6ce41cbd8a973baf00d3ecdb917">  327</a></span>&#160;M0_INTERNAL <span class="keywordtype">int</span> <a class="code" href="../../d1/d85/group__varr.html#gaac38f6ce41cbd8a973baf00d3ecdb917">m0_varr_cursor_move</a>(<span class="keyword">struct</span> <a class="code" href="../../da/d8c/structm0__varr__cursor.html">m0_varr_cursor</a> *cursor,</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                                    uint64_t inc)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;{</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordtype">void</span>                        *<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a4b9218d5c001301e593c59b2f36f9d17">buf</a>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d3/deb/structm0__varr__path__element.html">m0_varr_path_element</a> *pe;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        uint32_t                     d = cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a7c429f6a5d97719fc029f4f8ba0688cf">vc_depth</a>;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        uint64_t                     target_idx;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        uint64_t                     max_idx_in_level;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        uint64_t                     idx_in_level;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(cursor != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(d &lt;= cursor-&gt;vc_arr-&gt;va_depth);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        pe = &amp;cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#aeee1820bf8f11c842f249c6f515256ef">vc_path</a>[d];</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        max_idx_in_level = <a class="code" href="../../dc/d17/varr_8c.html#aa78c1d6be1653ba5fefc1efd644cb2e4">max_idx_within_level</a>(cursor, d);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        target_idx = cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a707d606a68b751eabb9b1199acd19bf2">vc_done</a> + inc;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordflow">if</span> (target_idx &gt; max_idx_in_level)</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                <span class="keywordflow">goto</span> end;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (target_idx == cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a707d606a68b751eabb9b1199acd19bf2">vc_done</a>)</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                <span class="keywordflow">goto</span> <a class="code" href="../../d3/daf/group___s_n_s_c_m_c_p.html#ga57d2c0c6b3e56c083dd5cd3fb627de6c">next</a>;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        idx_in_level = pe-&gt;<a class="code" href="../../d3/deb/structm0__varr__path__element.html#a2fcc7bd22fccff0d73e24ecd9eea2779">vp_idx</a> + inc;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordflow">while</span> (d &gt; 0 &amp;&amp; idx_in_level &gt;= pe-&gt;<a class="code" href="../../d3/deb/structm0__varr__path__element.html#a1228115bdcbdfc6426d2937db6a98f97">vp_width</a>) {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                inc        = <a class="code" href="../../dc/d17/varr_8c.html#aaf9cc9021aca7065056206a06724789f">inc_for_next_level</a>(cursor, idx_in_level,</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                                  d);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                pe-&gt;<a class="code" href="../../d3/deb/structm0__varr__path__element.html#a2fcc7bd22fccff0d73e24ecd9eea2779">vp_idx</a> = <a class="code" href="../../dc/d17/varr_8c.html#a6c92dd465dc50928577a459ef40baf94">inc_to_idx_xlate</a>(cursor, idx_in_level, d);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                --pe;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                --d;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                idx_in_level  = pe-&gt;<a class="code" href="../../d3/deb/structm0__varr__path__element.html#a2fcc7bd22fccff0d73e24ecd9eea2779">vp_idx</a> + inc;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        pe-&gt;<a class="code" href="../../d3/deb/structm0__varr__path__element.html#a9a3cb08906e48d45d91bf618b753ea34">vp_buf</a> = <a class="code" href="../../dc/d17/varr_8c.html#a9e751a5ea0dd1d59f4bb2db940dc44ba">buff_incr</a>(cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a3c8257d30a15c8a8035c89e13bac487d">vc_arr</a>, d, pe-&gt;<a class="code" href="../../d3/deb/structm0__varr__path__element.html#a9a3cb08906e48d45d91bf618b753ea34">vp_buf</a>,</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                               inc);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        pe-&gt;<a class="code" href="../../d3/deb/structm0__varr__path__element.html#a2fcc7bd22fccff0d73e24ecd9eea2779">vp_idx</a> = idx_in_level;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keywordflow">while</span> (d &lt; cursor-&gt;vc_depth) {</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                <a class="code" href="../../d9/dd0/structbuf.html">buf</a> = pe-&gt;<a class="code" href="../../d3/deb/structm0__varr__path__element.html#a9a3cb08906e48d45d91bf618b753ea34">vp_buf</a>;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                ++pe;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                ++d;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                pe-&gt;<a class="code" href="../../d3/deb/structm0__varr__path__element.html#a9a3cb08906e48d45d91bf618b753ea34">vp_buf</a> = *(<span class="keywordtype">void</span> **)<a class="code" href="../../d9/dd0/structbuf.html">buf</a>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                pe-&gt;<a class="code" href="../../d3/deb/structm0__varr__path__element.html#a9a3cb08906e48d45d91bf618b753ea34">vp_buf</a> = <a class="code" href="../../dc/d17/varr_8c.html#a9e751a5ea0dd1d59f4bb2db940dc44ba">buff_incr</a>(cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a3c8257d30a15c8a8035c89e13bac487d">vc_arr</a>, d, pe-&gt;<a class="code" href="../../d3/deb/structm0__varr__path__element.html#a9a3cb08906e48d45d91bf618b753ea34">vp_buf</a>,</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                                       pe-&gt;<a class="code" href="../../d3/deb/structm0__varr__path__element.html#a2fcc7bd22fccff0d73e24ecd9eea2779">vp_idx</a>);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a707d606a68b751eabb9b1199acd19bf2">vc_done</a> = target_idx;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordflow">goto</span> <a class="code" href="../../d3/daf/group___s_n_s_c_m_c_p.html#ga57d2c0c6b3e56c083dd5cd3fb627de6c">next</a>;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<a class="code" href="../../d3/daf/group___s_n_s_c_m_c_p.html#ga57d2c0c6b3e56c083dd5cd3fb627de6c">next</a>:</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;end:</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;}</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="../../dc/d17/varr_8c.html#aa78c1d6be1653ba5fefc1efd644cb2e4">  376</a></span>&#160;M0_INTERNAL uint64_t <a class="code" href="../../dc/d17/varr_8c.html#aa78c1d6be1653ba5fefc1efd644cb2e4">max_idx_within_level</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../da/d8c/structm0__varr__cursor.html">m0_varr_cursor</a> *cursor,</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                          uint32_t <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a>)</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;{</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        uint64_t shift;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        shift = <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a> == cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a3c8257d30a15c8a8035c89e13bac487d">vc_arr</a>-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ad8ae8e7db19fb11cc359c0ebce6f183f">va_depth</a> ? 0 :</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a3c8257d30a15c8a8035c89e13bac487d">vc_arr</a>-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a5b5eb9a377d46880e84f98680857cbd5">va_buf_shift</a> - cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a3c8257d30a15c8a8035c89e13bac487d">vc_arr</a>-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#aec0d74de8671b8a894aa2a745379174f">va_obj_shift</a> +</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                (cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a3c8257d30a15c8a8035c89e13bac487d">vc_arr</a>-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ad8ae8e7db19fb11cc359c0ebce6f183f">va_depth</a> - <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a> - 1) *</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a3c8257d30a15c8a8035c89e13bac487d">vc_arr</a>-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ab6a95545c9b7b95efcb4f811cd8787bf">va_bufptr_nr_shift</a>;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d17/varr_8c.html#a6d73ddb09041cdd20e8c8653c70351a5">safe_bitshift</a>(cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a3c8257d30a15c8a8035c89e13bac487d">vc_arr</a>-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#abdf39f5ccafeffeadaf1585a89b48954">va_nr</a> - 1, shift, &gt;&gt;);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;}</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno"><a class="line" href="../../dc/d17/varr_8c.html#a6c92dd465dc50928577a459ef40baf94">  388</a></span>&#160;M0_INTERNAL uint32_t <a class="code" href="../../dc/d17/varr_8c.html#a6c92dd465dc50928577a459ef40baf94">inc_to_idx_xlate</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../da/d8c/structm0__varr__cursor.html">m0_varr_cursor</a> *cursor,</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                                        uint64_t carry, uint32_t <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a>)</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;{</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(cursor != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(depth &lt;= cursor-&gt;vc_arr-&gt;va_depth);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="keywordflow">return</span> carry &amp; (cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#aeee1820bf8f11c842f249c6f515256ef">vc_path</a>[<a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a>].<a class="code" href="../../d3/deb/structm0__varr__path__element.html#a1228115bdcbdfc6426d2937db6a98f97">vp_width</a> - 1);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;}</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="../../dc/d17/varr_8c.html#aaf9cc9021aca7065056206a06724789f">  396</a></span>&#160;M0_INTERNAL uint64_t <a class="code" href="../../dc/d17/varr_8c.html#aaf9cc9021aca7065056206a06724789f">inc_for_next_level</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../da/d8c/structm0__varr__cursor.html">m0_varr_cursor</a> *cursor,</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                                          uint64_t carry, uint32_t <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a>)</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;{</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(cursor != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(depth &lt;= cursor-&gt;vc_arr-&gt;va_depth);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d17/varr_8c.html#a6d73ddb09041cdd20e8c8653c70351a5">safe_bitshift</a>(carry, <a class="code" href="../../dc/d17/varr_8c.html#a0b8ffbde766e18b0e805e75ce936cba8">log_radix</a>(cursor-&gt;<a class="code" href="../../da/d8c/structm0__varr__cursor.html#a3c8257d30a15c8a8035c89e13bac487d">vc_arr</a>, <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a>), &gt;&gt;);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;}</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno"><a class="line" href="../../dc/d17/varr_8c.html#a0b8ffbde766e18b0e805e75ce936cba8">  404</a></span>&#160;M0_INTERNAL uint8_t <a class="code" href="../../dc/d17/varr_8c.html#a0b8ffbde766e18b0e805e75ce936cba8">log_radix</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr, uint32_t <a class="code" href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a>)</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;{</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(arr != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(level &lt;= arr-&gt;va_depth);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a> &lt;= 1)</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a> == 1 ? <a class="code" href="../../d1/d85/group__varr.html#gga17f37faba3c6a98134aabf4181cfa03dac378c947b9d927cb8aea5096574527a7">M0_VA_TNODE_NR_SHIFT</a> : 0;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a> == arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ad8ae8e7db19fb11cc359c0ebce6f183f">va_depth</a> ?</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                        arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a5b5eb9a377d46880e84f98680857cbd5">va_buf_shift</a> - arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#aec0d74de8671b8a894aa2a745379174f">va_obj_shift</a> :</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                        arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ab6a95545c9b7b95efcb4f811cd8787bf">va_bufptr_nr_shift</a>;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;}</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno"><a class="line" href="../../dc/d17/varr_8c.html#a432fd5e3f253276a17b6e284f4b874b3">  417</a></span>&#160;M0_INTERNAL uint32_t <a class="code" href="../../dc/d17/varr_8c.html#a432fd5e3f253276a17b6e284f4b874b3">index_within_level</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr,</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                                        uint64_t target_idx, uint32_t <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a>)</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;{</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        uint64_t shift;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        uint64_t mask_bits;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(arr != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(depth &lt;= arr-&gt;va_depth);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        shift = <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a> == arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ad8ae8e7db19fb11cc359c0ebce6f183f">va_depth</a> ? 0 :</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a5b5eb9a377d46880e84f98680857cbd5">va_buf_shift</a> - arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#aec0d74de8671b8a894aa2a745379174f">va_obj_shift</a> +</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                (arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ad8ae8e7db19fb11cc359c0ebce6f183f">va_depth</a> - <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a> - 1) * arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ab6a95545c9b7b95efcb4f811cd8787bf">va_bufptr_nr_shift</a>;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        mask_bits = <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a> == arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ad8ae8e7db19fb11cc359c0ebce6f183f">va_depth</a> ?</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a5b5eb9a377d46880e84f98680857cbd5">va_buf_shift</a> - arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#aec0d74de8671b8a894aa2a745379174f">va_obj_shift</a> :</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a> == 1 ? <a class="code" href="../../d1/d85/group__varr.html#gga17f37faba3c6a98134aabf4181cfa03dac378c947b9d927cb8aea5096574527a7">M0_VA_TNODE_NR_SHIFT</a> : arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ab6a95545c9b7b95efcb4f811cd8787bf">va_bufptr_nr_shift</a>;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        target_idx  = <a class="code" href="../../dc/d17/varr_8c.html#a6d73ddb09041cdd20e8c8653c70351a5">safe_bitshift</a>(target_idx, shift, &gt;&gt;);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        target_idx &amp;= <a class="code" href="../../dc/d17/varr_8c.html#a67e8455d04cd07c25f5ee2287cae8105">last_nbits_set</a>(mask_bits);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="keywordflow">return</span> target_idx;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;}</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno"><a class="line" href="../../dc/d17/varr_8c.html#a67e8455d04cd07c25f5ee2287cae8105">  437</a></span>&#160;M0_INTERNAL uint64_t <a class="code" href="../../dc/d17/varr_8c.html#a67e8455d04cd07c25f5ee2287cae8105">last_nbits_set</a>(uint8_t <a class="code" href="../../d6/d69/rpc_2ut_2fops_8h.html#a27700a99892b7d9ae8741a462791ef78">n</a>)</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;{</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d6/d69/rpc_2ut_2fops_8h.html#a27700a99892b7d9ae8741a462791ef78">n</a> &lt;= 64);</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d6/d69/rpc_2ut_2fops_8h.html#a27700a99892b7d9ae8741a462791ef78">n</a> &lt; 64 ? ~<a class="code" href="../../dc/d17/varr_8c.html#a6d73ddb09041cdd20e8c8653c70351a5">safe_bitshift</a>(~(uint64_t) 0, <a class="code" href="../../d6/d69/rpc_2ut_2fops_8h.html#a27700a99892b7d9ae8741a462791ef78">n</a>, &lt;&lt;) :</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                ~(uint64_t) 0;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;}</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno"><a class="line" href="../../dc/d17/varr_8c.html#a9e751a5ea0dd1d59f4bb2db940dc44ba">  444</a></span>&#160;M0_INTERNAL <span class="keywordtype">void</span> *<a class="code" href="../../dc/d17/varr_8c.html#a9e751a5ea0dd1d59f4bb2db940dc44ba">buff_incr</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr, uint32_t <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a>,</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                            <span class="keywordtype">void</span> *buff, uint32_t inc)</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;{</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordtype">size_t</span> inc_unit;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(arr != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; buff != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a> == arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ad8ae8e7db19fb11cc359c0ebce6f183f">va_depth</a>)</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                inc_unit = arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a3ad0908bfb0841de37ceeeecbc687431">va_obj_size</a>;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                inc_unit = <a class="code" href="../../d1/d85/group__varr.html#gga17f37faba3c6a98134aabf4181cfa03da89b3ea0cc1526d1279c95203407bbaf4">M0_VA_TNODEPTR_SIZE</a>;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        buff += inc*inc_unit;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="keywordflow">return</span> buff;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;}</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno"><a class="line" href="../../dc/d17/varr_8c.html#a49d76def8f99fe60f5cc203cf403bb35">  459</a></span>&#160;M0_INTERNAL <span class="keywordtype">void</span> <a class="code" href="../../dc/d17/varr_8c.html#a49d76def8f99fe60f5cc203cf403bb35">varr_buffers_dealloc</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr)</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;{</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../da/d8c/structm0__varr__cursor.html">m0_varr_cursor</a> cursor;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="keywordtype">int</span>                   <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a>;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keywordtype">void</span>                 *holder;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        int32_t               <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        uint32_t              <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a>;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a> = arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#af4005d4ec13ddaec06244724b2bfdbf9">va_failure_depth</a> == 0 ? arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ad8ae8e7db19fb11cc359c0ebce6f183f">va_depth</a> :</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#af4005d4ec13ddaec06244724b2bfdbf9">va_failure_depth</a>;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> = <a class="code" href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a> - 1; <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> &gt; 0; --<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>) {</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> = <a class="code" href="../../d1/d85/group__varr.html#gaba6dd984f2871e99fe6e83b031d54eeb">m0_varr_cursor_init</a>(&amp;cursor, arr, <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(<a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> == 0);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                <span class="keywordflow">do</span> {</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                        holder = *(<span class="keywordtype">void</span> **)<a class="code" href="../../d1/d85/group__varr.html#gaaf9634624e2f4b37f6e0f21707da2666">m0_varr_cursor_get</a>(&amp;cursor);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                        <span class="comment">/* This condition will fail when varr_buffers_alloc()</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">                         * has got terminated intermittently. */</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                        <span class="keywordflow">if</span> ((<span class="keywordtype">void</span> *)holder != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                                <a class="code" href="../../d5/d0f/linux__kernel_2varr_8c.html#a83f125dc17a501fe72f4aeada3943c90">m0_varr_buf_free</a>(holder, arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a74a26be788b1d5e0e92bca308c97df00">va_bufsize</a>);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                        } <span class="keywordflow">else</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                } <span class="keywordflow">while</span> (<a class="code" href="../../d1/d85/group__varr.html#ga7781025454c6e790a421c43545b4e839">m0_varr_cursor_next</a>(&amp;cursor));</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        }</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;}</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno"><a class="line" href="../../d1/d85/group__varr.html#ga6f8bba2108de618eb1951ec19286b101">  486</a></span>&#160;M0_INTERNAL <span class="keywordtype">void</span> <a class="code" href="../../d1/d85/group__varr.html#ga6f8bba2108de618eb1951ec19286b101">m0_varr_fini</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr)</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;{</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(arr != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a43de0aa0897f31bc310c085f7216f463">M0_PRE_EX</a>(<a class="code" href="../../dc/d17/varr_8c.html#a6f03808b645cb00e0dad3d80115e3200">varr_invariant</a>(arr));</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <a class="code" href="../../dc/d17/varr_8c.html#a49d76def8f99fe60f5cc203cf403bb35">varr_buffers_dealloc</a>(arr);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <a class="code" href="../../d7/ded/group__memory.html#ga0b8533a3024754008602759e71337eb3">m0_free</a>(arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a713009eeb6d8752d67b6665f124439de">va_cache</a>);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        m0_varr_bob_fini(arr);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#abdf39f5ccafeffeadaf1585a89b48954">va_nr</a>     = arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a74a26be788b1d5e0e92bca308c97df00">va_bufsize</a> = 0;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ad8ae8e7db19fb11cc359c0ebce6f183f">va_depth</a>  = 0;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;}</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno"><a class="line" href="../../dc/d17/varr_8c.html#a6f03808b645cb00e0dad3d80115e3200">  498</a></span>&#160;M0_INTERNAL <span class="keywordtype">bool</span> <a class="code" href="../../dc/d17/varr_8c.html#a6f03808b645cb00e0dad3d80115e3200">varr_invariant</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr)</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;{</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keywordflow">return</span>  m0_varr_bob_check(arr) &amp;&amp;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#abdf39f5ccafeffeadaf1585a89b48954">va_nr</a> &gt; 0         &amp;&amp;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a5b5eb9a377d46880e84f98680857cbd5">va_buf_shift</a> &gt;= arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#aec0d74de8671b8a894aa2a745379174f">va_obj_shift</a>;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;}</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno"><a class="line" href="../../d1/d85/group__varr.html#ga35cafde5ff1cf649c57a2a900dc8155d">  505</a></span>&#160;M0_INTERNAL <span class="keywordtype">void</span> *<a class="code" href="../../d1/d85/group__varr.html#ga35cafde5ff1cf649c57a2a900dc8155d">m0_varr_ele_get</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr, uint64_t <a class="code" href="../../d7/d93/structindex.html">index</a>)</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;{</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        uint32_t  <a class="code" href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a>;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="keywordtype">void</span>     *holder;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(arr != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d7/d93/structindex.html">index &lt; arr-&gt;</a>va_nr);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        holder = <a class="code" href="../../dc/d17/varr_8c.html#ad60ebf8a6d4dfaf9bd596898ed226294">cache_fetch</a>(arr, <a class="code" href="../../d7/d93/structindex.html">index</a>);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordflow">if</span> (holder != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                <span class="keywordflow">goto</span> end;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        holder = (<span class="keywordtype">void</span> *)arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a155015ca581bc3c2c0c8bc57b25a7292">va_tree</a>;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        for (<a class="code" href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a> = 1; <a class="code" href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a> &lt; arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ad8ae8e7db19fb11cc359c0ebce6f183f">va_depth</a>; ++<a class="code" href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a>) {</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                holder =  <a class="code" href="../../dc/d17/varr_8c.html#a9e751a5ea0dd1d59f4bb2db940dc44ba">buff_incr</a>(arr, <a class="code" href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a>, holder,</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                                    <a class="code" href="../../dc/d17/varr_8c.html#a432fd5e3f253276a17b6e284f4b874b3">index_within_level</a>((<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *)</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                                                       arr, <a class="code" href="../../d7/d93/structindex.html">index</a>, <a class="code" href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a>));</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                <span class="comment">/* Dereferences the buffer pointer at given offset. */</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                holder = *(<span class="keywordtype">void</span> **)holder;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(holder != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        }</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <a class="code" href="../../dc/d17/varr_8c.html#a2d0f0fec84deb254ed60eaeb12fb2b80">cache_update</a>(arr, holder, <a class="code" href="../../d7/d93/structindex.html">index</a>);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a2e1de306397a5d1345d541dbe2fa7544">M0_POST_EX</a>(<a class="code" href="../../dc/d17/varr_8c.html#a6f03808b645cb00e0dad3d80115e3200">varr_invariant</a>(arr));</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;end:</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="comment">/* Adds to holder the index of required object within a buffer */</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d17/varr_8c.html#a9e751a5ea0dd1d59f4bb2db940dc44ba">buff_incr</a>(arr, arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ad8ae8e7db19fb11cc359c0ebce6f183f">va_depth</a>, holder,</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                         <a class="code" href="../../dc/d17/varr_8c.html#a432fd5e3f253276a17b6e284f4b874b3">index_within_level</a>((<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *) arr,</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                                            <a class="code" href="../../d7/d93/structindex.html">index</a>, arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ad8ae8e7db19fb11cc359c0ebce6f183f">va_depth</a>));</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;}</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno"><a class="line" href="../../dc/d17/varr_8c.html#ad60ebf8a6d4dfaf9bd596898ed226294">  535</a></span>&#160;M0_INTERNAL <span class="keywordtype">void</span> *<a class="code" href="../../dc/d17/varr_8c.html#ad60ebf8a6d4dfaf9bd596898ed226294">cache_fetch</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr, uint64_t <a class="code" href="../../d7/d93/structindex.html">index</a>)</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;{</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../da/d1c/structvarr__cache.html">varr_cache</a> *<a class="code" href="../../d1/df6/structcache.html">cache</a>;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(arr != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <a class="code" href="../../d1/df6/structcache.html">cache</a> = arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a713009eeb6d8752d67b6665f124439de">va_cache</a>;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d1/df6/structcache.html">cache</a>-&gt;vc_buff != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>           &amp;&amp;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                <a class="code" href="../../d1/df6/structcache.html">cache</a>-&gt;vc_first_index &lt;= <a class="code" href="../../d7/d93/structindex.html">index</a>  &amp;&amp;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                <a class="code" href="../../d7/d93/structindex.html">index</a> &lt;= <a class="code" href="../../d1/df6/structcache.html">cache</a>-&gt;vc_last_index   ?</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                <a class="code" href="../../d1/df6/structcache.html">cache</a>-&gt;vc_buff : <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;}</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno"><a class="line" href="../../dc/d17/varr_8c.html#a2d0f0fec84deb254ed60eaeb12fb2b80">  547</a></span>&#160;M0_INTERNAL <span class="keywordtype">void</span> <a class="code" href="../../dc/d17/varr_8c.html#a2d0f0fec84deb254ed60eaeb12fb2b80">cache_update</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr, <span class="keywordtype">void</span> *holder,</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                              uint64_t <a class="code" href="../../d7/d93/structindex.html">index</a>)</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;{</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        uint64_t           index_in_level;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../da/d1c/structvarr__cache.html">varr_cache</a> *<a class="code" href="../../d1/df6/structcache.html">cache</a>;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(arr != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d7/d93/structindex.html">index &lt; arr-&gt;</a>va_nr);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <a class="code" href="../../d1/df6/structcache.html">cache</a> = arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#a713009eeb6d8752d67b6665f124439de">va_cache</a>;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        index_in_level = <a class="code" href="../../dc/d17/varr_8c.html#a432fd5e3f253276a17b6e284f4b874b3">index_within_level</a>((<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *)arr,</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                                            <a class="code" href="../../d7/d93/structindex.html">index</a>, arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#ad8ae8e7db19fb11cc359c0ebce6f183f">va_depth</a>);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <a class="code" href="../../d1/df6/structcache.html">cache</a>-&gt;vc_buff = holder;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <a class="code" href="../../d1/df6/structcache.html">cache</a>-&gt;vc_first_index = <a class="code" href="../../d7/d93/structindex.html">index</a> - index_in_level;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <a class="code" href="../../d1/df6/structcache.html">cache</a>-&gt;vc_last_index = <a class="code" href="../../db/dc9/group__arith.html#ga3ab271ddef8d2ab1ee331f95138294b5">min64u</a>(<a class="code" href="../../d1/df6/structcache.html">cache</a>-&gt;vc_first_index +</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                                      <a class="code" href="../../dc/d17/varr_8c.html#a441fc36aecf8fc47d3c7aa1b762265a4">varr_obj_nr_in_buff</a>((<span class="keyword">const</span> <span class="keyword">struct</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                                                           <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *) arr) -</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                                      1, arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#abdf39f5ccafeffeadaf1585a89b48954">va_nr</a> - 1);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;}</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno"><a class="line" href="../../d1/d85/group__varr.html#ga2f7c8b2091bf82e77ccb0c20bd82ecaa">  567</a></span>&#160;M0_INTERNAL uint64_t <a class="code" href="../../d1/d85/group__varr.html#ga2f7c8b2091bf82e77ccb0c20bd82ecaa">m0_varr_size</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d75/structm0__varr.html">m0_varr</a> *arr)</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;{</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(arr != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="keywordflow">return</span> arr-&gt;<a class="code" href="../../d5/d75/structm0__varr.html#abdf39f5ccafeffeadaf1585a89b48954">va_nr</a>;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;}</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="preprocessor">#undef M0_TRACE_SUBSYSTEM</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment"> *  Local variables:</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment"> *  c-indentation-style: &quot;K&amp;R&quot;</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment"> *  c-basic-offset: 8</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment"> *  tab-width: 8</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment"> *  fill-column: 80</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment"> *  scroll-step: 1</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment"> *  End:</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment"> */</span></div><div class="ttc" id="group__varr_html_gaba6dd984f2871e99fe6e83b031d54eeb"><div class="ttname"><a href="../../d1/d85/group__varr.html#gaba6dd984f2871e99fe6e83b031d54eeb">m0_varr_cursor_init</a></div><div class="ttdeci">M0_INTERNAL int m0_varr_cursor_init(struct m0_varr_cursor *cursor, const struct m0_varr *arr, uint32_t depth)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00263">varr.c:263</a></div></div>
<div class="ttc" id="varr_8c_html_a19cb0f30f36fd78b7967c0137a456ce4"><div class="ttname"><a href="../../dc/d17/varr_8c.html#a19cb0f30f36fd78b7967c0137a456ce4">total_leaf_buffers</a></div><div class="ttdeci">M0_INTERNAL uint64_t total_leaf_buffers(unsigned long nr, unsigned long obj_nr_in_1_cont, uint8_t obj_nr_shift)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00178">varr.c:178</a></div></div>
<div class="ttc" id="structcache_html"><div class="ttname"><a href="../../d1/df6/structcache.html">cache</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d8d/beck_8c_source.html#l00235">beck.c:235</a></div></div>
<div class="ttc" id="structm0__varr__path__element_html"><div class="ttname"><a href="../../d3/deb/structm0__varr__path__element.html">m0_varr_path_element</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00102">varr.h:102</a></div></div>
<div class="ttc" id="group__addb2_html_ga5b89fe130d0e27d86bd6b4d92141a87e"><div class="ttname"><a href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a></div><div class="ttdeci">static size_t nr</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d75/dump_8c_source.html#l01505">dump.c:1505</a></div></div>
<div class="ttc" id="assert_8h_html_a1c063bd08f7e1ab3a6e6008ef825d471"><div class="ttname"><a href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a></div><div class="ttdeci">#define M0_PRE(cond)</div></div>
<div class="ttc" id="trace_8h_html"><div class="ttname"><a href="../../d1/d1b/trace_8h.html">trace.h</a></div></div>
<div class="ttc" id="types_8h_html"><div class="ttname"><a href="../../d9/d49/types_8h.html">types.h</a></div></div>
<div class="ttc" id="structm0__varr_html_a9ac0103192044e65358843cfa137c372"><div class="ttname"><a href="../../d5/d75/structm0__varr.html#a9ac0103192044e65358843cfa137c372">m0_varr::va_buff_nr</a></div><div class="ttdeci">uint64_t va_buff_nr</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00125">varr.h:125</a></div></div>
<div class="ttc" id="memory_8h_html"><div class="ttname"><a href="../../dc/d18/memory_8h.html">memory.h</a></div></div>
<div class="ttc" id="structm0__varr__cursor_html_a707d606a68b751eabb9b1199acd19bf2"><div class="ttname"><a href="../../da/d8c/structm0__varr__cursor.html#a707d606a68b751eabb9b1199acd19bf2">m0_varr_cursor::vc_done</a></div><div class="ttdeci">uint64_t vc_done</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00112">varr.h:112</a></div></div>
<div class="ttc" id="structm0__varr__cursor_html_a7c429f6a5d97719fc029f4f8ba0688cf"><div class="ttname"><a href="../../da/d8c/structm0__varr__cursor.html#a7c429f6a5d97719fc029f4f8ba0688cf">m0_varr_cursor::vc_depth</a></div><div class="ttdeci">uint32_t vc_depth</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00110">varr.h:110</a></div></div>
<div class="ttc" id="structm0__varr__cursor_html_a3c8257d30a15c8a8035c89e13bac487d"><div class="ttname"><a href="../../da/d8c/structm0__varr__cursor.html#a3c8257d30a15c8a8035c89e13bac487d">m0_varr_cursor::vc_arr</a></div><div class="ttdeci">struct m0_varr * vc_arr</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00109">varr.h:109</a></div></div>
<div class="ttc" id="lib_2user__space_2misc_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../db/df8/lib_2user__space_2misc_8h_source.html#l00038">misc.h:38</a></div></div>
<div class="ttc" id="string_8h_html"><div class="ttname"><a href="../../da/d66/string_8h.html">string.h</a></div></div>
<div class="ttc" id="lib_2misc_8h_html_a7f75ab6839d468f4d23480a9c65724c5"><div class="ttname"><a href="../../df/d2a/lib_2misc_8h.html#a7f75ab6839d468f4d23480a9c65724c5">ergo</a></div><div class="ttdeci">#define ergo(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d2a/lib_2misc_8h_source.html#l00293">misc.h:293</a></div></div>
<div class="ttc" id="structm0__varr_html_a155015ca581bc3c2c0c8bc57b25a7292"><div class="ttname"><a href="../../d5/d75/structm0__varr.html#a155015ca581bc3c2c0c8bc57b25a7292">m0_varr::va_tree</a></div><div class="ttdeci">void * va_tree[M0_VA_TNODE_NR]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00157">varr.h:157</a></div></div>
<div class="ttc" id="errno_8h_html"><div class="ttname"><a href="../../d8/dc2/errno_8h.html">errno.h</a></div></div>
<div class="ttc" id="trace_8c_html_a6543b98a1d49f74ab36f657fae00df6f"><div class="ttname"><a href="../../d8/ddc/trace_8c.html#a6543b98a1d49f74ab36f657fae00df6f">level</a></div><div class="ttdeci">enum m0_trace_level level</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddc/trace_8c_source.html#l00111">trace.c:111</a></div></div>
<div class="ttc" id="varr_8h_html"><div class="ttname"><a href="../../d4/d72/varr_8h.html">varr.h</a></div></div>
<div class="ttc" id="structm0__varr__cursor_html_aeee1820bf8f11c842f249c6f515256ef"><div class="ttname"><a href="../../da/d8c/structm0__varr__cursor.html#aeee1820bf8f11c842f249c6f515256ef">m0_varr_cursor::vc_path</a></div><div class="ttdeci">struct m0_varr_path_element vc_path[M0_VA_DEPTH_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00118">varr.h:118</a></div></div>
<div class="ttc" id="structm0__bob__type_html"><div class="ttname"><a href="../../de/dcc/structm0__bob__type.html">m0_bob_type</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d91/bob_8h_source.html#l00071">bob.h:71</a></div></div>
<div class="ttc" id="structm0__varr_html_a3ad0908bfb0841de37ceeeecbc687431"><div class="ttname"><a href="../../d5/d75/structm0__varr.html#a3ad0908bfb0841de37ceeeecbc687431">m0_varr::va_obj_size</a></div><div class="ttdeci">size_t va_obj_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00126">varr.h:126</a></div></div>
<div class="ttc" id="group__varr_html_gaac38f6ce41cbd8a973baf00d3ecdb917"><div class="ttname"><a href="../../d1/d85/group__varr.html#gaac38f6ce41cbd8a973baf00d3ecdb917">m0_varr_cursor_move</a></div><div class="ttdeci">M0_INTERNAL int m0_varr_cursor_move(struct m0_varr_cursor *cursor, uint64_t inc)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00327">varr.c:327</a></div></div>
<div class="ttc" id="varr_8c_html_aa78c1d6be1653ba5fefc1efd644cb2e4"><div class="ttname"><a href="../../dc/d17/varr_8c.html#aa78c1d6be1653ba5fefc1efd644cb2e4">max_idx_within_level</a></div><div class="ttdeci">M0_INTERNAL uint64_t max_idx_within_level(const struct m0_varr_cursor *cursor, uint32_t depth)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00376">varr.c:376</a></div></div>
<div class="ttc" id="group__varr_html_gga17f37faba3c6a98134aabf4181cfa03da89b3ea0cc1526d1279c95203407bbaf4"><div class="ttname"><a href="../../d1/d85/group__varr.html#gga17f37faba3c6a98134aabf4181cfa03da89b3ea0cc1526d1279c95203407bbaf4">M0_VA_TNODEPTR_SIZE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00090">varr.h:90</a></div></div>
<div class="ttc" id="lnet__ut_8c_html_a7d467c1d283fdfa1f2081ba1e0d01b6e"><div class="ttname"><a href="../../d2/d68/lnet__ut_8c.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a></div><div class="ttdeci">#define PAGE_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d68/lnet__ut_8c_source.html#l00277">lnet_ut.c:277</a></div></div>
<div class="ttc" id="m0t1fs_2linux__kernel_2dir_8c_html_a4b9218d5c001301e593c59b2f36f9d17"><div class="ttname"><a href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a4b9218d5c001301e593c59b2f36f9d17">buf</a></div><div class="ttdeci">static int void * buf</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c_source.html#l01019">dir.c:1019</a></div></div>
<div class="ttc" id="structm0__bob__type_html_ad5f763ba2b5ee51f9d88f64101eabf6f"><div class="ttname"><a href="../../de/dcc/structm0__bob__type.html#ad5f763ba2b5ee51f9d88f64101eabf6f">m0_bob_type::bt_name</a></div><div class="ttdeci">const char * bt_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d91/bob_8h_source.html#l00073">bob.h:73</a></div></div>
<div class="ttc" id="structbuf_html"><div class="ttname"><a href="../../d9/dd0/structbuf.html">buf</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00887">sock.c:887</a></div></div>
<div class="ttc" id="linux__kernel_2varr_8c_html_ae766224f83e4861543fd9b46d527632b"><div class="ttname"><a href="../../d5/d0f/linux__kernel_2varr_8c.html#ae766224f83e4861543fd9b46d527632b">m0_varr_buf_alloc</a></div><div class="ttdeci">M0_EXTERN void * m0_varr_buf_alloc(size_t bufsize)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d0f/linux__kernel_2varr_8c_source.html#l00030">varr.c:30</a></div></div>
<div class="ttc" id="structm0__varr_html_a713009eeb6d8752d67b6665f124439de"><div class="ttname"><a href="../../d5/d75/structm0__varr.html#a713009eeb6d8752d67b6665f124439de">m0_varr::va_cache</a></div><div class="ttdeci">struct varr_cache * va_cache</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00159">varr.h:159</a></div></div>
<div class="ttc" id="m0t1fs_2linux__kernel_2dir_8c_html_a9a02a790ad457506f9f3bc12121e6079"><div class="ttname"><a href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a9a02a790ad457506f9f3bc12121e6079">M0_RC</a></div><div class="ttdeci">return M0_RC(rc)</div></div>
<div class="ttc" id="finject_8h_html"><div class="ttname"><a href="../../dd/dc9/finject_8h.html">finject.h</a></div></div>
<div class="ttc" id="group__varr_html_gga17f37faba3c6a98134aabf4181cfa03dae55463aacfcb4f929c9b11d66aee0248"><div class="ttname"><a href="../../d1/d85/group__varr.html#gga17f37faba3c6a98134aabf4181cfa03dae55463aacfcb4f929c9b11d66aee0248">M0_VA_TNODE_NR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00088">varr.h:88</a></div></div>
<div class="ttc" id="structvarr__cache_html"><div class="ttname"><a href="../../da/d1c/structvarr__cache.html">varr_cache</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d3f/varr__private_8h_source.html#l00031">varr_private.h:31</a></div></div>
<div class="ttc" id="structindex_html"><div class="ttname"><a href="../../d7/d93/structindex.html">index</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d83/idx__mock_8c_source.html#l00101">idx_mock.c:101</a></div></div>
<div class="ttc" id="m0t1fs_2linux__kernel_2dir_8c_html_a7e98b8a17c0aad30ba64d47b74e2a6c1"><div class="ttname"><a href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c_source.html#l01033">dir.c:1033</a></div></div>
<div class="ttc" id="base_8c_html_ae2664ba3cf6162e7c15933d083553f52"><div class="ttname"><a href="../../dc/de2/base_8c.html#ae2664ba3cf6162e7c15933d083553f52">depth</a></div><div class="ttdeci">static unsigned depth</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/de2/base_8c_source.html#l00377">base.c:377</a></div></div>
<div class="ttc" id="ut_2note_8c_html_acb740041b3f31283d9739c5c97bcf93a"><div class="ttname"><a href="../../d7/d48/ut_2note_8c.html#acb740041b3f31283d9739c5c97bcf93a">root</a></div><div class="ttdeci">struct m0_conf_root * root</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d48/ut_2note_8c_source.html#l00050">note.c:50</a></div></div>
<div class="ttc" id="m0t1fs_2linux__kernel_2dir_8c_html_a01283f6c481bc4a3d0f204e957179d6e"><div class="ttname"><a href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a></div><div class="ttdeci">return M0_ERR(-EOPNOTSUPP)</div></div>
<div class="ttc" id="varr_8c_html_a432fd5e3f253276a17b6e284f4b874b3"><div class="ttname"><a href="../../dc/d17/varr_8c.html#a432fd5e3f253276a17b6e284f4b874b3">index_within_level</a></div><div class="ttdeci">M0_INTERNAL uint32_t index_within_level(const struct m0_varr *arr, uint64_t target_idx, uint32_t depth)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00417">varr.c:417</a></div></div>
<div class="ttc" id="varr_8c_html_aae28bf43b009a87b3092c80c073b3b52"><div class="ttname"><a href="../../dc/d17/varr_8c.html#aae28bf43b009a87b3092c80c073b3b52">varr_bobtype</a></div><div class="ttdeci">M0_INTERNAL const struct m0_bob_type varr_bobtype</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00042">varr.c:42</a></div></div>
<div class="ttc" id="group__varr_html_gga17f37faba3c6a98134aabf4181cfa03dac378c947b9d927cb8aea5096574527a7"><div class="ttname"><a href="../../d1/d85/group__varr.html#gga17f37faba3c6a98134aabf4181cfa03dac378c947b9d927cb8aea5096574527a7">M0_VA_TNODE_NR_SHIFT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00092">varr.h:92</a></div></div>
<div class="ttc" id="structm0__varr_html_a919d554b2cfb20fbd48b7c87933f7c7a"><div class="ttname"><a href="../../d5/d75/structm0__varr.html#a919d554b2cfb20fbd48b7c87933f7c7a">m0_varr::va_bufptr_nr</a></div><div class="ttdeci">uint64_t va_bufptr_nr</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00148">varr.h:148</a></div></div>
<div class="ttc" id="group__varr_html_ga2f7c8b2091bf82e77ccb0c20bd82ecaa"><div class="ttname"><a href="../../d1/d85/group__varr.html#ga2f7c8b2091bf82e77ccb0c20bd82ecaa">m0_varr_size</a></div><div class="ttdeci">M0_INTERNAL uint64_t m0_varr_size(const struct m0_varr *arr)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00567">varr.c:567</a></div></div>
<div class="ttc" id="assert_8h_html_ac8bebb1ebb72c1dae891a1a1c24e7aec"><div class="ttname"><a href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a></div><div class="ttdeci">#define M0_ASSERT(cond)</div></div>
<div class="ttc" id="varr_8c_html_aba52909ef96b580abd22d2109f4d8a4c"><div class="ttname"><a href="../../dc/d17/varr_8c.html#aba52909ef96b580abd22d2109f4d8a4c">nearest_power_of_two</a></div><div class="ttdeci">M0_INTERNAL uint8_t nearest_power_of_two(size_t num)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00157">varr.c:157</a></div></div>
<div class="ttc" id="linux__kernel_2varr_8c_html_a83f125dc17a501fe72f4aeada3943c90"><div class="ttname"><a href="../../d5/d0f/linux__kernel_2varr_8c.html#a83f125dc17a501fe72f4aeada3943c90">m0_varr_buf_free</a></div><div class="ttdeci">M0_EXTERN void m0_varr_buf_free(void *buf, size_t bufsize)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d0f/linux__kernel_2varr_8c_source.html#l00038">varr.c:38</a></div></div>
<div class="ttc" id="structm0__varr_html_ad8ae8e7db19fb11cc359c0ebce6f183f"><div class="ttname"><a href="../../d5/d75/structm0__varr.html#ad8ae8e7db19fb11cc359c0ebce6f183f">m0_varr::va_depth</a></div><div class="ttdeci">uint32_t va_depth</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00138">varr.h:138</a></div></div>
<div class="ttc" id="group__varr_html_gaaf9634624e2f4b37f6e0f21707da2666"><div class="ttname"><a href="../../d1/d85/group__varr.html#gaaf9634624e2f4b37f6e0f21707da2666">m0_varr_cursor_get</a></div><div class="ttdeci">M0_INTERNAL void * m0_varr_cursor_get(struct m0_varr_cursor *cursor)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00316">varr.c:316</a></div></div>
<div class="ttc" id="structm0__varr__path__element_html_a2fcc7bd22fccff0d73e24ecd9eea2779"><div class="ttname"><a href="../../d3/deb/structm0__varr__path__element.html#a2fcc7bd22fccff0d73e24ecd9eea2779">m0_varr_path_element::vp_idx</a></div><div class="ttdeci">uint32_t vp_idx</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00103">varr.h:103</a></div></div>
<div class="ttc" id="group__varr_html_gab59e87c9fe2db4071082fb33fa79c655"><div class="ttname"><a href="../../d1/d85/group__varr.html#gab59e87c9fe2db4071082fb33fa79c655">m0_varr_init</a></div><div class="ttdeci">M0_INTERNAL int m0_varr_init(struct m0_varr *arr, uint64_t nr, size_t size, size_t bufsize)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00114">varr.c:114</a></div></div>
<div class="ttc" id="group___s_n_s_c_m_c_p_html_ga57d2c0c6b3e56c083dd5cd3fb627de6c"><div class="ttname"><a href="../../d3/daf/group___s_n_s_c_m_c_p.html#ga57d2c0c6b3e56c083dd5cd3fb627de6c">next</a></div><div class="ttdeci">static int next[]</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d2f/sns_2cm_2cp_8c_source.html#l00248">cp.c:248</a></div></div>
<div class="ttc" id="varr_8c_html_a8c9e944c788a5c597a148fa6235a754e"><div class="ttname"><a href="../../dc/d17/varr_8c.html#a8c9e944c788a5c597a148fa6235a754e">M0_BOB_DEFINE</a></div><div class="ttdeci">M0_BOB_DEFINE(M0_INTERNAL, &amp;varr_bobtype, m0_varr)</div></div>
<div class="ttc" id="varr_8c_html_a8b0dc9364932c66fef2e00ccf185f046"><div class="ttname"><a href="../../dc/d17/varr_8c.html#a8b0dc9364932c66fef2e00ccf185f046">children_of_level</a></div><div class="ttdeci">M0_INTERNAL uint32_t children_of_level(const struct m0_varr *arr, uint32_t level)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00301">varr.c:301</a></div></div>
<div class="ttc" id="varr_8c_html_a49d76def8f99fe60f5cc203cf403bb35"><div class="ttname"><a href="../../dc/d17/varr_8c.html#a49d76def8f99fe60f5cc203cf403bb35">varr_buffers_dealloc</a></div><div class="ttdeci">M0_INTERNAL void varr_buffers_dealloc(struct m0_varr *arr)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00459">varr.c:459</a></div></div>
<div class="ttc" id="structm0__varr__path__element_html_a9a3cb08906e48d45d91bf618b753ea34"><div class="ttname"><a href="../../d3/deb/structm0__varr__path__element.html#a9a3cb08906e48d45d91bf618b753ea34">m0_varr_path_element::vp_buf</a></div><div class="ttdeci">void * vp_buf</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00105">varr.h:105</a></div></div>
<div class="ttc" id="group__varr_html_ga7781025454c6e790a421c43545b4e839"><div class="ttname"><a href="../../d1/d85/group__varr.html#ga7781025454c6e790a421c43545b4e839">m0_varr_cursor_next</a></div><div class="ttdeci">M0_INTERNAL int m0_varr_cursor_next(struct m0_varr_cursor *cursor)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00322">varr.c:322</a></div></div>
<div class="ttc" id="group__arith_html_ga3ab271ddef8d2ab1ee331f95138294b5"><div class="ttname"><a href="../../db/dc9/group__arith.html#ga3ab271ddef8d2ab1ee331f95138294b5">min64u</a></div><div class="ttdeci">static uint64_t min64u(uint64_t a, uint64_t b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/deb/arith_8h_source.html#l00066">arith.h:66</a></div></div>
<div class="ttc" id="varr_8c_html_a8b01ee449c16a7a3030adf3f8d8c356d"><div class="ttname"><a href="../../dc/d17/varr_8c.html#a8b01ee449c16a7a3030adf3f8d8c356d">varr_buffers_alloc</a></div><div class="ttdeci">M0_INTERNAL int varr_buffers_alloc(struct m0_varr *arr)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00237">varr.c:237</a></div></div>
<div class="ttc" id="varr_8c_html_aaf9cc9021aca7065056206a06724789f"><div class="ttname"><a href="../../dc/d17/varr_8c.html#aaf9cc9021aca7065056206a06724789f">inc_for_next_level</a></div><div class="ttdeci">M0_INTERNAL uint64_t inc_for_next_level(const struct m0_varr_cursor *cursor, uint64_t carry, uint32_t depth)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00396">varr.c:396</a></div></div>
<div class="ttc" id="varr_8c_html_a6d73ddb09041cdd20e8c8653c70351a5"><div class="ttname"><a href="../../dc/d17/varr_8c.html#a6d73ddb09041cdd20e8c8653c70351a5">safe_bitshift</a></div><div class="ttdeci">#define safe_bitshift(num, shift, operator)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00106">varr.c:106</a></div></div>
<div class="ttc" id="structm0__varr__cursor_html"><div class="ttname"><a href="../../da/d8c/structm0__varr__cursor.html">m0_varr_cursor</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00108">varr.h:108</a></div></div>
<div class="ttc" id="rpc_2ut_2fops_8h_html_a27700a99892b7d9ae8741a462791ef78"><div class="ttname"><a href="../../d6/d69/rpc_2ut_2fops_8h.html#a27700a99892b7d9ae8741a462791ef78">n</a></div><div class="ttdeci">uint64_t n</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d69/rpc_2ut_2fops_8h_source.html#l00107">fops.h:107</a></div></div>
<div class="ttc" id="structm0__varr_html_af4005d4ec13ddaec06244724b2bfdbf9"><div class="ttname"><a href="../../d5/d75/structm0__varr.html#af4005d4ec13ddaec06244724b2bfdbf9">m0_varr::va_failure_depth</a></div><div class="ttdeci">uint32_t va_failure_depth</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00161">varr.h:161</a></div></div>
<div class="ttc" id="varr_8c_html_a9e751a5ea0dd1d59f4bb2db940dc44ba"><div class="ttname"><a href="../../dc/d17/varr_8c.html#a9e751a5ea0dd1d59f4bb2db940dc44ba">buff_incr</a></div><div class="ttdeci">M0_INTERNAL void * buff_incr(const struct m0_varr *arr, uint32_t depth, void *buff, uint32_t inc)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00444">varr.c:444</a></div></div>
<div class="ttc" id="group__varr_html_ga6f8bba2108de618eb1951ec19286b101"><div class="ttname"><a href="../../d1/d85/group__varr.html#ga6f8bba2108de618eb1951ec19286b101">m0_varr_fini</a></div><div class="ttdeci">M0_INTERNAL void m0_varr_fini(struct m0_varr *arr)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00486">varr.c:486</a></div></div>
<div class="ttc" id="varr_8c_html_a6c92dd465dc50928577a459ef40baf94"><div class="ttname"><a href="../../dc/d17/varr_8c.html#a6c92dd465dc50928577a459ef40baf94">inc_to_idx_xlate</a></div><div class="ttdeci">M0_INTERNAL uint32_t inc_to_idx_xlate(const struct m0_varr_cursor *cursor, uint64_t carry, uint32_t depth)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00388">varr.c:388</a></div></div>
<div class="ttc" id="structm0__varr_html_a5b5eb9a377d46880e84f98680857cbd5"><div class="ttname"><a href="../../d5/d75/structm0__varr.html#a5b5eb9a377d46880e84f98680857cbd5">m0_varr::va_buf_shift</a></div><div class="ttdeci">uint8_t va_buf_shift</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00135">varr.h:135</a></div></div>
<div class="ttc" id="lib_2misc_8h_html"><div class="ttname"><a href="../../df/d2a/lib_2misc_8h.html">misc.h</a></div></div>
<div class="ttc" id="group__memory_html_ga2dd26426583fa272fa2061075e2dcf57"><div class="ttname"><a href="../../d7/ded/group__memory.html#ga2dd26426583fa272fa2061075e2dcf57">M0_ALLOC_PTR</a></div><div class="ttdeci">#define M0_ALLOC_PTR(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/memory_8h_source.html#l00086">memory.h:86</a></div></div>
<div class="ttc" id="varr_8c_html_a6f03808b645cb00e0dad3d80115e3200"><div class="ttname"><a href="../../dc/d17/varr_8c.html#a6f03808b645cb00e0dad3d80115e3200">varr_invariant</a></div><div class="ttdeci">M0_INTERNAL bool varr_invariant(const struct m0_varr *arr)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00498">varr.c:498</a></div></div>
<div class="ttc" id="varr_8c_html_ad60ebf8a6d4dfaf9bd596898ed226294"><div class="ttname"><a href="../../dc/d17/varr_8c.html#ad60ebf8a6d4dfaf9bd596898ed226294">cache_fetch</a></div><div class="ttdeci">M0_INTERNAL void * cache_fetch(const struct m0_varr *arr, uint64_t index)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00535">varr.c:535</a></div></div>
<div class="ttc" id="ut_2di_8c_html_a8629956d8c29c6159e411f38f24c140d"><div class="ttname"><a href="../../d4/d00/ut_2di_8c.html#a8629956d8c29c6159e411f38f24c140d">size</a></div><div class="ttdeci">m0_bcount_t size</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d00/ut_2di_8c_source.html#l00039">di.c:39</a></div></div>
<div class="ttc" id="structm0__varr_html_ab6a95545c9b7b95efcb4f811cd8787bf"><div class="ttname"><a href="../../d5/d75/structm0__varr.html#ab6a95545c9b7b95efcb4f811cd8787bf">m0_varr::va_bufptr_nr_shift</a></div><div class="ttdeci">uint8_t va_bufptr_nr_shift</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00149">varr.h:149</a></div></div>
<div class="ttc" id="varr_8c_html_a0b8ffbde766e18b0e805e75ce936cba8"><div class="ttname"><a href="../../dc/d17/varr_8c.html#a0b8ffbde766e18b0e805e75ce936cba8">log_radix</a></div><div class="ttdeci">M0_INTERNAL uint8_t log_radix(const struct m0_varr *arr, uint32_t level)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00404">varr.c:404</a></div></div>
<div class="ttc" id="varr_8c_html_a67e8455d04cd07c25f5ee2287cae8105"><div class="ttname"><a href="../../dc/d17/varr_8c.html#a67e8455d04cd07c25f5ee2287cae8105">last_nbits_set</a></div><div class="ttdeci">M0_INTERNAL uint64_t last_nbits_set(uint8_t n)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00437">varr.c:437</a></div></div>
<div class="ttc" id="varr_8c_html_a441fc36aecf8fc47d3c7aa1b762265a4"><div class="ttname"><a href="../../dc/d17/varr_8c.html#a441fc36aecf8fc47d3c7aa1b762265a4">varr_obj_nr_in_buff</a></div><div class="ttdeci">M0_INTERNAL unsigned long varr_obj_nr_in_buff(const struct m0_varr *arr)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00171">varr.c:171</a></div></div>
<div class="ttc" id="structm0__varr__path__element_html_a1228115bdcbdfc6426d2937db6a98f97"><div class="ttname"><a href="../../d3/deb/structm0__varr__path__element.html#a1228115bdcbdfc6426d2937db6a98f97">m0_varr_path_element::vp_width</a></div><div class="ttdeci">uint32_t vp_width</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00104">varr.h:104</a></div></div>
<div class="ttc" id="bob_8h_html"><div class="ttname"><a href="../../d4/d91/bob_8h.html">bob.h</a></div></div>
<div class="ttc" id="varr_8c_html_acc4ac4f9d3862ba274c1df8fe5c3a230"><div class="ttname"><a href="../../dc/d17/varr_8c.html#acc4ac4f9d3862ba274c1df8fe5c3a230">depth_find</a></div><div class="ttdeci">M0_INTERNAL uint32_t depth_find(const struct m0_varr *arr, uint64_t buff_nr)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00220">varr.c:220</a></div></div>
<div class="ttc" id="magic_8h_html_a82bffe7189227eff068dab27a6040119ad193e8c84f1b0169764b4fea9977d28d"><div class="ttname"><a href="../../dd/d08/magic_8h.html#a82bffe7189227eff068dab27a6040119ad193e8c84f1b0169764b4fea9977d28d">M0_LIB_GENARRAY_MAGIC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/magic_8h_source.html#l01041">magic.h:1041</a></div></div>
<div class="ttc" id="structm0__varr_html"><div class="ttname"><a href="../../d5/d75/structm0__varr.html">m0_varr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00121">varr.h:121</a></div></div>
<div class="ttc" id="assert_8h_html_a43de0aa0897f31bc310c085f7216f463"><div class="ttname"><a href="../../dc/da7/assert_8h.html#a43de0aa0897f31bc310c085f7216f463">M0_PRE_EX</a></div><div class="ttdeci">#define M0_PRE_EX(cond)</div></div>
<div class="ttc" id="varr_8c_html_a2d0f0fec84deb254ed60eaeb12fb2b80"><div class="ttname"><a href="../../dc/d17/varr_8c.html#a2d0f0fec84deb254ed60eaeb12fb2b80">cache_update</a></div><div class="ttdeci">M0_INTERNAL void cache_update(struct m0_varr *arr, void *holder, uint64_t start_index)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00547">varr.c:547</a></div></div>
<div class="ttc" id="bulk__if_8c_html_a86cf672daa4e0ad11ad10efc894d19c8"><div class="ttname"><a href="../../db/d9d/bulk__if_8c.html#a86cf672daa4e0ad11ad10efc894d19c8">num</a></div><div class="ttdeci">int num</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d9d/bulk__if_8c_source.html#l00054">bulk_if.c:54</a></div></div>
<div class="ttc" id="group__memory_html_ga0b8533a3024754008602759e71337eb3"><div class="ttname"><a href="../../d7/ded/group__memory.html#ga0b8533a3024754008602759e71337eb3">m0_free</a></div><div class="ttdeci">void m0_free(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd5/memory_8c_source.html#l00146">memory.c:146</a></div></div>
<div class="ttc" id="structm0__varr_html_a74a26be788b1d5e0e92bca308c97df00"><div class="ttname"><a href="../../d5/d75/structm0__varr.html#a74a26be788b1d5e0e92bca308c97df00">m0_varr::va_bufsize</a></div><div class="ttdeci">size_t va_bufsize</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00133">varr.h:133</a></div></div>
<div class="ttc" id="varr__private_8h_html"><div class="ttname"><a href="../../d1/d3f/varr__private_8h.html">varr_private.h</a></div></div>
<div class="ttc" id="cm_2repreb_2trigger__fop_8h_html_ac6509c6fe4cbf7bde170597172f8a288"><div class="ttname"><a href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a></div><div class="ttdeci">int32_t rc</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db8/cm_2repreb_2trigger__fop_8h_source.html#l00047">trigger_fop.h:47</a></div></div>
<div class="ttc" id="assert_8h_html_a2e1de306397a5d1345d541dbe2fa7544"><div class="ttname"><a href="../../dc/da7/assert_8h.html#a2e1de306397a5d1345d541dbe2fa7544">M0_POST_EX</a></div><div class="ttdeci">#define M0_POST_EX(cond)</div></div>
<div class="ttc" id="lib_2user__space_2misc_8h_html_ad4a7496cd704df3829c87864e7dbd703"><div class="ttname"><a href="../../db/df8/lib_2user__space_2misc_8h.html#ad4a7496cd704df3829c87864e7dbd703">offsetof</a></div><div class="ttdeci">#define offsetof(typ, memb)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/df8/lib_2user__space_2misc_8h_source.html#l00029">misc.h:29</a></div></div>
<div class="ttc" id="structm0__varr_html_abdf39f5ccafeffeadaf1585a89b48954"><div class="ttname"><a href="../../d5/d75/structm0__varr.html#abdf39f5ccafeffeadaf1585a89b48954">m0_varr::va_nr</a></div><div class="ttdeci">uint64_t va_nr</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00123">varr.h:123</a></div></div>
<div class="ttc" id="group__varr_html_ga35cafde5ff1cf649c57a2a900dc8155d"><div class="ttname"><a href="../../d1/d85/group__varr.html#ga35cafde5ff1cf649c57a2a900dc8155d">m0_varr_ele_get</a></div><div class="ttdeci">M0_INTERNAL void * m0_varr_ele_get(struct m0_varr *arr, uint64_t index)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d17/varr_8c_source.html#l00505">varr.c:505</a></div></div>
<div class="ttc" id="structm0__varr_html_aec0d74de8671b8a894aa2a745379174f"><div class="ttname"><a href="../../d5/d75/structm0__varr.html#aec0d74de8671b8a894aa2a745379174f">m0_varr::va_obj_shift</a></div><div class="ttdeci">uint8_t va_obj_shift</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d72/varr_8h_source.html#l00128">varr.h:128</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="../../dc/d17/varr_8c.html">varr.c</a></li>
    <li class="footer">Generated on Thu Apr 14 2022 14:02:56 for Motr by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
