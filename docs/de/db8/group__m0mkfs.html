<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Motr: M0mkfs</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Motr
   &#160;<span id="projectnumber">M0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('de/db8/group__m0mkfs.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">M0mkfs</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga9eaccc4505d14861026fcce76742ac28"><td class="memItemLeft" align="right" valign="top">M0_INTERNAL int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/db8/group__m0mkfs.html#ga9eaccc4505d14861026fcce76742ac28">main</a> (int argc, char **argv)</td></tr>
<tr class="separator:ga9eaccc4505d14861026fcce76742ac28"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Abstract.</p>
<p>This is mkfs stage0 tool. It prepares storage in a way m0d did before and allows to run m0d after that.</p>
<p>Currently mkfs does the following:</p><ul>
<li>prepare stob for IO;</li>
<li>prepare stob for addb;</li>
<li>prepare metadata and create initial metadata structures, such as: root cob; hierarachy root; initial metadata tables.</li>
<li>segmap is created in normal file and saved in working dir. It then can be found by m0d in startup time and used;</li>
</ul>
<p>Options.</p>
<p>Mkfs fully reuses startup code from motr/setup.c with tiny modificatios in order to support "erase" mode, that is, when mkfs is run on top of existing stobs and structures that have already been used by m0d.</p>
<p>This is why <a class="el" href="../../d9/d54/group__init.html#ga2cf31aef5d867c9769e7fef5e1d71206">m0_init()</a> and <a class="el" href="../../df/dca/group__m0d.html#ga65476510ec9dd526f9ea5ab6abeb0fe8">m0_cs_init()</a> and <a class="el" href="../../df/dca/group__m0d.html#ga1f6035a94a88b54e30c5ee54e133adc9">m0_cs_setup_env()</a> are used same way as they used by m0d. The difference is that <a class="el" href="../../df/dca/group__m0d.html#ga1f6035a94a88b54e30c5ee54e133adc9">m0_cs_setup_env()</a> has "mkfs" argument set to true and services and fops handling is not started for mkfs path.</p>
<p>That said, that both, mkfs and m0d share the same set of options such as endpoints, bufer sizes, etc. Obviously, not all of them needed for mkfs as they are clearly m0d start options and not all of them needed by m0d as they may be applied to mkfs once, saved and reussd by m0d in startup time. This set of options that will not change between runs and needs to be saved by mkfs to some storare structures.</p>
<p>This structure that we can use for saving things like that is called seg0. Integration with seg0 is part of stage1 work that will be started as soon as stage0 is finished.</p>
<p>Anticipating stage1 work.</p>
<ul>
<li>seg0 integration;</li>
<li>save those m0d start options, that don't change between runs, to seg0;</li>
<li>stop sharing options between m0d and mkfs. Each of them should handle only minimaly need set of them. </li>
</ul>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga9eaccc4505d14861026fcce76742ac28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9eaccc4505d14861026fcce76742ac28">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">M0_INTERNAL int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Represents various network transports supported by a particular node in a cluster. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/dd7/m0mkfs_8c_source.html#l00095">95</a> of file <a class="el" href="../../d7/dd7/m0mkfs_8c_source.html">m0mkfs.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/db8/group__m0mkfs_ga9eaccc4505d14861026fcce76742ac28_cgraph.png" border="0" usemap="#de/db8/group__m0mkfs_ga9eaccc4505d14861026fcce76742ac28_cgraph" alt=""/></div>
<map name="de/db8/group__m0mkfs_ga9eaccc4505d14861026fcce76742ac28_cgraph" id="de/db8/group__m0mkfs_ga9eaccc4505d14861026fcce76742ac28_cgraph">
<area shape="rect" id="node2" href="../../d2/d0b/version_8c.html#abca693d7a04010bf4b817a4f4cc18535" title="m0_build_info_print" alt="" coords="122,5,257,32"/>
<area shape="rect" id="node3" href="../../d1/d07/group__uuid.html#ga92bfd31fc8175c93312ecde79ed0285a" title="m0_node_uuid_string_set" alt="" coords="104,56,275,83"/>
<area shape="rect" id="node4" href="../../d9/d54/group__init.html#ga2cf31aef5d867c9769e7fef5e1d71206" title="m0_init" alt="" coords="157,107,221,133"/>
<area shape="rect" id="node5" href="../../df/dca/group__m0d.html#ga65476510ec9dd526f9ea5ab6abeb0fe8" title="m0_cs_init" alt="" coords="147,157,232,184"/>
<area shape="rect" id="node6" href="../../d9/dd2/group__net.html#gaad3b4251c5eac10bebb98c22f5186afc" title="m0_net_all_xprt_get" alt="" coords="120,208,259,235"/>
<area shape="rect" id="node7" href="../../d9/dd2/group__net.html#gaf5a91fe4037d1c75e0609169ae78640c" title="m0_net_xprt_nr" alt="" coords="133,259,245,285"/>
<area shape="rect" id="node8" href="../../df/dca/group__m0d.html#ga1f6035a94a88b54e30c5ee54e133adc9" title="m0_cs_setup_env" alt="" coords="125,309,253,336"/>
<area shape="rect" id="node9" href="../../df/dca/group__m0d.html#gad62c78c1e577601240ec100716e9fac6" title="m0_cs_fini" alt="" coords="147,360,232,387"/>
<area shape="rect" id="node10" href="../../d9/d54/group__init.html#gaedfc69ef15debd2675b7670a44bb3820" title="m0_fini" alt="" coords="157,411,221,437"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Apr 14 2022 14:04:00 for Motr by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
