<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Motr: Distributed File Lock DLD</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Motr
   &#160;<span id="projectnumber">M0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d8/df4/_file_lock.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Distributed File Lock DLD </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li><a class="el" href="../../d8/df4/_file_lock.html#FileLockDLD-ovw">Overview</a></li>
<li><a class="el" href="../../d8/df4/_file_lock.html#FileLockDLD-req">Requirements</a></li>
<li>FileLockDLD-depends</li>
<li><a class="el" href="../../d8/df4/_file_lock.html#FileLockDLD-fspec">Functional Specification</a></li>
<li><a class="el" href="../../d8/df4/_file_lock.html#FileLockDLD-lspec">Logical Specification</a><ul>
<li><a class="el" href="../../d8/df4/_file_lock.html#FileLockDLD-lspec-comps">Component Overview</a></li>
<li>FileLockDLD-lspec-numa</li>
</ul>
</li>
<li><a class="el" href="../../d8/df4/_file_lock.html#FileLockDLD-conformance">Conformance</a></li>
<li><a class="el" href="../../d8/df4/_file_lock.html#FileLockDLD-ut">Unit Tests</a></li>
<li><a class="el" href="../../d8/df4/_file_lock.html#FileLockDLD-st">System Tests</a></li>
<li><a class="el" href="../../d8/df4/_file_lock.html#FileLockDLD-ref">References</a></li>
<li><a class="el" href="../../d8/df4/_file_lock.html#FileLockDLD-impl-plan">Implementation Plan</a></li>
</ul>
<hr/>
 <h1><a class="anchor" id="FileLockDLD-ovw"></a>
Overview</h1>
<p>This DLD describes the implementation of a distributed file lock. The distributed file lock is implemented over Motr resource manager. Motr resource manager already provides a distributed resource management framework within a cluster (provides semantics similar to a distributed lock manager).</p>
<p><b>Purpose of a DLD</b> <br />
 The purpose of the Detailed Level Design (DLD) specification of a distributed file lock is to:</p><ul>
<li>Implement file lock resource type of Motr resource manager</li>
<li>Implement distributed file lock interfaces</li>
</ul>
<hr/>
 <h1><a class="anchor" id="FileLockDLD-req"></a>
Requirements</h1>
<ul>
<li><b>R.rm-file-lock.async</b> The distributed file lock should provide async interfaces.</li>
<li><b>R.rm-file-lock.RM</b> The distributed file lock shall use RM (resource manager) to implement the interfaces.</li>
</ul>
<h1><a class="anchor" id="FileLockDLD-lspec"></a>
Logical Specification</h1>
<ul>
<li><a class="el" href="../../d8/df4/_file_lock.html#FileLockDLD-lspec-comps">Component Overview</a></li>
<li><a class="el" href="../../da/ddd/group___file_lock_internal.html">Distributed File Lock Internals</a> <br />
 - FileLockDLD-lspec-numa</li>
</ul>
<h2><a class="anchor" id="FileLockDLD-lspec-comps"></a>
Component Overview</h2>
<p>The distributed file lock implements following resource manager ops:</p><ul>
<li>resource type ops</li>
<li>resource ops</li>
<li>resource credit ops</li>
</ul>
<hr/>
 <h1><a class="anchor" id="FileLockDLD-conformance"></a>
Conformance</h1>
<ul>
<li><b>I.rm-file-lock.async</b> The interfaces are async.</li>
<li><b>I.rm-file-lock.RM</b> Implements RM ops to implement file lock resource</li>
</ul>
<hr/>
 <h1><a class="anchor" id="FileLockDLD-ut"></a>
Unit Tests</h1>
<p>Following scenarios will be tested: </p><dl class="test"><dt><b><a class="el" href="../../d4/df6/test.html#_test000057">Test:</a></b></dt><dd>1) Lock usage when no other thread is using the lock<ul>
<li>wait mode: gets the lock</li>
</ul>
</dd></dl>
<dl class="test"><dt><b><a class="el" href="../../d4/df6/test.html#_test000058">Test:</a></b></dt><dd>2) Lock usage when a local thread is holding the lock<ul>
<li>wait mode: gets the lock when the other thread releases the lock</li>
</ul>
</dd></dl>
<dl class="test"><dt><b><a class="el" href="../../d4/df6/test.html#_test000059">Test:</a></b></dt><dd>3) Lock usage when a remote thread is holding the lock<ul>
<li>wait mode: gets the lock when the other thread releases the lock</li>
</ul>
</dd></dl>
<dl class="test"><dt><b><a class="el" href="../../d4/df6/test.html#_test000060">Test:</a></b></dt><dd>4) lib/ut/mutex.c like test<ul>
<li>A set of arbitrary thread perform lock, unlock operations. Verify the number of operations match the expected result.</li>
</ul>
</dd></dl>
<hr/>
 <h1><a class="anchor" id="FileLockDLD-st"></a>
System Tests</h1>
<p>System tests will be performed by the subsystem that uses the distributed file lock.</p>
<hr/>
 <h1><a class="anchor" id="FileLockDLD-ref"></a>
References</h1>
<ul>
<li><p class="startli">HLD of resource manager Interfaces : For documentation links, please refer to this file : doc/motr-design-doc-list.rst</p>
<hr/>
 </li>
</ul>
<h1><a class="anchor" id="FileLockDLD-impl-plan"></a>
Implementation Plan</h1>
<p>It implements:</p><ul>
<li><a class="el" href="../../d9/dfe/structm0__rm__resource__type__ops.html">m0_rm_resource_type_ops</a></li>
<li><a class="el" href="../../d3/d16/structm0__rm__resource__ops.html">m0_rm_resource_ops</a></li>
<li><a class="el" href="../../d0/d64/structm0__rm__credit__ops.html">m0_rm_credit_ops</a></li>
<li>m0_rm_file_lock_* external interfaces</li>
</ul>
<p><a class="el" href="../../d8/df4/_file_lock.html#FileLockDLD-fspec-ds">Data Structures</a></p><ul>
<li><a class="el" href="../../d8/df4/_file_lock.html#FileLockDLD-fspec-sub">Subroutines</a></li>
</ul>
<h1><a class="anchor" id="FileLockDLD-fspec"></a>
Functional Specification</h1>
<p>This section describes the data structure and the external interfaces of the distributed file lock implemented using resource manager.</p>
<h1><a class="anchor" id="FileLockDLD-fspec-ds"></a>
Data Structures</h1>
<p>The distributed mutex will have the following data structure:</p><ul>
<li><a class="el" href="../../d8/d89/structm0__file.html">m0_file</a> This holds generic RM resource, fid and data-integrity operations supported for this file.</li>
</ul>
<h1><a class="anchor" id="FileLockDLD-fspec-sub"></a>
Subroutines</h1>
<p>The asynchronous distributed file lock provides the functions listed in in the sub-sections below:</p>
<h2><a class="anchor" id="FileLockDLD-fspec-sub-cons"></a>
Constructors and Destructors</h2>
<h2><a class="anchor" id="FileLockDLD-fspec-sub-opi"></a>
Operational Interfaces</h2>
<ul>
<li><a class="el" href="../../de/d3f/group___file_lock.html#gab776e9b223dbba8588539c6f9d3e8d7a">m0_file_lock()</a></li>
<li><a class="el" href="../../de/d3f/group___file_lock.html#gafd6834f89c127fefbc03dce4488236dc">m0_file_unlock()</a></li>
<li><a class="el" href="../../de/d3f/group___file_lock.html#ga199b185a1145615a455b8f57392ee3f2">m0_file_lock_type_register()</a></li>
<li><a class="el" href="../../de/d3f/group___file_lock.html#ga26571914d690db8a9b6291f249e4bbe8">m0_file_lock_type_deregister()</a></li>
<li><a class="el" href="../../de/d3f/group___file_lock.html#gad9b266121f86244dc70779328fa56dd0">m0_file_owner_init()</a></li>
<li><a class="el" href="../../de/d3f/group___file_lock.html#gac41ba6d8a3d9b5e08f9e6209241d33c4">m0_file_owner_fini()</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri May 20 2022 10:35:32 for Motr by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
