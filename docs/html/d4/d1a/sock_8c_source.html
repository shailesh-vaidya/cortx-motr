<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Motr: net/sock/sock.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Motr
   &#160;<span id="projectnumber">M0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d4/d1a/sock_8c_source.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">sock.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d4/d1a/sock_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* -*- C -*- */</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * Copyright (c) 2019-2020 Seagate Technology LLC and/or its Affiliates</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * you may not use this file except in compliance with the License.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * You may obtain a copy of the License at</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *     http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * See the License for the specific language governing permissions and</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * limitations under the License.</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * For any questions about this software or licensing,</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * please email opensource@seagate.com or cortx-questions@seagate.com.</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="preprocessor">#include &lt;sys/epoll.h&gt;</span>                     <span class="comment">/* epoll_create */</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="preprocessor">#include &lt;sys/types.h&gt;</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="preprocessor">#include &lt;sys/uio.h&gt;</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="preprocessor">#include &lt;sys/socket.h&gt;</span>                    <span class="comment">/* epoll_create */</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="preprocessor">#include &lt;netinet/in.h&gt;</span>                    <span class="comment">/* INET_ADDRSTRLEN */</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="preprocessor">#include &lt;netinet/ip.h&gt;</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="preprocessor">#include &lt;arpa/inet.h&gt;</span>                     <span class="comment">/* inet_pton, htons */</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="../../da/d66/string_8h.html">string.h</a>&gt;</span>                        <span class="comment">/* strchr */</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span>                        <span class="comment">/* close */</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div><div class="line"><a name="l00618"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gae762ad8776496e788bf62e0fa1615b61">  618</a></span>&#160;<span class="preprocessor">#define M0_TRACE_SUBSYSTEM M0_TRACE_SUBSYS_NET</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d1b/trace_8h.html">lib/trace.h</a>&quot;</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/dc2/errno_8h.html">lib/errno.h</a>&quot;</span>                     <span class="comment">/* EINTR, ENOMEM */</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/dd5/thread_8h.html">lib/thread.h</a>&quot;</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d2a/lib_2misc_8h.html">lib/misc.h</a>&quot;</span>                      <span class="comment">/* ARRAY_SIZE, IS_IN_ARRAY */</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/d30/tlist_8h.html">lib/tlist.h</a>&quot;</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d49/types_8h.html">lib/types.h</a>&quot;</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/d66/string_8h.html">lib/string.h</a>&quot;</span>                    <span class="comment">/* m0_strdup */</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/dcf/chan_8h.html">lib/chan.h</a>&quot;</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d18/memory_8h.html">lib/memory.h</a>&quot;</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d85/lib_2cookie_8h.html">lib/cookie.h</a>&quot;</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/dcb/bitmap_8h.html">lib/bitmap.h</a>&quot;</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/df7/refs_8h.html">lib/refs.h</a>&quot;</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/df7/time_8h.html">lib/time.h</a>&quot;</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d56/sm_8h.html">sm/sm.h</a>&quot;</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/d08/magic_8h.html">motr/magic.h</a>&quot;</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/db3/net_2net_8h.html">net/net.h</a>&quot;</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/d03/buffer__pool_8h.html">net/buffer_pool.h</a>&quot;</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d7c/net__internal_8h.html">net/net_internal.h</a>&quot;</span>              <span class="comment">/* m0_net__tm_invariant */</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/d0a/format_8h.html">format/format.h</a>&quot;</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/da2/net_2sock_2xcode_8h.html">net/sock/xcode.h</a>&quot;</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="preprocessor">#include &quot;net/sock/xcode_xc.h&quot;</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gac9a0035e715dad0f3b263bb6ae8371af">  642</a></span>&#160;<span class="preprocessor">#define EP_DEBUG (1)</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="preprocessor">#ifdef ENABLE_SOCK_MOCK_LNET</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="preprocessor">#define MOCK_LNET (1)</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00647"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga204a3875802e9f8ff4b75db13dda46d3">  647</a></span>&#160;<span class="preprocessor">#define MOCK_LNET (0)</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="keyword">struct </span><a class="code" href="../../dd/d74/structsock.html">sock</a>;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="keyword">struct </span><a class="code" href="../../d1/d99/structmover.html">mover</a>;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="keyword">struct </span><a class="code" href="../../d9/db9/structaddr.html">addr</a>;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="keyword">struct </span><a class="code" href="../../da/da7/structep.html">ep</a>;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="keyword">struct </span><a class="code" href="../../d9/dd0/structbuf.html">buf</a>;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="keyword">struct </span><a class="code" href="../../d8/dee/structma.html">ma</a>;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="keyword">struct </span><a class="code" href="../../d5/d0e/structbdesc.html">bdesc</a>;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="keyword">struct </span><a class="code" href="../../df/de8/structpacket.html">packet</a>;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga2a989014423ee897a1d4314f292babdb">  662</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../d5/d16/group__netsock.html#ga2a989014423ee897a1d4314f292babdb">sock_state</a> {</div><div class="line"><a name="l00666"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaabb033d58518dadd28210bc74bef6051">  666</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaabb033d58518dadd28210bc74bef6051">S_INIT</a>,</div><div class="line"><a name="l00673"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbae1999ab5c5b6740876a5e8ed025260aa">  673</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbae1999ab5c5b6740876a5e8ed025260aa">S_LISTENING</a>,</div><div class="line"><a name="l00680"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba9d8566da037aa1256e85c81f275b7805">  680</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba9d8566da037aa1256e85c81f275b7805">S_CONNECTING</a>,</div><div class="line"><a name="l00685"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaa86daa3f2c345452a3235108d80ad8aa">  685</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaa86daa3f2c345452a3235108d80ad8aa">S_OPEN</a>,</div><div class="line"><a name="l00690"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba57451d0f52d3a8d7604c40753f7dd109">  690</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba57451d0f52d3a8d7604c40753f7dd109">S_DELETED</a></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;};</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga6c152f6e1ae044464fc6f6655a5ae35c">  698</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../d5/d16/group__netsock.html#ga6c152f6e1ae044464fc6f6655a5ae35c">mover_opcode</a> {</div><div class="line"><a name="l00699"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca0cb0be5475011ea9319ce55b30e74634">  699</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca0cb0be5475011ea9319ce55b30e74634">M_READ</a>,</div><div class="line"><a name="l00700"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca7af369c035a45a9babde5a9443b5ef01">  700</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca7af369c035a45a9babde5a9443b5ef01">M_WRITE</a>,</div><div class="line"><a name="l00701"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca207d824841acf342e7184b3d3fc5996b">  701</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca207d824841acf342e7184b3d3fc5996b">M_CLOSE</a>,</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca2d8a44ef484e0c3387f049bf8778987e">  703</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca2d8a44ef484e0c3387f049bf8778987e">M_NR</a></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;};</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gafb7c011cf74bbdbc6d54539a53224c39">  707</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../d5/d16/group__netsock.html#gafb7c011cf74bbdbc6d54539a53224c39">sock_flags</a> {</div><div class="line"><a name="l00709"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39a7418706169c4419c7ceb4553a8416673">  709</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39a7418706169c4419c7ceb4553a8416673">HAS_READ</a>   = <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae644c20b9d43e4e0810716647b3d16be">M0_BITS</a>(<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca0cb0be5475011ea9319ce55b30e74634">M_READ</a>),</div><div class="line"><a name="l00711"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39afd7faf6c636cbc6f3d3cc0683c0584dc">  711</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39afd7faf6c636cbc6f3d3cc0683c0584dc">HAS_WRITE</a>  = <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae644c20b9d43e4e0810716647b3d16be">M0_BITS</a>(<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca7af369c035a45a9babde5a9443b5ef01">M_WRITE</a>),</div><div class="line"><a name="l00713"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39a5b03f1e8c060b7325973da921d99df5b">  713</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39a5b03f1e8c060b7325973da921d99df5b">WRITE_POLL</a> = <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae644c20b9d43e4e0810716647b3d16be">M0_BITS</a>(<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca2d8a44ef484e0c3387f049bf8778987e">M_NR</a> + 1)</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;};</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div><div class="line"><a name="l00740"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga65022b439e12c2b69863bb55134dd9a9">  740</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../d5/d16/group__netsock.html#ga65022b439e12c2b69863bb55134dd9a9">rw_state</a> {</div><div class="line"><a name="l00741"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a63581c61e8680cb3c6be0310a4e19e81">  741</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a63581c61e8680cb3c6be0310a4e19e81">R_IDLE</a>,</div><div class="line"><a name="l00742"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a16de0923aedc356f652438ff75d553c2">  742</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a16de0923aedc356f652438ff75d553c2">R_PK</a>,</div><div class="line"><a name="l00743"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">  743</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a>,</div><div class="line"><a name="l00744"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a943628239c02f3d0241ca831508900b5">  744</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a943628239c02f3d0241ca831508900b5">R_INTERVAL</a>,</div><div class="line"><a name="l00745"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a502dbd83cd4018628e13bcba822ce710">  745</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a502dbd83cd4018628e13bcba822ce710">R_PK_DONE</a>,</div><div class="line"><a name="l00746"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a575df14f8416f291b63a463ddaa1c37f">  746</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a575df14f8416f291b63a463ddaa1c37f">R_FAIL</a>,</div><div class="line"><a name="l00747"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a1bd27bf23812341749c87673d015d3ac">  747</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a1bd27bf23812341749c87673d015d3ac">R_DONE</a>,</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a5858564d816c4f9e1cd1218b6b350330">  749</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a5858564d816c4f9e1cd1218b6b350330">R_NR</a>,</div><div class="line"><a name="l00750"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a5d340199a21a4f8b0934eda7e17efb79">  750</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a5d340199a21a4f8b0934eda7e17efb79">STATE_NR</a> = <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a5858564d816c4f9e1cd1218b6b350330">R_NR</a></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;};</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno"><a class="line" href="../../da/da7/structep.html">  754</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../da/da7/structep.html">ep</a> {</div><div class="line"><a name="l00756"></a><span class="lineno"><a class="line" href="../../da/da7/structep.html#a3851e3d045cfdff109ee4c7c69b1e9b8">  756</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d2/d80/structm0__net__end__point.html">m0_net_end_point</a> <a class="code" href="../../da/da7/structep.html#a3851e3d045cfdff109ee4c7c69b1e9b8">e_ep</a>;</div><div class="line"><a name="l00758"></a><span class="lineno"><a class="line" href="../../da/da7/structep.html#a7fa38028a1ed8e0d494fc3d2f179a890">  758</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d9/db9/structaddr.html">addr</a>             <a class="code" href="../../da/da7/structep.html#a7fa38028a1ed8e0d494fc3d2f179a890">e_a</a>;</div><div class="line"><a name="l00760"></a><span class="lineno"><a class="line" href="../../da/da7/structep.html#aa56814b0282f4d2f416fad8bda1da592">  760</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d4/d8a/structm0__tl.html">m0_tl</a>            <a class="code" href="../../da/da7/structep.html#aa56814b0282f4d2f416fad8bda1da592">e_sock</a>;</div><div class="line"><a name="l00762"></a><span class="lineno"><a class="line" href="../../da/da7/structep.html#ac2bafd27a0e0c46e6cc7791b1a33ebcb">  762</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d4/d8a/structm0__tl.html">m0_tl</a>            <a class="code" href="../../da/da7/structep.html#ac2bafd27a0e0c46e6cc7791b1a33ebcb">e_writer</a>;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="preprocessor">#ifdef EP_DEBUG</span></div><div class="line"><a name="l00764"></a><span class="lineno"><a class="line" href="../../da/da7/structep.html#aa1c8901cba3b2ad15bcb1599772f8e96">  764</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="../../da/da7/structep.html#aa1c8901cba3b2ad15bcb1599772f8e96">e_r_mover</a>;</div><div class="line"><a name="l00765"></a><span class="lineno"><a class="line" href="../../da/da7/structep.html#ae4872a5d9413746fc1332b2a766dab29">  765</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="../../da/da7/structep.html#ae4872a5d9413746fc1332b2a766dab29">e_r_sock</a>;</div><div class="line"><a name="l00766"></a><span class="lineno"><a class="line" href="../../da/da7/structep.html#a10fa53c9fb4b7c26d14f7af762878d6c">  766</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="../../da/da7/structep.html#a10fa53c9fb4b7c26d14f7af762878d6c">e_r_buf</a>;</div><div class="line"><a name="l00767"></a><span class="lineno"><a class="line" href="../../da/da7/structep.html#ad800a8d736e37f9934761bfe00b1d4cc">  767</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="../../da/da7/structep.html#ad800a8d736e37f9934761bfe00b1d4cc">e_r_find</a>;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;};</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno"><a class="line" href="../../d8/dee/structma.html">  772</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d8/dee/structma.html">ma</a> {</div><div class="line"><a name="l00774"></a><span class="lineno"><a class="line" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">  774</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>;</div><div class="line"><a name="l00793"></a><span class="lineno"><a class="line" href="../../d8/dee/structma.html#a8d69a44fe8c21a67f1e6c63253a7824e">  793</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d1/d67/structm0__thread.html">m0_thread</a>           <a class="code" href="../../d8/dee/structma.html#a8d69a44fe8c21a67f1e6c63253a7824e">t_poller</a>;</div><div class="line"><a name="l00795"></a><span class="lineno"><a class="line" href="../../d8/dee/structma.html#a7fac31b01cd71bf3b8c7f6f4746adc1b">  795</a></span>&#160;        <span class="keywordtype">int</span>                        <a class="code" href="../../d8/dee/structma.html#a7fac31b01cd71bf3b8c7f6f4746adc1b">t_epollfd</a>;</div><div class="line"><a name="l00796"></a><span class="lineno"><a class="line" href="../../d8/dee/structma.html#abdee7b3d9f72fefb859aaae81d4731d8">  796</a></span>&#160;        <span class="keywordtype">bool</span>                       <a class="code" href="../../d8/dee/structma.html#abdee7b3d9f72fefb859aaae81d4731d8">t_shutdown</a>;</div><div class="line"><a name="l00798"></a><span class="lineno"><a class="line" href="../../d8/dee/structma.html#a628f89b20b4000abc13078fc9ccf2354">  798</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d4/d8a/structm0__tl.html">m0_tl</a>               <a class="code" href="../../d8/dee/structma.html#a628f89b20b4000abc13078fc9ccf2354">t_deathrow</a>;</div><div class="line"><a name="l00800"></a><span class="lineno"><a class="line" href="../../d8/dee/structma.html#ac99334eddbdd3038853049e49ba745dd">  800</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d4/d8a/structm0__tl.html">m0_tl</a>               <a class="code" href="../../d8/dee/structma.html#ac99334eddbdd3038853049e49ba745dd">t_done</a>;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;};</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div><div class="line"><a name="l00806"></a><span class="lineno"><a class="line" href="../../d9/da1/structmover__op.html">  806</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d9/da1/structmover__op.html">mover_op</a> {</div><div class="line"><a name="l00808"></a><span class="lineno"><a class="line" href="../../d9/da1/structmover__op.html#ab8beda65eddc61a5164c51e31768d1bb">  808</a></span>&#160;        <a class="code" href="../../d6/dca/namespaceerror__injection.html#a61569f2965b7a369eb10b6d75d410d11">int</a>  (*<a class="code" href="../../d9/da1/structmover__op.html#ab8beda65eddc61a5164c51e31768d1bb">o_op</a>)(<span class="keyword">struct </span><a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct </span><a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l00815"></a><span class="lineno"><a class="line" href="../../d9/da1/structmover__op.html#af280ae6a9e633322df0554bfdda29ad7">  815</a></span>&#160;        <span class="keywordtype">bool</span>   <a class="code" href="../../d9/da1/structmover__op.html#af280ae6a9e633322df0554bfdda29ad7">o_doesio</a>;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;};</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00825"></a><span class="lineno"><a class="line" href="../../d3/d91/structmover__op__vec.html">  825</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d3/d91/structmover__op__vec.html">mover_op_vec</a> {</div><div class="line"><a name="l00827"></a><span class="lineno"><a class="line" href="../../d3/d91/structmover__op__vec.html#a966fde66dc94059be9485d9effb30ea4">  827</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>     *<a class="code" href="../../d3/d91/structmover__op__vec.html#a966fde66dc94059be9485d9effb30ea4">v_name</a>;</div><div class="line"><a name="l00828"></a><span class="lineno"><a class="line" href="../../d3/d91/structmover__op__vec.html#ab40f2a603ffa58f56082c18410af1855">  828</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d9/da1/structmover__op.html">mover_op</a> <a class="code" href="../../d3/d91/structmover__op__vec.html#ab40f2a603ffa58f56082c18410af1855">v_op</a>[<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a5d340199a21a4f8b0934eda7e17efb79">STATE_NR</a>][<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca2d8a44ef484e0c3387f049bf8778987e">M_NR</a>];</div><div class="line"><a name="l00833"></a><span class="lineno"><a class="line" href="../../d3/d91/structmover__op__vec.html#a707b7e830f22652f532e197bd262b00f">  833</a></span>&#160;        void          (*<a class="code" href="../../d3/d91/structmover__op__vec.html#a707b7e830f22652f532e197bd262b00f">v_error</a>)(<span class="keyword">struct </span><a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct </span><a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <span class="keywordtype">int</span> <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a>);</div><div class="line"><a name="l00837"></a><span class="lineno"><a class="line" href="../../d3/d91/structmover__op__vec.html#a7eccb74f14ac85b2def28fe7951c8bb2">  837</a></span>&#160;        void          (*<a class="code" href="../../d3/d91/structmover__op__vec.html#a7eccb74f14ac85b2def28fe7951c8bb2">v_done</a>) (<span class="keyword">struct </span><a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct </span><a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;};</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno"><a class="line" href="../../d1/d99/structmover.html">  846</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d1/d99/structmover.html">mover</a> {</div><div class="line"><a name="l00847"></a><span class="lineno"><a class="line" href="../../d1/d99/structmover.html#abd473b0a325187c40e68d6d4b325c739">  847</a></span>&#160;        uint64_t                   <a class="code" href="../../d1/d99/structmover.html#abd473b0a325187c40e68d6d4b325c739">m_magix</a>;</div><div class="line"><a name="l00859"></a><span class="lineno"><a class="line" href="../../d1/d99/structmover.html#a1ae1f926434f6a0fa9ce813927773bff">  859</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../dd/d74/structsock.html">sock</a>               *<a class="code" href="../../d1/d99/structmover.html#a1ae1f926434f6a0fa9ce813927773bff">m_sock</a>;</div><div class="line"><a name="l00861"></a><span class="lineno"><a class="line" href="../../d1/d99/structmover.html#a212cefc7f5b7749302619a3c811bd7e7">  861</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../da/da7/structep.html">ep</a>                 *<a class="code" href="../../d1/d99/structmover.html#a212cefc7f5b7749302619a3c811bd7e7">m_ep</a>;</div><div class="line"><a name="l00862"></a><span class="lineno"><a class="line" href="../../d1/d99/structmover.html#a92dce5c08e4c69047f6eed9aa16b4d34">  862</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../db/d49/structm0__sm.html">m0_sm</a>               <a class="code" href="../../d1/d99/structmover.html#a92dce5c08e4c69047f6eed9aa16b4d34">m_sm</a>;</div><div class="line"><a name="l00863"></a><span class="lineno"><a class="line" href="../../d1/d99/structmover.html#a0d1d6b88abb201c5a587cf638ebe19e8">  863</a></span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d3/d91/structmover__op__vec.html">mover_op_vec</a> *<a class="code" href="../../d1/d99/structmover.html#a0d1d6b88abb201c5a587cf638ebe19e8">m_op</a>;</div><div class="line"><a name="l00865"></a><span class="lineno"><a class="line" href="../../d1/d99/structmover.html#aa5b6c92647fb63fda90ff44a83eee117">  865</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d9/de0/structm0__tlink.html">m0_tlink</a>            <a class="code" href="../../d1/d99/structmover.html#aa5b6c92647fb63fda90ff44a83eee117">m_linkage</a>;</div><div class="line"><a name="l00867"></a><span class="lineno"><a class="line" href="../../d1/d99/structmover.html#a009dde470277f894204e183285891cca">  867</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d9/dd0/structbuf.html">buf</a>                *<a class="code" href="../../d1/d99/structmover.html#a009dde470277f894204e183285891cca">m_buf</a>;</div><div class="line"><a name="l00869"></a><span class="lineno"><a class="line" href="../../d1/d99/structmover.html#aaaca63f1cdbf4c52c0c81e350ccc5f00">  869</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../df/de8/structpacket.html">packet</a>              <a class="code" href="../../d1/d99/structmover.html#aaaca63f1cdbf4c52c0c81e350ccc5f00">m_pk</a>;</div><div class="line"><a name="l00871"></a><span class="lineno"><a class="line" href="../../d1/d99/structmover.html#a4dedef8ceff4a5f475a2de0c5e1a4cc9">  871</a></span>&#160;        <span class="keywordtype">char</span>                       <a class="code" href="../../d1/d99/structmover.html#a4dedef8ceff4a5f475a2de0c5e1a4cc9">m_pkbuf</a>[<span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="../../df/de8/structpacket.html">packet</a>)];</div><div class="line"><a name="l00876"></a><span class="lineno"><a class="line" href="../../d1/d99/structmover.html#a4daf9d9599efabce6dcdfb868e2b5a9c">  876</a></span>&#160;        <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a>                <a class="code" href="../../d1/d99/structmover.html#a4daf9d9599efabce6dcdfb868e2b5a9c">m_nob</a>;</div><div class="line"><a name="l00881"></a><span class="lineno"><a class="line" href="../../d1/d99/structmover.html#adfeaac1889973a845e1674735bf1a625">  881</a></span>&#160;        <span class="keywordtype">void</span>                      *<a class="code" href="../../d1/d99/structmover.html#adfeaac1889973a845e1674735bf1a625">m_scratch</a>;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;};</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div><div class="line"><a name="l00887"></a><span class="lineno"><a class="line" href="../../d9/dd0/structbuf.html">  887</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d9/dd0/structbuf.html">buf</a> {</div><div class="line"><a name="l00888"></a><span class="lineno"><a class="line" href="../../d9/dd0/structbuf.html#a98e68f2754cbb2b3c318029356595862">  888</a></span>&#160;        uint64_t              <a class="code" href="../../d9/dd0/structbuf.html#a98e68f2754cbb2b3c318029356595862">b_magix</a>;</div><div class="line"><a name="l00890"></a><span class="lineno"><a class="line" href="../../d9/dd0/structbuf.html#a29fb49838c5d9685aa56e9c32c0dab54">  890</a></span>&#160;        uint64_t              <a class="code" href="../../d9/dd0/structbuf.html#a29fb49838c5d9685aa56e9c32c0dab54">b_cookie</a>;</div><div class="line"><a name="l00892"></a><span class="lineno"><a class="line" href="../../d9/dd0/structbuf.html#a11ed429feb7ad22be45284e8055fe465">  892</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d9/d7e/structm0__net__buffer.html">m0_net_buffer</a> *<a class="code" href="../../d9/dd0/structbuf.html#a11ed429feb7ad22be45284e8055fe465">b_buf</a>;</div><div class="line"><a name="l00894"></a><span class="lineno"><a class="line" href="../../d9/dd0/structbuf.html#ae21aab4029adf5ae3070f4379195d157">  894</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d1/d99/structmover.html">mover</a>          <a class="code" href="../../d9/dd0/structbuf.html#ae21aab4029adf5ae3070f4379195d157">b_writer</a>;</div><div class="line"><a name="l00896"></a><span class="lineno"><a class="line" href="../../d9/dd0/structbuf.html#a65bbee1059773d953d6c79dd44b04401">  896</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d9/d78/structm0__bitmap.html">m0_bitmap</a>      <a class="code" href="../../d9/dd0/structbuf.html#a65bbee1059773d953d6c79dd44b04401">b_done</a>;</div><div class="line"><a name="l00898"></a><span class="lineno"><a class="line" href="../../d9/dd0/structbuf.html#aebfa795c2499f9ffbb7391dbfc94981e">  898</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d5/d0e/structbdesc.html">bdesc</a>          <a class="code" href="../../d9/dd0/structbuf.html#aebfa795c2499f9ffbb7391dbfc94981e">b_peer</a>;</div><div class="line"><a name="l00900"></a><span class="lineno"><a class="line" href="../../d9/dd0/structbuf.html#a38f9df430deb5db9891b42147ef7a69e">  900</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../da/da7/structep.html">ep</a>            *<a class="code" href="../../d9/dd0/structbuf.html#a38f9df430deb5db9891b42147ef7a69e">b_other</a>;</div><div class="line"><a name="l00902"></a><span class="lineno"><a class="line" href="../../d9/dd0/structbuf.html#a01f42002dae28fb693128ce02d8d0c9f">  902</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d9/de0/structm0__tlink.html">m0_tlink</a>       <a class="code" href="../../d9/dd0/structbuf.html#a01f42002dae28fb693128ce02d8d0c9f">b_linkage</a>;</div><div class="line"><a name="l00904"></a><span class="lineno"><a class="line" href="../../d9/dd0/structbuf.html#a85f97c6e705fc8e0e25da5b8b7ef2824">  904</a></span>&#160;        <a class="code" href="../../d9/d49/types_8h.html#a4f7930f80649d778aee0bd974ff16645">m0_bindex_t</a>           <a class="code" href="../../d9/dd0/structbuf.html#a85f97c6e705fc8e0e25da5b8b7ef2824">b_offset</a>;</div><div class="line"><a name="l00909"></a><span class="lineno"><a class="line" href="../../d9/dd0/structbuf.html#a1fad047c5710429941a570879286459f">  909</a></span>&#160;        <a class="code" href="../../d9/d49/types_8h.html#a4f7930f80649d778aee0bd974ff16645">m0_bindex_t</a>           <a class="code" href="../../d9/dd0/structbuf.html#a1fad047c5710429941a570879286459f">b_length</a>;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;};</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div><div class="line"><a name="l00913"></a><span class="lineno"><a class="line" href="../../dd/d74/structsock.html">  913</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../dd/d74/structsock.html">sock</a> {</div><div class="line"><a name="l00914"></a><span class="lineno"><a class="line" href="../../dd/d74/structsock.html#ace549a57906dd4da1361177d42b38e2a">  914</a></span>&#160;        uint64_t        <a class="code" href="../../dd/d74/structsock.html#ace549a57906dd4da1361177d42b38e2a">s_magix</a>;</div><div class="line"><a name="l00916"></a><span class="lineno"><a class="line" href="../../dd/d74/structsock.html#a9f16c5c31b0670702bd2d4bf0ac9cc81">  916</a></span>&#160;        <span class="keywordtype">int</span>             <a class="code" href="../../dd/d74/structsock.html#a9f16c5c31b0670702bd2d4bf0ac9cc81">s_fd</a>;</div><div class="line"><a name="l00918"></a><span class="lineno"><a class="line" href="../../dd/d74/structsock.html#a4f142f45799c6f3ad8de534340993083">  918</a></span>&#160;        uint64_t        <a class="code" href="../../dd/d74/structsock.html#a4f142f45799c6f3ad8de534340993083">s_flags</a>;</div><div class="line"><a name="l00919"></a><span class="lineno"><a class="line" href="../../dd/d74/structsock.html#a5766c3b04a967df4143cd23bff6f83e5">  919</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../db/d49/structm0__sm.html">m0_sm</a>    <a class="code" href="../../dd/d74/structsock.html#a5766c3b04a967df4143cd23bff6f83e5">s_sm</a>;</div><div class="line"><a name="l00921"></a><span class="lineno"><a class="line" href="../../dd/d74/structsock.html#a6b1c16e61cb1a9524341d304929fe7d7">  921</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../da/da7/structep.html">ep</a>      *<a class="code" href="../../dd/d74/structsock.html#a6b1c16e61cb1a9524341d304929fe7d7">s_ep</a>;</div><div class="line"><a name="l00923"></a><span class="lineno"><a class="line" href="../../dd/d74/structsock.html#a1c1ad6e6c23a3d0ee6495ceffcf0387a">  923</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d1/d99/structmover.html">mover</a>    <a class="code" href="../../dd/d74/structsock.html#a1c1ad6e6c23a3d0ee6495ceffcf0387a">s_reader</a>;</div><div class="line"><a name="l00925"></a><span class="lineno"><a class="line" href="../../dd/d74/structsock.html#abebb1e2d51bd6b3b68ea4bfd8653eba3">  925</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d9/de0/structm0__tlink.html">m0_tlink</a> <a class="code" href="../../dd/d74/structsock.html#abebb1e2d51bd6b3b68ea4bfd8653eba3">s_linkage</a>;</div><div class="line"><a name="l00927"></a><span class="lineno"><a class="line" href="../../dd/d74/structsock.html#a6b4cebb106f36737b769484fa3f280df">  927</a></span>&#160;        <a class="code" href="../../d9/d7d/group__time.html#ga3e0d20573b53285374bbd0c65a7a42eb">m0_time_t</a>       <a class="code" href="../../dd/d74/structsock.html#a6b4cebb106f36737b769484fa3f280df">s_last</a>;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;};</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div><div class="line"><a name="l00935"></a><span class="lineno"><a class="line" href="../../d7/d2a/structsocktype.html">  935</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d7/d2a/structsocktype.html">socktype</a> {</div><div class="line"><a name="l00936"></a><span class="lineno"><a class="line" href="../../d7/d2a/structsocktype.html#a6f6622bd6a97e172f6100f47386bdfcf">  936</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>                *<a class="code" href="../../d7/d2a/structsocktype.html#a6f6622bd6a97e172f6100f47386bdfcf">st_name</a>;</div><div class="line"><a name="l00938"></a><span class="lineno"><a class="line" href="../../d7/d2a/structsocktype.html#a7694a7e62d9bb040c50f65a840633725">  938</a></span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d3/d91/structmover__op__vec.html">mover_op_vec</a> *<a class="code" href="../../d7/d2a/structsocktype.html#a7694a7e62d9bb040c50f65a840633725">st_reader</a>;</div><div class="line"><a name="l00940"></a><span class="lineno"><a class="line" href="../../d7/d2a/structsocktype.html#a0cbbaff8fcbc9fc999d25b371502fc3f">  940</a></span>&#160;        <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a>              (*<a class="code" href="../../d7/d2a/structsocktype.html#a0cbbaff8fcbc9fc999d25b371502fc3f">st_pk_size</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d1/d99/structmover.html">mover</a> *w,</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                                               <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l00946"></a><span class="lineno"><a class="line" href="../../d7/d2a/structsocktype.html#a1e8391986d046d379abbba78f51fd2eb">  946</a></span>&#160;        void                     (*<a class="code" href="../../d7/d2a/structsocktype.html#a1e8391986d046d379abbba78f51fd2eb">st_error</a>)(<span class="keyword">struct </span><a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <span class="keyword">struct </span><a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l00948"></a><span class="lineno"><a class="line" href="../../d7/d2a/structsocktype.html#a631f5466b3b1bd950fe9cb9391648272">  948</a></span>&#160;        <span class="keywordtype">int</span>                        <a class="code" href="../../d7/d2a/structsocktype.html#a631f5466b3b1bd950fe9cb9391648272">st_proto</a>;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;};</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;</div><div class="line"><a name="l00956"></a><span class="lineno"><a class="line" href="../../d3/d5d/structpfamily.html">  956</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d3/d5d/structpfamily.html">pfamily</a> {</div><div class="line"><a name="l00957"></a><span class="lineno"><a class="line" href="../../d3/d5d/structpfamily.html#a0d651171d046e2dff23fa92afd2a44ba">  957</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d3/d5d/structpfamily.html#a0d651171d046e2dff23fa92afd2a44ba">f_name</a>;</div><div class="line"><a name="l00963"></a><span class="lineno"><a class="line" href="../../d3/d5d/structpfamily.html#a47da420cb14c4c92a1e09df6913ec690">  963</a></span>&#160;        void      (*<a class="code" href="../../d3/d5d/structpfamily.html#a47da420cb14c4c92a1e09df6913ec690">f_encode</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d9/db9/structaddr.html">addr</a> *a, <span class="keyword">struct </span>sockaddr *sa);</div><div class="line"><a name="l00969"></a><span class="lineno"><a class="line" href="../../d3/d5d/structpfamily.html#abd6fbc18f045b5408003c90e81fab0c9">  969</a></span>&#160;        void      (*<a class="code" href="../../d3/d5d/structpfamily.html#abd6fbc18f045b5408003c90e81fab0c9">f_decode</a>)(<span class="keyword">struct </span><a class="code" href="../../d9/db9/structaddr.html">addr</a> *a, <span class="keyword">const</span> <span class="keyword">struct </span>sockaddr *sa);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;};</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment"> * Tracing helpers</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div><div class="line"><a name="l00976"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga0fc8219d03e704f2de43967fea4cb861">  976</a></span>&#160;<span class="preprocessor">#define SAFE(val, exp, fallback) ((val) != NULL ? (exp) : (fallback))</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga1aa1c0282667dd20fd028e9cbca9a730">  978</a></span>&#160;<span class="preprocessor">#define EP_F &quot;%s&quot;</span></div><div class="line"><a name="l00979"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaa0d80eec95c45cbd7162a05d571f4495">  979</a></span>&#160;<span class="preprocessor">#define EP_P(e) SAFE(e, (e)-&gt;e_ep.nep_addr, &quot;null&quot;)</span></div><div class="line"><a name="l00980"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gab2d8ecc7d9da047c0d42124b1dfbc332">  980</a></span>&#160;<span class="preprocessor">#define EP_FL EP_F &quot;-&gt;&quot; EP_F</span></div><div class="line"><a name="l00981"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga7b11e10d73d8c362dcc9575556eae75a">  981</a></span>&#160;<span class="preprocessor">#define EP_PL(e) EP_P(SAFE(e, ma_src(ep_ma(e)), NULL)), EP_P(e)</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div><div class="line"><a name="l00983"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga0f4c6f587f5574e2334e62b7c6ce9551">  983</a></span>&#160;<span class="preprocessor">#define SOCK_F EP_FL &quot;/%i/%&quot; PRIx64 &quot;/%i&quot;</span></div><div class="line"><a name="l00984"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga87024d181bcdab57ece0bc28a5aaa0fd">  984</a></span>&#160;<span class="preprocessor">#define SOCK_P(s) EP_PL(SAFE(s, (s)-&gt;s_ep, NULL)),      \</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="preprocessor">        SAFE(s, (s)-&gt;s_sm.sm_state, 0),                 \</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="preprocessor">        SAFE(s, (s)-&gt;s_flags, 0), SAFE(s, (s)-&gt;s_fd, 0)</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div><div class="line"><a name="l00988"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga275ae63e03470896123e2a44fbd06c1d">  988</a></span>&#160;<span class="preprocessor">#define B_F &quot;[[%i]@%p:&quot;EP_FL&quot;]&quot;</span></div><div class="line"><a name="l00989"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga1cd83a8f97b7d63bd601f3d1fe184d67">  989</a></span>&#160;<span class="preprocessor">#define B_P(b) (b)-&gt;b_buf-&gt;nb_qtype, (b), EP_PL((b)-&gt;b_other)</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div><div class="line"><a name="l00991"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga69dcfba03c6d43734c25d912a4f2288c">  991</a></span>&#160;<span class="preprocessor">#define TLOG(...) do { </span><span class="comment">/* M0_LOG(M0_DEBUG, __VA_ARGS__) */</span><span class="preprocessor">; } while (0)</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<a class="code" href="../../d5/d16/group__netsock.html#ga1e7c2252df38be7469c526b95eb574d7">M0_TL_DESCR_DEFINE</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <span class="stringliteral">&quot;sockets&quot;</span>,</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                   <span class="keyword">static</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a>, s_linkage, s_magix,</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                   <a class="code" href="../../dd/d08/magic_8h.html#a82bffe7189227eff068dab27a6040119ac62a4c66a91e970592f239e3f4f9f312">M0_NET_SOCK_SOCK_MAGIC</a>, <a class="code" href="../../dd/d08/magic_8h.html#a82bffe7189227eff068dab27a6040119a2a4fc13216e88ce327872fb39eccedd3">M0_NET_SOCK_SOCK_HEAD_MAGIC</a>);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<a class="code" href="../../d5/d16/group__netsock.html#gad555af4464b2da0aef4a71bedbf10cb8">M0_TL_DEFINE</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <span class="keyword">static</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a>);</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<a class="code" href="../../d5/d16/group__netsock.html#ga1e7c2252df38be7469c526b95eb574d7">M0_TL_DESCR_DEFINE</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <span class="stringliteral">&quot;movers&quot;</span>,</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                   <span class="keyword">static</span>, <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a>, m_linkage, m_magix,</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                   <a class="code" href="../../dd/d08/magic_8h.html#a82bffe7189227eff068dab27a6040119a32d28878571141d2702fa633e19f7956">M0_NET_SOCK_MOVER_MAGIC</a>, <a class="code" href="../../dd/d08/magic_8h.html#a82bffe7189227eff068dab27a6040119a30b904fff35185374fee40103e5c1541">M0_NET_SOCK_MOVER_HEAD_MAGIC</a>);</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<a class="code" href="../../d5/d16/group__netsock.html#gad555af4464b2da0aef4a71bedbf10cb8">M0_TL_DEFINE</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <span class="keyword">static</span>, <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a>);</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<a class="code" href="../../d5/d16/group__netsock.html#ga1e7c2252df38be7469c526b95eb574d7">M0_TL_DESCR_DEFINE</a>(b, <span class="stringliteral">&quot;buffers&quot;</span>,</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                   <span class="keyword">static</span>, <span class="keyword">struct</span> <a class="code" href="../../d9/dd0/structbuf.html">buf</a>, b_linkage, b_magix,</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                   <a class="code" href="../../dd/d08/magic_8h.html#a82bffe7189227eff068dab27a6040119a6df0c239fb1ce74f3a1aca3bff2c4a32">M0_NET_SOCK_BUF_MAGIC</a>, <a class="code" href="../../dd/d08/magic_8h.html#a82bffe7189227eff068dab27a6040119a015d48412488befb0ddf1c4db9d2e8d2">M0_NET_SOCK_BUF_HEAD_MAGIC</a>);</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<a class="code" href="../../d5/d16/group__netsock.html#gad555af4464b2da0aef4a71bedbf10cb8">M0_TL_DEFINE</a>(b, <span class="keyword">static</span>, <span class="keyword">struct</span> <a class="code" href="../../d9/dd0/structbuf.html">buf</a>);</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>  <a class="code" href="../../d5/d16/group__netsock.html#gaa548b4086af9f91b36c2c97493d2345c">dom_init</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/da0/structm0__net__xprt.html">m0_net_xprt</a> *<a class="code" href="../../dc/de2/net_2module_8c.html#a1435da8b61a16e2cfe821bca92347237">xprt</a>, <span class="keyword">struct</span> <a class="code" href="../../db/d78/structm0__net__domain.html">m0_net_domain</a> *<a class="code" href="../../dc/d74/addb2_2ut_2storage_8c.html#a6b9f7e6115c241d0a8ea3087490f1043">dom</a>);</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gac94eaec48aa0330f08aad1dac30716f5">dom_fini</a>(<span class="keyword">struct</span> <a class="code" href="../../db/d78/structm0__net__domain.html">m0_net_domain</a> *<a class="code" href="../../dc/d74/addb2_2ut_2storage_8c.html#a6b9f7e6115c241d0a8ea3087490f1043">dom</a>);</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>  <a class="code" href="../../d5/d16/group__netsock.html#gaeb8ce0b9e88d70b11be23556bbe3a7f8">ma_init</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>  <a class="code" href="../../d5/d16/group__netsock.html#gae71a95ee2475544498101a69c50b50e0">ma_confine</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>,</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                       <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/d78/structm0__bitmap.html">m0_bitmap</a> *processors);</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>  <a class="code" href="../../d5/d16/group__netsock.html#ga659f364dd5da411dc3961db0fb7de77e">ma_start</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>);</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>  <a class="code" href="../../d5/d16/group__netsock.html#ga2db0d962bdf2f6c2bcdc183f1a44592f">ma_stop</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>, <span class="keywordtype">bool</span> cancel);</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gaf8c51d155d8cf0609ffee4056167686b">ma_fini</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>  <a class="code" href="../../d5/d16/group__netsock.html#ga7d7e64eb8e44b6ffc187727ae565f1c4">end_point_create</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d80/structm0__net__end__point.html">m0_net_end_point</a> **epp,</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                             <span class="keyword">struct</span> <a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>);</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>  <a class="code" href="../../d5/d16/group__netsock.html#ga57bdbf76bd38811d51a9e332f2e9aea0">buf_register</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d7e/structm0__net__buffer.html">m0_net_buffer</a> *nb);</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gaa35d272e8d4f283958b86460800e24cd">buf_deregister</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d7e/structm0__net__buffer.html">m0_net_buffer</a> *nb);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>  <a class="code" href="../../d5/d16/group__netsock.html#ga9cdacdb6229f7becd262087bcefc9715">buf_add</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d7e/structm0__net__buffer.html">m0_net_buffer</a> *nb);</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga53079337909bf84060a165ba7eb1fc5d">buf_del</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d7e/structm0__net__buffer.html">m0_net_buffer</a> *nb);</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>  <a class="code" href="../../d5/d16/group__netsock.html#ga37e31a2f36872125309e4bcb50a89e33">bev_deliver_sync</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga08bbaf5a7ac6a88d11c356fc7bcd34ef">bev_deliver_all</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#ga88373be29952aeec9a2de84b52257efe">bev_pending</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gad87cb84510da3568b658ee9e4c9592d1">bev_notify</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>, <span class="keyword">struct</span> <a class="code" href="../../d0/d12/structm0__chan.html">m0_chan</a> *<a class="code" href="../../d8/d57/rdwr__test__bench_8c.html#a75b25076e6274990c36afcf04b70a53c">chan</a>);</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d5/d16/group__netsock.html#ga42954f73b21f92d35c9cc7cdafdf0cc6">get_max_buffer_size</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../db/d78/structm0__net__domain.html">m0_net_domain</a> *<a class="code" href="../../dc/d74/addb2_2ut_2storage_8c.html#a6b9f7e6115c241d0a8ea3087490f1043">dom</a>);</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d5/d16/group__netsock.html#gad243458e06517a7a34f083a6f226fb90">get_max_buffer_segment_size</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../db/d78/structm0__net__domain.html">m0_net_domain</a> *);</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="keyword">static</span> int32_t <a class="code" href="../../d5/d16/group__netsock.html#ga95a9ed0a5357022173b96f24d664374d">get_max_buffer_segments</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../db/d78/structm0__net__domain.html">m0_net_domain</a> *<a class="code" href="../../dc/d74/addb2_2ut_2storage_8c.html#a6b9f7e6115c241d0a8ea3087490f1043">dom</a>);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d5/d16/group__netsock.html#ga06ffa7bbccaa76fcccf8f02aa9c785b6">get_max_buffer_desc_size</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../db/d78/structm0__net__domain.html">m0_net_domain</a> *);</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga8a644fbe7fd0461e873a5a65f8d7d7ab">poller</a>   (<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gaf1d3252cd239283ea83af68fed6f78ca">ma__fini</a> (<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga9ed54523c05b17d045c4e884d7d0cc8a">ma_prune</a> (<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga14e6c41476564f25463e5b82fb17454f">ma_lock</a>  (<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gac11937bd71bc58ad75da8f7973aa3ddf">ma_unlock</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#gaea9acfa0baa7ea23380d77247e9894d6">ma_is_locked</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga1ccbabd9aaf069d324a4bba8a258ceb3">ma_event_post</a> (<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>, <span class="keyword">enum</span> <a class="code" href="../../d9/dd2/group__net.html#gaaa9dbf6c20e7f07dfe6fc3746f6183e2">m0_net_tm_state</a> state);</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga87f26fc0b5e6e27c0130d1c1bd877ff8">ma_buf_done</a>   (<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga87fceeb0675eca3bdc635f0be855673f">ma_buf_timeout</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d9/dd0/structbuf.html">buf</a> *<a class="code" href="../../d5/d16/group__netsock.html#ga2ef026fece207711f7b686f95bc6e4ff">ma_recv_buf</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>, <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> len);</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../d5/d16/group__netsock.html#gaab89d3e82371dfcccd5807a8762c2baa">ma_src</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>  <a class="code" href="../../d5/d16/group__netsock.html#ga27438def5d2ab354391ff1e2bd182c61">ep_find</a>   (<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>, <span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> **<a class="code" href="../../dd/d6d/group__xcode.html#ga50fe33eaae68b43814656f241a6ac907">out</a>);</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>  <a class="code" href="../../d5/d16/group__netsock.html#ga87fd9494dc7688b4f4cddb2bc5bfbaaa">ep_create</a> (<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>, <span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>,</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                       <span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> **<a class="code" href="../../dd/d6d/group__xcode.html#ga50fe33eaae68b43814656f241a6ac907">out</a>);</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga12fee080a96fe0bee1c5bf5ccb564ac8">ep_free</a>   (<span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a>);</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga5c9c81b5351fd8f6692c7069bc8d30ce">ep_put</a>    (<span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a>);</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga1378244d34c151c34550cddb28441154">ep_get</a>    (<span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a>);</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#ga6f158d48c8168947b0fef56f8bc52747">ep_eq</a>     (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a>, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *<a class="code" href="../../d9/db9/structaddr.html">addr</a>);</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d5/d16/group__netsock.html#ga78251ee15fee7c0c5da7f01379891e47">ep_ma</a> (<span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a>);</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../d5/d16/group__netsock.html#ga7d9e1d49b40b58dcb0d60a64aa70c4aa">ep_net</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d80/structm0__net__end__point.html">m0_net_end_point</a> *<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>);</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga5d22cfa334f2d6feb81248e6cd840562">ep_release</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d3f/structm0__ref.html">m0_ref</a> *ref);</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#gae9390c6a48f66a887e7e0929bd089c25">ep_invariant</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a>);</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>  <a class="code" href="../../d5/d16/group__netsock.html#ga45a84b5062bc213795304baca5b13f74">ep_add</a>(<span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a>, <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *w);</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga29cb5f0cd1ec36cce44a8d9baa6a1746">ep_del</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *w);</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>  <a class="code" href="../../d5/d16/group__netsock.html#ga98d09139fd60f6dd4f1200e42646b498">ep_balance</a>(<span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a>);</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>   <a class="code" href="../../d5/d16/group__netsock.html#ga97fcfe2ab24d7ddf0d1a4e1d144cb94a">addr_resolve</a>     (<span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>);</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>   <a class="code" href="../../d5/d16/group__netsock.html#gade75dddfcbfe49fe6ac9fca3c97457e3">addr_parse</a>       (<span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>);</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>   <a class="code" href="../../d5/d16/group__netsock.html#ga7189084138c48f66266d05c5bd6e1fdb">addr_parse_lnet</a>  (<span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>);</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>   <a class="code" href="../../d5/d16/group__netsock.html#gad41ec2097710f43c74d3114562b8a48a">addr_parse_native</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>);</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span>  <a class="code" href="../../d5/d16/group__netsock.html#ga88e81fbd6443046da02ec3cb446fa705">addr_decode</a>      (<span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <span class="keyword">const</span> <span class="keyword">struct</span> sockaddr *sa);</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span>  <a class="code" href="../../d5/d16/group__netsock.html#ga0551d085ef008b4fac533739771a1eb7">addr_encode</a>      (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <span class="keyword">struct</span> sockaddr *sa);</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d5/d16/group__netsock.html#ga1346d46974aa7185fed3b07d84480295">addr_print</a>       (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *<a class="code" href="../../d9/db9/structaddr.html">addr</a>);</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span>  <a class="code" href="../../d5/d16/group__netsock.html#gafe00935b90da1e6a5c7315945de225c4">addr_invariant</a>   (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *<a class="code" href="../../d9/db9/structaddr.html">addr</a>);</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span>  <a class="code" href="../../d5/d16/group__netsock.html#gaa44e650cf8e69290b8b265d8e706c7f4">addr_eq</a>          (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *a0, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *a1);</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>  <a class="code" href="../../d5/d16/group__netsock.html#gaa05d2431e69de06adf149afa0903de7b">sock_in</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gafe6b9b0c71898374d7d07b83666fae36">sock_out</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gaae7a60c600aecff6e08ebb32cf387475">sock_close</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga85d8da4dc83ae2334a7422a46b355949">sock_done</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <span class="keywordtype">bool</span> balance);</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga47e5eb47dbd6e7dcaac7b58e6fc7e5b1">sock_fini</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#ga41bd19654c4aa2b6f9cbfb78c32b953a">sock_event</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, uint32_t ev);</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>  <a class="code" href="../../d5/d16/group__netsock.html#gadc31941bba50c68b4c51483468b7acd4">sock_ctl</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <span class="keywordtype">int</span> <a class="code" href="../../d3/d1b/libdemo_8c.html#a99a30df0f2488360cdd46b4b88e5f5f0">op</a>, uint32_t <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a1e4cb2455f92782546a91bf8b5953aca">flags</a>);</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>  <a class="code" href="../../d5/d16/group__netsock.html#ga906821f5f2486bc82055c4e23550f9b9">sock_init_fd</a>(<span class="keywordtype">int</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a>, uint32_t <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a1e4cb2455f92782546a91bf8b5953aca">flags</a>);</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>  <a class="code" href="../../d5/d16/group__netsock.html#ga3e46e3a9fe0688a77c21473c9b1a3dde">sock_init</a>(<span class="keywordtype">int</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a>, <span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../df/ded/ut_2fd_8c.html#aac62f57bd247b8b9b145f09eef0e6e09">src</a>, <span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../df/ded/ut_2fd_8c.html#a71c20dda6f28285e2e67284efccaf3dc">tgt</a>, uint32_t <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a1e4cb2455f92782546a91bf8b5953aca">flags</a>);</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d5/d16/group__netsock.html#ga2482df25ee4d73a2fcdfe64fdadd7079">sock_writer</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#gadbe2464eb0dd92b5b19e5f2cfe21b715">sock_invariant</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d5/d16/group__netsock.html#gafea137fe2248694702f66bd158c45022">buf_ma</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dd0/structbuf.html">buf</a> *<a class="code" href="../../d9/dd0/structbuf.html">buf</a>);</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#gaca062f63e8a27154bb6e046504692bc9">buf_invariant</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/dd0/structbuf.html">buf</a> *<a class="code" href="../../d9/dd0/structbuf.html">buf</a>);</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga31831f32963572f54a3bc7d9fbe848cc">buf_fini</a>     (<span class="keyword">struct</span> <a class="code" href="../../d9/dd0/structbuf.html">buf</a> *<a class="code" href="../../d9/dd0/structbuf.html">buf</a>);</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>  <a class="code" href="../../d5/d16/group__netsock.html#gaef26c34c66e8e88befd9b30a9cae179c">buf_accept</a>   (<span class="keyword">struct</span> <a class="code" href="../../d9/dd0/structbuf.html">buf</a> *<a class="code" href="../../d9/dd0/structbuf.html">buf</a>, <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>);</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga901a7c7ecafb57cbf6885b57b9272e34">buf_done</a>     (<span class="keyword">struct</span> <a class="code" href="../../d9/dd0/structbuf.html">buf</a> *<a class="code" href="../../d9/dd0/structbuf.html">buf</a>, <span class="keywordtype">int</span> <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a>);</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gaad5bbb2a3b9939c8f2b9ee3cdb43849a">buf_complete</a> (<span class="keyword">struct</span> <a class="code" href="../../d9/dd0/structbuf.html">buf</a> *<a class="code" href="../../d9/dd0/structbuf.html">buf</a>);</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gac04519716eaedbe76c2c3cc947eff2f6">bdesc_create</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <span class="keyword">struct</span> <a class="code" href="../../d9/dd0/structbuf.html">buf</a> *<a class="code" href="../../d9/dd0/structbuf.html">buf</a>,</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                        <span class="keyword">struct</span> <a class="code" href="../../d0/db8/structm0__net__buf__desc.html">m0_net_buf_desc</a> *<a class="code" href="../../dd/d6d/group__xcode.html#ga50fe33eaae68b43814656f241a6ac907">out</a>);</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga13c610ec12e0a3b29cec26487f5651ab">bdesc_encode</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d0e/structbdesc.html">bdesc</a> *bd, <span class="keyword">struct</span> <a class="code" href="../../d0/db8/structm0__net__buf__desc.html">m0_net_buf_desc</a> *<a class="code" href="../../dd/d6d/group__xcode.html#ga50fe33eaae68b43814656f241a6ac907">out</a>);</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga765e88256787793065e7620d01449d4d">bdesc_decode</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d0/db8/structm0__net__buf__desc.html">m0_net_buf_desc</a> *nbd, <span class="keyword">struct</span> <a class="code" href="../../d5/d0e/structbdesc.html">bdesc</a> *<a class="code" href="../../dd/d6d/group__xcode.html#ga50fe33eaae68b43814656f241a6ac907">out</a>);</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga429999edeace62099ef3af8bd784d97d">mover_init</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>,</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                       <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d3/d91/structmover__op__vec.html">mover_op_vec</a> *vop);</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga023f04699c602a061ce4d4353e71c78a">mover_fini</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>  <a class="code" href="../../d5/d16/group__netsock.html#ga7b643699db61d5c148110d150136c16a">mover_op</a>  (<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <span class="keywordtype">int</span> <a class="code" href="../../d3/d1b/libdemo_8c.html#a99a30df0f2488360cdd46b4b88e5f5f0">op</a>);</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#gad1278e0c872e51530c6943d527e786a3">mover_is_reader</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>);</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#ga02f3f80057e9c21bfbdf4993dc6ba169">mover_is_writer</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>);</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#ga4d04d2d80f14221e812b0d455d4639c9">mover_invariant</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>);</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d5/d16/group__netsock.html#ga0783c9a92d6de5ed67d4e9c382001d5d">pk_size</a> (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d5/d16/group__netsock.html#ga08a2e9fc0c071a8d9af463180a71fd54">pk_tsize</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>);</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d5/d16/group__netsock.html#gaf7d93c09d009488be1e33a3fb74e45a9">pk_dnob</a> (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>);</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gab2a4957b29b0ff2f9b6abec6b37d71a6">pk_state</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *w);</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga643216df42cd41316bad263fdcf690ad">pk_io</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *w, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>,</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                 uint64_t <a class="code" href="../../d2/d66/group__dtm.html#ga8b3ab54ed3e81c69863d65e4e6c424a0">flag</a>, <span class="keyword">struct</span> <a class="code" href="../../da/d2c/structm0__bufvec.html">m0_bufvec</a> *bv, <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d4/d00/ut_2di_8c.html#a8629956d8c29c6159e411f38f24c140d">size</a>);</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga2158d30690db2c9459c9a9226d9d15aa">pk_iov_prep</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <span class="keyword">struct</span> iovec *iv, <span class="keywordtype">int</span> <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a>,</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                       <span class="keyword">struct</span> <a class="code" href="../../da/d2c/structm0__bufvec.html">m0_bufvec</a> *bv, <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d4/d00/ut_2di_8c.html#a8629956d8c29c6159e411f38f24c140d">size</a>, <span class="keywordtype">int</span> *<a class="code" href="../../d6/d0c/ut_2xcode_8c.html#a5f7d24ded17bf1ab44fdadf38c54a8b5">count</a>);</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gad7ba5dff1c65580fa18971ea7decf804">pk_header_init</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span>  <a class="code" href="../../d5/d16/group__netsock.html#gae0d835e5b33df4f26664af2f5c067f25">pk_header_done</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>);</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gabcf3ea8f28ad69325421a0cd066c8537">pk_done</a>  (<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>);</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga9963c546f67a16058c52e3e7eab7135c">pk_encdec</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <span class="keyword">enum</span> <a class="code" href="../../dd/d6d/group__xcode.html#ga39540fe756fec0792fdc0cc5cf7ab4b0">m0_xcode_what</a> what);</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gae6f42c83bbf4ab42da96adcb1aa02522">pk_decode</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>);</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gab694a18ebf526a77cfc704584c6a113f">pk_encode</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>);</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga92af4fb43448938aec447314de63ead1">stream_idle</a>    (<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gac86b71d05137f15bfeb5d34369b0116c">stream_pk</a>      (<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga908d163d92427d231903fa6e41a0abac">stream_header</a>  (<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga67b3a394cd9c1d7006a0c7c25282654c">stream_interval</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga714f0d57ccf1e2483267c981523a2864">stream_pk_done</a> (<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gaf169bc1171797bdc8c2bb37224838416">dgram_idle</a>     (<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga2eeacc9003a18e21618078440d7b57bb">dgram_pk</a>       (<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga1020d1d4f82dee7a79a9913595fcd030">dgram_header</a>   (<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga2fb2b3f17a4539bcf5363d68b7fea102">dgram_interval</a> (<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gad9fd986ece2d618089cfda4b185ce4ba">dgram_pk_done</a>  (<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gaaaa58dcfcdb1cc514329dc50bd3095b4">writer_idle</a>    (<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gab1deb8e1ba4744c222d7b95ea6d93752">writer_pk</a>      (<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga925c36d21e3c699446204c869a3e521e">writer_write</a>   (<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gab7beaa2515ba0faa730209abea6ed21d">writer_pk_done</a> (<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga9cea9b44e270d3cbaf2a5ef16fd653d5">get_idle</a>       (<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gaf2365098ff35cf19fc407ec542cf83d2">get_pk</a>         (<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga84fc4959018349aa9d99831f5e959505">writer_done</a>   (<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gaa0e13143fda3ace8485c788fa68c2655">writer_error</a>  (<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *w, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <span class="keywordtype">int</span> <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a>);</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d5/d16/group__netsock.html#ga75c3bacd4693a09b670e17916de5f0da">stream_pk_size</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *w, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span>        <a class="code" href="../../d5/d16/group__netsock.html#ga40ac618bb526e1fb205d17dfe4cc199f">stream_error</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d5/d16/group__netsock.html#ga8e6066984626295aac1349f675ff830f">dgram_pk_size</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *w, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span>        <a class="code" href="../../d5/d16/group__netsock.html#gaa84a0ba7e9ca103362e6b5a62228daad">dgram_error</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga69b44214debab83060d1387e07cebade">ip4_encode</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *a, <span class="keyword">struct</span> sockaddr *sa);</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga407a665abe98d73380b1333c033f6d63">ip4_decode</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *a, <span class="keyword">const</span> <span class="keyword">struct</span> sockaddr *sa);</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga41ef6a6d745f5cf282ab2a42c1eeb09d">ip6_encode</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *a, <span class="keyword">struct</span> sockaddr *sa);</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga8de83c5591e35a816141fffb1ae24e7f">ip6_decode</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *a, <span class="keyword">const</span> <span class="keyword">struct</span> sockaddr *sa);</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;</div><div class="line"><a name="l01147"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga916c31c6b0bf58b1c49128b94079fff8"> 1147</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../de/dbb/structm0__sm__conf.html">m0_sm_conf</a> <a class="code" href="../../d5/d16/group__netsock.html#ga916c31c6b0bf58b1c49128b94079fff8">sock_conf</a>;</div><div class="line"><a name="l01148"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga5f25f2a8c8e86982bd9c99b99cb97b4e"> 1148</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../de/dbb/structm0__sm__conf.html">m0_sm_conf</a> <a class="code" href="../../d5/d16/group__netsock.html#ga5f25f2a8c8e86982bd9c99b99cb97b4e">rw_conf</a>;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;</div><div class="line"><a name="l01150"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gae1c39f3887a734f80f90af19db496846"> 1150</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d3/d91/structmover__op__vec.html">mover_op_vec</a> <a class="code" href="../../d5/d16/group__netsock.html#gae1c39f3887a734f80f90af19db496846">stream_reader_op</a>;</div><div class="line"><a name="l01151"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaadafef50a110b8e53312f153d1c103d3"> 1151</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d3/d91/structmover__op__vec.html">mover_op_vec</a> <a class="code" href="../../d5/d16/group__netsock.html#gaadafef50a110b8e53312f153d1c103d3">dgram_reader_op</a>;</div><div class="line"><a name="l01152"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaaea8f9114f06faf1285bfd1bd5c6da3b"> 1152</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d3/d91/structmover__op__vec.html">mover_op_vec</a> <a class="code" href="../../d5/d16/group__netsock.html#gaaea8f9114f06faf1285bfd1bd5c6da3b">writer_op</a>;</div><div class="line"><a name="l01153"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaa3f97a589c8ebf7495ac65e2efd70f67"> 1153</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d3/d91/structmover__op__vec.html">mover_op_vec</a> <a class="code" href="../../d5/d16/group__netsock.html#gaa3f97a589c8ebf7495ac65e2efd70f67">get_op</a>;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;</div><div class="line"><a name="l01155"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga8ee1bd6f751a2a078fc04723d6e88d33"> 1155</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d3/d5d/structpfamily.html">pfamily</a>  <a class="code" href="../../d5/d16/group__netsock.html#ga8ee1bd6f751a2a078fc04723d6e88d33">pf</a>[];</div><div class="line"><a name="l01156"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga2c304ecfc57668f0196522601f103071"> 1156</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d7/d2a/structsocktype.html">socktype</a> <a class="code" href="../../d5/d16/group__netsock.html#ga2c304ecfc57668f0196522601f103071">stype</a>[];</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;</div><div class="line"><a name="l01158"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gab9e8dc20b199a933933acfd3a5b0853f"> 1158</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d3/d99/structm0__format__tag.html">m0_format_tag</a> <a class="code" href="../../d5/d16/group__netsock.html#gab9e8dc20b199a933933acfd3a5b0853f">put_tag</a>;</div><div class="line"><a name="l01159"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga37552715ad676e57ef041ea8bf86616b"> 1159</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d3/d99/structm0__format__tag.html">m0_format_tag</a> <a class="code" href="../../d5/d16/group__netsock.html#ga37552715ad676e57ef041ea8bf86616b">get_tag</a>;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d3/d5d/structpfamily.html">pfamily</a> <a class="code" href="../../d5/d16/group__netsock.html#ga8ee1bd6f751a2a078fc04723d6e88d33">pf</a>[] = {</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        [AF_UNIX]  = {</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                .<a class="code" href="../../d3/d5d/structpfamily.html#a0d651171d046e2dff23fa92afd2a44ba">f_name</a> = <span class="stringliteral">&quot;unix&quot;</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        },</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        [AF_INET]  = {</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                .f_name   = <span class="stringliteral">&quot;inet&quot;</span>,</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                .f_encode = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga69b44214debab83060d1387e07cebade">ip4_encode</a>,</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                .f_decode = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga407a665abe98d73380b1333c033f6d63">ip4_decode</a></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        },</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        [AF_INET6] = {</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                .f_name = <span class="stringliteral">&quot;inet6&quot;</span>,</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                .f_encode = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga41ef6a6d745f5cf282ab2a42c1eeb09d">ip6_encode</a>,</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                .f_decode = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga8de83c5591e35a816141fffb1ae24e7f">ip6_decode</a></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        }</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;};</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d7/d2a/structsocktype.html">socktype</a> <a class="code" href="../../d5/d16/group__netsock.html#ga2c304ecfc57668f0196522601f103071">stype</a>[] = {</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        [SOCK_STREAM] = {</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                .<a class="code" href="../../d7/d2a/structsocktype.html#a6f6622bd6a97e172f6100f47386bdfcf">st_name</a>    = <span class="stringliteral">&quot;stream&quot;</span>,</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                .st_reader  = &amp;<a class="code" href="../../d5/d16/group__netsock.html#gae1c39f3887a734f80f90af19db496846">stream_reader_op</a>,</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                .st_pk_size = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga75c3bacd4693a09b670e17916de5f0da">stream_pk_size</a>,</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                .st_error   = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga40ac618bb526e1fb205d17dfe4cc199f">stream_error</a>,</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                .st_proto   = IPPROTO_TCP</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        },</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        [SOCK_DGRAM]  = {</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                .st_name    = <span class="stringliteral">&quot;dgram&quot;</span>,</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                .st_reader  = &amp;<a class="code" href="../../d5/d16/group__netsock.html#gaadafef50a110b8e53312f153d1c103d3">dgram_reader_op</a>,</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                .st_pk_size = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga8e6066984626295aac1349f675ff830f">dgram_pk_size</a>,</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                .st_error   = &amp;<a class="code" href="../../d5/d16/group__netsock.html#gaa84a0ba7e9ca103362e6b5a62228daad">dgram_error</a>,</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                .st_proto   = IPPROTO_UDP</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        }</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;};</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment"> * static const char *rw_name[] = {</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment"> *      &quot;IDLE&quot;,</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="comment"> *      &quot;PK&quot;,</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment"> *      &quot;HEADER&quot;,</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment"> *      &quot;INTERVAL&quot;,</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment"> *      &quot;PK_DONE&quot;,</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment"> *      &quot;FAIL&quot;,</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment"> *      &quot;DONE&quot;,</span></div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="comment"> *      };</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="preprocessor">#ifdef EP_DEBUG</span></div><div class="line"><a name="l01207"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga7da4b8d0066b704056c040ddd9845aa7"> 1207</a></span>&#160;<span class="preprocessor">#define EP_GET(e, f) \</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="preprocessor">        ({ struct ep *__ep = (e); ep_get(__ep); M0_CNT_INC(__ep-&gt;e_r_ ## f); })</span></div><div class="line"><a name="l01209"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga2ca93efdb493d25d0eabb1d9722070c0"> 1209</a></span>&#160;<span class="preprocessor">#define EP_PUT(e, f) \</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="preprocessor">        ({ struct ep *__ep = (e); ep_put(__ep); M0_CNT_DEC(__ep-&gt;e_r_ ## f); })</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="preprocessor">#define EP_GET(e, f) ep_get(e)</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="preprocessor">#define EP_PUT(e, f) ep_put(e)</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;</div><div class="line"><a name="l01216"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7"> 1216</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>)</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;{</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a> = <a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d4/d8a/structm0__tl.html">m0_tl</a>              *eps = &amp;<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>-&gt;ntm_end_points;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        <span class="keywordflow">return</span>  <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>-&gt;ntm_xprt_private == <a class="code" href="../../d8/dee/structma.html">ma</a>) &amp;&amp;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                <a class="code" href="../../d0/d50/group__net__pvt.html#gaaab2835349be6b88fe5230b89c779608">m0_net__tm_invariant</a>(<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>) &amp;&amp;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                s_tlist_invariant(&amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a628f89b20b4000abc13078fc9ccf2354">t_deathrow</a>) &amp;&amp;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                <span class="comment">/* ma is either fully uninitialised or fully initialised. */</span></div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>((<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a8d69a44fe8c21a67f1e6c63253a7824e">t_poller</a>.<a class="code" href="../../d1/d67/structm0__thread.html#a4f2462d0260378ce98d6ba0ab1b18a45">t_func</a> == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; <a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a7fac31b01cd71bf3b8c7f6f4746adc1b">t_epollfd</a> == -1 &amp;&amp;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                     m0_nep_tlist_is_empty(eps) &amp;&amp;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                     s_tlist_is_empty(&amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a628f89b20b4000abc13078fc9ccf2354">t_deathrow</a>)) ||</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                    (<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a8d69a44fe8c21a67f1e6c63253a7824e">t_poller</a>.<a class="code" href="../../d1/d67/structm0__thread.html#a4f2462d0260378ce98d6ba0ab1b18a45">t_func</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; <a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a7fac31b01cd71bf3b8c7f6f4746adc1b">t_epollfd</a> &gt;= 0 &amp;&amp;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                     <a class="code" href="../../d7/d08/group__tlist.html#gaff792c7170b8ef517d40f1a37eb5340d">m0_tl_exists</a>(m0_nep, nep, eps,</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                                  <a class="code" href="../../d7/d08/group__tlist.html#gaff792c7170b8ef517d40f1a37eb5340d">m0_tl_exists</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga7d9e1d49b40b58dcb0d60a64aa70c4aa">ep_net</a>(nep)-&gt;e_sock,</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                                          <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_sm.sm_state == <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbae1999ab5c5b6740876a5e8ed025260aa">S_LISTENING</a>))) ||</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                    <a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#abdee7b3d9f72fefb859aaae81d4731d8">t_shutdown</a>) &amp;&amp;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                <span class="comment">/* In STARTED state ma is fully initialised. */</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(<a class="code" href="../../df/d2a/lib_2misc_8h.html#a7f75ab6839d468f4d23480a9c65724c5">ergo</a>(<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>-&gt;ntm_state == <a class="code" href="../../d9/dd2/group__net.html#ggaaa9dbf6c20e7f07dfe6fc3746f6183e2abbe89cdedac94d27fe1eeb53c4a82ffe">M0_NET_TM_STARTED</a>,</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                         <a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a7fac31b01cd71bf3b8c7f6f4746adc1b">t_epollfd</a> &gt;= 0)) &amp;&amp;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(<a class="code" href="../../d7/d08/group__tlist.html#gaff6f93b3ca67a19e8460cc469f5eabda">m0_tl_forall</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, &amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a628f89b20b4000abc13078fc9ccf2354">t_deathrow</a>, <a class="code" href="../../d5/d16/group__netsock.html#gadbe2464eb0dd92b5b19e5f2cfe21b715">sock_invariant</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>))) &amp;&amp;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                <span class="comment">/* Endpoints are unique. */</span></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(<a class="code" href="../../d7/d08/group__tlist.html#gaff6f93b3ca67a19e8460cc469f5eabda">m0_tl_forall</a>(m0_nep, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>, eps,</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                        <a class="code" href="../../d7/d08/group__tlist.html#gaff6f93b3ca67a19e8460cc469f5eabda">m0_tl_forall</a>(m0_nep, <a class="code" href="../../d1/d41/ut_2rwlock_8c.html#a1d2a9f68c117ca7f7fdcb220f4c08fa4">q</a>, eps,</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                             <a class="code" href="../../d5/d16/group__netsock.html#ga6f158d48c8168947b0fef56f8bc52747">ep_eq</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga7d9e1d49b40b58dcb0d60a64aa70c4aa">ep_net</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>), &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga7d9e1d49b40b58dcb0d60a64aa70c4aa">ep_net</a>(<a class="code" href="../../d1/d41/ut_2rwlock_8c.html#a1d2a9f68c117ca7f7fdcb220f4c08fa4">q</a>)-&gt;e_a) == (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a> == <a class="code" href="../../d1/d41/ut_2rwlock_8c.html#a1d2a9f68c117ca7f7fdcb220f4c08fa4">q</a>)))) &amp;&amp;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(<a class="code" href="../../d7/d08/group__tlist.html#gaff6f93b3ca67a19e8460cc469f5eabda">m0_tl_forall</a>(m0_nep, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>, eps, <a class="code" href="../../d5/d16/group__netsock.html#ga78251ee15fee7c0c5da7f01379891e47">ep_ma</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga7d9e1d49b40b58dcb0d60a64aa70c4aa">ep_net</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>)) == <a class="code" href="../../d8/dee/structma.html">ma</a> &amp;&amp;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                                 <a class="code" href="../../d5/d16/group__netsock.html#gae9390c6a48f66a887e7e0929bd089c25">ep_invariant</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga7d9e1d49b40b58dcb0d60a64aa70c4aa">ep_net</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>)))) &amp;&amp;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(<a class="code" href="../../df/d2a/lib_2misc_8h.html#a70993fc357f576c5a7d2ac4b7f4f35c5">m0_forall</a>(<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>, <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a>(<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>-&gt;ntm_q),</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                        <a class="code" href="../../d7/d08/group__tlist.html#gaff6f93b3ca67a19e8460cc469f5eabda">m0_tl_forall</a>(m0_net_tm, nb, &amp;<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>-&gt;ntm_q[<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>],</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                                     <a class="code" href="../../d5/d16/group__netsock.html#gaca062f63e8a27154bb6e046504692bc9">buf_invariant</a>(nb-&gt;nb_xprt_private)))) &amp;&amp;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(<a class="code" href="../../d7/d08/group__tlist.html#gaff6f93b3ca67a19e8460cc469f5eabda">m0_tl_forall</a>(b, <a class="code" href="../../d9/dd0/structbuf.html">buf</a>, &amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ac99334eddbdd3038853049e49ba745dd">t_done</a>, <a class="code" href="../../d5/d16/group__netsock.html#gaca062f63e8a27154bb6e046504692bc9">buf_invariant</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>)));</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;}</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div><div class="line"><a name="l01250"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gadbe2464eb0dd92b5b19e5f2cfe21b715"> 1250</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#gadbe2464eb0dd92b5b19e5f2cfe21b715">sock_invariant</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;{</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a> = <a class="code" href="../../d5/d16/group__netsock.html#ga78251ee15fee7c0c5da7f01379891e47">ep_ma</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_ep);</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <span class="keywordflow">return</span>  <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>((<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_sm.sm_state == <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba57451d0f52d3a8d7604c40753f7dd109">S_DELETED</a>) ==</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                    s_tlist_contains(&amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a628f89b20b4000abc13078fc9ccf2354">t_deathrow</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)) &amp;&amp;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>((<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_sm.sm_state != <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba57451d0f52d3a8d7604c40753f7dd109">S_DELETED</a>) ==</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                    s_tlist_contains(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_ep-&gt;e_sock, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>));</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;}</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;</div><div class="line"><a name="l01260"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaca062f63e8a27154bb6e046504692bc9"> 1260</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#gaca062f63e8a27154bb6e046504692bc9">buf_invariant</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/dd0/structbuf.html">buf</a> *<a class="code" href="../../d9/dd0/structbuf.html">buf</a>)</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;{</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d9/d7e/structm0__net__buffer.html">m0_net_buffer</a> *nb = <a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a11ed429feb7ad22be45284e8055fe465">b_buf</a>;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <span class="comment">/* Either the buffer is only added to the domain (not associated with a</span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment">           transfer machine... */</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        <span class="keywordflow">return</span>  (nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a812faa986d50d32e318c06cc330cf195">nb_flags</a> == <a class="code" href="../../d9/dd2/group__net.html#gga1936206a7485cc1c14e35c6e0d348a38aedcce3f60d38c656f02ff5e483e147bc">M0_NET_BUF_REGISTERED</a> &amp;&amp;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                 nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a81bdb16b1858bd23bc6ad680aec0d816">nb_tm</a> == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) ^ <span class="comment">/* or (exclusively) ... */</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                <span class="comment">/* it is queued to a machine. */</span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                (<a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a812faa986d50d32e318c06cc330cf195">nb_flags</a> &amp; (<a class="code" href="../../d9/dd2/group__net.html#gga1936206a7485cc1c14e35c6e0d348a38aedcce3f60d38c656f02ff5e483e147bc">M0_NET_BUF_REGISTERED</a>|<a class="code" href="../../d9/dd2/group__net.html#gga1936206a7485cc1c14e35c6e0d348a38a432c1776f408487b2150a80c70f64307">M0_NET_BUF_QUEUED</a>))&amp;&amp;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                 <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a81bdb16b1858bd23bc6ad680aec0d816">nb_tm</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                 <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(<a class="code" href="../../df/d2a/lib_2misc_8h.html#a7f75ab6839d468f4d23480a9c65724c5">ergo</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#ae21aab4029adf5ae3070f4379195d157">b_writer</a>.<a class="code" href="../../d1/d99/structmover.html#a92dce5c08e4c69047f6eed9aa16b4d34">m_sm</a>.<a class="code" href="../../db/d49/structm0__sm.html#ade11f5baac8ba43d50a4e069e2743cb7">sm_conf</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                          <a class="code" href="../../d5/d16/group__netsock.html#ga4d04d2d80f14221e812b0d455d4639c9">mover_invariant</a>(&amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#ae21aab4029adf5ae3070f4379195d157">b_writer</a>))) &amp;&amp;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                 <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(<a class="code" href="../../d9/dd2/group__net.html#gade3c99118f605e1975055c935cf806d6">m0_net__buffer_invariant</a>(nb)));</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;}</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;</div><div class="line"><a name="l01275"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gafe00935b90da1e6a5c7315945de225c4"> 1275</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#gafe00935b90da1e6a5c7315945de225c4">addr_invariant</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *a)</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;{</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        <span class="keywordflow">return</span>  <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(<a class="code" href="../../df/d2a/lib_2misc_8h.html#a3a6a6708976cdeb3aec96b1d2545bd8d">IS_IN_ARRAY</a>(a-&gt;<a class="code" href="../../d9/db9/structaddr.html#ad8ca990694d5e0a6cef86dd67ba2e6b7">a_family</a>, <a class="code" href="../../d5/d16/group__netsock.html#ga8ee1bd6f751a2a078fc04723d6e88d33">pf</a>)) &amp;&amp;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga8ee1bd6f751a2a078fc04723d6e88d33">pf</a>[a-&gt;<a class="code" href="../../d9/db9/structaddr.html#ad8ca990694d5e0a6cef86dd67ba2e6b7">a_family</a>].<a class="code" href="../../d3/d5d/structpfamily.html#a0d651171d046e2dff23fa92afd2a44ba">f_name</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(<a class="code" href="../../df/d2a/lib_2misc_8h.html#a3a6a6708976cdeb3aec96b1d2545bd8d">IS_IN_ARRAY</a>(a-&gt;<a class="code" href="../../d9/db9/structaddr.html#a5f0f751a9bdbdd75feadad5803d13285">a_socktype</a>, <a class="code" href="../../d5/d16/group__netsock.html#ga2c304ecfc57668f0196522601f103071">stype</a>)) &amp;&amp;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga2c304ecfc57668f0196522601f103071">stype</a>[a-&gt;<a class="code" href="../../d9/db9/structaddr.html#a5f0f751a9bdbdd75feadad5803d13285">a_socktype</a>].<a class="code" href="../../d7/d2a/structsocktype.html#a6f6622bd6a97e172f6100f47386bdfcf">st_name</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(M0_IN(a-&gt;<a class="code" href="../../d9/db9/structaddr.html#ad8ca990694d5e0a6cef86dd67ba2e6b7">a_family</a>, (AF_INET, AF_INET6))) &amp;&amp;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(M0_IN(a-&gt;<a class="code" href="../../d9/db9/structaddr.html#a5f0f751a9bdbdd75feadad5803d13285">a_socktype</a>, (SOCK_STREAM, SOCK_DGRAM))) &amp;&amp;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(M0_IN(a-&gt;<a class="code" href="../../d9/db9/structaddr.html#a830ec069f03642982b29f2b596d3e133">a_protocol</a>, (0, IPPROTO_TCP, IPPROTO_UDP)));</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;}</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;</div><div class="line"><a name="l01286"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gae9390c6a48f66a887e7e0929bd089c25"> 1286</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#gae9390c6a48f66a887e7e0929bd089c25">ep_invariant</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a>)</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;{</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a> = <a class="code" href="../../d5/d16/group__netsock.html#ga78251ee15fee7c0c5da7f01379891e47">ep_ma</a>((<span class="keywordtype">void</span> *)<a class="code" href="../../da/da7/structep.html">ep</a>);</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        <span class="keywordflow">return</span>  <a class="code" href="../../d5/d16/group__netsock.html#gafe00935b90da1e6a5c7315945de225c4">addr_invariant</a>(&amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a7fa38028a1ed8e0d494fc3d2f179a890">e_a</a>) &amp;&amp;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                <a class="code" href="../../d9/dd2/group__net.html#ga2232890cb77bcf9969b217df250eab63">m0_net__ep_invariant</a>((<span class="keywordtype">void</span> *)&amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a3851e3d045cfdff109ee4c7c69b1e9b8">e_ep</a>,</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                                     (<span class="keywordtype">void</span> *)<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>, <span class="keyword">true</span>) &amp;&amp;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a3851e3d045cfdff109ee4c7c69b1e9b8">e_ep</a>.<a class="code" href="../../d2/d80/structm0__net__end__point.html#a737da65a4b01c33c2014c861e38f7398">nep_addr</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="preprocessor">#ifdef EP_DEBUG</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                <span class="comment">/*</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment">                 * Reference counters consistency:</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="comment">                 */</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                <span class="comment">/* Each writer got a reference... */</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#aa1c8901cba3b2ad15bcb1599772f8e96">e_r_mover</a> == m_tlist_length(&amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#ac2bafd27a0e0c46e6cc7791b1a33ebcb">e_writer</a>)) &amp;&amp;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                <span class="comment">/*</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="comment">                 * and each socket (including ones lingering on ma-&gt;t_deathrow)</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="comment">                 * got a reference.</span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="comment">                 */</span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#ae4872a5d9413746fc1332b2a766dab29">e_r_sock</a>  == s_tlist_length(&amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#aa56814b0282f4d2f416fad8bda1da592">e_sock</a>) +</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                    m0_tl_fold(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, dead, &amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a628f89b20b4000abc13078fc9ccf2354">t_deathrow</a>, 0,</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                               dead + (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_ep == <a class="code" href="../../da/da7/structep.html">ep</a>))) &amp;&amp;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(<a class="code" href="../../d7/d08/group__tlist.html#gaff6f93b3ca67a19e8460cc469f5eabda">m0_tl_forall</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, &amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#aa56814b0282f4d2f416fad8bda1da592">e_sock</a>,</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                                 <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_ep == <a class="code" href="../../da/da7/structep.html">ep</a> &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#gadbe2464eb0dd92b5b19e5f2cfe21b715">sock_invariant</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>))) &amp;&amp;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(<a class="code" href="../../d7/d08/group__tlist.html#gaff6f93b3ca67a19e8460cc469f5eabda">m0_tl_forall</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, w, &amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#ac2bafd27a0e0c46e6cc7791b1a33ebcb">e_writer</a>,</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                                 w-&gt;m_ep == <a class="code" href="../../da/da7/structep.html">ep</a> &amp;&amp;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                                 <span class="comment">/*</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="comment">                                  * The writer locked to a socket is always at</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="comment">                                  * the head of the writers list.</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="comment">                                  */</span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                                 <a class="code" href="../../df/d2a/lib_2misc_8h.html#a7f75ab6839d468f4d23480a9c65724c5">ergo</a>(w-&gt;m_sock != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                                      w == m_tlist_head(&amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#ac2bafd27a0e0c46e6cc7791b1a33ebcb">e_writer</a>))));</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;}</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;</div><div class="line"><a name="l01320"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga4d04d2d80f14221e812b0d455d4639c9"> 1320</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#ga4d04d2d80f14221e812b0d455d4639c9">mover_invariant</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>)</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;{</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        <span class="keywordflow">return</span>  <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(m_tlink_is_in(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>) == (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_ep != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) &amp;&amp;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                <a class="code" href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a>(M0_IN(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_op, (&amp;<a class="code" href="../../d5/d16/group__netsock.html#gaaea8f9114f06faf1285bfd1bd5c6da3b">writer_op</a>, &amp;<a class="code" href="../../d5/d16/group__netsock.html#gaa3f97a589c8ebf7495ac65e2efd70f67">get_op</a>)) ||</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                    <a class="code" href="../../df/d2a/lib_2misc_8h.html#a1446f7688b06ecc811aed5f93a4a7b43">m0_exists</a>(<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>, <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga2c304ecfc57668f0196522601f103071">stype</a>),</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                              <a class="code" href="../../d5/d16/group__netsock.html#ga2c304ecfc57668f0196522601f103071">stype</a>[<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>].st_reader == <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_op));</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;}</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;</div><div class="line"><a name="l01329"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaa548b4086af9f91b36c2c97493d2345c"> 1329</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gaa548b4086af9f91b36c2c97493d2345c">dom_init</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/da0/structm0__net__xprt.html">m0_net_xprt</a> *<a class="code" href="../../dc/de2/net_2module_8c.html#a1435da8b61a16e2cfe821bca92347237">xprt</a>, <span class="keyword">struct</span> <a class="code" href="../../db/d78/structm0__net__domain.html">m0_net_domain</a> *<a class="code" href="../../dc/d74/addb2_2ut_2storage_8c.html#a6b9f7e6115c241d0a8ea3087490f1043">dom</a>)</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;{</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        <a class="code" href="../../d8/d98/group__trace.html#ga6548fb7186df5dbebd72d1bcbce1cbc3">M0_ENTRY</a>();</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a9a02a790ad457506f9f3bc12121e6079">M0_RC</a>(0);</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;}</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;</div><div class="line"><a name="l01336"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gac94eaec48aa0330f08aad1dac30716f5"> 1336</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gac94eaec48aa0330f08aad1dac30716f5">dom_fini</a>(<span class="keyword">struct</span> <a class="code" href="../../db/d78/structm0__net__domain.html">m0_net_domain</a> *<a class="code" href="../../dc/d74/addb2_2ut_2storage_8c.html#a6b9f7e6115c241d0a8ea3087490f1043">dom</a>)</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;{</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        <a class="code" href="../../d8/d98/group__trace.html#ga6548fb7186df5dbebd72d1bcbce1cbc3">M0_ENTRY</a>();</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#ad1c2b8b0cf1cc0d319e690c0bef9569e">M0_LEAVE</a>();</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;}</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;</div><div class="line"><a name="l01342"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga14e6c41476564f25463e5b82fb17454f"> 1342</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga14e6c41476564f25463e5b82fb17454f">ma_lock</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>)</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;{</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        <a class="code" href="../../d0/d04/group__mutex.html#gae26efdb3a765f750c5992041d6ee2336">m0_mutex_lock</a>(&amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;ntm_mutex);</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;}</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;</div><div class="line"><a name="l01347"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gac11937bd71bc58ad75da8f7973aa3ddf"> 1347</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gac11937bd71bc58ad75da8f7973aa3ddf">ma_unlock</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>)</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;{</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        <a class="code" href="../../d0/d04/group__mutex.html#ga18963570792098f5ab3cf3e8ede8046a">m0_mutex_unlock</a>(&amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;ntm_mutex);</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;}</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div><div class="line"><a name="l01352"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaea9acfa0baa7ea23380d77247e9894d6"> 1352</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#gaea9acfa0baa7ea23380d77247e9894d6">ma_is_locked</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>)</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;{</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d0/d04/group__mutex.html#ga0c96633d90ccf7e2ed6ffee75d983975">m0_mutex_is_locked</a>(&amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;ntm_mutex);</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;}</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;</div><div class="line"><a name="l01360"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga8a644fbe7fd0461e873a5a65f8d7d7ab"> 1360</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga8a644fbe7fd0461e873a5a65f8d7d7ab">poller</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>)</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;{</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        <span class="keyword">enum</span> { EV_NR = 256 };</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        <span class="keyword">struct </span>epoll_event ev[EV_NR] = {};</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        <span class="keywordtype">int</span>                <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a>;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        <span class="keywordtype">int</span>                <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="comment">         * Notify users that ma reached M0_NET_TM_STARTED state.</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="comment">         * This also sets ma-&gt;ntm_ep.</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="comment">         * This should be done once per tm, so if multiple poller threads are</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="comment">         * used, only 1 event should be posted.</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="comment">         * @todo there is a race condition here: an application (i.e., the rpc</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="comment">         * layer), might timeout waiting for the ma to start and call</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="comment">         * m0_net_tm_stop(), which moves ma into STOPPING state, but the event</span></div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="comment">         * posted below moves the ma back into STARTED state.</span></div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="comment">         * Because of this, we do not assert ma states here.</span></div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga1ccbabd9aaf069d324a4bba8a258ceb3">ma_event_post</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>, <a class="code" href="../../d9/dd2/group__net.html#ggaaa9dbf6c20e7f07dfe6fc3746f6183e2abbe89cdedac94d27fe1eeb53c4a82ffe">M0_NET_TM_STARTED</a>);</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;        <span class="keywordflow">while</span> (1) {</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#abdee7b3d9f72fefb859aaae81d4731d8">t_shutdown</a>)</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a> = epoll_wait(<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a7fac31b01cd71bf3b8c7f6f4746adc1b">t_epollfd</a>, ev, <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a>(ev), 1000);</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a> == -1) {</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                        <a class="code" href="../../d8/d98/group__trace.html#gabf13f904bc760a195c4e3b75fa471f58">M0_LOG</a>(<a class="code" href="../../d8/d98/group__trace.html#gga222dfe20eda8c002fbab0ebbb2a7848ba8d2169c7a189138ea53e05ce2c558d4f">M0_DEBUG</a>, <span class="stringliteral">&quot;epoll: %i.&quot;</span>, -errno);</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                        <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(errno == EINTR);</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                }</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                <span class="comment">/* Check again because epoll() may block for some time */</span></div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#abdee7b3d9f72fefb859aaae81d4731d8">t_shutdown</a>)</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                <a class="code" href="../../d8/d98/group__trace.html#gabf13f904bc760a195c4e3b75fa471f58">M0_LOG</a>(<a class="code" href="../../d8/d98/group__trace.html#gga222dfe20eda8c002fbab0ebbb2a7848ba8d2169c7a189138ea53e05ce2c558d4f">M0_DEBUG</a>, <span class="stringliteral">&quot;Got: %d.&quot;</span>, <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a>);</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#ga14e6c41476564f25463e5b82fb17454f">ma_lock</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(<a class="code" href="../../d5/d16/group__netsock.html#gaea9acfa0baa7ea23380d77247e9894d6">ma_is_locked</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>) &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>));</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> = 0; <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> &lt; <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a>; ++<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>) {</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                        <span class="keyword">struct </span><a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a> = ev[<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>].data.ptr;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_sm.sm_state == <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba57451d0f52d3a8d7604c40753f7dd109">S_DELETED</a>)</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d16/group__netsock.html#ga41bd19654c4aa2b6f9cbfb78c32b953a">sock_event</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, ev[<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>].events))</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                                <span class="comment">/*</span></div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="comment">                                 * Ran out of buffers on the receive queue,</span></div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="comment">                                 * break out, deliver completion events,</span></div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="comment">                                 * re-provision.</span></div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="comment">                                 */</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                }</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                <span class="comment">/* @todo close long-unused sockets. */</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#ga87fceeb0675eca3bdc635f0be855673f">ma_buf_timeout</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                <span class="comment">/*</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="comment">                 * Deliver buffer completion events and re-provision receive</span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="comment">                 * queue if necessary.</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="comment">                 */</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#ga87f26fc0b5e6e27c0130d1c1bd877ff8">ma_buf_done</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>));</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                <span class="comment">/*</span></div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="comment">                 * This is the only place, where sock structures are freed,</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="comment">                 * except for ma finalisation.</span></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="comment">                 */</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#ga9ed54523c05b17d045c4e884d7d0cc8a">ma_prune</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>));</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#gac11937bd71bc58ad75da8f7973aa3ddf">ma_unlock</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        }</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;}</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;</div><div class="line"><a name="l01445"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaeb8ce0b9e88d70b11be23556bbe3a7f8"> 1445</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gaeb8ce0b9e88d70b11be23556bbe3a7f8">ma_init</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>)</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;{</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        <span class="keywordtype">int</span>        result;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>-&gt;ntm_xprt_private == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        <a class="code" href="../../d7/ded/group__memory.html#ga2dd26426583fa272fa2061075e2dcf57">M0_ALLOC_PTR</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/dee/structma.html">ma</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                <a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a7fac31b01cd71bf3b8c7f6f4746adc1b">t_epollfd</a> = -1;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                <a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#abdee7b3d9f72fefb859aaae81d4731d8">t_shutdown</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                <a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>-&gt;ntm_xprt_private = <a class="code" href="../../d8/dee/structma.html">ma</a>;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                <a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a> = <a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>;</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                s_tlist_init(&amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a628f89b20b4000abc13078fc9ccf2354">t_deathrow</a>);</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                b_tlist_init(&amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ac99334eddbdd3038853049e49ba745dd">t_done</a>);</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                result = 0;</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        } <span class="keywordflow">else</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                result = <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-ENOMEM);</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a9a02a790ad457506f9f3bc12121e6079">M0_RC</a>(result);</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;}</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;</div><div class="line"><a name="l01467"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga9ed54523c05b17d045c4e884d7d0cc8a"> 1467</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga9ed54523c05b17d045c4e884d7d0cc8a">ma_prune</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>)</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;{</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../dd/d74/structsock.html">sock</a>;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gaea9acfa0baa7ea23380d77247e9894d6">ma_is_locked</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>));</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        <a class="code" href="../../d7/d08/group__tlist.html#ga6c73104b68112bed660165c64164fadf">m0_tl_for</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, &amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a628f89b20b4000abc13078fc9ccf2354">t_deathrow</a>, <a class="code" href="../../dd/d74/structsock.html">sock</a>) {</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#ga47e5eb47dbd6e7dcaac7b58e6fc7e5b1">sock_fini</a>(<a class="code" href="../../dd/d74/structsock.html">sock</a>);</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        } <a class="code" href="../../d7/d08/group__tlist.html#gaef8bbd93c23f12be0bfbb16ced9ad206">m0_tl_endfor</a>;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#aea86d55595126b703b9e619887f09a22">M0_POST</a>(s_tlist_is_empty(&amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a628f89b20b4000abc13078fc9ccf2354">t_deathrow</a>));</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;}</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;</div><div class="line"><a name="l01484"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaf1d3252cd239283ea83af68fed6f78ca"> 1484</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gaf1d3252cd239283ea83af68fed6f78ca">ma__fini</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>)</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;{</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d2/d80/structm0__net__end__point.html">m0_net_end_point</a> *<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gaea9acfa0baa7ea23380d77247e9894d6">ma_is_locked</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>));</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#abdee7b3d9f72fefb859aaae81d4731d8">t_shutdown</a>) {</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                <span class="comment">/* Set the shutdown flag.</span></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="comment">                 * Release the lock and wait for poller(), so that the poller()</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="comment">                 * will get a chance to detect this flag and exit.</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="comment">                 */</span></div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                <a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#abdee7b3d9f72fefb859aaae81d4731d8">t_shutdown</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#gac11937bd71bc58ad75da8f7973aa3ddf">ma_unlock</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a8d69a44fe8c21a67f1e6c63253a7824e">t_poller</a>.<a class="code" href="../../d1/d67/structm0__thread.html#a4f2462d0260378ce98d6ba0ab1b18a45">t_func</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                        <a class="code" href="../../db/d41/group__kthread.html#ga250c810f6cc1aad898687f5282314713">m0_thread_join</a>(&amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a8d69a44fe8c21a67f1e6c63253a7824e">t_poller</a>);</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                        <a class="code" href="../../da/dd8/group__thread.html#ga2a9d1d0b44cfa91b6fd83f66d2f4fc00">m0_thread_fini</a>(&amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a8d69a44fe8c21a67f1e6c63253a7824e">t_poller</a>);</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                }</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                <span class="comment">/* Go on finalizing the ma */</span></div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#ga14e6c41476564f25463e5b82fb17454f">ma_lock</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                <a class="code" href="../../d7/d08/group__tlist.html#ga6c73104b68112bed660165c64164fadf">m0_tl_for</a>(m0_nep, &amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#a4d20259926d66ad4922f26d196260c97">ntm_end_points</a>, <a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>) {</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                        <span class="keyword">struct </span><a class="code" href="../../da/da7/structep.html">ep</a>   *<a class="code" href="../../da/da7/structep.html">ep</a> = <a class="code" href="../../d5/d16/group__netsock.html#ga7d9e1d49b40b58dcb0d60a64aa70c4aa">ep_net</a>(<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>);</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                        <span class="keyword">struct </span><a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../dd/d74/structsock.html">sock</a>;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                        <a class="code" href="../../d7/d08/group__tlist.html#ga6c73104b68112bed660165c64164fadf">m0_tl_for</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, &amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#aa56814b0282f4d2f416fad8bda1da592">e_sock</a>, <a class="code" href="../../dd/d74/structsock.html">sock</a>) {</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                                <a class="code" href="../../d5/d16/group__netsock.html#ga85d8da4dc83ae2334a7422a46b355949">sock_done</a>(<a class="code" href="../../dd/d74/structsock.html">sock</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                        } <a class="code" href="../../d7/d08/group__tlist.html#gaef8bbd93c23f12be0bfbb16ced9ad206">m0_tl_endfor</a>;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                } <a class="code" href="../../d7/d08/group__tlist.html#gaef8bbd93c23f12be0bfbb16ced9ad206">m0_tl_endfor</a>;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                <span class="comment">/*</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="comment">                 * Finalise epoll after sockets, because sock_done() removes the</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="comment">                 * socket from the poll set.</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="comment">                 */</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a7fac31b01cd71bf3b8c7f6f4746adc1b">t_epollfd</a> &gt;= 0) {</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                        close(<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a7fac31b01cd71bf3b8c7f6f4746adc1b">t_epollfd</a>);</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                        <a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a7fac31b01cd71bf3b8c7f6f4746adc1b">t_epollfd</a> = -1;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                }</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#ga87f26fc0b5e6e27c0130d1c1bd877ff8">ma_buf_done</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#ga9ed54523c05b17d045c4e884d7d0cc8a">ma_prune</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                b_tlist_fini(&amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ac99334eddbdd3038853049e49ba745dd">t_done</a>);</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                s_tlist_fini(&amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a628f89b20b4000abc13078fc9ccf2354">t_deathrow</a>);</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(m0_nep_tlist_is_empty(&amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#a4d20259926d66ad4922f26d196260c97">ntm_end_points</a>));</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                <a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#adaf6dbd711e031c0a236d31364f63d1e">ntm_ep</a> = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        }</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#aea86d55595126b703b9e619887f09a22">M0_POST</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>));</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;}</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;</div><div class="line"><a name="l01530"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaf8c51d155d8cf0609ffee4056167686b"> 1530</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gaf8c51d155d8cf0609ffee4056167686b">ma_fini</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>)</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;{</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a> = <a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>-&gt;ntm_xprt_private;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga14e6c41476564f25463e5b82fb17454f">ma_lock</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gaea9acfa0baa7ea23380d77247e9894d6">ma_is_locked</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>) &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>));</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gaf1d3252cd239283ea83af68fed6f78ca">ma__fini</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gac11937bd71bc58ad75da8f7973aa3ddf">ma_unlock</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        <a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>-&gt;ntm_xprt_private = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        <a class="code" href="../../d7/ded/group__memory.html#ga0b8533a3024754008602759e71337eb3">m0_free</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;}</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;</div><div class="line"><a name="l01551"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga659f364dd5da411dc3961db0fb7de77e"> 1551</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga659f364dd5da411dc3961db0fb7de77e">ma_start</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>)</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;{</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a> = <a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>-&gt;ntm_xprt_private;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;        <span class="keywordtype">int</span>        result;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gaea9acfa0baa7ea23380d77247e9894d6">ma_is_locked</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>) &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>));</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>-&gt;ntm_state == <a class="code" href="../../d9/dd2/group__net.html#ggaaa9dbf6c20e7f07dfe6fc3746f6183e2aec060e2edf58c654f83989d5635bf0a6">M0_NET_TM_STARTING</a>);</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment">         * - initialise epoll</span></div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="comment">         * - parse the address and create the source endpoint</span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="comment">         * - create the listening socket</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="comment">         * - start the poller thread.</span></div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="comment">         * Should be done in this order, because the poller thread uses the</span></div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="comment">         * listening socket to get the source endpoint to post a ma state change</span></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="comment">         * event (outside of ma lock).</span></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        <a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a7fac31b01cd71bf3b8c7f6f4746adc1b">t_epollfd</a> = epoll_create(1);</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a7fac31b01cd71bf3b8c7f6f4746adc1b">t_epollfd</a> &gt;= 0) {</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                <span class="keyword">struct </span><a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../d4/de8/sw_8h.html#a2f37eff18c7fc0bdbe63c3e2020932ed">ep</a>;</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                result = <a class="code" href="../../d5/d16/group__netsock.html#ga27438def5d2ab354391ff1e2bd182c61">ep_find</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>, <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>, &amp;<a class="code" href="../../da/da7/structep.html">ep</a>);</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                <span class="keywordflow">if</span> (result == 0) {</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                        result = <a class="code" href="../../d5/d16/group__netsock.html#ga3e46e3a9fe0688a77c21473c9b1a3dde">sock_init</a>(-1, <a class="code" href="../../da/da7/structep.html">ep</a>, <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, EPOLLET);</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                        <span class="keywordflow">if</span> (result == 0) {</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                                result = <a class="code" href="../../da/dd8/group__thread.html#gadfa88d6ec630f9ef157f5ac6fd3cb778">M0_THREAD_INIT</a>(&amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a8d69a44fe8c21a67f1e6c63253a7824e">t_poller</a>,</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;                                                        <span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *, <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                                                        &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga8a644fbe7fd0461e873a5a65f8d7d7ab">poller</a>, <a class="code" href="../../d8/dee/structma.html">ma</a>, <span class="stringliteral">&quot;socktm&quot;</span>);</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                        }</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                        <a class="code" href="../../d5/d16/group__netsock.html#ga2ca93efdb493d25d0eabb1d9722070c0">EP_PUT</a>(<a class="code" href="../../da/da7/structep.html">ep</a>, find);</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;                }</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        } <span class="keywordflow">else</span></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                result = -errno;</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        <span class="keywordflow">if</span> (result != 0)</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#gaf1d3252cd239283ea83af68fed6f78ca">ma__fini</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#aea86d55595126b703b9e619887f09a22">M0_POST</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>));</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a9a02a790ad457506f9f3bc12121e6079">M0_RC</a>(result);</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;}</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;</div><div class="line"><a name="l01603"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga2db0d962bdf2f6c2bcdc183f1a44592f"> 1603</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga2db0d962bdf2f6c2bcdc183f1a44592f">ma_stop</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>, <span class="keywordtype">bool</span> cancel)</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;{</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a> = <a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>-&gt;ntm_xprt_private;</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gaea9acfa0baa7ea23380d77247e9894d6">ma_is_locked</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>) &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>));</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>-&gt;ntm_state == <a class="code" href="../../d9/dd2/group__net.html#ggaaa9dbf6c20e7f07dfe6fc3746f6183e2a39b6318d195085ad1ec281a72d6cc70d">M0_NET_TM_STOPPING</a>);</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;        <span class="keywordflow">if</span> (cancel)</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                <a class="code" href="../../d0/d50/group__net__pvt.html#gaf0b898c77dcf888cc05e3493df2a6910">m0_net__tm_cancel</a>(<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>);</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gaf1d3252cd239283ea83af68fed6f78ca">ma__fini</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gac11937bd71bc58ad75da8f7973aa3ddf">ma_unlock</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga1ccbabd9aaf069d324a4bba8a258ceb3">ma_event_post</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>, <a class="code" href="../../d9/dd2/group__net.html#ggaaa9dbf6c20e7f07dfe6fc3746f6183e2a47cc9cefcc503559a55be5c92786547a">M0_NET_TM_STOPPED</a>);</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga14e6c41476564f25463e5b82fb17454f">ma_lock</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;}</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;</div><div class="line"><a name="l01619"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gae71a95ee2475544498101a69c50b50e0"> 1619</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gae71a95ee2475544498101a69c50b50e0">ma_confine</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>,</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                      <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/d78/structm0__bitmap.html">m0_bitmap</a> *processors)</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;{</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;        <span class="keywordflow">return</span> -ENOSYS;</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;}</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;</div><div class="line"><a name="l01628"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga1ccbabd9aaf069d324a4bba8a258ceb3"> 1628</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga1ccbabd9aaf069d324a4bba8a258ceb3">ma_event_post</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>, <span class="keyword">enum</span> <a class="code" href="../../d9/dd2/group__net.html#gaaa9dbf6c20e7f07dfe6fc3746f6183e2">m0_net_tm_state</a> state)</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;{</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d2/d80/structm0__net__end__point.html">m0_net_end_point</a> *listen;</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;<span class="comment">         * Find &quot;self&quot; end-point. Cannot use ma_src(), because</span></div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="comment">         * m0_net_transfer_mc::ntm_ep can be not yet or already not set.</span></div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        <span class="keywordflow">if</span> (state == <a class="code" href="../../d9/dd2/group__net.html#ggaaa9dbf6c20e7f07dfe6fc3746f6183e2abbe89cdedac94d27fe1eeb53c4a82ffe">M0_NET_TM_STARTED</a>) {</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                listen = <a class="code" href="../../d7/d08/group__tlist.html#ga7b79fdd8d7679c6a9255581f90afd016">m0_tl_find</a>(m0_nep, ne, &amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#a4d20259926d66ad4922f26d196260c97">ntm_end_points</a>,</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                    <a class="code" href="../../d7/d08/group__tlist.html#gaff792c7170b8ef517d40f1a37eb5340d">m0_tl_exists</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <a class="code" href="../../dd/d74/structsock.html">sock</a>, &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga7d9e1d49b40b58dcb0d60a64aa70c4aa">ep_net</a>(ne)-&gt;e_sock,</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                                 <a class="code" href="../../dd/d74/structsock.html">sock</a>-&gt;<a class="code" href="../../dd/d74/structsock.html#a5766c3b04a967df4143cd23bff6f83e5">s_sm</a>.<a class="code" href="../../db/d49/structm0__sm.html#a15f271ddbf3fecd39f2711f07f40b76e">sm_state</a> == <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbae1999ab5c5b6740876a5e8ed025260aa">S_LISTENING</a>));</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(listen != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;        } <span class="keywordflow">else</span></div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                listen = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;        <a class="code" href="../../d9/dd2/group__net.html#gaf4918bd635674075138b44a33c9044ef">m0_net_tm_event_post</a>(&amp;(<span class="keyword">struct</span> <a class="code" href="../../d3/d91/structm0__net__tm__event.html">m0_net_tm_event</a>) {</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                        .nte_type       = <a class="code" href="../../d9/dd2/group__net.html#ggaec9cfded6bc6b9349030aaa4567ba007adc299d95655914620169514c19683107">M0_NET_TEV_STATE_CHANGE</a>,</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                        .nte_next_state = state,</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                        .nte_time       = <a class="code" href="../../d9/d7d/group__time.html#ga793cbf6341b841b090d83d0dea2993fa">m0_time_now</a>(),</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                        .nte_ep         = listen,</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                        .nte_tm         = <a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>,</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        });</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;}</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;</div><div class="line"><a name="l01656"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga87fceeb0675eca3bdc635f0be855673f"> 1656</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga87fceeb0675eca3bdc635f0be855673f">ma_buf_timeout</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>)</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;{</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a> = <a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        <span class="keywordtype">int</span>                        <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>;</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;        <a class="code" href="../../d9/d7d/group__time.html#ga3e0d20573b53285374bbd0c65a7a42eb">m0_time_t</a>                  now = <a class="code" href="../../d9/d7d/group__time.html#ga793cbf6341b841b090d83d0dea2993fa">m0_time_now</a>();</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>));</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> = 0; <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> &lt; <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a>(<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>-&gt;ntm_q); ++<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>) {</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                <span class="keyword">struct </span><a class="code" href="../../d9/d7e/structm0__net__buffer.html">m0_net_buffer</a> *nb;</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                <a class="code" href="../../d7/d08/group__tlist.html#ga6c73104b68112bed660165c64164fadf">m0_tl_for</a>(m0_net_tm, &amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#a142b6d767fee3f0ae250a85a0e6f968a">ntm_q</a>[<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>], nb) {</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                        <span class="keywordflow">if</span> (nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a497bfb73d57da600b22403a389003815">nb_timeout</a> &lt; now) {</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                                nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a812faa986d50d32e318c06cc330cf195">nb_flags</a> |= <a class="code" href="../../d9/dd2/group__net.html#gga1936206a7485cc1c14e35c6e0d348a38addfdd273e0a3eeb2f63aded3cea7e61d">M0_NET_BUF_TIMED_OUT</a>;</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                                <a class="code" href="../../d5/d16/group__netsock.html#ga901a7c7ecafb57cbf6885b57b9272e34">buf_done</a>(nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a01eabeb5b66a8de67b2a7514563e1893">nb_xprt_private</a>, -ETIMEDOUT);</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                        }</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;                } <a class="code" href="../../d7/d08/group__tlist.html#gaef8bbd93c23f12be0bfbb16ced9ad206">m0_tl_endfor</a>;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;        }</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#aea86d55595126b703b9e619887f09a22">M0_POST</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>));</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;}</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;</div><div class="line"><a name="l01683"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga87f26fc0b5e6e27c0130d1c1bd877ff8"> 1683</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga87f26fc0b5e6e27c0130d1c1bd877ff8">ma_buf_done</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>)</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;{</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d9/dd0/structbuf.html">buf</a> *<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a4b9218d5c001301e593c59b2f36f9d17">buf</a>;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        <span class="keywordtype">int</span>         <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a> = 0;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gaea9acfa0baa7ea23380d77247e9894d6">ma_is_locked</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>) &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>));</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        <a class="code" href="../../d7/d08/group__tlist.html#ga6c73104b68112bed660165c64164fadf">m0_tl_for</a>(b, &amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ac99334eddbdd3038853049e49ba745dd">t_done</a>, <a class="code" href="../../d9/dd0/structbuf.html">buf</a>) {</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                b_tlist_del(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>);</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#gaad5bbb2a3b9939c8f2b9ee3cdb43849a">buf_complete</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>);</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;                <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a>++;</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        } <a class="code" href="../../d7/d08/group__tlist.html#gaef8bbd93c23f12be0bfbb16ced9ad206">m0_tl_endfor</a>;</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a> &gt; 0 &amp;&amp; <a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#ac25a898a8ec2a7d4876cdd9ee7e5a19d">ntm_callback_counter</a> == 0)</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;                <a class="code" href="../../df/da0/group__chan.html#gad1968f64b50443b0c89881a2471321da">m0_chan_broadcast</a>(&amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#a2754c804d4265d5dd78c6ea474b2becb">ntm_chan</a>);</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#aea86d55595126b703b9e619887f09a22">M0_POST</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>));</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;}</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;</div><div class="line"><a name="l01703"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga2ef026fece207711f7b686f95bc6e4ff"> 1703</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d9/dd0/structbuf.html">buf</a> *<a class="code" href="../../d5/d16/group__netsock.html#ga2ef026fece207711f7b686f95bc6e4ff">ma_recv_buf</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>, <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> len)</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;{</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d9/d7e/structm0__net__buffer.html">m0_net_buffer</a> *nb;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        nb = <a class="code" href="../../d7/d08/group__tlist.html#ga7b79fdd8d7679c6a9255581f90afd016">m0_tl_find</a>(m0_net_tm, nb, &amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#a142b6d767fee3f0ae250a85a0e6f968a">ntm_q</a>[<a class="code" href="../../d9/dd2/group__net.html#gga4a25e727e622f7aaaedfe8ffa01fa005aa95a74f1b59dffb048013e381c4f6733">M0_NET_QT_MSG_RECV</a>],({</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                        struct buf *b = nb-&gt;nb_xprt_private;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                        b-&gt;b_done.b_words == NULL &amp;&amp;</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                        m0_vec_count(&amp;nb-&gt;nb_buffer.ov_vec) &gt;= len;</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;              }));</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        <span class="keywordflow">return</span> nb != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ? nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a01eabeb5b66a8de67b2a7514563e1893">nb_xprt_private</a> : <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;}</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;</div><div class="line"><a name="l01716"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaab89d3e82371dfcccd5807a8762c2baa"> 1716</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../d5/d16/group__netsock.html#gaab89d3e82371dfcccd5807a8762c2baa">ma_src</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>)</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;{</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#ga7d9e1d49b40b58dcb0d60a64aa70c4aa">ep_net</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#adaf6dbd711e031c0a236d31364f63d1e">ntm_ep</a>);</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;}</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;</div><div class="line"><a name="l01728"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga7d7e64eb8e44b6ffc187727ae565f1c4"> 1728</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga7d7e64eb8e44b6ffc187727ae565f1c4">end_point_create</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d80/structm0__net__end__point.html">m0_net_end_point</a> **epp,</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                            <span class="keyword">struct</span> <a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>,</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>)</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;{</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../d4/de8/sw_8h.html#a2f37eff18c7fc0bdbe63c3e2020932ed">ep</a>;</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a> = <a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>-&gt;ntm_xprt_private;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        <span class="keywordtype">int</span>        result;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gaea9acfa0baa7ea23380d77247e9894d6">ma_is_locked</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>) &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>));</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;        result = <a class="code" href="../../d5/d16/group__netsock.html#ga27438def5d2ab354391ff1e2bd182c61">ep_find</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>, <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>, &amp;<a class="code" href="../../da/da7/structep.html">ep</a>);</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;        *epp = result == 0 ? &amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a3851e3d045cfdff109ee4c7c69b1e9b8">e_ep</a> : <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a9a02a790ad457506f9f3bc12121e6079">M0_RC</a>(result);</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;}</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;</div><div class="line"><a name="l01749"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga57bdbf76bd38811d51a9e332f2e9aea0"> 1749</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga57bdbf76bd38811d51a9e332f2e9aea0">buf_register</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d7e/structm0__net__buffer.html">m0_net_buffer</a> *nb)</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;{</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d9/dd0/structbuf.html">buf</a> *b;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;        <a class="code" href="../../d7/ded/group__memory.html#ga2dd26426583fa272fa2061075e2dcf57">M0_ALLOC_PTR</a>(b);</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;        <span class="keywordflow">if</span> (b != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;                nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a01eabeb5b66a8de67b2a7514563e1893">nb_xprt_private</a> = b;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;                b-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a11ed429feb7ad22be45284e8055fe465">b_buf</a> = nb;</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                b_tlink_init(b);</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a9a02a790ad457506f9f3bc12121e6079">M0_RC</a>(0);</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        } <span class="keywordflow">else</span></div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-ENOMEM);</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;}</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;</div><div class="line"><a name="l01770"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaa35d272e8d4f283958b86460800e24cd"> 1770</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gaa35d272e8d4f283958b86460800e24cd">buf_deregister</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d7e/structm0__net__buffer.html">m0_net_buffer</a> *nb)</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;{</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d9/dd0/structbuf.html">buf</a> *<a class="code" href="../../d9/dd0/structbuf.html">buf</a> = nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a01eabeb5b66a8de67b2a7514563e1893">nb_xprt_private</a>;</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a812faa986d50d32e318c06cc330cf195">nb_flags</a> == <a class="code" href="../../d9/dd2/group__net.html#gga1936206a7485cc1c14e35c6e0d348a38aedcce3f60d38c656f02ff5e483e147bc">M0_NET_BUF_REGISTERED</a> &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#gaca062f63e8a27154bb6e046504692bc9">buf_invariant</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>));</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga31831f32963572f54a3bc7d9fbe848cc">buf_fini</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>);</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;        <a class="code" href="../../d7/ded/group__memory.html#ga0b8533a3024754008602759e71337eb3">m0_free</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>);</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a01eabeb5b66a8de67b2a7514563e1893">nb_xprt_private</a> = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;}</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;</div><div class="line"><a name="l01787"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga9cdacdb6229f7becd262087bcefc9715"> 1787</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga9cdacdb6229f7becd262087bcefc9715">buf_add</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d7e/structm0__net__buffer.html">m0_net_buffer</a> *nb)</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;{</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d9/dd0/structbuf.html">buf</a>   *<a class="code" href="../../d9/dd0/structbuf.html">buf</a>  = nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a01eabeb5b66a8de67b2a7514563e1893">nb_xprt_private</a>;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d8/dee/structma.html">ma</a>    *<a class="code" href="../../d8/dee/structma.html">ma</a>   = <a class="code" href="../../d5/d16/group__netsock.html#gafea137fe2248694702f66bd158c45022">buf_ma</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>);</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d1/d99/structmover.html">mover</a> *w    = &amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#ae21aab4029adf5ae3070f4379195d157">b_writer</a>;</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d5/d0e/structbdesc.html">bdesc</a> *peer = &amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#aebfa795c2499f9ffbb7391dbfc94981e">b_peer</a>;</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;        <span class="keywordtype">int</span>           <a class="code" href="../../dd/dc1/structqt.html">qt</a>   = nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#afacc91b5275a95609cdf10a1568f9a19">nb_qtype</a>;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;        <span class="keywordtype">int</span>           result;</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;        <span class="comment">//printf(&quot;add: %p[%i]\n&quot;, buf, qt);</span></div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gaea9acfa0baa7ea23380d77247e9894d6">ma_is_locked</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>) &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>) &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#gaca062f63e8a27154bb6e046504692bc9">buf_invariant</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>));</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;        <span class="comment">/* Next 2 asserts are from nlx_xo_buf_add(). */</span></div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a82a78a85f6bfa614dfad3da5ad714dd0">nb_offset</a> == 0); <span class="comment">/* Do not support an offset during add. */</span></div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>((nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a812faa986d50d32e318c06cc330cf195">nb_flags</a> &amp; <a class="code" href="../../d9/dd2/group__net.html#gga1936206a7485cc1c14e35c6e0d348a38a83ca4bce210bde991f2794ea9d5e54e8">M0_NET_BUF_RETAIN</a>) == 0);</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;        <span class="keywordflow">if</span> (M0_IN(<a class="code" href="../../dd/dc1/structqt.html">qt</a>, (<a class="code" href="../../d9/dd2/group__net.html#gga4a25e727e622f7aaaedfe8ffa01fa005a6d67ad80a2bedad4348a39bc2282cd1c">M0_NET_QT_MSG_SEND</a>, <a class="code" href="../../d9/dd2/group__net.html#gga4a25e727e622f7aaaedfe8ffa01fa005a1f1b9d40dde28be93c6787f597ebaa2d">M0_NET_QT_ACTIVE_BULK_SEND</a>)))</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#ga429999edeace62099ef3af8bd784d97d">mover_init</a>(w, <a class="code" href="../../d8/dee/structma.html">ma</a>, &amp;<a class="code" href="../../d5/d16/group__netsock.html#gaaea8f9114f06faf1285bfd1bd5c6da3b">writer_op</a>);</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../dd/dc1/structqt.html">qt</a> == <a class="code" href="../../d9/dd2/group__net.html#gga4a25e727e622f7aaaedfe8ffa01fa005ae7cb093e47fc16794e9639d47a19a300">M0_NET_QT_ACTIVE_BULK_RECV</a>)</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#ga429999edeace62099ef3af8bd784d97d">mover_init</a>(w, <a class="code" href="../../d8/dee/structma.html">ma</a>, &amp;<a class="code" href="../../d5/d16/group__netsock.html#gaa3f97a589c8ebf7495ac65e2efd70f67">get_op</a>);</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        w-&gt;<a class="code" href="../../d1/d99/structmover.html#a009dde470277f894204e183285891cca">m_buf</a> = <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a4b9218d5c001301e593c59b2f36f9d17">buf</a>;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="../../dd/dc1/structqt.html">qt</a>) {</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d9/dd2/group__net.html#gga4a25e727e622f7aaaedfe8ffa01fa005aa95a74f1b59dffb048013e381c4f6733">M0_NET_QT_MSG_RECV</a>:</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;                result = 0;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d9/dd2/group__net.html#gga4a25e727e622f7aaaedfe8ffa01fa005a6d67ad80a2bedad4348a39bc2282cd1c">M0_NET_QT_MSG_SEND</a>: {</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;                <span class="keyword">struct </span><a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a> = <a class="code" href="../../d5/d16/group__netsock.html#ga7d9e1d49b40b58dcb0d60a64aa70c4aa">ep_net</a>(nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a43fdc44f1f8f5d5e0be28c07e054160a">nb_ep</a>);</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;                <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a719f71a97b21a0b81358f883d3c5c2cf">nb_length</a> &lt;= <a class="code" href="../../d0/d7f/group__vec.html#ga9c79d9e7b339acaf8b46ac0a813f064d">m0_vec_count</a>(&amp;nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a19d709b59dd6fd480b660cbe8217b0b2">nb_buffer</a>.<a class="code" href="../../da/d2c/structm0__bufvec.html#ad790ff2243358efb3defea0a266a4503">ov_vec</a>));</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;                peer-&gt;<a class="code" href="../../d5/d0e/structbdesc.html#a3c935369999fdd23bd11054c19df4703">bd_addr</a> = <a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a7fa38028a1ed8e0d494fc3d2f179a890">e_a</a>;</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;                result = <a class="code" href="../../d5/d16/group__netsock.html#ga45a84b5062bc213795304baca5b13f74">ep_add</a>(<a class="code" href="../../da/da7/structep.html">ep</a>, w);</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;        }</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d9/dd2/group__net.html#gga4a25e727e622f7aaaedfe8ffa01fa005a333d129741296b1e7280906adb4b097e">M0_NET_QT_PASSIVE_BULK_RECV</a>: <span class="comment">/* For passive buffers, generate */</span></div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d9/dd2/group__net.html#gga4a25e727e622f7aaaedfe8ffa01fa005a17e109851881bbe14310ace19d6335d1">M0_NET_QT_PASSIVE_BULK_SEND</a>: <span class="comment">/* the buffer descriptor. */</span></div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;                <a class="code" href="../../da/dd3/group__cookie.html#ga70e6219c7f5302e50b667d2d614f0e1f">m0_cookie_new</a>(&amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a29fb49838c5d9685aa56e9c32c0dab54">b_cookie</a>);</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                result = <a class="code" href="../../d5/d16/group__netsock.html#gac04519716eaedbe76c2c3cc947eff2f6">bdesc_create</a>(&amp;<a class="code" href="../../d5/d16/group__netsock.html#gaab89d3e82371dfcccd5807a8762c2baa">ma_src</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>)-&gt;<a class="code" href="../../da/da7/structep.html#a7fa38028a1ed8e0d494fc3d2f179a890">e_a</a>, <a class="code" href="../../d9/dd0/structbuf.html">buf</a>, &amp;nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a237f51e9559c38a64897ddfc5620ee73">nb_desc</a>);</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d9/dd2/group__net.html#gga4a25e727e622f7aaaedfe8ffa01fa005ae7cb093e47fc16794e9639d47a19a300">M0_NET_QT_ACTIVE_BULK_RECV</a>: <span class="comment">/* For active buffers, decode the */</span></div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d9/dd2/group__net.html#gga4a25e727e622f7aaaedfe8ffa01fa005a1f1b9d40dde28be93c6787f597ebaa2d">M0_NET_QT_ACTIVE_BULK_SEND</a>: <span class="comment">/* passive buffer descriptor. */</span></div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                result = <a class="code" href="../../d5/d16/group__netsock.html#ga765e88256787793065e7620d01449d4d">bdesc_decode</a>(&amp;nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a237f51e9559c38a64897ddfc5620ee73">nb_desc</a>, peer);</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;                <span class="keywordflow">if</span> (result == 0) {</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                        <span class="keyword">struct </span><a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../d4/de8/sw_8h.html#a2f37eff18c7fc0bdbe63c3e2020932ed">ep</a>; <span class="comment">/* Passive peer end-point. */</span></div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                        result = <a class="code" href="../../d5/d16/group__netsock.html#ga87fd9494dc7688b4f4cddb2bc5bfbaaa">ep_create</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>, &amp;peer-&gt;<a class="code" href="../../d5/d0e/structbdesc.html#a3c935369999fdd23bd11054c19df4703">bd_addr</a>, <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;<a class="code" href="../../da/da7/structep.html">ep</a>);</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;                        <span class="keywordflow">if</span> (result == 0) {</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                                result = <a class="code" href="../../d5/d16/group__netsock.html#ga45a84b5062bc213795304baca5b13f74">ep_add</a>(<a class="code" href="../../da/da7/structep.html">ep</a>, w);</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                                <a class="code" href="../../d5/d16/group__netsock.html#ga2ca93efdb493d25d0eabb1d9722070c0">EP_PUT</a>(<a class="code" href="../../da/da7/structep.html">ep</a>, find);</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                        }</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                }</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                <a class="code" href="../../dc/da7/assert_8h.html#a3c39879398f6b8e4a2ed005fbf2e79c1">M0_IMPOSSIBLE</a>(<span class="stringliteral">&quot;invalid queue type: %x&quot;</span>, <a class="code" href="../../dd/dc1/structqt.html">qt</a>);</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;        }</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;        <span class="keywordflow">if</span> (result != 0)</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#ga023f04699c602a061ce4d4353e71c78a">mover_fini</a>(w);</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#aea86d55595126b703b9e619887f09a22">M0_POST</a>(<a class="code" href="../../d5/d16/group__netsock.html#gaea9acfa0baa7ea23380d77247e9894d6">ma_is_locked</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>) &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>) &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#gaca062f63e8a27154bb6e046504692bc9">buf_invariant</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>));</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga69dcfba03c6d43734c25d912a4f2288c">TLOG</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga275ae63e03470896123e2a44fbd06c1d">B_F</a>, <a class="code" href="../../d5/d16/group__netsock.html#ga1cd83a8f97b7d63bd601f3d1fe184d67">B_P</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>));</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a9a02a790ad457506f9f3bc12121e6079">M0_RC</a>(result);</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;}</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;</div><div class="line"><a name="l01853"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga53079337909bf84060a165ba7eb1fc5d"> 1853</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga53079337909bf84060a165ba7eb1fc5d">buf_del</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d7e/structm0__net__buffer.html">m0_net_buffer</a> *nb)</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;{</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d9/dd0/structbuf.html">buf</a> *<a class="code" href="../../d9/dd0/structbuf.html">buf</a> = nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a01eabeb5b66a8de67b2a7514563e1893">nb_xprt_private</a>;</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d8/dee/structma.html">ma</a>  *<a class="code" href="../../d8/dee/structma.html">ma</a>  = <a class="code" href="../../d5/d16/group__netsock.html#gafea137fe2248694702f66bd158c45022">buf_ma</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>);</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gaea9acfa0baa7ea23380d77247e9894d6">ma_is_locked</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>) &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>) &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#gaca062f63e8a27154bb6e046504692bc9">buf_invariant</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>));</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga69dcfba03c6d43734c25d912a4f2288c">TLOG</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga275ae63e03470896123e2a44fbd06c1d">B_F</a>, <a class="code" href="../../d5/d16/group__netsock.html#ga1cd83a8f97b7d63bd601f3d1fe184d67">B_P</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>));</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a812faa986d50d32e318c06cc330cf195">nb_flags</a> |= <a class="code" href="../../d9/dd2/group__net.html#gga1936206a7485cc1c14e35c6e0d348a38ae86d2cc38dc70add00f2614e05ff58f4">M0_NET_BUF_CANCELLED</a>;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga901a7c7ecafb57cbf6885b57b9272e34">buf_done</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>, -ECANCELED);</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;}</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;</div><div class="line"><a name="l01864"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga37e31a2f36872125309e4bcb50a89e33"> 1864</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga37e31a2f36872125309e4bcb50a89e33">bev_deliver_sync</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>)</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;{</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;}</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;</div><div class="line"><a name="l01869"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga08bbaf5a7ac6a88d11c356fc7bcd34ef"> 1869</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga08bbaf5a7ac6a88d11c356fc7bcd34ef">bev_deliver_all</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>)</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;{</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;}</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;</div><div class="line"><a name="l01873"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga88373be29952aeec9a2de84b52257efe"> 1873</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#ga88373be29952aeec9a2de84b52257efe">bev_pending</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>)</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;{</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;}</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;</div><div class="line"><a name="l01878"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gad87cb84510da3568b658ee9e4c9592d1"> 1878</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gad87cb84510da3568b658ee9e4c9592d1">bev_notify</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>, <span class="keyword">struct</span> <a class="code" href="../../d0/d12/structm0__chan.html">m0_chan</a> *<a class="code" href="../../d8/d57/rdwr__test__bench_8c.html#a75b25076e6274990c36afcf04b70a53c">chan</a>)</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;{</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;}</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;</div><div class="line"><a name="l01889"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga42954f73b21f92d35c9cc7cdafdf0cc6"> 1889</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d5/d16/group__netsock.html#ga42954f73b21f92d35c9cc7cdafdf0cc6">get_max_buffer_size</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../db/d78/structm0__net__domain.html">m0_net_domain</a> *<a class="code" href="../../dc/d74/addb2_2ut_2storage_8c.html#a6b9f7e6115c241d0a8ea3087490f1043">dom</a>)</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;{</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d16/group__netsock.html#ga204a3875802e9f8ff4b75db13dda46d3">MOCK_LNET</a>)</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;                <span class="keywordflow">return</span> 1024*1024;</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;                <span class="comment">/* There is no real limit. Return an arbitrary large number. */</span></div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d9/d49/types_8h.html#a18efc29f05f292310db38a8c7e81dcdaa83ee4dc69be6e419ad4b3a5c80f81b2a">M0_BCOUNT_MAX</a> / 2;</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;}</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;</div><div class="line"><a name="l01905"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gad243458e06517a7a34f083a6f226fb90"> 1905</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d5/d16/group__netsock.html#gad243458e06517a7a34f083a6f226fb90">get_max_buffer_segment_size</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../db/d78/structm0__net__domain.html">m0_net_domain</a> *<a class="code" href="../../dc/d74/addb2_2ut_2storage_8c.html#a6b9f7e6115c241d0a8ea3087490f1043">dom</a>)</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;{</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d16/group__netsock.html#ga204a3875802e9f8ff4b75db13dda46d3">MOCK_LNET</a>)</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;                <span class="keywordflow">return</span> 4096;</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;                <span class="comment">/* There is no real limit. Return an arbitrary large number. */</span></div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d9/d49/types_8h.html#a18efc29f05f292310db38a8c7e81dcdaa83ee4dc69be6e419ad4b3a5c80f81b2a">M0_BCOUNT_MAX</a> / 2;</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;}</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;</div><div class="line"><a name="l01921"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga95a9ed0a5357022173b96f24d664374d"> 1921</a></span>&#160;<span class="keyword">static</span> int32_t <a class="code" href="../../d5/d16/group__netsock.html#ga95a9ed0a5357022173b96f24d664374d">get_max_buffer_segments</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../db/d78/structm0__net__domain.html">m0_net_domain</a> *<a class="code" href="../../dc/d74/addb2_2ut_2storage_8c.html#a6b9f7e6115c241d0a8ea3087490f1043">dom</a>)</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;{</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d16/group__netsock.html#ga204a3875802e9f8ff4b75db13dda46d3">MOCK_LNET</a>)</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;                <span class="keywordflow">return</span> 512;</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;                <span class="comment">/* There is no real limit. Return an arbitrary large number. */</span></div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d2/de1/linux__kernel_2types_8h.html#a181807730d4a375f848ba139813ce04f">INT32_MAX</a> / 2; <span class="comment">/* Beat this, LNet! */</span></div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;}</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;</div><div class="line"><a name="l01937"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga06ffa7bbccaa76fcccf8f02aa9c785b6"> 1937</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d5/d16/group__netsock.html#ga06ffa7bbccaa76fcccf8f02aa9c785b6">get_max_buffer_desc_size</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../db/d78/structm0__net__domain.html">m0_net_domain</a> *<a class="code" href="../../dc/d74/addb2_2ut_2storage_8c.html#a6b9f7e6115c241d0a8ea3087490f1043">dom</a>)</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;{</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="../../d5/d0e/structbdesc.html">bdesc</a>);</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;}</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;</div><div class="line"><a name="l01942"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga02a03579ff3f069899aab4182f6540e7"> 1942</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d5/d16/group__netsock.html#ga02a03579ff3f069899aab4182f6540e7">get_rpc_max_seg_size</a>(<span class="keyword">struct</span> <a class="code" href="../../db/d78/structm0__net__domain.html">m0_net_domain</a> *ndom)</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;{</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d16/group__netsock.html#ga204a3875802e9f8ff4b75db13dda46d3">MOCK_LNET</a>)</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;                <span class="keywordflow">return</span> 4096;</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d9/dd2/group__net.html#gaee2caeb05b63fb6fa403ba4d38034443">default_xo_rpc_max_seg_size</a>(ndom);</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;}</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;</div><div class="line"><a name="l01950"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga65f17ccc7d00545d9f55335529fcc01c"> 1950</a></span>&#160;<span class="keyword">static</span> uint32_t <a class="code" href="../../d5/d16/group__netsock.html#ga65f17ccc7d00545d9f55335529fcc01c">get_rpc_max_segs_nr</a>(<span class="keyword">struct</span> <a class="code" href="../../db/d78/structm0__net__domain.html">m0_net_domain</a> *ndom)</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;{</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d16/group__netsock.html#ga204a3875802e9f8ff4b75db13dda46d3">MOCK_LNET</a>)</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;                <span class="keywordflow">return</span> 512;</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d9/dd2/group__net.html#ga93051c2ca6262088898f15dc82d4008d">default_xo_rpc_max_segs_nr</a>(ndom);</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;}</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;</div><div class="line"><a name="l01959"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaa05d2431e69de06adf149afa0903de7b"> 1959</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gaa05d2431e69de06adf149afa0903de7b">sock_in</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;{</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gadbe2464eb0dd92b5b19e5f2cfe21b715">sock_invariant</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>) &amp;&amp; <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_sm.sm_state == <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaa86daa3f2c345452a3235108d80ad8aa">S_OPEN</a>);</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga69dcfba03c6d43734c25d912a4f2288c">TLOG</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga0f4c6f587f5574e2334e62b7c6ce9551">SOCK_F</a>, <a class="code" href="../../d5/d16/group__netsock.html#ga87024d181bcdab57ece0bc28a5aaa0fd">SOCK_P</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>));</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;        <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_flags |= <a class="code" href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39a7418706169c4419c7ceb4553a8416673">HAS_READ</a>;</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#ga7b643699db61d5c148110d150136c16a">mover_op</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_reader, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca0cb0be5475011ea9319ce55b30e74634">M_READ</a>);</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;}</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;</div><div class="line"><a name="l01968"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gafe6b9b0c71898374d7d07b83666fae36"> 1968</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gafe6b9b0c71898374d7d07b83666fae36">sock_out</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;{</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d1/d99/structmover.html">mover</a> *w;</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;        <span class="keywordtype">int</span>           state;</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gadbe2464eb0dd92b5b19e5f2cfe21b715">sock_invariant</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>));</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga69dcfba03c6d43734c25d912a4f2288c">TLOG</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga0f4c6f587f5574e2334e62b7c6ce9551">SOCK_F</a>, <a class="code" href="../../d5/d16/group__netsock.html#ga87024d181bcdab57ece0bc28a5aaa0fd">SOCK_P</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>));</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_flags |= <a class="code" href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39afd7faf6c636cbc6f3d3cc0683c0584dc">HAS_WRITE</a>;</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;<span class="comment">         * @todo this can monopolise processor. Consider breaking out of this</span></div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<span class="comment">         * loop after some number of iterations.</span></div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;        <span class="keywordflow">while</span> ((<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_flags &amp; <a class="code" href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39afd7faf6c636cbc6f3d3cc0683c0584dc">HAS_WRITE</a>) &amp;&amp;</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;               (w = m_tlist_head(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_ep-&gt;e_writer)) != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;                state = <a class="code" href="../../d5/d16/group__netsock.html#ga7b643699db61d5c148110d150136c16a">mover_op</a>(w, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca7af369c035a45a9babde5a9443b5ef01">M_WRITE</a>);</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;                <span class="keywordflow">if</span> (state != <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a1bd27bf23812341749c87673d015d3ac">R_DONE</a> &amp;&amp; w-&gt;<a class="code" href="../../d1/d99/structmover.html#a1ae1f926434f6a0fa9ce813927773bff">m_sock</a> != <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;                        m_tlist_move_tail(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_ep-&gt;e_writer, w);</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        }</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;}</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;</div><div class="line"><a name="l01989"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaae7a60c600aecff6e08ebb32cf387475"> 1989</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gaae7a60c600aecff6e08ebb32cf387475">sock_close</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;{</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gadbe2464eb0dd92b5b19e5f2cfe21b715">sock_invariant</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>));</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga69dcfba03c6d43734c25d912a4f2288c">TLOG</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga0f4c6f587f5574e2334e62b7c6ce9551">SOCK_F</a>, <a class="code" href="../../d5/d16/group__netsock.html#ga87024d181bcdab57ece0bc28a5aaa0fd">SOCK_P</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>));</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga7b643699db61d5c148110d150136c16a">mover_op</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_reader, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca207d824841acf342e7184b3d3fc5996b">M_CLOSE</a>);</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d16/group__netsock.html#ga2482df25ee4d73a2fcdfe64fdadd7079">sock_writer</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>) != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#ga7b643699db61d5c148110d150136c16a">mover_op</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga2482df25ee4d73a2fcdfe64fdadd7079">sock_writer</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>), <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca207d824841acf342e7184b3d3fc5996b">M_CLOSE</a>);</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;}</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;</div><div class="line"><a name="l01999"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga2482df25ee4d73a2fcdfe64fdadd7079"> 1999</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d5/d16/group__netsock.html#ga2482df25ee4d73a2fcdfe64fdadd7079">sock_writer</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;{</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d1/d99/structmover.html">mover</a> *w = m_tlist_head(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_ep-&gt;e_writer);</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;        <span class="keywordflow">return</span> w != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; w-&gt;<a class="code" href="../../d1/d99/structmover.html#a1ae1f926434f6a0fa9ce813927773bff">m_sock</a> == <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a> ? w : <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;}</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;</div><div class="line"><a name="l02011"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga47e5eb47dbd6e7dcaac7b58e6fc7e5b1"> 2011</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga47e5eb47dbd6e7dcaac7b58e6fc7e5b1">sock_fini</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;{</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a> = <a class="code" href="../../d5/d16/group__netsock.html#ga78251ee15fee7c0c5da7f01379891e47">ep_ma</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_ep);</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gaea9acfa0baa7ea23380d77247e9894d6">ma_is_locked</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>));</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_ep != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_reader.m_sm.sm_conf == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_sm.sm_conf != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_sm.sm_state == <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba57451d0f52d3a8d7604c40753f7dd109">S_DELETED</a>);</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(s_tlist_contains(&amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a628f89b20b4000abc13078fc9ccf2354">t_deathrow</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>));</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga69dcfba03c6d43734c25d912a4f2288c">TLOG</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga0f4c6f587f5574e2334e62b7c6ce9551">SOCK_F</a>, <a class="code" href="../../d5/d16/group__netsock.html#ga87024d181bcdab57ece0bc28a5aaa0fd">SOCK_P</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>));</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga2ca93efdb493d25d0eabb1d9722070c0">EP_PUT</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_ep, <a class="code" href="../../dd/d74/structsock.html">sock</a>);</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;        <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_ep = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;        <a class="code" href="../../d1/dc1/group__sm.html#ga22cf05c6937b3cea98367c6c8fc85600">m0_sm_fini</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_sm);</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;        s_tlink_del_fini(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;        <a class="code" href="../../d7/ded/group__memory.html#ga0b8533a3024754008602759e71337eb3">m0_free</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;}</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;</div><div class="line"><a name="l02035"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga85d8da4dc83ae2334a7422a46b355949"> 2035</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga85d8da4dc83ae2334a7422a46b355949">sock_done</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <span class="keywordtype">bool</span> balance)</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;{</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a> = <a class="code" href="../../d5/d16/group__netsock.html#ga78251ee15fee7c0c5da7f01379891e47">ep_ma</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_ep);</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gaea9acfa0baa7ea23380d77247e9894d6">ma_is_locked</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>));</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_ep != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_reader.m_sm.sm_conf != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_sm.sm_conf != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gadbe2464eb0dd92b5b19e5f2cfe21b715">sock_invariant</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>));</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga69dcfba03c6d43734c25d912a4f2288c">TLOG</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga0f4c6f587f5574e2334e62b7c6ce9551">SOCK_F</a>, <a class="code" href="../../d5/d16/group__netsock.html#ga87024d181bcdab57ece0bc28a5aaa0fd">SOCK_P</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>));</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;        <span class="comment">/* This function can be called multiple times, should be idempotent. */</span></div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_fd &gt; 0)</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#gaae7a60c600aecff6e08ebb32cf387475">sock_close</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_sm.sm_state != <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba57451d0f52d3a8d7604c40753f7dd109">S_DELETED</a>) { <span class="comment">/* sock_close() might finalise. */</span></div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#ga023f04699c602a061ce4d4353e71c78a">mover_fini</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_reader);</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;                <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga2482df25ee4d73a2fcdfe64fdadd7079">sock_writer</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>) == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_fd &gt; 0) {</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                        <span class="keywordtype">int</span> result = <a class="code" href="../../d5/d16/group__netsock.html#gadc31941bba50c68b4c51483468b7acd4">sock_ctl</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, EPOLL_CTL_DEL, 0);</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;                        <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(<a class="code" href="../../df/d2a/lib_2misc_8h.html#a7f75ab6839d468f4d23480a9c65724c5">ergo</a>(result != 0, errno == ENOENT));</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;                        shutdown(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_fd, SHUT_RDWR);</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;                        close(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_fd);</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;                        <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_fd = -1;</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;                }</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;                <a class="code" href="../../d1/dc1/group__sm.html#ga44ae6c237c23107f3a9c5b9202582416">m0_sm_state_set</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_sm, <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba57451d0f52d3a8d7604c40753f7dd109">S_DELETED</a>);</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;                s_tlist_move(&amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a628f89b20b4000abc13078fc9ccf2354">t_deathrow</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                <span class="keywordflow">if</span> (balance)</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;                        (void)<a class="code" href="../../d5/d16/group__netsock.html#ga98d09139fd60f6dd4f1200e42646b498">ep_balance</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_ep);</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;        }</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;}</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;</div><div class="line"><a name="l02079"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga3e46e3a9fe0688a77c21473c9b1a3dde"> 2079</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga3e46e3a9fe0688a77c21473c9b1a3dde">sock_init</a>(<span class="keywordtype">int</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a>, <span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../df/ded/ut_2fd_8c.html#aac62f57bd247b8b9b145f09eef0e6e09">src</a>, <span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../df/ded/ut_2fd_8c.html#a71c20dda6f28285e2e67284efccaf3dc">tgt</a>, uint32_t <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a1e4cb2455f92782546a91bf8b5953aca">flags</a>)</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;{</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d8/dee/structma.html">ma</a>   *<a class="code" href="../../d8/dee/structma.html">ma</a> = <a class="code" href="../../d5/d16/group__netsock.html#ga78251ee15fee7c0c5da7f01379891e47">ep_ma</a>(<a class="code" href="../../df/ded/ut_2fd_8c.html#aac62f57bd247b8b9b145f09eef0e6e09">src</a>);</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../da/da7/structep.html">ep</a>   *<a class="code" href="../../da/da7/structep.html">ep</a> = <a class="code" href="../../df/ded/ut_2fd_8c.html#a71c20dda6f28285e2e67284efccaf3dc">tgt</a> ?: <a class="code" href="../../df/ded/ut_2fd_8c.html#aac62f57bd247b8b9b145f09eef0e6e09">src</a>;</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>;</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;        <span class="keywordtype">int</span>          result;</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        <span class="keywordtype">int</span>          state = <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaabb033d58518dadd28210bc74bef6051">S_INIT</a>;</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gaea9acfa0baa7ea23380d77247e9894d6">ma_is_locked</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>));</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>((<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a1e4cb2455f92782546a91bf8b5953aca">flags</a> &amp; ~(EPOLLOUT|EPOLLET)) == 0);</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../df/ded/ut_2fd_8c.html#aac62f57bd247b8b9b145f09eef0e6e09">src</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(M0_IN(<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#adaf6dbd711e031c0a236d31364f63d1e">ntm_ep</a>, (<a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;<a class="code" href="../../df/ded/ut_2fd_8c.html#aac62f57bd247b8b9b145f09eef0e6e09">src</a>-&gt;e_ep)));</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../df/d2a/lib_2misc_8h.html#a7f75ab6839d468f4d23480a9c65724c5">ergo</a>(<a class="code" href="../../df/ded/ut_2fd_8c.html#a71c20dda6f28285e2e67284efccaf3dc">tgt</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/dee/structma.html">ma</a> == <a class="code" href="../../d5/d16/group__netsock.html#ga78251ee15fee7c0c5da7f01379891e47">ep_ma</a>(<a class="code" href="../../df/ded/ut_2fd_8c.html#a71c20dda6f28285e2e67284efccaf3dc">tgt</a>) &amp;&amp;</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                    <a class="code" href="../../df/ded/ut_2fd_8c.html#aac62f57bd247b8b9b145f09eef0e6e09">src</a>-&gt;e_a.a_family   == <a class="code" href="../../df/ded/ut_2fd_8c.html#a71c20dda6f28285e2e67284efccaf3dc">tgt</a>-&gt;e_a.a_family &amp;&amp;</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;                    <a class="code" href="../../df/ded/ut_2fd_8c.html#aac62f57bd247b8b9b145f09eef0e6e09">src</a>-&gt;e_a.a_socktype == <a class="code" href="../../df/ded/ut_2fd_8c.html#a71c20dda6f28285e2e67284efccaf3dc">tgt</a>-&gt;e_a.a_socktype &amp;&amp;</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                    <a class="code" href="../../df/ded/ut_2fd_8c.html#aac62f57bd247b8b9b145f09eef0e6e09">src</a>-&gt;e_a.a_protocol == <a class="code" href="../../df/ded/ut_2fd_8c.html#a71c20dda6f28285e2e67284efccaf3dc">tgt</a>-&gt;e_a.a_protocol));</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;        <a class="code" href="../../d7/ded/group__memory.html#ga2dd26426583fa272fa2061075e2dcf57">M0_ALLOC_PTR</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a> == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-ENOMEM);</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;        <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_ep = <a class="code" href="../../d4/de8/sw_8h.html#a2f37eff18c7fc0bdbe63c3e2020932ed">ep</a>;</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga7da4b8d0066b704056c040ddd9845aa7">EP_GET</a>(<a class="code" href="../../da/da7/structep.html">ep</a>, <a class="code" href="../../dd/d74/structsock.html">sock</a>);</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;        s_tlink_init_at(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, &amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#aa56814b0282f4d2f416fad8bda1da592">e_sock</a>);</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;        <a class="code" href="../../d1/dc1/group__sm.html#gada087b0429614bfb575369ff95deb31b">m0_sm_init</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_sm, &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga916c31c6b0bf58b1c49128b94079fff8">sock_conf</a>, state, &amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#a65dc683b82f708154ef6debc8b2a7629">ntm_group</a>);</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga429999edeace62099ef3af8bd784d97d">mover_init</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_reader, <a class="code" href="../../d8/dee/structma.html">ma</a>, <a class="code" href="../../d5/d16/group__netsock.html#ga2c304ecfc57668f0196522601f103071">stype</a>[<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a7fa38028a1ed8e0d494fc3d2f179a890">e_a</a>.<a class="code" href="../../d9/db9/structaddr.html#a5f0f751a9bdbdd75feadad5803d13285">a_socktype</a>].<a class="code" href="../../d7/d2a/structsocktype.html#a7694a7e62d9bb040c50f65a840633725">st_reader</a>);</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;        <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_reader.m_sock = <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>;</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;        result = <a class="code" href="../../d5/d16/group__netsock.html#ga906821f5f2486bc82055c4e23550f9b9">sock_init_fd</a>(<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <a class="code" href="../../df/ded/ut_2fd_8c.html#aac62f57bd247b8b9b145f09eef0e6e09">src</a>, <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a1e4cb2455f92782546a91bf8b5953aca">flags</a>);</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;        <span class="keywordflow">if</span> (result == 0) {</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a> &gt;= 0) {</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;                        state = <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaa86daa3f2c345452a3235108d80ad8aa">S_OPEN</a>;</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../df/ded/ut_2fd_8c.html#a71c20dda6f28285e2e67284efccaf3dc">tgt</a> == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;                        <span class="comment">/* Listening. */</span></div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a7fa38028a1ed8e0d494fc3d2f179a890">e_a</a>.<a class="code" href="../../d9/db9/structaddr.html#a5f0f751a9bdbdd75feadad5803d13285">a_socktype</a> == SOCK_STREAM)</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;                                result = listen(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_fd, 128);</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;                        <span class="keywordflow">if</span> (result == 0)</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;                                <span class="comment">/*</span></div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;<span class="comment">                                 * Will be readable on an incoming connection.</span></div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="comment">                                 */</span></div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;                                state = <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbae1999ab5c5b6740876a5e8ed025260aa">S_LISTENING</a>;</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;                                result = <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-errno);</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;                        <span class="comment">/* Connecting. */</span></div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a7fa38028a1ed8e0d494fc3d2f179a890">e_a</a>.<a class="code" href="../../d9/db9/structaddr.html#a5f0f751a9bdbdd75feadad5803d13285">a_socktype</a> == SOCK_STREAM) {</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;                                <span class="keyword">struct </span>sockaddr_storage sa = {};</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;                                <a class="code" href="../../d5/d16/group__netsock.html#ga0551d085ef008b4fac533739771a1eb7">addr_encode</a>(&amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a7fa38028a1ed8e0d494fc3d2f179a890">e_a</a>, (<span class="keywordtype">void</span> *)&amp;sa);</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;                                result = connect(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_fd,</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;                                                 (<span class="keywordtype">void</span> *)&amp;sa, <span class="keyword">sizeof</span> sa);</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;                        }</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;                        <span class="keywordflow">if</span> (result == 0) {</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;                                state = <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaa86daa3f2c345452a3235108d80ad8aa">S_OPEN</a>;</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;                        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (errno == EINPROGRESS) {</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;                                <span class="comment">/*</span></div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;<span class="comment">                                 * Will be writable on a successful connection,</span></div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;<span class="comment">                                 * will be writable and readable on a failure.</span></div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;<span class="comment">                                 */</span></div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;                                state = <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba9d8566da037aa1256e85c81f275b7805">S_CONNECTING</a>;</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;                                result = 0;</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;                        } <span class="keywordflow">else</span></div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;                                result = <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-errno);</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;                }</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;                <span class="keywordflow">if</span> (result == 0)</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;                        <a class="code" href="../../d1/dc1/group__sm.html#ga44ae6c237c23107f3a9c5b9202582416">m0_sm_state_set</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_sm, state);</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;        }</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;        <span class="keywordflow">if</span> (result != 0)</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#ga85d8da4dc83ae2334a7422a46b355949">sock_done</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#aea86d55595126b703b9e619887f09a22">M0_POST</a>(<a class="code" href="../../df/d2a/lib_2misc_8h.html#a7f75ab6839d468f4d23480a9c65724c5">ergo</a>(result == 0, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#gadbe2464eb0dd92b5b19e5f2cfe21b715">sock_invariant</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)));</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a9a02a790ad457506f9f3bc12121e6079">M0_RC</a>(result);</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;}</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;</div><div class="line"><a name="l02154"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga906821f5f2486bc82055c4e23550f9b9"> 2154</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga906821f5f2486bc82055c4e23550f9b9">sock_init_fd</a>(<span class="keywordtype">int</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a>, uint32_t <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a1e4cb2455f92782546a91bf8b5953aca">flags</a>)</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;{</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;        <span class="keywordtype">int</span> result = 0;</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a> &lt; 0) {</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                <span class="keywordtype">int</span> <a class="code" href="../../d2/d66/group__dtm.html#ga8b3ab54ed3e81c69863d65e4e6c424a0">flag</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a> = socket(<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a7fa38028a1ed8e0d494fc3d2f179a890">e_a</a>.<a class="code" href="../../d9/db9/structaddr.html#ad8ca990694d5e0a6cef86dd67ba2e6b7">a_family</a>,</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;                            <span class="comment">/* Linux: set NONBLOCK immediately. */</span></div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;                            <a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a7fa38028a1ed8e0d494fc3d2f179a890">e_a</a>.<a class="code" href="../../d9/db9/structaddr.html#a5f0f751a9bdbdd75feadad5803d13285">a_socktype</a> | SOCK_NONBLOCK,</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;                            <a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a7fa38028a1ed8e0d494fc3d2f179a890">e_a</a>.<a class="code" href="../../d9/db9/structaddr.html#a830ec069f03642982b29f2b596d3e133">a_protocol</a>);</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                <span class="comment">/*</span></div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;<span class="comment">                 * Perhaps set some other socket options here? SO_LINGER, etc.</span></div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;<span class="comment">                 */</span></div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a> &gt;= 0) {</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                        <span class="comment">/* EPOLLET means the socket is for listening. */</span></div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a1e4cb2455f92782546a91bf8b5953aca">flags</a> &amp; EPOLLET) {</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                                <span class="keyword">struct </span>sockaddr_storage sa = {};</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                                result = setsockopt(<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a>, SOL_SOCKET,</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;                                                    SO_REUSEADDR,</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;                                                    &amp;<a class="code" href="../../d2/d66/group__dtm.html#ga8b3ab54ed3e81c69863d65e4e6c424a0">flag</a>, <span class="keyword">sizeof</span> <a class="code" href="../../d2/d66/group__dtm.html#ga8b3ab54ed3e81c69863d65e4e6c424a0">flag</a>);</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;                                <span class="keywordflow">if</span> (result == 0) {</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;                                        <a class="code" href="../../d5/d16/group__netsock.html#ga0551d085ef008b4fac533739771a1eb7">addr_encode</a>(&amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a7fa38028a1ed8e0d494fc3d2f179a890">e_a</a>, (<span class="keywordtype">void</span> *)&amp;sa);</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;                                        result = bind(<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a>, (<span class="keywordtype">void</span> *)&amp;sa,</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;                                                      <span class="keyword">sizeof</span> sa);</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;                                } <span class="keywordflow">else</span></div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;                                        result = <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-errno);</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;                        } <span class="keywordflow">else</span></div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;                                result = 0;</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;                }</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;        }</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a> &gt;= 0 &amp;&amp; result == 0) {</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;                <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_fd = <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a>;</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;                result = <a class="code" href="../../d5/d16/group__netsock.html#gadc31941bba50c68b4c51483468b7acd4">sock_ctl</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, EPOLL_CTL_ADD, <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a1e4cb2455f92782546a91bf8b5953aca">flags</a> &amp; ~EPOLLET);</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        }</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;        <span class="keywordflow">if</span> (result != 0 || <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a> &lt; 0)</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;                result = <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-errno);</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a9a02a790ad457506f9f3bc12121e6079">M0_RC</a>(result);</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;}</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;</div><div class="line"><a name="l02201"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga41bd19654c4aa2b6f9cbfb78c32b953a"> 2201</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#ga41bd19654c4aa2b6f9cbfb78c32b953a">sock_event</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, uint32_t ev)</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;{</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;        <span class="keyword">enum</span> { EV_ERR = EPOLLRDHUP|EPOLLERR|EPOLLHUP };</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;        <span class="keyword">struct </span>sockaddr_storage sa = {};</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d9/db9/structaddr.html">addr</a>             <a class="code" href="../../d9/db9/structaddr.html">addr</a>;</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;        <span class="keywordtype">int</span>                     result;</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gadbe2464eb0dd92b5b19e5f2cfe21b715">sock_invariant</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>));</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;        <a class="code" href="../../d8/d98/group__trace.html#gabf13f904bc760a195c4e3b75fa471f58">M0_LOG</a>(<a class="code" href="../../d8/d98/group__trace.html#gga222dfe20eda8c002fbab0ebbb2a7848ba8d2169c7a189138ea53e05ce2c558d4f">M0_DEBUG</a>, <span class="stringliteral">&quot;State: %x, event: %x.&quot;</span>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_sm.sm_state, ev);</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga69dcfba03c6d43734c25d912a4f2288c">TLOG</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga0f4c6f587f5574e2334e62b7c6ce9551">SOCK_F</a><span class="stringliteral">&quot;: %x&quot;</span>, <a class="code" href="../../d5/d16/group__netsock.html#ga87024d181bcdab57ece0bc28a5aaa0fd">SOCK_P</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>), ev);</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_sm.sm_state) {</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaabb033d58518dadd28210bc74bef6051">S_INIT</a>:</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba57451d0f52d3a8d7604c40753f7dd109">S_DELETED</a>:</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;                <a class="code" href="../../dc/da7/assert_8h.html#a3c39879398f6b8e4a2ed005fbf2e79c1">M0_IMPOSSIBLE</a>(<span class="stringliteral">&quot;Wrong state: %x.&quot;</span>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_sm.sm_state);</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbae1999ab5c5b6740876a5e8ed025260aa">S_LISTENING</a>:</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;                <span class="keywordflow">if</span> (ev == EPOLLIN) { <span class="comment">/* A new incoming connection. */</span></div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;                        <span class="keywordtype">int</span>        <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a>;</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;                        socklen_t  socklen = <span class="keyword">sizeof</span> sa;</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;                        <span class="keyword">struct </span><a class="code" href="../../da/da7/structep.html">ep</a> *we = <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_ep;</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;                        <a class="code" href="../../d9/db9/structaddr.html">addr</a> = we-&gt;<a class="code" href="../../da/da7/structep.html#a7fa38028a1ed8e0d494fc3d2f179a890">e_a</a>; <span class="comment">/* Copy family, socktype, proto. */</span></div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;                        <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a> = accept4(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_fd,</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;                                     (<span class="keywordtype">void</span> *)&amp;sa, &amp;socklen, SOCK_NONBLOCK);</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a> &gt;= 0) {</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;                                <span class="keyword">struct </span><a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a> = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                                <a class="code" href="../../d5/d16/group__netsock.html#ga88e81fbd6443046da02ec3cb446fa705">addr_decode</a>(&amp;<a class="code" href="../../d9/db9/structaddr.html">addr</a>, (<span class="keywordtype">void</span> *)&amp;sa);</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;                                <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(<a class="code" href="../../d5/d16/group__netsock.html#gafe00935b90da1e6a5c7315945de225c4">addr_invariant</a>(&amp;<a class="code" href="../../d9/db9/structaddr.html">addr</a>));</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;                                result = <a class="code" href="../../d5/d16/group__netsock.html#ga87fd9494dc7688b4f4cddb2bc5bfbaaa">ep_create</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga78251ee15fee7c0c5da7f01379891e47">ep_ma</a>(we),</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;                                                   &amp;<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;<a class="code" href="../../da/da7/structep.html">ep</a>) ?:</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                                        <span class="comment">/*</span></div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;<span class="comment">                                         * Accept incoming connections</span></div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;<span class="comment">                                         * unconditionally. Alternatively, it</span></div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;<span class="comment">                                         * can be rejected by some admission</span></div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;<span class="comment">                                         * policy.</span></div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;<span class="comment">                                         */</span></div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;                                        <a class="code" href="../../d5/d16/group__netsock.html#ga3e46e3a9fe0688a77c21473c9b1a3dde">sock_init</a>(<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a>, we, <a class="code" href="../../da/da7/structep.html">ep</a>, 0);</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;                                <span class="keywordflow">if</span> (result != 0)</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                                        <span class="comment">/*</span></div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;<span class="comment">                                         * Maybe already closed in sock_init()</span></div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;<span class="comment">                                         * failure path, do not care.</span></div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;<span class="comment">                                         */</span></div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;                                        close(<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a>);</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="../../da/da7/structep.html">ep</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;                                        <a class="code" href="../../d5/d16/group__netsock.html#ga2ca93efdb493d25d0eabb1d9722070c0">EP_PUT</a>(<a class="code" href="../../da/da7/structep.html">ep</a>, find);</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;                        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (M0_IN(errno, (EWOULDBLOCK,  <span class="comment">/* BSD */</span></div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;                                                 ECONNABORTED, <span class="comment">/* POSIX */</span></div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;                                                 EPROTO)) ||   <span class="comment">/* SVR4 */</span></div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;                                   M0_IN(errno,</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;<span class="comment">         * Linux accept() (and accept4()) passes already-pending network errors</span></div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;<span class="comment">         * on the new socket as an error code from accept(). This behavior</span></div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;<span class="comment">         * differs from other BSD socket implementations. For reliable operation</span></div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;<span class="comment">         * the application should detect the network errors defined for the</span></div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;<span class="comment">         * protocol after accept() and treat them like EAGAIN by retrying.  In</span></div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;<span class="comment">         * the case of TCP/IP, these are... -- https://manpath.be/f14/2/accept4</span></div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                                                (ENETDOWN, EPROTO, ENOPROTOOPT,</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;                                                 EHOSTDOWN, ENONET,</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;                                                 EHOSTUNREACH, EOPNOTSUPP,</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;                                                 ENETUNREACH))) {</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;                                <a class="code" href="../../d8/d98/group__trace.html#gabf13f904bc760a195c4e3b75fa471f58">M0_LOG</a>(<a class="code" href="../../d8/d98/group__trace.html#gga222dfe20eda8c002fbab0ebbb2a7848ba8d2169c7a189138ea53e05ce2c558d4f">M0_DEBUG</a>, <span class="stringliteral">&quot;Got: %i.&quot;</span>, errno);</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;                                <a class="code" href="../../d8/d98/group__trace.html#gabf13f904bc760a195c4e3b75fa471f58">M0_LOG</a>(<a class="code" href="../../d8/d98/group__trace.html#gga222dfe20eda8c002fbab0ebbb2a7848baa28fc2108a650f33c5b984b7ce5e852b">M0_ERROR</a>, <span class="stringliteral">&quot;Got: %i.&quot;</span>, errno);</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;                        }</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;                } <span class="keywordflow">else</span></div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;                        <a class="code" href="../../d8/d98/group__trace.html#gabf13f904bc760a195c4e3b75fa471f58">M0_LOG</a>(<a class="code" href="../../d8/d98/group__trace.html#gga222dfe20eda8c002fbab0ebbb2a7848baa28fc2108a650f33c5b984b7ce5e852b">M0_ERROR</a>,</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;                               <span class="stringliteral">&quot;Unexpected event while listening: %x.&quot;</span>, ev);</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba9d8566da037aa1256e85c81f275b7805">S_CONNECTING</a>:</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;                <span class="keywordflow">if</span> ((ev &amp; (EPOLLOUT|EPOLLIN)) == EPOLLOUT) {</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;                        <span class="comment">/* Successful connection. */</span></div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;                        <a class="code" href="../../d1/dc1/group__sm.html#ga44ae6c237c23107f3a9c5b9202582416">m0_sm_state_set</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_sm, <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaa86daa3f2c345452a3235108d80ad8aa">S_OPEN</a>);</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((ev &amp; (EPOLLOUT|EPOLLIN)) == (EPOLLOUT|EPOLLIN)) {</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;                        <span class="comment">/* Failed connection. */</span></div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;                        <a class="code" href="../../d5/d16/group__netsock.html#ga85d8da4dc83ae2334a7422a46b355949">sock_done</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;                        <a class="code" href="../../d8/d98/group__trace.html#gabf13f904bc760a195c4e3b75fa471f58">M0_LOG</a>(<a class="code" href="../../d8/d98/group__trace.html#gga222dfe20eda8c002fbab0ebbb2a7848baa28fc2108a650f33c5b984b7ce5e852b">M0_ERROR</a>,</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;                               <span class="stringliteral">&quot;Unexpected event while connecting: %x.&quot;</span>, ev);</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                }</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaa86daa3f2c345452a3235108d80ad8aa">S_OPEN</a>:</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;                <span class="keywordflow">if</span> (ev &amp; EPOLLIN) {</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;                        <span class="comment">/* Ran out of buffer on the receive queue. */</span></div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d16/group__netsock.html#gaa05d2431e69de06adf149afa0903de7b">sock_in</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>) == -ENOBUFS)</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;                                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;                }</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_sm.sm_state == <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaa86daa3f2c345452a3235108d80ad8aa">S_OPEN</a> &amp;&amp; ev &amp; EPOLLOUT)</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                        <a class="code" href="../../d5/d16/group__netsock.html#gafe6b9b0c71898374d7d07b83666fae36">sock_out</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_sm.sm_state == <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaa86daa3f2c345452a3235108d80ad8aa">S_OPEN</a> &amp;&amp; ev &amp; EV_ERR)</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                        <a class="code" href="../../d5/d16/group__netsock.html#gaae7a60c600aecff6e08ebb32cf387475">sock_close</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;        }</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;        <span class="keywordflow">if</span> (ev &amp; ~(EPOLLIN|EPOLLOUT|EV_ERR))</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;                <a class="code" href="../../d8/d98/group__trace.html#gabf13f904bc760a195c4e3b75fa471f58">M0_LOG</a>(<a class="code" href="../../d8/d98/group__trace.html#gga222dfe20eda8c002fbab0ebbb2a7848baa28fc2108a650f33c5b984b7ce5e852b">M0_ERROR</a>, <span class="stringliteral">&quot;Unexpected event: %x.&quot;</span>, ev);</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;}</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;</div><div class="line"><a name="l02305"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gadc31941bba50c68b4c51483468b7acd4"> 2305</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gadc31941bba50c68b4c51483468b7acd4">sock_ctl</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <span class="keywordtype">int</span> <a class="code" href="../../d3/d1b/libdemo_8c.html#a99a30df0f2488360cdd46b4b88e5f5f0">op</a>, uint32_t <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a1e4cb2455f92782546a91bf8b5953aca">flags</a>)</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;{</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;        <span class="keywordtype">int</span> result;</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;        <span class="comment">/* Always monitor errors. */</span></div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;        <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a1e4cb2455f92782546a91bf8b5953aca">flags</a> |= EPOLLIN | EPOLLRDHUP | EPOLLERR | EPOLLHUP;</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;        result = epoll_ctl(<a class="code" href="../../d5/d16/group__netsock.html#ga78251ee15fee7c0c5da7f01379891e47">ep_ma</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_ep)-&gt;<a class="code" href="../../d8/dee/structma.html#a7fac31b01cd71bf3b8c7f6f4746adc1b">t_epollfd</a>, <a class="code" href="../../d3/d1b/libdemo_8c.html#a99a30df0f2488360cdd46b4b88e5f5f0">op</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_fd,</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;                           &amp;(<span class="keyword">struct</span> epoll_event){</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;                                   .events = flags,</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;                                   .data   = { .ptr = s }});</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;        <span class="keywordflow">if</span> (result == 0) {</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;                <span class="keywordflow">if</span> ((<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a1e4cb2455f92782546a91bf8b5953aca">flags</a> &amp; EPOLLOUT) != 0)</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;                        <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_flags |= <a class="code" href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39a5b03f1e8c060b7325973da921d99df5b">WRITE_POLL</a>;</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;                        <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_flags &amp;= ~<a class="code" href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39a5b03f1e8c060b7325973da921d99df5b">WRITE_POLL</a>;</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;        }</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;        <span class="keywordflow">return</span> result;</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;}</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;</div><div class="line"><a name="l02333"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga87fd9494dc7688b4f4cddb2bc5bfbaaa"> 2333</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga87fd9494dc7688b4f4cddb2bc5bfbaaa">ep_create</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>, <span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>,</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;                     <span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> **<a class="code" href="../../dd/d6d/group__xcode.html#ga50fe33eaae68b43814656f241a6ac907">out</a>)</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;{</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../da/da7/structep.html">ep</a>               *<a class="code" href="../../d4/de8/sw_8h.html#a2f37eff18c7fc0bdbe63c3e2020932ed">ep</a>;</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d2/d80/structm0__net__end__point.html">m0_net_end_point</a> *<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>;</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;        <span class="keywordtype">char</span>                    *cname;</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gaea9acfa0baa7ea23380d77247e9894d6">ma_is_locked</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>) &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#gafe00935b90da1e6a5c7315945de225c4">addr_invariant</a>(<a class="code" href="../../d9/db9/structaddr.html">addr</a>));</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;<span class="comment">         * @todo this is duplicated in every transport. Should be factored out</span></div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;<span class="comment">         * by exporting -&gt;xo_ep_eq() method.</span></div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;        <a class="code" href="../../d7/d08/group__tlist.html#ga6c73104b68112bed660165c64164fadf">m0_tl_for</a>(m0_nep, &amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#a4d20259926d66ad4922f26d196260c97">ntm_end_points</a>, <a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>) {</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;                <span class="keyword">struct </span><a class="code" href="../../da/da7/structep.html">ep</a> *xep = <a class="code" href="../../d5/d16/group__netsock.html#ga7d9e1d49b40b58dcb0d60a64aa70c4aa">ep_net</a>(<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>);</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d5/d16/group__netsock.html#ga6f158d48c8168947b0fef56f8bc52747">ep_eq</a>(xep, <a class="code" href="../../d9/db9/structaddr.html">addr</a>)) {</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;                        <a class="code" href="../../d5/d16/group__netsock.html#ga7da4b8d0066b704056c040ddd9845aa7">EP_GET</a>(xep, find);</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;                        *<a class="code" href="../../dd/d6d/group__xcode.html#ga50fe33eaae68b43814656f241a6ac907">out</a> = xep;</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a9a02a790ad457506f9f3bc12121e6079">M0_RC</a>(0);</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;                }</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;        } <a class="code" href="../../d7/d08/group__tlist.html#gaef8bbd93c23f12be0bfbb16ced9ad206">m0_tl_endfor</a>;</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;        cname = <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ? <a class="code" href="../../da/d66/string_8h.html#a2dc1ae82475e3a33c9e62abefd40fc73">m0_strdup</a>(<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>) : <a class="code" href="../../d5/d16/group__netsock.html#ga1346d46974aa7185fed3b07d84480295">addr_print</a>(<a class="code" href="../../d9/db9/structaddr.html">addr</a>);</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;        <a class="code" href="../../d7/ded/group__memory.html#ga2dd26426583fa272fa2061075e2dcf57">M0_ALLOC_PTR</a>(<a class="code" href="../../da/da7/structep.html">ep</a>);</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;        <span class="keywordflow">if</span> (cname == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="../../da/da7/structep.html">ep</a> == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;                <a class="code" href="../../d7/ded/group__memory.html#ga0b8533a3024754008602759e71337eb3">m0_free</a>(<a class="code" href="../../da/da7/structep.html">ep</a>);</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;                <a class="code" href="../../d7/ded/group__memory.html#ga0b8533a3024754008602759e71337eb3">m0_free</a>(cname);</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-ENOMEM);</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;        }</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;        <a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a> = &amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a3851e3d045cfdff109ee4c7c69b1e9b8">e_ep</a>;</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;        <a class="code" href="../../d4/de4/refs_8c.html#a5d62779a5f7a71f16a43727e524117e0">m0_ref_init</a>(&amp;<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>-&gt;nep_ref, 1, &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga5d22cfa334f2d6feb81248e6cd840562">ep_release</a>);</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;<span class="preprocessor">#ifdef EP_DEBUG</span></div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;        <a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#ad800a8d736e37f9934761bfe00b1d4cc">e_r_find</a> = 1;</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;        <a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>-&gt;nep_tm = <a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>;</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;        m0_nep_tlink_init_at_tail(<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>, &amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#a4d20259926d66ad4922f26d196260c97">ntm_end_points</a>);</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;        s_tlist_init(&amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#aa56814b0282f4d2f416fad8bda1da592">e_sock</a>);</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;        m_tlist_init(&amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#ac2bafd27a0e0c46e6cc7791b1a33ebcb">e_writer</a>);</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;        <a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>-&gt;nep_addr = cname;</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;        <a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a7fa38028a1ed8e0d494fc3d2f179a890">e_a</a> = *<a class="code" href="../../d6/dd4/node__k_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a>;</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;        *<a class="code" href="../../dd/d6d/group__xcode.html#ga50fe33eaae68b43814656f241a6ac907">out</a> = <a class="code" href="../../d4/de8/sw_8h.html#a2f37eff18c7fc0bdbe63c3e2020932ed">ep</a>;</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#aea86d55595126b703b9e619887f09a22">M0_POST</a>(*<a class="code" href="../../dd/d6d/group__xcode.html#ga50fe33eaae68b43814656f241a6ac907">out</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#gae9390c6a48f66a887e7e0929bd089c25">ep_invariant</a>(*<a class="code" href="../../dd/d6d/group__xcode.html#ga50fe33eaae68b43814656f241a6ac907">out</a>));</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#aea86d55595126b703b9e619887f09a22">M0_POST</a>(<a class="code" href="../../d5/d16/group__netsock.html#gaea9acfa0baa7ea23380d77247e9894d6">ma_is_locked</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>));</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga69dcfba03c6d43734c25d912a4f2288c">TLOG</a>(<a class="code" href="../../d5/d16/group__netsock.html#gab2d8ecc7d9da047c0d42124b1dfbc332">EP_FL</a>, <a class="code" href="../../d5/d16/group__netsock.html#ga7b11e10d73d8c362dcc9575556eae75a">EP_PL</a>(<a class="code" href="../../da/da7/structep.html">ep</a>));</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a9a02a790ad457506f9f3bc12121e6079">M0_RC</a>(0);</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;}</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;</div><div class="line"><a name="l02379"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga27438def5d2ab354391ff1e2bd182c61"> 2379</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga27438def5d2ab354391ff1e2bd182c61">ep_find</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>, <span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> **<a class="code" href="../../dd/d6d/group__xcode.html#ga50fe33eaae68b43814656f241a6ac907">out</a>)</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;{</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d9/db9/structaddr.html">addr</a> <a class="code" href="../../d9/db9/structaddr.html">addr</a> = {};</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#ga97fcfe2ab24d7ddf0d1a4e1d144cb94a">addr_resolve</a>(&amp;<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>) ?: <a class="code" href="../../d5/d16/group__netsock.html#ga87fd9494dc7688b4f4cddb2bc5bfbaaa">ep_create</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>, &amp;<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>, <a class="code" href="../../dd/d6d/group__xcode.html#ga50fe33eaae68b43814656f241a6ac907">out</a>);</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;}</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;</div><div class="line"><a name="l02387"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga78251ee15fee7c0c5da7f01379891e47"> 2387</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d5/d16/group__netsock.html#ga78251ee15fee7c0c5da7f01379891e47">ep_ma</a>(<span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a>)</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;{</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a3851e3d045cfdff109ee4c7c69b1e9b8">e_ep</a>.<a class="code" href="../../d2/d80/structm0__net__end__point.html#a37cfc5c61a742cc97c8013820988dfa2">nep_tm</a>-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#a8b18058969fa6fe0a12df59639accbe2">ntm_xprt_private</a>;</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;}</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;</div><div class="line"><a name="l02393"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga7d9e1d49b40b58dcb0d60a64aa70c4aa"> 2393</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../d5/d16/group__netsock.html#ga7d9e1d49b40b58dcb0d60a64aa70c4aa">ep_net</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d80/structm0__net__end__point.html">m0_net_end_point</a> *<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>)</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;{</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#af8c317a42292b61c93aae91e59118a46">container_of</a>(<a class="code" href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a>, <span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a>, <a class="code" href="../../da/da7/structep.html#a3851e3d045cfdff109ee4c7c69b1e9b8">e_ep</a>);</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;}</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;</div><div class="line"><a name="l02404"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga5d22cfa334f2d6feb81248e6cd840562"> 2404</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga5d22cfa334f2d6feb81248e6cd840562">ep_release</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d3f/structm0__ref.html">m0_ref</a> *ref)</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;{</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga12fee080a96fe0bee1c5bf5ccb564ac8">ep_free</a>(<a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#af8c317a42292b61c93aae91e59118a46">container_of</a>(ref, <span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a>, <a class="code" href="../../da/da7/structep.html#a3851e3d045cfdff109ee4c7c69b1e9b8">e_ep</a>.<a class="code" href="../../d2/d80/structm0__net__end__point.html#ac6f6a62f57f3af00ab1d86dfa5278f2c">nep_ref</a>));</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;}</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;</div><div class="line"><a name="l02414"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga45a84b5062bc213795304baca5b13f74"> 2414</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga45a84b5062bc213795304baca5b13f74">ep_add</a>(<span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a>, <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *w)</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;{</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gae9390c6a48f66a887e7e0929bd089c25">ep_invariant</a>(<a class="code" href="../../da/da7/structep.html">ep</a>));</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga4d04d2d80f14221e812b0d455d4639c9">mover_invariant</a>(w) &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#ga02f3f80057e9c21bfbdf4993dc6ba169">mover_is_writer</a>(w));</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(w-&gt;<a class="code" href="../../d1/d99/structmover.html#a212cefc7f5b7749302619a3c811bd7e7">m_ep</a> == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;        m_tlist_add_tail(&amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#ac2bafd27a0e0c46e6cc7791b1a33ebcb">e_writer</a>, w);</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga7da4b8d0066b704056c040ddd9845aa7">EP_GET</a>(<a class="code" href="../../da/da7/structep.html">ep</a>, <a class="code" href="../../d1/d99/structmover.html">mover</a>);</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;        w-&gt;<a class="code" href="../../d1/d99/structmover.html#a212cefc7f5b7749302619a3c811bd7e7">m_ep</a> = <a class="code" href="../../d4/de8/sw_8h.html#a2f37eff18c7fc0bdbe63c3e2020932ed">ep</a>;</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a9a02a790ad457506f9f3bc12121e6079">M0_RC</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga98d09139fd60f6dd4f1200e42646b498">ep_balance</a>(<a class="code" href="../../da/da7/structep.html">ep</a>));</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;}</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;</div><div class="line"><a name="l02431"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga29cb5f0cd1ec36cce44a8d9baa6a1746"> 2431</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga29cb5f0cd1ec36cce44a8d9baa6a1746">ep_del</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *w)</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;{</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a> = w-&gt;<a class="code" href="../../d1/d99/structmover.html#a212cefc7f5b7749302619a3c811bd7e7">m_ep</a>;</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../da/da7/structep.html">ep</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;                <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gae9390c6a48f66a887e7e0929bd089c25">ep_invariant</a>(<a class="code" href="../../da/da7/structep.html">ep</a>));</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;                <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga4d04d2d80f14221e812b0d455d4639c9">mover_invariant</a>(w) &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#ga02f3f80057e9c21bfbdf4993dc6ba169">mover_is_writer</a>(w));</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;                <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(M0_IN(w-&gt;<a class="code" href="../../d1/d99/structmover.html#a92dce5c08e4c69047f6eed9aa16b4d34">m_sm</a>.<a class="code" href="../../db/d49/structm0__sm.html#a15f271ddbf3fecd39f2711f07f40b76e">sm_state</a>, (<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a1bd27bf23812341749c87673d015d3ac">R_DONE</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a575df14f8416f291b63a463ddaa1c37f">R_FAIL</a>)));</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;                <span class="keywordflow">if</span> (m_tlink_is_in(w)) {</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;                        m_tlist_del(w);</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;                        <a class="code" href="../../d5/d16/group__netsock.html#ga98d09139fd60f6dd4f1200e42646b498">ep_balance</a>(<a class="code" href="../../da/da7/structep.html">ep</a>);</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;                        <a class="code" href="../../d5/d16/group__netsock.html#ga2ca93efdb493d25d0eabb1d9722070c0">EP_PUT</a>(<a class="code" href="../../da/da7/structep.html">ep</a>, <a class="code" href="../../d1/d99/structmover.html">mover</a>);</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;                }</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;                w-&gt;<a class="code" href="../../d1/d99/structmover.html#a212cefc7f5b7749302619a3c811bd7e7">m_ep</a> = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;        }</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;}</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;</div><div class="line"><a name="l02456"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga98d09139fd60f6dd4f1200e42646b498"> 2456</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga98d09139fd60f6dd4f1200e42646b498">ep_balance</a>(<span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a>)</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;{</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;        <span class="keywordtype">int</span>          result = 0;</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>;</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;        <span class="keywordflow">if</span> (m_tlist_is_empty(&amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#ac2bafd27a0e0c46e6cc7791b1a33ebcb">e_writer</a>)) {</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;                <span class="comment">/*</span></div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;<span class="comment">                 * No more writers.</span></div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;<span class="comment">                 *</span></div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;<span class="comment">                 * @todo Consider closing the sockets to this endpoint (after</span></div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;<span class="comment">                 * some time?).</span></div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;<span class="comment">                 */</span></div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;                <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a> = s_tlist_head(&amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#aa56814b0282f4d2f416fad8bda1da592">e_sock</a>);</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;                        result = <a class="code" href="../../d5/d16/group__netsock.html#gadc31941bba50c68b4c51483468b7acd4">sock_ctl</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, EPOLL_CTL_MOD, 0);</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;                <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(result == 0);</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;                <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a> = <a class="code" href="../../d7/d08/group__tlist.html#ga7b79fdd8d7679c6a9255581f90afd016">m0_tl_find</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, &amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#aa56814b0282f4d2f416fad8bda1da592">e_sock</a>, M0_IN(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_sm.sm_state,</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;                                                (<a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba9d8566da037aa1256e85c81f275b7805">S_CONNECTING</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaa86daa3f2c345452a3235108d80ad8aa">S_OPEN</a>)));</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a> == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;                        result = <a class="code" href="../../d5/d16/group__netsock.html#ga3e46e3a9fe0688a77c21473c9b1a3dde">sock_init</a>(-1, <a class="code" href="../../d5/d16/group__netsock.html#gaab89d3e82371dfcccd5807a8762c2baa">ma_src</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga78251ee15fee7c0c5da7f01379891e47">ep_ma</a>(<a class="code" href="../../da/da7/structep.html">ep</a>)), <a class="code" href="../../da/da7/structep.html">ep</a>, EPOLLOUT);</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;                <span class="keywordflow">else</span> {</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;                        <span class="comment">/*</span></div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;<span class="comment">                         * @todo Alternatively, more parallel sockets can be</span></div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;<span class="comment">                         * opened.</span></div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;<span class="comment">                         */</span></div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;                        <span class="comment">/* Make sure that at least one socket is writable. */</span></div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;                        <span class="keywordflow">if</span> (!(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_flags &amp; <a class="code" href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39a5b03f1e8c060b7325973da921d99df5b">WRITE_POLL</a>))</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;                                result = <a class="code" href="../../d5/d16/group__netsock.html#gadc31941bba50c68b4c51483468b7acd4">sock_ctl</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, EPOLL_CTL_MOD, EPOLLOUT);</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;                                result = 0;</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;                }</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;        }</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;        <span class="keywordflow">return</span> result;</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;}</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;</div><div class="line"><a name="l02493"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga12fee080a96fe0bee1c5bf5ccb564ac8"> 2493</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga12fee080a96fe0bee1c5bf5ccb564ac8">ep_free</a>(<span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a>)</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;{</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;        m0_nep_tlist_del(&amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a3851e3d045cfdff109ee4c7c69b1e9b8">e_ep</a>);</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;        m_tlist_fini(&amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#ac2bafd27a0e0c46e6cc7791b1a33ebcb">e_writer</a>);</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;        s_tlist_fini(&amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#aa56814b0282f4d2f416fad8bda1da592">e_sock</a>);</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;        <a class="code" href="../../d7/ded/group__memory.html#ga0b8533a3024754008602759e71337eb3">m0_free</a>((<span class="keywordtype">void</span> *)<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a3851e3d045cfdff109ee4c7c69b1e9b8">e_ep</a>.<a class="code" href="../../d2/d80/structm0__net__end__point.html#a737da65a4b01c33c2014c861e38f7398">nep_addr</a>);</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;        <a class="code" href="../../d7/ded/group__memory.html#ga0b8533a3024754008602759e71337eb3">m0_free</a>(<a class="code" href="../../da/da7/structep.html">ep</a>);</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;}</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;</div><div class="line"><a name="l02502"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga5c9c81b5351fd8f6692c7069bc8d30ce"> 2502</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga5c9c81b5351fd8f6692c7069bc8d30ce">ep_put</a>(<span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a>)</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;{</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;        <a class="code" href="../../d4/de4/refs_8c.html#a96dc9c89402bf6a5782c951d9de8285b">m0_ref_put</a>(&amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a3851e3d045cfdff109ee4c7c69b1e9b8">e_ep</a>.<a class="code" href="../../d2/d80/structm0__net__end__point.html#ac6f6a62f57f3af00ab1d86dfa5278f2c">nep_ref</a>);</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;}</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;</div><div class="line"><a name="l02507"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga1378244d34c151c34550cddb28441154"> 2507</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga1378244d34c151c34550cddb28441154">ep_get</a>(<span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a>)</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;{</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;        <a class="code" href="../../d4/de4/refs_8c.html#ad4ed148978270f86b1af2ea8697f8aae">m0_ref_get</a>(&amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a3851e3d045cfdff109ee4c7c69b1e9b8">e_ep</a>.<a class="code" href="../../d2/d80/structm0__net__end__point.html#ac6f6a62f57f3af00ab1d86dfa5278f2c">nep_ref</a>);</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;}</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;</div><div class="line"><a name="l02518"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga97fcfe2ab24d7ddf0d1a4e1d144cb94a"> 2518</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga97fcfe2ab24d7ddf0d1a4e1d144cb94a">addr_resolve</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>)</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;{</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;        <span class="keywordtype">int</span> result = <a class="code" href="../../d5/d16/group__netsock.html#gade75dddfcbfe49fe6ac9fca3c97457e3">addr_parse</a>(<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>);</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;        <span class="keywordflow">if</span> (result == 0) {</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;                <span class="comment">/*</span></div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;<span class="comment">                 * Currently only numberical ip addresses are supported (see</span></div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;<span class="comment">                 * addr_parse()). They do not require any resolving. In the</span></div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;<span class="comment">                 * future, use getaddrinfo(3).</span></div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;<span class="comment">                 */</span></div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;                ;</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;        }</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a9a02a790ad457506f9f3bc12121e6079">M0_RC</a>(result);</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;}</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;</div><div class="line"><a name="l02554"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gade75dddfcbfe49fe6ac9fca3c97457e3"> 2554</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gade75dddfcbfe49fe6ac9fca3c97457e3">addr_parse</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>)</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;{</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;        <span class="keywordtype">int</span> result;</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>[0] == 0)</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;                result =  <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPROTO);</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>[0] &lt; <span class="charliteral">&#39;0&#39;</span> || <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>[0] &gt; <span class="charliteral">&#39;9&#39;</span>)</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;                result = <a class="code" href="../../d5/d16/group__netsock.html#gad41ec2097710f43c74d3114562b8a48a">addr_parse_native</a>(<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>);</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;                <span class="comment">/* Lnet format. */</span></div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;                result = <a class="code" href="../../d5/d16/group__netsock.html#ga7189084138c48f66266d05c5bd6e1fdb">addr_parse_lnet</a>(<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>);</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#aea86d55595126b703b9e619887f09a22">M0_POST</a>(<a class="code" href="../../df/d2a/lib_2misc_8h.html#a7f75ab6839d468f4d23480a9c65724c5">ergo</a>(result == 0, <a class="code" href="../../d5/d16/group__netsock.html#gafe00935b90da1e6a5c7315945de225c4">addr_invariant</a>(<a class="code" href="../../d9/db9/structaddr.html">addr</a>)));</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a9a02a790ad457506f9f3bc12121e6079">M0_RC</a>(result);</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;}</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;</div><div class="line"><a name="l02578"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga9ba243c1f191db3785f0c9950e95266a"> 2578</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="../../d5/d16/group__netsock.html#ga9ba243c1f191db3785f0c9950e95266a">autotm</a>[1024] = {};</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;</div><div class="line"><a name="l02580"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga7189084138c48f66266d05c5bd6e1fdb"> 2580</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga7189084138c48f66266d05c5bd6e1fdb">addr_parse_lnet</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>)</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;{</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;        <span class="keyword">struct </span>sockaddr_in  sin;</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;        <span class="keywordtype">char</span>               *<a class="code" href="../../dd/d6d/group__xcode.html#ga44f0d2ee812fb0647c72314b571f9d0d">at</a>                  = strchr(<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>, <span class="charliteral">&#39;@&#39;</span>);</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;        <span class="keywordtype">char</span>                ip[INET_ADDRSTRLEN] = {};</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;        <span class="keywordtype">int</span>                 <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a>;</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;        <span class="keywordtype">unsigned</span>            pid;</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;        <span class="keywordtype">unsigned</span>            portal;</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;        <span class="keywordtype">unsigned</span>            tmid;</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;        <span class="keywordflow">if</span> (strncmp(<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>, <span class="stringliteral">&quot;0@lo&quot;</span>, 4) == 0) {</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;                sin.sin_addr.s_addr = htonl(INADDR_LOOPBACK);</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../dd/d6d/group__xcode.html#ga44f0d2ee812fb0647c72314b571f9d0d">at</a> == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="../../dd/d6d/group__xcode.html#ga44f0d2ee812fb0647c72314b571f9d0d">at</a> - <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a> &gt;= <span class="keyword">sizeof</span> ip)</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPROTO);</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;                memcpy(ip, <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>, <a class="code" href="../../dd/d6d/group__xcode.html#ga44f0d2ee812fb0647c72314b571f9d0d">at</a> - <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>);</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;                <span class="keywordflow">if</span> (inet_pton(AF_INET, ip, &amp;sin.sin_addr) != 1)</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPROTO);</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;        }</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;        sin.sin_family = AF_INET;</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="../../dd/d6d/group__xcode.html#ga44f0d2ee812fb0647c72314b571f9d0d">at</a> = strchr(<a class="code" href="../../dd/d6d/group__xcode.html#ga44f0d2ee812fb0647c72314b571f9d0d">at</a>, <span class="charliteral">&#39;:&#39;</span>)) == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="comment">/* Skip &#39;tcp...:&#39; bit. */</span></div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPROTO);</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;        <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a> = sscanf(<a class="code" href="../../dd/d6d/group__xcode.html#ga44f0d2ee812fb0647c72314b571f9d0d">at</a> + 1, <span class="stringliteral">&quot;%u:%u:%u&quot;</span>, &amp;pid, &amp;portal, &amp;tmid);</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a> != 3) {</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;                <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a> = sscanf(<a class="code" href="../../dd/d6d/group__xcode.html#ga44f0d2ee812fb0647c72314b571f9d0d">at</a> + 1, <span class="stringliteral">&quot;%u:%u:*&quot;</span>, &amp;pid, &amp;portal);</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a> != 2)</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPROTO);</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a> = 0; <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a> &lt; <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga9ba243c1f191db3785f0c9950e95266a">autotm</a>); ++<a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a>) {</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d16/group__netsock.html#ga9ba243c1f191db3785f0c9950e95266a">autotm</a>[<a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a>] == 0) {</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;                                tmid = <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a>;</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;                        }</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;                }</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a> == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga9ba243c1f191db3785f0c9950e95266a">autotm</a>))</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EADDRNOTAVAIL);</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;        }</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;<span class="comment">         * Hard-code LUSTRE_SRV_LNET_PID to avoid dependencies on the Lustre</span></div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;<span class="comment">         * headers.</span></div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;        <span class="keywordflow">if</span> (pid != 12345)</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPROTO);</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;<span class="comment">         * Deterministically combine portal and tmid into a unique 16-bit port</span></div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;<span class="comment">         * number (greater than 1024). Tricky.</span></div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;<span class="comment">         * Port number is, in binary: tttttttttt1ppppp, that is, 10 bits of tmid</span></div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;<span class="comment">         * (which must be less than 1024), followed by a set bit (guaranteeing</span></div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;<span class="comment">         * that the port is not reserved), followed by 5 bits of (portal - 30),</span></div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;<span class="comment">         * so that portal must be in the range 30..61.</span></div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;        <span class="keywordflow">if</span> (tmid &gt;= 1024 || (portal - 30) &gt;= 32)</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d8/d98/group__trace.html#gadcff472fb398402105feb7fa41add0a5">M0_ERR_INFO</a>(-EPROTO,</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;                                   <span class="stringliteral">&quot;portal: %u, tmid: %u&quot;</span>, portal, tmid);</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;        sin.sin_port     = htons(tmid | (1 &lt;&lt; 10) | ((portal - 30) &lt;&lt; 11));</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;        <a class="code" href="../../d9/db9/structaddr.html">addr</a>-&gt;<a class="code" href="../../d9/db9/structaddr.html#ad8ca990694d5e0a6cef86dd67ba2e6b7">a_family</a>   = PF_INET;</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;        <a class="code" href="../../d9/db9/structaddr.html">addr</a>-&gt;<a class="code" href="../../d9/db9/structaddr.html#a5f0f751a9bdbdd75feadad5803d13285">a_socktype</a> = SOCK_STREAM;</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;        <a class="code" href="../../d9/db9/structaddr.html">addr</a>-&gt;<a class="code" href="../../d9/db9/structaddr.html#a830ec069f03642982b29f2b596d3e133">a_protocol</a> = IPPROTO_TCP;</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga9ba243c1f191db3785f0c9950e95266a">autotm</a>[tmid] = 1;</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga88e81fbd6443046da02ec3cb446fa705">addr_decode</a>(<a class="code" href="../../d9/db9/structaddr.html">addr</a>, (<span class="keywordtype">void</span> *)&amp;sin);</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a9a02a790ad457506f9f3bc12121e6079">M0_RC</a>(0);</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;}</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;</div><div class="line"><a name="l02643"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gad41ec2097710f43c74d3114562b8a48a"> 2643</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gad41ec2097710f43c74d3114562b8a48a">addr_parse_native</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>)</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;{</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;        <span class="keywordtype">int</span>   shift;</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;        <span class="keywordtype">int</span>   result;</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;        <span class="keywordtype">int</span>   <a class="code" href="../../d9/d6a/group__stob.html#ga3efb0e1a16208deecbd84c15401f7cf8">f</a>;</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;        <span class="keywordtype">int</span>   <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>;</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;        <span class="keywordtype">long</span>  <a class="code" href="../../d4/d54/namespaceinflux__test__data.html#af8fb0f45ee0195c7422a49e6a8d72369">port</a>;</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;        <span class="keywordtype">char</span> *<a class="code" href="../../dd/d6d/group__xcode.html#ga44f0d2ee812fb0647c72314b571f9d0d">at</a>;</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;        <span class="keywordtype">char</span> *end;</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;        <span class="keywordtype">char</span>  ip[INET6_ADDRSTRLEN] = {};</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d9/d6a/group__stob.html#ga3efb0e1a16208deecbd84c15401f7cf8">f</a> = 0; <a class="code" href="../../d9/d6a/group__stob.html#ga3efb0e1a16208deecbd84c15401f7cf8">f</a> &lt; <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga8ee1bd6f751a2a078fc04723d6e88d33">pf</a>); ++<a class="code" href="../../d9/d6a/group__stob.html#ga3efb0e1a16208deecbd84c15401f7cf8">f</a>) {</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d5/d16/group__netsock.html#ga8ee1bd6f751a2a078fc04723d6e88d33">pf</a>[<a class="code" href="../../d9/d6a/group__stob.html#ga3efb0e1a16208deecbd84c15401f7cf8">f</a>].f_name != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;                        shift = strlen(<a class="code" href="../../d5/d16/group__netsock.html#ga8ee1bd6f751a2a078fc04723d6e88d33">pf</a>[<a class="code" href="../../d9/d6a/group__stob.html#ga3efb0e1a16208deecbd84c15401f7cf8">f</a>].f_name);</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;                        <span class="keywordflow">if</span> (strncmp(<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>, <a class="code" href="../../d5/d16/group__netsock.html#ga8ee1bd6f751a2a078fc04723d6e88d33">pf</a>[<a class="code" href="../../d9/d6a/group__stob.html#ga3efb0e1a16208deecbd84c15401f7cf8">f</a>].f_name, shift) == 0)</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;                }</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;        }</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d9/d6a/group__stob.html#ga3efb0e1a16208deecbd84c15401f7cf8">f</a> == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga8ee1bd6f751a2a078fc04723d6e88d33">pf</a>) || <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>[shift] != <span class="charliteral">&#39;:&#39;</span>)</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EINVAL);</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;        <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a> += shift + 1;</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a> = 0; <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a> &lt; <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga2c304ecfc57668f0196522601f103071">stype</a>); ++<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>) {</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d5/d16/group__netsock.html#ga2c304ecfc57668f0196522601f103071">stype</a>[<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>].st_name != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;                        shift = strlen(<a class="code" href="../../d5/d16/group__netsock.html#ga2c304ecfc57668f0196522601f103071">stype</a>[<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>].st_name);</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;                        <span class="keywordflow">if</span> (strncmp(<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>, <a class="code" href="../../d5/d16/group__netsock.html#ga2c304ecfc57668f0196522601f103071">stype</a>[<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>].st_name, shift) == 0)</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;                }</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;        }</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a> == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga2c304ecfc57668f0196522601f103071">stype</a>) || <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>[shift] != <span class="charliteral">&#39;:&#39;</span>)</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EINVAL);</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;        <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a> += shift + 1;</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;        <a class="code" href="../../dd/d6d/group__xcode.html#ga44f0d2ee812fb0647c72314b571f9d0d">at</a> = strchr(<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>, <span class="charliteral">&#39;@&#39;</span>);</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d6d/group__xcode.html#ga44f0d2ee812fb0647c72314b571f9d0d">at</a> == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;                <span class="comment">/* XXX @todo: default port? */</span></div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EINVAL);</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;                <a class="code" href="../../d4/d54/namespaceinflux__test__data.html#af8fb0f45ee0195c7422a49e6a8d72369">port</a> = strtol(<a class="code" href="../../dd/d6d/group__xcode.html#ga44f0d2ee812fb0647c72314b571f9d0d">at</a> + 1, &amp;end, 10);</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;                <span class="keywordflow">if</span> (*end != 0)</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EINVAL);</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;                <span class="keywordflow">if</span> (errno != 0)</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-errno);</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;                <span class="keywordflow">if</span> (port &lt; 0 || port &gt; USHRT_MAX)</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-ERANGE);</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;        }</div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;        memcpy(ip, <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>, <a class="code" href="../../db/dc9/group__arith.html#ga5fb15c6777f74e8ef6ed68098fb73606">min64</a>(<a class="code" href="../../dd/d6d/group__xcode.html#ga44f0d2ee812fb0647c72314b571f9d0d">at</a> - <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>, <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a>(ip) - 1));</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;        result = inet_pton(<a class="code" href="../../d9/d6a/group__stob.html#ga3efb0e1a16208deecbd84c15401f7cf8">f</a>, ip, <a class="code" href="../../d9/db9/structaddr.html">addr</a>-&gt;<a class="code" href="../../d9/db9/structaddr.html#a8abdba8b976548e55d92fc17d4a5111c">a_data</a>.<a class="code" href="../../df/dd9/structaddrdata.html#a640ae27554cd6f225fa8440610ea239e">v_data</a>);</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;        <span class="keywordflow">if</span> (result == 0)</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EINVAL);</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;        <span class="keywordflow">if</span> (result == -1)</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-errno);</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;        <a class="code" href="../../d9/db9/structaddr.html">addr</a>-&gt;<a class="code" href="../../d9/db9/structaddr.html#ad8ca990694d5e0a6cef86dd67ba2e6b7">a_family</a>   = <a class="code" href="../../d9/d6a/group__stob.html#ga3efb0e1a16208deecbd84c15401f7cf8">f</a>;</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;        <a class="code" href="../../d9/db9/structaddr.html">addr</a>-&gt;<a class="code" href="../../d9/db9/structaddr.html#a5f0f751a9bdbdd75feadad5803d13285">a_socktype</a> = <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>;</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;        <a class="code" href="../../d9/db9/structaddr.html">addr</a>-&gt;<a class="code" href="../../d9/db9/structaddr.html#a830ec069f03642982b29f2b596d3e133">a_protocol</a> = <a class="code" href="../../d5/d16/group__netsock.html#ga2c304ecfc57668f0196522601f103071">stype</a>[<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>].<a class="code" href="../../d7/d2a/structsocktype.html#a631f5466b3b1bd950fe9cb9391648272">st_proto</a>;</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;        <a class="code" href="../../d9/db9/structaddr.html">addr</a>-&gt;<a class="code" href="../../d9/db9/structaddr.html#a684be829a8f7d0ee1367fed2fb93b501">a_port</a>     = <a class="code" href="../../d4/d54/namespaceinflux__test__data.html#af8fb0f45ee0195c7422a49e6a8d72369">port</a>;</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#aea86d55595126b703b9e619887f09a22">M0_POST</a>(<a class="code" href="../../d5/d16/group__netsock.html#gafe00935b90da1e6a5c7315945de225c4">addr_invariant</a>(<a class="code" href="../../d9/db9/structaddr.html">addr</a>));</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;}</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;</div><div class="line"><a name="l02702"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga69b44214debab83060d1387e07cebade"> 2702</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga69b44214debab83060d1387e07cebade">ip4_encode</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *a, <span class="keyword">struct</span> sockaddr *sa)</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;{</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;        <span class="keyword">struct </span>sockaddr_in *sin = (<span class="keywordtype">void</span> *)sa;</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;        <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae0d2e870ac085d7b16c48c2c52765009">M0_SET0</a>(sin);</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;<span class="preprocessor">#if 0 </span><span class="comment">/* BSD Reno. */</span><span class="preprocessor"></span></div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;        sin-&gt;sin_len         = <span class="keyword">sizeof</span> *sin;</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;        sin-&gt;sin_port        = htons(a-&gt;<a class="code" href="../../d9/db9/structaddr.html#a684be829a8f7d0ee1367fed2fb93b501">a_port</a>);</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;        sin-&gt;sin_addr.s_addr = *(uint32_t *)&amp;a-&gt;<a class="code" href="../../d9/db9/structaddr.html#a8abdba8b976548e55d92fc17d4a5111c">a_data</a>.<a class="code" href="../../df/dd9/structaddrdata.html#a640ae27554cd6f225fa8440610ea239e">v_data</a>[0];</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;}</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;</div><div class="line"><a name="l02715"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga407a665abe98d73380b1333c033f6d63"> 2715</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga407a665abe98d73380b1333c033f6d63">ip4_decode</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *a, <span class="keyword">const</span> <span class="keyword">struct</span> sockaddr *sa)</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;{</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span>sockaddr_in *sin = (<span class="keywordtype">void</span> *)sa;</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;        a-&gt;<a class="code" href="../../d9/db9/structaddr.html#a684be829a8f7d0ee1367fed2fb93b501">a_port</a> = ntohs(sin-&gt;sin_port);</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;        *((uint32_t *)&amp;a-&gt;<a class="code" href="../../d9/db9/structaddr.html#a8abdba8b976548e55d92fc17d4a5111c">a_data</a>.<a class="code" href="../../df/dd9/structaddrdata.html#a640ae27554cd6f225fa8440610ea239e">v_data</a>[0]) = sin-&gt;sin_addr.s_addr;</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;}</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;</div><div class="line"><a name="l02724"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga41ef6a6d745f5cf282ab2a42c1eeb09d"> 2724</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga41ef6a6d745f5cf282ab2a42c1eeb09d">ip6_encode</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *a, <span class="keyword">struct</span> sockaddr *sa)</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;{</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;        <span class="keyword">struct </span>sockaddr_in6 *sin6 = (<span class="keywordtype">void</span> *)sa;</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;        <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae0d2e870ac085d7b16c48c2c52765009">M0_SET0</a>(sin6);</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;<span class="preprocessor">#if 0 </span><span class="comment">/* BSD Reno. */</span><span class="preprocessor"></span></div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;        sin6-&gt;sin6_len         = <span class="keyword">sizeof</span> *sin6;</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;        sin6-&gt;sin6_port        = htons(a-&gt;<a class="code" href="../../d9/db9/structaddr.html#a684be829a8f7d0ee1367fed2fb93b501">a_port</a>);</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;        memcpy(sin6-&gt;sin6_addr.s6_addr, a-&gt;<a class="code" href="../../d9/db9/structaddr.html#a8abdba8b976548e55d92fc17d4a5111c">a_data</a>.<a class="code" href="../../df/dd9/structaddrdata.html#a640ae27554cd6f225fa8440610ea239e">v_data</a>,</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;               <span class="keyword">sizeof</span> sin6-&gt;sin6_addr.s6_addr);</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;}</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;</div><div class="line"><a name="l02738"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga8de83c5591e35a816141fffb1ae24e7f"> 2738</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga8de83c5591e35a816141fffb1ae24e7f">ip6_decode</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *a, <span class="keyword">const</span> <span class="keyword">struct</span> sockaddr *sa)</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;{</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;        <span class="keyword">struct </span>sockaddr_in6 *sin6 = (<span class="keywordtype">void</span> *)sa;</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;        a-&gt;<a class="code" href="../../d9/db9/structaddr.html#a684be829a8f7d0ee1367fed2fb93b501">a_port</a> = ntohs(sin6-&gt;sin6_port);</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;        memcpy(a-&gt;<a class="code" href="../../d9/db9/structaddr.html#a8abdba8b976548e55d92fc17d4a5111c">a_data</a>.<a class="code" href="../../df/dd9/structaddrdata.html#a640ae27554cd6f225fa8440610ea239e">v_data</a>, sin6-&gt;sin6_addr.s6_addr,</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;               <span class="keyword">sizeof</span> sin6-&gt;sin6_addr.s6_addr);</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;}</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;</div><div class="line"><a name="l02748"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga1346d46974aa7185fed3b07d84480295"> 2748</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d5/d16/group__netsock.html#ga1346d46974aa7185fed3b07d84480295">addr_print</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *a)</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;{</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;        <span class="keywordtype">char</span> *<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>;</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;        <span class="keywordtype">int</span>   nob;</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;        <span class="keyword">struct </span>sockaddr_storage sa = {};</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;        <span class="keyword">enum</span> { <a class="code" href="../../d0/d8c/m0hsm__api_8c.html#aa52ea6a123f47db5e6b145e5fc5e369aa8d8e435ab97a976436593ad9c058ec4a">MAX_LEN</a> = <span class="keyword">sizeof</span>(<span class="stringliteral">&quot;inet6:stream:@65536&quot;</span>) + INET6_ADDRSTRLEN };</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gafe00935b90da1e6a5c7315945de225c4">addr_invariant</a>(a));</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;        <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a> = <a class="code" href="../../d7/ded/group__memory.html#ga80e6a4e9d078f93b5917555b7b3d3fec">m0_alloc</a>(<a class="code" href="../../d0/d8c/m0hsm__api_8c.html#aa52ea6a123f47db5e6b145e5fc5e369aa8d8e435ab97a976436593ad9c058ec4a">MAX_LEN</a>);</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a> == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;        nob = snprintf(<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>, <a class="code" href="../../d0/d8c/m0hsm__api_8c.html#aa52ea6a123f47db5e6b145e5fc5e369aa8d8e435ab97a976436593ad9c058ec4a">MAX_LEN</a>, <span class="stringliteral">&quot;%s:%s:&quot;</span>,</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;                       <a class="code" href="../../d5/d16/group__netsock.html#ga8ee1bd6f751a2a078fc04723d6e88d33">pf</a>[a-&gt;<a class="code" href="../../d9/db9/structaddr.html#ad8ca990694d5e0a6cef86dd67ba2e6b7">a_family</a>].<a class="code" href="../../d3/d5d/structpfamily.html#a0d651171d046e2dff23fa92afd2a44ba">f_name</a>, <a class="code" href="../../d5/d16/group__netsock.html#ga2c304ecfc57668f0196522601f103071">stype</a>[a-&gt;<a class="code" href="../../d9/db9/structaddr.html#a5f0f751a9bdbdd75feadad5803d13285">a_socktype</a>].<a class="code" href="../../d7/d2a/structsocktype.html#a6f6622bd6a97e172f6100f47386bdfcf">st_name</a>);</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(nob &lt; <a class="code" href="../../d0/d8c/m0hsm__api_8c.html#aa52ea6a123f47db5e6b145e5fc5e369aa8d8e435ab97a976436593ad9c058ec4a">MAX_LEN</a>);</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga0551d085ef008b4fac533739771a1eb7">addr_encode</a>(a, (<span class="keywordtype">void</span> *)&amp;sa);</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;        <span class="keywordflow">switch</span> (a-&gt;<a class="code" href="../../d9/db9/structaddr.html#ad8ca990694d5e0a6cef86dd67ba2e6b7">a_family</a>) {</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;        <span class="keywordflow">case</span> AF_INET: {</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;                <span class="keyword">struct </span>sockaddr_in *sin = (<span class="keywordtype">void</span> *)&amp;sa;</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;                inet_ntop(AF_INET, &amp;sin-&gt;sin_addr, <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a> + nob, <a class="code" href="../../d0/d8c/m0hsm__api_8c.html#aa52ea6a123f47db5e6b145e5fc5e369aa8d8e435ab97a976436593ad9c058ec4a">MAX_LEN</a> - nob);</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;        }</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;        <span class="keywordflow">case</span> AF_INET6: {</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;                <span class="keyword">struct </span>sockaddr_in6 *sin = (<span class="keywordtype">void</span> *)&amp;sa;</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;                inet_ntop(AF_INET6, &amp;sin-&gt;sin6_addr, <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a> + nob, <a class="code" href="../../d0/d8c/m0hsm__api_8c.html#aa52ea6a123f47db5e6b145e5fc5e369aa8d8e435ab97a976436593ad9c058ec4a">MAX_LEN</a> - nob);</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;        }</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;                <a class="code" href="../../dc/da7/assert_8h.html#a3c39879398f6b8e4a2ed005fbf2e79c1">M0_IMPOSSIBLE</a>(<span class="stringliteral">&quot;Wrong family: %i.&quot;</span>, a-&gt;<a class="code" href="../../d9/db9/structaddr.html#ad8ca990694d5e0a6cef86dd67ba2e6b7">a_family</a>);</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;        }</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;        nob = strlen(<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>);</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(nob &lt; <a class="code" href="../../d0/d8c/m0hsm__api_8c.html#aa52ea6a123f47db5e6b145e5fc5e369aa8d8e435ab97a976436593ad9c058ec4a">MAX_LEN</a>);</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;        nob += snprintf(<a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a> + nob, <a class="code" href="../../d0/d8c/m0hsm__api_8c.html#aa52ea6a123f47db5e6b145e5fc5e369aa8d8e435ab97a976436593ad9c058ec4a">MAX_LEN</a> - nob, <span class="stringliteral">&quot;@%i&quot;</span>, a-&gt;<a class="code" href="../../d9/db9/structaddr.html#a684be829a8f7d0ee1367fed2fb93b501">a_port</a>);</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(nob &lt; <a class="code" href="../../d0/d8c/m0hsm__api_8c.html#aa52ea6a123f47db5e6b145e5fc5e369aa8d8e435ab97a976436593ad9c058ec4a">MAX_LEN</a>);</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a>;</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;}</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;</div><div class="line"><a name="l02788"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga88e81fbd6443046da02ec3cb446fa705"> 2788</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga88e81fbd6443046da02ec3cb446fa705">addr_decode</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <span class="keyword">const</span> <span class="keyword">struct</span> sockaddr *sa)</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;{</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../df/d2a/lib_2misc_8h.html#a3a6a6708976cdeb3aec96b1d2545bd8d">IS_IN_ARRAY</a>(<a class="code" href="../../d9/db9/structaddr.html">addr</a>-&gt;<a class="code" href="../../d9/db9/structaddr.html#ad8ca990694d5e0a6cef86dd67ba2e6b7">a_family</a>, <a class="code" href="../../d5/d16/group__netsock.html#ga8ee1bd6f751a2a078fc04723d6e88d33">pf</a>));</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga8ee1bd6f751a2a078fc04723d6e88d33">pf</a>[<a class="code" href="../../d9/db9/structaddr.html">addr</a>-&gt;<a class="code" href="../../d9/db9/structaddr.html#ad8ca990694d5e0a6cef86dd67ba2e6b7">a_family</a>].<a class="code" href="../../d3/d5d/structpfamily.html#a0d651171d046e2dff23fa92afd2a44ba">f_name</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;        <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae0d2e870ac085d7b16c48c2c52765009">M0_SET0</a>(&amp;<a class="code" href="../../d9/db9/structaddr.html">addr</a>-&gt;<a class="code" href="../../d9/db9/structaddr.html#a8abdba8b976548e55d92fc17d4a5111c">a_data</a>);</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga8ee1bd6f751a2a078fc04723d6e88d33">pf</a>[<a class="code" href="../../d9/db9/structaddr.html">addr</a>-&gt;<a class="code" href="../../d9/db9/structaddr.html#ad8ca990694d5e0a6cef86dd67ba2e6b7">a_family</a>].<a class="code" href="../../d3/d5d/structpfamily.html#abd6fbc18f045b5408003c90e81fab0c9">f_decode</a>(<a class="code" href="../../d9/db9/structaddr.html">addr</a>, sa);</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;}</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;</div><div class="line"><a name="l02797"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga0551d085ef008b4fac533739771a1eb7"> 2797</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga0551d085ef008b4fac533739771a1eb7">addr_encode</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <span class="keyword">struct</span> sockaddr *sa)</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;{</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../df/d2a/lib_2misc_8h.html#a3a6a6708976cdeb3aec96b1d2545bd8d">IS_IN_ARRAY</a>(<a class="code" href="../../d9/db9/structaddr.html">addr</a>-&gt;<a class="code" href="../../d9/db9/structaddr.html#ad8ca990694d5e0a6cef86dd67ba2e6b7">a_family</a>, <a class="code" href="../../d5/d16/group__netsock.html#ga8ee1bd6f751a2a078fc04723d6e88d33">pf</a>));</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga8ee1bd6f751a2a078fc04723d6e88d33">pf</a>[<a class="code" href="../../d9/db9/structaddr.html">addr</a>-&gt;<a class="code" href="../../d9/db9/structaddr.html#ad8ca990694d5e0a6cef86dd67ba2e6b7">a_family</a>].<a class="code" href="../../d3/d5d/structpfamily.html#a0d651171d046e2dff23fa92afd2a44ba">f_name</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga8ee1bd6f751a2a078fc04723d6e88d33">pf</a>[<a class="code" href="../../d9/db9/structaddr.html">addr</a>-&gt;<a class="code" href="../../d9/db9/structaddr.html#ad8ca990694d5e0a6cef86dd67ba2e6b7">a_family</a>].<a class="code" href="../../d3/d5d/structpfamily.html#a47da420cb14c4c92a1e09df6913ec690">f_encode</a>(<a class="code" href="../../d9/db9/structaddr.html">addr</a>, sa);</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;        sa-&gt;sa_family = <a class="code" href="../../d9/db9/structaddr.html">addr</a>-&gt;<a class="code" href="../../d9/db9/structaddr.html#ad8ca990694d5e0a6cef86dd67ba2e6b7">a_family</a>;</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;}</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;</div><div class="line"><a name="l02806"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaa44e650cf8e69290b8b265d8e706c7f4"> 2806</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#gaa44e650cf8e69290b8b265d8e706c7f4">addr_eq</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *a0, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *a1)</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;{</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;        <span class="keywordflow">return</span>  a0-&gt;<a class="code" href="../../d9/db9/structaddr.html#ad8ca990694d5e0a6cef86dd67ba2e6b7">a_family</a>    == a1-&gt;<a class="code" href="../../d9/db9/structaddr.html#ad8ca990694d5e0a6cef86dd67ba2e6b7">a_family</a> &amp;&amp;</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;                a0-&gt;<a class="code" href="../../d9/db9/structaddr.html#a830ec069f03642982b29f2b596d3e133">a_protocol</a>  == a1-&gt;<a class="code" href="../../d9/db9/structaddr.html#a830ec069f03642982b29f2b596d3e133">a_protocol</a> &amp;&amp;</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;                a0-&gt;<a class="code" href="../../d9/db9/structaddr.html#a5f0f751a9bdbdd75feadad5803d13285">a_socktype</a>  == a1-&gt;<a class="code" href="../../d9/db9/structaddr.html#a5f0f751a9bdbdd75feadad5803d13285">a_socktype</a> &amp;&amp;</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;                memcmp(a0-&gt;<a class="code" href="../../d9/db9/structaddr.html#a8abdba8b976548e55d92fc17d4a5111c">a_data</a>.<a class="code" href="../../df/dd9/structaddrdata.html#a640ae27554cd6f225fa8440610ea239e">v_data</a>, a1-&gt;<a class="code" href="../../d9/db9/structaddr.html#a8abdba8b976548e55d92fc17d4a5111c">a_data</a>.<a class="code" href="../../df/dd9/structaddrdata.html#a640ae27554cd6f225fa8440610ea239e">v_data</a>,</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;                       <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a>(a0-&gt;<a class="code" href="../../d9/db9/structaddr.html#a8abdba8b976548e55d92fc17d4a5111c">a_data</a>.<a class="code" href="../../df/dd9/structaddrdata.html#a640ae27554cd6f225fa8440610ea239e">v_data</a>)) == 0;</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;}</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;</div><div class="line"><a name="l02816"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga6f158d48c8168947b0fef56f8bc52747"> 2816</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#ga6f158d48c8168947b0fef56f8bc52747">ep_eq</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a>, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *a0)</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;{</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d9/db9/structaddr.html">addr</a> *a1 = &amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a7fa38028a1ed8e0d494fc3d2f179a890">e_a</a>;</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gaa44e650cf8e69290b8b265d8e706c7f4">addr_eq</a>(a0, a1) &amp;&amp; a0-&gt;<a class="code" href="../../d9/db9/structaddr.html#a684be829a8f7d0ee1367fed2fb93b501">a_port</a> == a1-&gt;<a class="code" href="../../d9/db9/structaddr.html#a684be829a8f7d0ee1367fed2fb93b501">a_port</a>;</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;}</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;</div><div class="line"><a name="l02823"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gafea137fe2248694702f66bd158c45022"> 2823</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d5/d16/group__netsock.html#gafea137fe2248694702f66bd158c45022">buf_ma</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dd0/structbuf.html">buf</a> *<a class="code" href="../../d9/dd0/structbuf.html">buf</a>)</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;{</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a11ed429feb7ad22be45284e8055fe465">b_buf</a>-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a81bdb16b1858bd23bc6ad680aec0d816">nb_tm</a>-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#a8b18058969fa6fe0a12df59639accbe2">ntm_xprt_private</a>;</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;}</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;</div><div class="line"><a name="l02835"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaef26c34c66e8e88befd9b30a9cae179c"> 2835</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gaef26c34c66e8e88befd9b30a9cae179c">buf_accept</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dd0/structbuf.html">buf</a> *<a class="code" href="../../d9/dd0/structbuf.html">buf</a>, <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>)</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;{</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../df/de8/structpacket.html">packet</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>      = &amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_pk;</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d5/d0e/structbdesc.html">bdesc</a>  *<a class="code" href="../../df/ded/ut_2fd_8c.html#aac62f57bd247b8b9b145f09eef0e6e09">src</a>    = &amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_src;</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;        <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a>    length = <a class="code" href="../../d0/d7f/group__vec.html#ga9c79d9e7b339acaf8b46ac0a813f064d">m0_vec_count</a>(&amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a11ed429feb7ad22be45284e8055fe465">b_buf</a>-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a19d709b59dd6fd480b660cbe8217b0b2">nb_buffer</a>.<a class="code" href="../../da/d2c/structm0__bufvec.html#ad790ff2243358efb3defea0a266a4503">ov_vec</a>);</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;        <span class="keywordtype">int</span>            result = 0;</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga4d04d2d80f14221e812b0d455d4639c9">mover_invariant</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>) &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#gad1278e0c872e51530c6943d527e786a3">mover_is_reader</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>));</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_offset + <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_size &gt; length)</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EMSGSIZE);</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_totalsize &gt; length)</div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EMSGSIZE);</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a65bbee1059773d953d6c79dd44b04401">b_done</a>.<a class="code" href="../../d9/d78/structm0__bitmap.html#a0a00837f749849ca259b96b56f3c6d46">b_words</a> == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;                result = <a class="code" href="../../df/df3/group__bitmap.html#ga0f9db6f3dbbce95cfc769ea48843d3f2">m0_bitmap_init</a>(&amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a65bbee1059773d953d6c79dd44b04401">b_done</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_nr);</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;                <span class="keywordflow">if</span> (result != 0)</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;                        <span class="keywordflow">return</span> result;</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;                <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_buf      = <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a4b9218d5c001301e593c59b2f36f9d17">buf</a>;</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;                <a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#aebfa795c2499f9ffbb7391dbfc94981e">b_peer</a>   = *<a class="code" href="../../df/ded/ut_2fd_8c.html#aac62f57bd247b8b9b145f09eef0e6e09">src</a>;</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;                <a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a1fad047c5710429941a570879286459f">b_length</a> = <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_totalsize;</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;                result = <a class="code" href="../../d5/d16/group__netsock.html#ga87fd9494dc7688b4f4cddb2bc5bfbaaa">ep_create</a>(<a class="code" href="../../d5/d16/group__netsock.html#gafea137fe2248694702f66bd158c45022">buf_ma</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>),</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;                                   &amp;<a class="code" href="../../df/ded/ut_2fd_8c.html#aac62f57bd247b8b9b145f09eef0e6e09">src</a>-&gt;bd_addr, <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a38f9df430deb5db9891b42147ef7a69e">b_other</a>);</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;<span class="preprocessor">#ifdef EP_DEBUG</span></div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;                <span class="keywordflow">if</span> (result == 0) {</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;                        <a class="code" href="../../db/dc9/group__arith.html#ga6ba808bd9de059edf42ab1d70c4c8964">M0_CNT_DEC</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a38f9df430deb5db9891b42147ef7a69e">b_other</a>-&gt;<a class="code" href="../../da/da7/structep.html#ad800a8d736e37f9934761bfe00b1d4cc">e_r_find</a>);</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;                        <a class="code" href="../../db/dc9/group__arith.html#gabcb07645e2a6233c6ce958784aaf9fe3">M0_CNT_INC</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a38f9df430deb5db9891b42147ef7a69e">b_other</a>-&gt;<a class="code" href="../../da/da7/structep.html#a10fa53c9fb4b7c26d14f7af762878d6c">e_r_buf</a>);</div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;                }</div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a65bbee1059773d953d6c79dd44b04401">b_done</a>.<a class="code" href="../../d9/d78/structm0__bitmap.html#ad28a5fb566aee29804413733338cfe60">b_nr</a> != <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_nr) {</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;                result = <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPROTO);</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a1fad047c5710429941a570879286459f">b_length</a> != <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_totalsize) {</div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;                result = <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPROTO);</div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a38f9df430deb5db9891b42147ef7a69e">b_other</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; !<a class="code" href="../../d5/d16/group__netsock.html#ga6f158d48c8168947b0fef56f8bc52747">ep_eq</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a38f9df430deb5db9891b42147ef7a69e">b_other</a>, &amp;<a class="code" href="../../df/ded/ut_2fd_8c.html#aac62f57bd247b8b9b145f09eef0e6e09">src</a>-&gt;bd_addr)){</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;                result = <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPROTO);</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (memcmp(&amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#aebfa795c2499f9ffbb7391dbfc94981e">b_peer</a>, <a class="code" href="../../df/ded/ut_2fd_8c.html#aac62f57bd247b8b9b145f09eef0e6e09">src</a>, <span class="keyword">sizeof</span> *<a class="code" href="../../df/ded/ut_2fd_8c.html#aac62f57bd247b8b9b145f09eef0e6e09">src</a>)) {</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;                result = <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPROTO);</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../df/df3/group__bitmap.html#ga0e2870d0310664efdf37a687856a5605">m0_bitmap_get</a>(&amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a65bbee1059773d953d6c79dd44b04401">b_done</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_idx)) {</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;                result = <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPROTO);</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;        }</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;        <span class="keywordflow">return</span> result;</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;}</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;</div><div class="line"><a name="l02883"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga31831f32963572f54a3bc7d9fbe848cc"> 2883</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga31831f32963572f54a3bc7d9fbe848cc">buf_fini</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dd0/structbuf.html">buf</a> *<a class="code" href="../../d9/dd0/structbuf.html">buf</a>)</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;{</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga023f04699c602a061ce4d4353e71c78a">mover_fini</a>(&amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#ae21aab4029adf5ae3070f4379195d157">b_writer</a>);</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;        b_tlink_fini(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>);</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a65bbee1059773d953d6c79dd44b04401">b_done</a>.<a class="code" href="../../d9/d78/structm0__bitmap.html#a0a00837f749849ca259b96b56f3c6d46">b_words</a> &gt; 0)</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;                <a class="code" href="../../df/df3/group__bitmap.html#ga0bd81180cdf7ef9abfb814a99fd9377a">m0_bitmap_fini</a>(&amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a65bbee1059773d953d6c79dd44b04401">b_done</a>);</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a38f9df430deb5db9891b42147ef7a69e">b_other</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#ga2ca93efdb493d25d0eabb1d9722070c0">EP_PUT</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a38f9df430deb5db9891b42147ef7a69e">b_other</a>, <a class="code" href="../../d9/dd0/structbuf.html">buf</a>);</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;                <a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a38f9df430deb5db9891b42147ef7a69e">b_other</a> = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;        }</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;        <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae0d2e870ac085d7b16c48c2c52765009">M0_SET0</a>(&amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#aebfa795c2499f9ffbb7391dbfc94981e">b_peer</a>);</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;        <a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a85f97c6e705fc8e0e25da5b8b7ef2824">b_offset</a> = 0;</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;        <a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a1fad047c5710429941a570879286459f">b_length</a> = 0;</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;        <a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#ae21aab4029adf5ae3070f4379195d157">b_writer</a>.<a class="code" href="../../d1/d99/structmover.html#a92dce5c08e4c69047f6eed9aa16b4d34">m_sm</a>.<a class="code" href="../../db/d49/structm0__sm.html#aae17393da3a8b1f9d299b515a73cd954">sm_rc</a> = 0;</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;}</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;</div><div class="line"><a name="l02900"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga901a7c7ecafb57cbf6885b57b9272e34"> 2900</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga901a7c7ecafb57cbf6885b57b9272e34">buf_done</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dd0/structbuf.html">buf</a> *<a class="code" href="../../d9/dd0/structbuf.html">buf</a>, <span class="keywordtype">int</span> <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a>)</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;{</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a> = <a class="code" href="../../d5/d16/group__netsock.html#gafea137fe2248694702f66bd158c45022">buf_ma</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>);</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gaea9acfa0baa7ea23380d77247e9894d6">ma_is_locked</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>) &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>) &amp;&amp; <a class="code" href="../../d5/d16/group__netsock.html#gaca062f63e8a27154bb6e046504692bc9">buf_invariant</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>));</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;        <span class="comment">/*printf(&quot;done: %p[%i] %&quot; PRIi64 &quot; %i\n&quot;, buf,</span></div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;<span class="comment">               buf-&gt;b_buf != NULL ? buf-&gt;b_buf-&gt;nb_qtype : -1,</span></div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;<span class="comment">               buf-&gt;b_buf != NULL ? buf-&gt;b_buf-&gt;nb_length : -1, rc); */</span></div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#ae21aab4029adf5ae3070f4379195d157">b_writer</a>.<a class="code" href="../../d1/d99/structmover.html#a92dce5c08e4c69047f6eed9aa16b4d34">m_sm</a>.<a class="code" href="../../db/d49/structm0__sm.html#aae17393da3a8b1f9d299b515a73cd954">sm_rc</a> == 0) <span class="comment">/* Reuse this field for result. */</span></div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;                <a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#ae21aab4029adf5ae3070f4379195d157">b_writer</a>.<a class="code" href="../../d1/d99/structmover.html#a92dce5c08e4c69047f6eed9aa16b4d34">m_sm</a>.<a class="code" href="../../db/d49/structm0__sm.html#aae17393da3a8b1f9d299b515a73cd954">sm_rc</a> = <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a>;</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;<span class="comment">         * Multiple buf_done() calls on the same buffer are possible if the</span></div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;<span class="comment">         * buffer is cancelled.</span></div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;        <span class="keywordflow">if</span> (!b_tlink_is_in(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>)) {</div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;                <span class="comment">/* Try to finalise. */</span></div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../da/dd8/group__thread.html#ga85ed595f0d7052f5db6639321564161b">m0_thread_self</a>() == &amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#a8d69a44fe8c21a67f1e6c63253a7824e">t_poller</a>)</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;                        <a class="code" href="../../d5/d16/group__netsock.html#gaad5bbb2a3b9939c8f2b9ee3cdb43849a">buf_complete</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>);</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;                        <span class="comment">/* Otherwise, postpone finalisation to ma_buf_done(). */</span></div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;                        b_tlist_add_tail(&amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ac99334eddbdd3038853049e49ba745dd">t_done</a>, <a class="code" href="../../d9/dd0/structbuf.html">buf</a>);</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;        }</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;}</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;</div><div class="line"><a name="l02925"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaad5bbb2a3b9939c8f2b9ee3cdb43849a"> 2925</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gaad5bbb2a3b9939c8f2b9ee3cdb43849a">buf_complete</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/dd0/structbuf.html">buf</a> *<a class="code" href="../../d9/dd0/structbuf.html">buf</a>)</div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;{</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>  = <a class="code" href="../../d5/d16/group__netsock.html#gafea137fe2248694702f66bd158c45022">buf_ma</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>);</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d9/d7e/structm0__net__buffer.html">m0_net_buffer</a> *nb = <a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a11ed429feb7ad22be45284e8055fe465">b_buf</a>;</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../db/d0c/structm0__net__buffer__event.html">m0_net_buffer_event</a> ev = {</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;                .<a class="code" href="../../db/d0c/structm0__net__buffer__event.html#a148f11166aa7f66f018aaf3d75dad81f">nbe_buffer</a> = nb,</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;                .nbe_status = <a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#ae21aab4029adf5ae3070f4379195d157">b_writer</a>.<a class="code" href="../../d1/d99/structmover.html#a92dce5c08e4c69047f6eed9aa16b4d34">m_sm</a>.<a class="code" href="../../db/d49/structm0__sm.html#aae17393da3a8b1f9d299b515a73cd954">sm_rc</a>,</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;                .nbe_time   = <a class="code" href="../../d9/d7d/group__time.html#ga793cbf6341b841b090d83d0dea2993fa">m0_time_now</a>()</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;        };</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;        <span class="keywordflow">if</span> (M0_IN(nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#afacc91b5275a95609cdf10a1568f9a19">nb_qtype</a>, (<a class="code" href="../../d9/dd2/group__net.html#gga4a25e727e622f7aaaedfe8ffa01fa005aa95a74f1b59dffb048013e381c4f6733">M0_NET_QT_MSG_RECV</a>,</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;                                 <a class="code" href="../../d9/dd2/group__net.html#gga4a25e727e622f7aaaedfe8ffa01fa005a333d129741296b1e7280906adb4b097e">M0_NET_QT_PASSIVE_BULK_RECV</a>,</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;                                 <a class="code" href="../../d9/dd2/group__net.html#gga4a25e727e622f7aaaedfe8ffa01fa005ae7cb093e47fc16794e9639d47a19a300">M0_NET_QT_ACTIVE_BULK_RECV</a>))) {</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;                ev.<a class="code" href="../../db/d0c/structm0__net__buffer__event.html#aca84768232b6c1bee823c636806391fe">nbe_length</a> = <a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a1fad047c5710429941a570879286459f">b_length</a>;</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;        }</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;        <span class="keywordflow">if</span> (nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#afacc91b5275a95609cdf10a1568f9a19">nb_qtype</a> == <a class="code" href="../../d9/dd2/group__net.html#gga4a25e727e622f7aaaedfe8ffa01fa005aa95a74f1b59dffb048013e381c4f6733">M0_NET_QT_MSG_RECV</a>) {</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;                <span class="keywordflow">if</span> (ev.<a class="code" href="../../db/d0c/structm0__net__buffer__event.html#a7776fd9f3f2ce6d0635e571ccf7374d4">nbe_status</a> == 0 &amp;&amp; <a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a38f9df430deb5db9891b42147ef7a69e">b_other</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;                        ev.<a class="code" href="../../db/d0c/structm0__net__buffer__event.html#a58518ab93e41d0d78e75ca97305f05e6">nbe_ep</a> = &amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a38f9df430deb5db9891b42147ef7a69e">b_other</a>-&gt;<a class="code" href="../../da/da7/structep.html#a3851e3d045cfdff109ee4c7c69b1e9b8">e_ep</a>;</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;                        <a class="code" href="../../d5/d16/group__netsock.html#ga7da4b8d0066b704056c040ddd9845aa7">EP_GET</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a38f9df430deb5db9891b42147ef7a69e">b_other</a>, find);</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;                }</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;                ev.<a class="code" href="../../db/d0c/structm0__net__buffer__event.html#a51e035eb76ce452d07baba911e6b969d">nbe_offset</a> = 0; <span class="comment">/* Starting offset not supported. */</span></div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;        }</div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;        <a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#ac25a898a8ec2a7d4876cdd9ee7e5a19d">ntm_callback_counter</a>++;</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;        <span class="comment">/*printf(&quot;DONE: %p[%i] %&quot; PRIi64 &quot; %i\n&quot;, buf,</span></div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;<span class="comment">          buf-&gt;b_buf != NULL ? buf-&gt;b_buf-&gt;nb_qtype : -1,</span></div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;<span class="comment">          buf-&gt;b_length, ev.nbe_status); */</span></div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga69dcfba03c6d43734c25d912a4f2288c">TLOG</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga275ae63e03470896123e2a44fbd06c1d">B_F</a><span class="stringliteral">&quot; nb: %p %i&quot;</span>, <a class="code" href="../../d5/d16/group__netsock.html#ga1cd83a8f97b7d63bd601f3d1fe184d67">B_P</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>), <a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a11ed429feb7ad22be45284e8055fe465">b_buf</a>, ev.<a class="code" href="../../db/d0c/structm0__net__buffer__event.html#a7776fd9f3f2ce6d0635e571ccf7374d4">nbe_status</a>);</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;<span class="comment">         * It&#39;s ok to clear buf state, because sock doesn&#39;t support</span></div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;<span class="comment">         * M0_NET_BUF_RETAIN flag and the buffer will be unqueued</span></div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;<span class="comment">         * unconditionally.</span></div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga31831f32963572f54a3bc7d9fbe848cc">buf_fini</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>);</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>));</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gac11937bd71bc58ad75da8f7973aa3ddf">ma_unlock</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;        <a class="code" href="../../d9/dd2/group__net.html#gaff7a97dce21f4689aba444caaf0dc00b">m0_net_buffer_event_post</a>(&amp;ev);</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga14e6c41476564f25463e5b82fb17454f">ma_lock</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>);</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>));</div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(M0_IN(<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#a4fde71affafb898e2a3f4d8153cea8d1">ntm_state</a>, (<a class="code" href="../../d9/dd2/group__net.html#ggaaa9dbf6c20e7f07dfe6fc3746f6183e2abbe89cdedac94d27fe1eeb53c4a82ffe">M0_NET_TM_STARTED</a>,</div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;                                              <a class="code" href="../../d9/dd2/group__net.html#ggaaa9dbf6c20e7f07dfe6fc3746f6183e2a39b6318d195085ad1ec281a72d6cc70d">M0_NET_TM_STOPPING</a>)));</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;        <a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#ac25a898a8ec2a7d4876cdd9ee7e5a19d">ntm_callback_counter</a>--;</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;}</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;</div><div class="line"><a name="l02969"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gac04519716eaedbe76c2c3cc947eff2f6"> 2969</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gac04519716eaedbe76c2c3cc947eff2f6">bdesc_create</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *<a class="code" href="../../d9/db9/structaddr.html">addr</a>, <span class="keyword">struct</span> <a class="code" href="../../d9/dd0/structbuf.html">buf</a> *<a class="code" href="../../d9/dd0/structbuf.html">buf</a>,</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;                        <span class="keyword">struct</span> <a class="code" href="../../d0/db8/structm0__net__buf__desc.html">m0_net_buf_desc</a> *<a class="code" href="../../dd/d6d/group__xcode.html#ga50fe33eaae68b43814656f241a6ac907">out</a>)</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;{</div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d5/d0e/structbdesc.html">bdesc</a> bd = { .<a class="code" href="../../d5/d0e/structbdesc.html#a3c935369999fdd23bd11054c19df4703">bd_addr</a> = *<a class="code" href="../../d9/db9/structaddr.html">addr</a> };</div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;</div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;        <a class="code" href="../../da/dd3/group__cookie.html#ga289890e8cb6e9317bf3b0ed7dc44076b">m0_cookie_init</a>(&amp;bd.<a class="code" href="../../d5/d0e/structbdesc.html#a34dcb14937ab90ea7bd8ae288a9418d2">bd_cookie</a>, &amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a29fb49838c5d9685aa56e9c32c0dab54">b_cookie</a>);</div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#ga13c610ec12e0a3b29cec26487f5651ab">bdesc_encode</a>(&amp;bd, <a class="code" href="../../dd/d6d/group__xcode.html#ga50fe33eaae68b43814656f241a6ac907">out</a>);</div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;}</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;</div><div class="line"><a name="l02978"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga13c610ec12e0a3b29cec26487f5651ab"> 2978</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga13c610ec12e0a3b29cec26487f5651ab">bdesc_encode</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d5/d0e/structbdesc.html">bdesc</a> *bd, <span class="keyword">struct</span> <a class="code" href="../../d0/db8/structm0__net__buf__desc.html">m0_net_buf_desc</a> *<a class="code" href="../../dd/d6d/group__xcode.html#ga50fe33eaae68b43814656f241a6ac907">out</a>)</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;{</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;        <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> len;</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;        <span class="keywordtype">int</span>         result;</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;        <span class="comment">/* Cannot pass &amp;out-&gt;nbd_len below, as it is 32 bits. */</span></div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;        result = <a class="code" href="../../dd/d6d/group__xcode.html#ga5a25acd32d709d7f330cecebb563217e">m0_xcode_obj_enc_to_buf</a>(&amp;<a class="code" href="../../dd/d6d/group__xcode.html#ga0733e26f11171dd0d95568ca3c104cd1">M0_XCODE_OBJ</a>(bdesc_xc, (<span class="keywordtype">void</span> *)bd),</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;                                         (<span class="keywordtype">void</span> **)&amp;<a class="code" href="../../dd/d6d/group__xcode.html#ga50fe33eaae68b43814656f241a6ac907">out</a>-&gt;nbd_data, &amp;len);</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;        <span class="keywordflow">if</span> (result == 0)</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;                <a class="code" href="../../dd/d6d/group__xcode.html#ga50fe33eaae68b43814656f241a6ac907">out</a>-&gt;nbd_len = len;</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;                <a class="code" href="../../d7/ded/group__memory.html#ga09f97acbce99e3114130a74a59062b2c">m0_free0</a>(&amp;<a class="code" href="../../dd/d6d/group__xcode.html#ga50fe33eaae68b43814656f241a6ac907">out</a>-&gt;nbd_data);</div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a9a02a790ad457506f9f3bc12121e6079">M0_RC</a>(result);</div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;}</div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;</div><div class="line"><a name="l02993"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga765e88256787793065e7620d01449d4d"> 2993</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga765e88256787793065e7620d01449d4d">bdesc_decode</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d0/db8/structm0__net__buf__desc.html">m0_net_buf_desc</a> *nbd, <span class="keyword">struct</span> <a class="code" href="../../d5/d0e/structbdesc.html">bdesc</a> *<a class="code" href="../../dd/d6d/group__xcode.html#ga50fe33eaae68b43814656f241a6ac907">out</a>)</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;{</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dd/d6d/group__xcode.html#ga15975ac0389baacc96abf5cb25c61d6d">m0_xcode_obj_dec_from_buf</a>(&amp;<a class="code" href="../../dd/d6d/group__xcode.html#ga0733e26f11171dd0d95568ca3c104cd1">M0_XCODE_OBJ</a>(bdesc_xc, <a class="code" href="../../dd/d6d/group__xcode.html#ga50fe33eaae68b43814656f241a6ac907">out</a>),</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;                                         nbd-&gt;<a class="code" href="../../d0/db8/structm0__net__buf__desc.html#a78814b06c233d6ed4e5f933f4c444cd7">nbd_data</a>, nbd-&gt;<a class="code" href="../../d0/db8/structm0__net__buf__desc.html#ae6384407df6be15e382ed78aa0e15473">nbd_len</a>);</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;}</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;</div><div class="line"><a name="l02999"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga429999edeace62099ef3af8bd784d97d"> 2999</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga429999edeace62099ef3af8bd784d97d">mover_init</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>,</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;                       <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d3/d91/structmover__op__vec.html">mover_op_vec</a> *vop)</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;{</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_sm.sm_conf == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;        <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae0d2e870ac085d7b16c48c2c52765009">M0_SET0</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>);</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;        m_tlink_init(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>);</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;        <a class="code" href="../../d1/dc1/group__sm.html#gada087b0429614bfb575369ff95deb31b">m0_sm_init</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_sm, &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga5f25f2a8c8e86982bd9c99b99cb97b4e">rw_conf</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a63581c61e8680cb3c6be0310a4e19e81">R_IDLE</a>, &amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#a65dc683b82f708154ef6debc8b2a7629">ntm_group</a>);</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;        <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_op = vop;</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#aea86d55595126b703b9e619887f09a22">M0_POST</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga4d04d2d80f14221e812b0d455d4639c9">mover_invariant</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>));</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;}</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;</div><div class="line"><a name="l03010"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga023f04699c602a061ce4d4353e71c78a"> 3010</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga023f04699c602a061ce4d4353e71c78a">mover_fini</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>)</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;{</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_sm.sm_conf != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) { <span class="comment">/* Must be idempotent. */</span></div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;                <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga4d04d2d80f14221e812b0d455d4639c9">mover_invariant</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>));</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_sm.sm_state != <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a1bd27bf23812341749c87673d015d3ac">R_DONE</a>)</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;                        <a class="code" href="../../d1/dc1/group__sm.html#ga44ae6c237c23107f3a9c5b9202582416">m0_sm_state_set</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_sm, <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a1bd27bf23812341749c87673d015d3ac">R_DONE</a>);</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;                <a class="code" href="../../d1/dc1/group__sm.html#ga22cf05c6937b3cea98367c6c8fc85600">m0_sm_fini</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_sm);</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;                <span class="keywordflow">if</span> (m_tlink_is_in(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>)) {</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;                        m_tlist_del(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>);</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;                        <a class="code" href="../../d5/d16/group__netsock.html#ga2ca93efdb493d25d0eabb1d9722070c0">EP_PUT</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_ep, <a class="code" href="../../d1/d99/structmover.html">mover</a>);</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;                        <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_ep = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;                }</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;                m_tlink_fini(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>);</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;                <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae0d2e870ac085d7b16c48c2c52765009">M0_SET0</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_pk);</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;                <a class="code" href="../../d7/ded/group__memory.html#ga09f97acbce99e3114130a74a59062b2c">m0_free0</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_scratch);</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;                <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_sm.sm_conf = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;        }</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;}</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;</div><div class="line"><a name="l03056"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga7b643699db61d5c148110d150136c16a"> 3056</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga7b643699db61d5c148110d150136c16a">mover_op</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <span class="keywordtype">int</span> <a class="code" href="../../d3/d1b/libdemo_8c.html#a99a30df0f2488360cdd46b4b88e5f5f0">op</a>)</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;{</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;        <span class="keywordtype">int</span> state = <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_sm.sm_state;</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../df/d2a/lib_2misc_8h.html#a3a6a6708976cdeb3aec96b1d2545bd8d">IS_IN_ARRAY</a>(state, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_op-&gt;v_op));</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../df/d2a/lib_2misc_8h.html#a3a6a6708976cdeb3aec96b1d2545bd8d">IS_IN_ARRAY</a>(<a class="code" href="../../d3/d1b/libdemo_8c.html#a99a30df0f2488360cdd46b4b88e5f5f0">op</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_op-&gt;v_op[state]));</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_sm.sm_conf != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga4d04d2d80f14221e812b0d455d4639c9">mover_invariant</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>));</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;<span class="comment">         * @todo This can monopolise processor doing state transitions for the</span></div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;<span class="comment">         * same mover (i.e., continuous stream of data from the same remote</span></div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;<span class="comment">         * end-point). Consider breaking out of this loop after some number of</span></div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;<span class="comment">         * iterations or bytes ioed.</span></div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;        <span class="keywordflow">while</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_flags &amp; <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae644c20b9d43e4e0810716647b3d16be">M0_BITS</a>(<a class="code" href="../../d3/d1b/libdemo_8c.html#a99a30df0f2488360cdd46b4b88e5f5f0">op</a>) || !<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_op-&gt;v_op[state][<a class="code" href="../../d3/d1b/libdemo_8c.html#a99a30df0f2488360cdd46b4b88e5f5f0">op</a>].o_doesio) {</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;                <a class="code" href="../../d8/d98/group__trace.html#gabf13f904bc760a195c4e3b75fa471f58">M0_LOG</a>(<a class="code" href="../../d8/d98/group__trace.html#gga222dfe20eda8c002fbab0ebbb2a7848ba8d2169c7a189138ea53e05ce2c558d4f">M0_DEBUG</a>, <span class="stringliteral">&quot;Got %s: state: %x, op: %x.&quot;</span>,</div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;                       <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_op-&gt;v_name, state, <a class="code" href="../../d3/d1b/libdemo_8c.html#a99a30df0f2488360cdd46b4b88e5f5f0">op</a>);</div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;                <span class="keywordflow">if</span> (state == <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a1bd27bf23812341749c87673d015d3ac">R_DONE</a>) {</div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_op-&gt;v_done != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;                                <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_op-&gt;v_done(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;                                <a class="code" href="../../d5/d16/group__netsock.html#ga023f04699c602a061ce4d4353e71c78a">mover_fini</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>);</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_sm.sm_state != <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaa86daa3f2c345452a3235108d80ad8aa">S_OPEN</a>) {</div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_op-&gt;v_op[state][<a class="code" href="../../d3/d1b/libdemo_8c.html#a99a30df0f2488360cdd46b4b88e5f5f0">op</a>].o_op == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;                        state = -EPROTO;</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../d3/d1b/libdemo_8c.html#a99a30df0f2488360cdd46b4b88e5f5f0">op</a> != <a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca207d824841acf342e7184b3d3fc5996b">M_CLOSE</a>) <span class="comment">/* Ignore unexpected events. */</span></div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;                } <span class="keywordflow">else</span></div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;                        state = <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_op-&gt;v_op[state][<a class="code" href="../../d3/d1b/libdemo_8c.html#a99a30df0f2488360cdd46b4b88e5f5f0">op</a>].o_op(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;                <span class="comment">/*</span></div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;<span class="comment">                 * printf(&quot;... %p: %s -&gt; %s (%p)\n&quot;,</span></div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;<span class="comment">                 *        m, rw_name[m-&gt;m_sm.sm_state],</span></div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;<span class="comment">                 *        state &gt;= 0 ? rw_name[state] : strerror(-state),</span></div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;<span class="comment">                 *        m-&gt;m_buf);</span></div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;<span class="comment">                 */</span></div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;                <span class="keywordflow">if</span> (state &gt;= 0) {</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;                        <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(<a class="code" href="../../df/d2a/lib_2misc_8h.html#a3a6a6708976cdeb3aec96b1d2545bd8d">IS_IN_ARRAY</a>(state, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_op-&gt;v_op));</div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;                        <a class="code" href="../../d1/dc1/group__sm.html#ga44ae6c237c23107f3a9c5b9202582416">m0_sm_state_set</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_sm, state);</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;                        <span class="keywordflow">if</span> (state == -ENOBUFS) <span class="comment">/* Unwind and re-provision. */</span></div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;                        <a class="code" href="../../d1/dc1/group__sm.html#ga44ae6c237c23107f3a9c5b9202582416">m0_sm_state_set</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_sm, <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a575df14f8416f291b63a463ddaa1c37f">R_FAIL</a>);</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_op-&gt;v_error != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;                                <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_op-&gt;v_error(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, state);</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;                        <a class="code" href="../../d1/dc1/group__sm.html#ga44ae6c237c23107f3a9c5b9202582416">m0_sm_state_set</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_sm, <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a1bd27bf23812341749c87673d015d3ac">R_DONE</a>);</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;                        <a class="code" href="../../d5/d16/group__netsock.html#ga2c304ecfc57668f0196522601f103071">stype</a>[<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_ep-&gt;e_a.a_socktype].<a class="code" href="../../d7/d2a/structsocktype.html#a1e8391986d046d379abbba78f51fd2eb">st_error</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;                }</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;                state = <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_sm.sm_state;</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;        }</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;        <span class="keywordflow">return</span> state;</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;}</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;</div><div class="line"><a name="l03110"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gad1278e0c872e51530c6943d527e786a3"> 3110</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#gad1278e0c872e51530c6943d527e786a3">mover_is_reader</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>)</div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;{</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;        <span class="keywordflow">return</span> !<a class="code" href="../../d5/d16/group__netsock.html#ga02f3f80057e9c21bfbdf4993dc6ba169">mover_is_writer</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>);</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;}</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;</div><div class="line"><a name="l03115"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga02f3f80057e9c21bfbdf4993dc6ba169"> 3115</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="../../d5/d16/group__netsock.html#ga02f3f80057e9c21bfbdf4993dc6ba169">mover_is_writer</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>)</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;{</div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;        <span class="keywordflow">return</span> M0_IN(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_op, (&amp;<a class="code" href="../../d5/d16/group__netsock.html#gaaea8f9114f06faf1285bfd1bd5c6da3b">writer_op</a>, &amp;<a class="code" href="../../d5/d16/group__netsock.html#gaa3f97a589c8ebf7495ac65e2efd70f67">get_op</a>));</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;}</div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;</div><div class="line"><a name="l03126"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga0783c9a92d6de5ed67d4e9c382001d5d"> 3126</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d5/d16/group__netsock.html#ga0783c9a92d6de5ed67d4e9c382001d5d">pk_size</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;{</div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#ga2c304ecfc57668f0196522601f103071">stype</a>[<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_ep-&gt;e_a.a_socktype].<a class="code" href="../../d7/d2a/structsocktype.html#a0cbbaff8fcbc9fc999d25b371502fc3f">st_pk_size</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;}</div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;</div><div class="line"><a name="l03132"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga08a2e9fc0c071a8d9af463180a71fd54"> 3132</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d5/d16/group__netsock.html#ga08a2e9fc0c071a8d9af463180a71fd54">pk_tsize</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>)</div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;{</div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">sizeof</span> <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_pkbuf + <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_pk.p_size;</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;}</div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;</div><div class="line"><a name="l03140"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaf7d93c09d009488be1e33a3fb74e45a9"> 3140</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d5/d16/group__netsock.html#gaf7d93c09d009488be1e33a3fb74e45a9">pk_dnob</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>)</div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;{</div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/dc9/group__arith.html#gaf09a62ac732850ebc8fb6c6e997a1ed7">max64</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_nob - <span class="keyword">sizeof</span> <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_pkbuf, 0);</div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;}</div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;</div><div class="line"><a name="l03151"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gab2a4957b29b0ff2f9b6abec6b37d71a6"> 3151</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gab2a4957b29b0ff2f9b6abec6b37d71a6">pk_state</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>)</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;{</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;        <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> nob = <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_nob;</div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;</div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;        <span class="keywordflow">if</span> (nob &lt; sizeof m-&gt;m_pkbuf)</div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a>;</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nob &lt; <a class="code" href="../../d5/d16/group__netsock.html#ga08a2e9fc0c071a8d9af463180a71fd54">pk_tsize</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>))</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a943628239c02f3d0241ca831508900b5">R_INTERVAL</a>;</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;                <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(nob == <a class="code" href="../../d5/d16/group__netsock.html#ga08a2e9fc0c071a8d9af463180a71fd54">pk_tsize</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>));</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a502dbd83cd4018628e13bcba822ce710">R_PK_DONE</a>;</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;        }</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;}</div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;</div><div class="line"><a name="l03177"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga2158d30690db2c9459c9a9226d9d15aa"> 3177</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga2158d30690db2c9459c9a9226d9d15aa">pk_iov_prep</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <span class="keyword">struct</span> iovec *iv, <span class="keywordtype">int</span> <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a>,</div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;                       <span class="keyword">struct</span> <a class="code" href="../../da/d2c/structm0__bufvec.html">m0_bufvec</a> *bv, <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../df/ded/ut_2fd_8c.html#a71c20dda6f28285e2e67284efccaf3dc">tgt</a>, <span class="keywordtype">int</span> *<a class="code" href="../../d6/d0c/ut_2xcode_8c.html#a5f7d24ded17bf1ab44fdadf38c54a8b5">count</a>)</div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;{</div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d5/d06/structm0__bufvec__cursor.html">m0_bufvec_cursor</a> <a class="code" href="../../d0/d9e/group__addb2.html#ga7be2f145dc9b5b3220c69a52f0409b25">cur</a>;</div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;        <span class="keywordtype">int</span>                     idx;</div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;</div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a> &gt; 0);</div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../df/ded/ut_2fd_8c.html#a71c20dda6f28285e2e67284efccaf3dc">tgt</a> &gt;= <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_nob);</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../df/ded/ut_2fd_8c.html#a71c20dda6f28285e2e67284efccaf3dc">tgt</a> &gt;= <span class="keyword">sizeof</span> <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_pkbuf); <span class="comment">/* For simplicity assume the entire</span></div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;<span class="comment">                                             header is always ioed. */</span></div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_nob &lt; <span class="keyword">sizeof</span> <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_pkbuf) { <span class="comment">/* Cannot use pk_state(): header can</span></div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;<span class="comment">                                               be unintialised for reads. */</span></div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;                iv[0].iov_base = &amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_pkbuf[<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_nob];</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;                *<a class="code" href="../../d6/d0c/ut_2xcode_8c.html#a5f7d24ded17bf1ab44fdadf38c54a8b5">count</a> = iv[0].iov_len = <span class="keyword">sizeof</span> <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_pkbuf - <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_nob;</div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;                idx = 1;</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;                *<a class="code" href="../../d6/d0c/ut_2xcode_8c.html#a5f7d24ded17bf1ab44fdadf38c54a8b5">count</a> = 0;</div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;                idx = 0;</div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;        }</div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../df/ded/ut_2fd_8c.html#a71c20dda6f28285e2e67284efccaf3dc">tgt</a> == <span class="keyword">sizeof</span> <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_pkbuf) <span class="comment">/* Only header is ioed. */</span></div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;                <span class="keywordflow">return</span> idx;</div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;        <a class="code" href="../../d0/d7f/group__vec.html#ga25676feab636093b10797af188337efc">m0_bufvec_cursor_init</a>(&amp;<a class="code" href="../../d0/d9e/group__addb2.html#ga7be2f145dc9b5b3220c69a52f0409b25">cur</a>, bv);</div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;        <a class="code" href="../../d0/d7f/group__vec.html#ga0519cf756af050c693a2b1ddc67394ef">m0_bufvec_cursor_move</a>(&amp;<a class="code" href="../../d0/d9e/group__addb2.html#ga7be2f145dc9b5b3220c69a52f0409b25">cur</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_pk.p_offset + <a class="code" href="../../d5/d16/group__netsock.html#gaf7d93c09d009488be1e33a3fb74e45a9">pk_dnob</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>));</div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;        <span class="keywordflow">for</span> (; idx &lt; <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a> &amp;&amp; !<a class="code" href="../../d0/d7f/group__vec.html#ga0519cf756af050c693a2b1ddc67394ef">m0_bufvec_cursor_move</a>(&amp;<a class="code" href="../../d0/d9e/group__addb2.html#ga7be2f145dc9b5b3220c69a52f0409b25">cur</a>, 0); ++idx) {</div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;                <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> frag = <a class="code" href="../../d0/d7f/group__vec.html#gad481d7c4ffe49912e0cca7c0262baa0b">m0_bufvec_cursor_step</a>(&amp;<a class="code" href="../../d0/d9e/group__addb2.html#ga7be2f145dc9b5b3220c69a52f0409b25">cur</a>);</div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;                frag = <a class="code" href="../../db/dc9/group__arith.html#ga3ab271ddef8d2ab1ee331f95138294b5">min64u</a>(frag, <a class="code" href="../../df/ded/ut_2fd_8c.html#a71c20dda6f28285e2e67284efccaf3dc">tgt</a> - <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_nob - *<a class="code" href="../../d6/d0c/ut_2xcode_8c.html#a5f7d24ded17bf1ab44fdadf38c54a8b5">count</a>);</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;                <span class="keywordflow">if</span> (frag == 0)</div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;                iv[idx].iov_base = <a class="code" href="../../d0/d7f/group__vec.html#gae76766a88069edeffeb892b1efe79d09">m0_bufvec_cursor_addr</a>(&amp;<a class="code" href="../../d0/d9e/group__addb2.html#ga7be2f145dc9b5b3220c69a52f0409b25">cur</a>);</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;                *<a class="code" href="../../d6/d0c/ut_2xcode_8c.html#a5f7d24ded17bf1ab44fdadf38c54a8b5">count</a> += (iv[idx].iov_len = frag);</div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;                <a class="code" href="../../d0/d7f/group__vec.html#ga0519cf756af050c693a2b1ddc67394ef">m0_bufvec_cursor_move</a>(&amp;<a class="code" href="../../d0/d9e/group__addb2.html#ga7be2f145dc9b5b3220c69a52f0409b25">cur</a>, frag);</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;        }</div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#aea86d55595126b703b9e619887f09a22">M0_POST</a>(m0_reduce(<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>, idx, 0ULL, + iv[<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>].iov_len) == *<a class="code" href="../../d6/d0c/ut_2xcode_8c.html#a5f7d24ded17bf1ab44fdadf38c54a8b5">count</a>);</div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#aea86d55595126b703b9e619887f09a22">M0_POST</a>(idx &gt; 0); <span class="comment">/* Check that there is some progress. */</span></div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;        <span class="keywordflow">return</span> idx;</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;}</div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;</div><div class="line"><a name="l03222"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga643216df42cd41316bad263fdcf690ad"> 3222</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga643216df42cd41316bad263fdcf690ad">pk_io</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, uint64_t <a class="code" href="../../d2/d66/group__dtm.html#ga8b3ab54ed3e81c69863d65e4e6c424a0">flag</a>,</div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;                 <span class="keyword">struct</span> <a class="code" href="../../da/d2c/structm0__bufvec.html">m0_bufvec</a> *bv, <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../df/ded/ut_2fd_8c.html#a71c20dda6f28285e2e67284efccaf3dc">tgt</a>)</div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;{</div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;        <span class="keyword">struct </span>iovec iv[256] = {};</div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;        <span class="keywordtype">int</span>          <a class="code" href="../../d6/d0c/ut_2xcode_8c.html#a5f7d24ded17bf1ab44fdadf38c54a8b5">count</a>;</div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;        <span class="keywordtype">int</span>          <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a>;</div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;        <span class="keywordtype">int</span>          <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a>;</div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;</div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(M0_IN(<a class="code" href="../../d2/d66/group__dtm.html#ga8b3ab54ed3e81c69863d65e4e6c424a0">flag</a>, (<a class="code" href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39a7418706169c4419c7ceb4553a8416673">HAS_READ</a>, <a class="code" href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39afd7faf6c636cbc6f3d3cc0683c0584dc">HAS_WRITE</a>)));</div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;        <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a> = <a class="code" href="../../d5/d16/group__netsock.html#ga2158d30690db2c9459c9a9226d9d15aa">pk_iov_prep</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, iv, <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a>(iv),</div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;                         bv ?: <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_buf != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ?</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;                         &amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_buf-&gt;b_buf-&gt;nb_buffer : <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/ded/ut_2fd_8c.html#a71c20dda6f28285e2e67284efccaf3dc">tgt</a>, &amp;<a class="code" href="../../d6/d0c/ut_2xcode_8c.html#a5f7d24ded17bf1ab44fdadf38c54a8b5">count</a>);</div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;        <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_flags &amp;= ~<a class="code" href="../../d2/d66/group__dtm.html#ga8b3ab54ed3e81c69863d65e4e6c424a0">flag</a>;</div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;        <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> = (<a class="code" href="../../d2/d66/group__dtm.html#ga8b3ab54ed3e81c69863d65e4e6c424a0">flag</a> == <a class="code" href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39a7418706169c4419c7ceb4553a8416673">HAS_READ</a> ? readv : writev)(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_fd, iv, <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a>);</div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;        <a class="code" href="../../d8/d98/group__trace.html#gabf13f904bc760a195c4e3b75fa471f58">M0_LOG</a>(<a class="code" href="../../d8/d98/group__trace.html#gga222dfe20eda8c002fbab0ebbb2a7848ba8d2169c7a189138ea53e05ce2c558d4f">M0_DEBUG</a>, <span class="stringliteral">&quot;flag: %&quot;</span> <a class="code" href="../../d2/de1/linux__kernel_2types_8h.html#ab8d0c29be4a0623c3de58011991e86e9">PRIi64</a> <span class="stringliteral">&quot;, rc: %i, idx: %i, errno: %i.&quot;</span>,</div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;               <a class="code" href="../../d2/d66/group__dtm.html#ga8b3ab54ed3e81c69863d65e4e6c424a0">flag</a>, <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a>, <a class="code" href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a>, errno);</div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> &gt;= 0) {</div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;                <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_nob += <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a>;</div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;                <span class="comment">/*</span></div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;<span class="comment">                 * If everything was ioed, the socket might have more space in</span></div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;<span class="comment">                 * the buffer, try to io some more.</span></div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;<span class="comment">                 */</span></div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;                <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_flags |= (<a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> == <a class="code" href="../../d6/d0c/ut_2xcode_8c.html#a5f7d24ded17bf1ab44fdadf38c54a8b5">count</a> ? <a class="code" href="../../d2/d66/group__dtm.html#ga8b3ab54ed3e81c69863d65e4e6c424a0">flag</a> : 0);</div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (errno == EWOULDBLOCK) { <span class="comment">/* Overshoot (see s_flags above). */</span></div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;                <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> = 0;</div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (errno == EINTR) { <span class="comment">/* Nothing was ioed, repeat. */</span></div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;                <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> = 0;</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;        } <span class="keywordflow">else</span></div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;                <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> = <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-errno);</div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;<span class="comment">         * printf(&quot;%s -&gt; %s, %p: flag: %&quot; PRIx64 &quot;, tgt: %&quot; PRIu64 &quot;, nob %&quot; PRIu64 &quot;,&quot;</span></div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;<span class="comment">         * &quot; nr: %i, count: %i, rc: %i, sflags: %&quot; PRIx64 &quot;\n&quot;,</span></div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;<span class="comment">         * ma_src(ep_ma(s-&gt;s_ep))-&gt;e_ep.nep_addr, s-&gt;s_ep-&gt;e_ep.nep_addr,</span></div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;<span class="comment">         * m, flag, tgt, m-&gt;m_nob, nr, count, rc, s-&gt;s_flags);</span></div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a>;</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;}</div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;</div><div class="line"><a name="l03261"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gad7ba5dff1c65580fa18971ea7decf804"> 3261</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gad7ba5dff1c65580fa18971ea7decf804">pk_header_init</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;{</div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../df/de8/structpacket.html">packet</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a> = &amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_pk;</div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;</div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../df/d2a/lib_2misc_8h.html#a5cdb9ee800461bf21629461944cc9cc1">M0_IS0</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_src.bd_cookie));</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga02f3f80057e9c21bfbdf4993dc6ba169">mover_is_writer</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>));</div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;        <a class="code" href="../../da/dd3/group__cookie.html#ga289890e8cb6e9317bf3b0ed7dc44076b">m0_cookie_init</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_src.bd_cookie, &amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_buf-&gt;b_cookie);</div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;        <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_src.bd_addr = <a class="code" href="../../d5/d16/group__netsock.html#gaab89d3e82371dfcccd5807a8762c2baa">ma_src</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga78251ee15fee7c0c5da7f01379891e47">ep_ma</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_ep))-&gt;<a class="code" href="../../da/da7/structep.html#a7fa38028a1ed8e0d494fc3d2f179a890">e_a</a>;</div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;        <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_dst         = <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_buf-&gt;b_peer;</div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;        <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_totalsize   = <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_buf-&gt;b_buf-&gt;nb_length;</div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#aea86d55595126b703b9e619887f09a22">M0_POST</a>(!<a class="code" href="../../df/d2a/lib_2misc_8h.html#a5cdb9ee800461bf21629461944cc9cc1">M0_IS0</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_dst));</div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;}</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;</div><div class="line"><a name="l03283"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gae0d835e5b33df4f26664af2f5c067f25"> 3283</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gae0d835e5b33df4f26664af2f5c067f25">pk_header_done</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>)</div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;{</div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../df/de8/structpacket.html">packet</a>       *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a> = &amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_pk;</div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d3/d99/structm0__format__tag.html">m0_format_tag</a> <a class="code" href="../../d0/d9e/group__addb2.html#ga3dd636d15d8f375bf0f0fb3c0505231f">tag</a>;</div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d8/dee/structma.html">ma</a>           *<a class="code" href="../../d8/dee/structma.html">ma</a> = <a class="code" href="../../d5/d16/group__netsock.html#ga78251ee15fee7c0c5da7f01379891e47">ep_ma</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_sock-&gt;s_ep);</div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;        <span class="keywordtype">int</span>                  result;</div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;        <span class="keywordtype">bool</span>                 isget;</div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;        <span class="keywordtype">bool</span>                 hassrc;</div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;        <span class="keywordtype">bool</span>                 hasdst;</div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d9/dd0/structbuf.html">buf</a>          *<a class="code" href="../../d9/dd0/structbuf.html">buf</a> = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;        uint64_t            *cookie;</div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;</div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_nob &gt;= <span class="keyword">sizeof</span> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>);</div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gad1278e0c872e51530c6943d527e786a3">mover_is_reader</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>));</div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;</div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gae6f42c83bbf4ab42da96adcb1aa02522">pk_decode</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>);</div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;        result = <a class="code" href="../../dd/dc1/group__format.html#ga855348e7fffce05eb9b2ce54891f0f9d">m0_format_footer_verify</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;        <span class="keywordflow">if</span> (result != 0)</div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(result);</div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;        <a class="code" href="../../dd/dc1/group__format.html#gaa8c1621ce128fe346c8e6bb5bd91c282">m0_format_header_unpack</a>(&amp;<a class="code" href="../../d0/d9e/group__addb2.html#ga3dd636d15d8f375bf0f0fb3c0505231f">tag</a>, &amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_header);</div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;        isget = memcmp(&amp;<a class="code" href="../../d0/d9e/group__addb2.html#ga3dd636d15d8f375bf0f0fb3c0505231f">tag</a>, &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga37552715ad676e57ef041ea8bf86616b">get_tag</a>, <span class="keyword">sizeof</span> <a class="code" href="../../d0/d9e/group__addb2.html#ga3dd636d15d8f375bf0f0fb3c0505231f">tag</a>) == 0;</div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;        <span class="keywordflow">if</span> (!isget &amp;&amp; memcmp(&amp;<a class="code" href="../../d0/d9e/group__addb2.html#ga3dd636d15d8f375bf0f0fb3c0505231f">tag</a>, &amp;<a class="code" href="../../d5/d16/group__netsock.html#gab9e8dc20b199a933933acfd3a5b0853f">put_tag</a>, <span class="keyword">sizeof</span> <a class="code" href="../../d0/d9e/group__addb2.html#ga3dd636d15d8f375bf0f0fb3c0505231f">tag</a>) != 0)</div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPROTO);</div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_idx &gt;= <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_nr)</div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPROTO);</div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_offset + <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_size &lt; <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_offset)</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EFBIG);</div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_offset + <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_size &gt; <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_totalsize)</div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPROTO);</div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_idx == 0 &amp;&amp; <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_offset != 0)</div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPROTO);</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_idx == <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_nr - 1 &amp;&amp;</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;            <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_offset + <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_size != <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_totalsize)</div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPROTO);</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d16/group__netsock.html#ga6f158d48c8168947b0fef56f8bc52747">ep_eq</a>(<a class="code" href="../../d5/d16/group__netsock.html#gaab89d3e82371dfcccd5807a8762c2baa">ma_src</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>), &amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_dst.bd_addr))</div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPROTO);</div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d16/group__netsock.html#gaa44e650cf8e69290b8b265d8e706c7f4">addr_eq</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_sock-&gt;s_ep-&gt;e_a, &amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_src.bd_addr))</div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPROTO);</div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;        hassrc = !<a class="code" href="../../df/d2a/lib_2misc_8h.html#a5cdb9ee800461bf21629461944cc9cc1">M0_IS0</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_src.bd_cookie);</div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;        hasdst = !<a class="code" href="../../df/d2a/lib_2misc_8h.html#a5cdb9ee800461bf21629461944cc9cc1">M0_IS0</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_dst.bd_cookie);</div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;        <span class="keywordflow">if</span> (!hassrc &amp;&amp; !hasdst)         <span class="comment">/* Go I know not whither */</span></div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPROTO); <span class="comment">/* and fetch I know not what? */</span></div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;        <span class="keywordflow">if</span> (hasdst) {</div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;                result = <a class="code" href="../../da/dd3/group__cookie.html#ga253606578697058d01448d06fdf5547c">m0_cookie_dereference</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_dst.bd_cookie, &amp;cookie);</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;                <span class="keywordflow">if</span> (result != 0)</div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="../../d8/d98/group__trace.html#gadcff472fb398402105feb7fa41add0a5">M0_ERR_INFO</a>(result,</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;                                           <span class="stringliteral">&quot;Wrong cookie: %&quot;</span> <a class="code" href="../../d2/de1/linux__kernel_2types_8h.html#aba38357387a474f439428dee1984fc5a">PRIx64</a> <span class="stringliteral">&quot;:%&quot;</span> <a class="code" href="../../d2/de1/linux__kernel_2types_8h.html#aba38357387a474f439428dee1984fc5a">PRIx64</a> <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;                                           <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_dst.bd_cookie.co_addr,</div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;                                           <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_dst.bd_cookie.co_generation);</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;                <a class="code" href="../../d9/dd0/structbuf.html">buf</a> = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#af8c317a42292b61c93aae91e59118a46">container_of</a>(cookie, <span class="keyword">struct</span> <a class="code" href="../../d9/dd0/structbuf.html">buf</a>, <a class="code" href="../../d9/dd0/structbuf.html#a29fb49838c5d9685aa56e9c32c0dab54">b_cookie</a>);</div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d5/d16/group__netsock.html#gafea137fe2248694702f66bd158c45022">buf_ma</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>) != <a class="code" href="../../d8/dee/structma.html">ma</a>)</div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPERM);</div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="../../df/d2a/lib_2misc_8h.html#a5cdb9ee800461bf21629461944cc9cc1">M0_IS0</a>(&amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#aebfa795c2499f9ffbb7391dbfc94981e">b_peer</a>) &amp;&amp;</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;                    memcmp(&amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#aebfa795c2499f9ffbb7391dbfc94981e">b_peer</a>, &amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_src, <span class="keyword">sizeof</span> <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_src) != 0)</div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPERM);</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;        }</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;        <span class="keywordflow">if</span> (isget) {</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_idx != 0 || <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_nr != 1 || <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_size != 0 ||</div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;                    <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_offset != 0 || !hasdst)</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPROTO);</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a11ed429feb7ad22be45284e8055fe465">b_buf</a>-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#afacc91b5275a95609cdf10a1568f9a19">nb_qtype</a> != <a class="code" href="../../d9/dd2/group__net.html#gga4a25e727e622f7aaaedfe8ffa01fa005a17e109851881bbe14310ace19d6335d1">M0_NET_QT_PASSIVE_BULK_SEND</a>)</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPERM);</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;                <a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#aebfa795c2499f9ffbb7391dbfc94981e">b_peer</a> = <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_src;</div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#ga429999edeace62099ef3af8bd784d97d">mover_init</a>(&amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#ae21aab4029adf5ae3070f4379195d157">b_writer</a>, <a class="code" href="../../d8/dee/structma.html">ma</a>, &amp;<a class="code" href="../../d5/d16/group__netsock.html#gaaea8f9114f06faf1285bfd1bd5c6da3b">writer_op</a>);</div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;                <a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#ae21aab4029adf5ae3070f4379195d157">b_writer</a>.<a class="code" href="../../d1/d99/structmover.html#a009dde470277f894204e183285891cca">m_buf</a> = <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a4b9218d5c001301e593c59b2f36f9d17">buf</a>;</div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;                result = <a class="code" href="../../d5/d16/group__netsock.html#ga45a84b5062bc213795304baca5b13f74">ep_add</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_sock-&gt;s_ep, &amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#ae21aab4029adf5ae3070f4379195d157">b_writer</a>);</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;                <span class="keywordflow">if</span> (result != 0)</div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;                        <a class="code" href="../../d5/d16/group__netsock.html#ga901a7c7ecafb57cbf6885b57b9272e34">buf_done</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>, result);</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a63581c61e8680cb3c6be0310a4e19e81">R_IDLE</a>;</div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;        }</div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;        <span class="keywordflow">if</span> (!hasdst) {</div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;                <span class="comment">/* Select a buffer from the receive queue. */</span></div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;                <a class="code" href="../../d9/dd0/structbuf.html">buf</a> = <a class="code" href="../../d5/d16/group__netsock.html#ga2ef026fece207711f7b686f95bc6e4ff">ma_recv_buf</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_totalsize);</div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d9/dd0/structbuf.html">buf</a> == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;                        <span class="keyword">struct </span><a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *tm   = <a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>;</div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;                        <span class="keyword">struct </span><a class="code" href="../../d4/d52/structm0__net__buffer__pool.html">m0_net_buffer_pool</a> *<a class="code" href="../../d0/df1/iter__ut_8c.html#a8b1bf9675fb77ab02a105e260477a59b">pool</a> = tm-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#ac16e5b955b5bfa853933e1784b57cac3">ntm_recv_pool</a>;</div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;                        <span class="comment">/*</span></div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;<span class="comment">                         * A user of network transport (such as the rpc module)</span></div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;<span class="comment">                         * has no control over consumption of buffers on the</span></div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;<span class="comment">                         * receive queue. It might (and does) so happen that</span></div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;<span class="comment">                         * this queue becomes empty.</span></div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;<span class="comment">                         *</span></div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;<span class="comment">                         * After a buffer completion event has been delivered to</span></div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;<span class="comment">                         * the user, m0_net_buffer_event_post() tries to</span></div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;<span class="comment">                         * re-provision the receive queue by calling</span></div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;<span class="comment">                         * m0_net__tm_provision_recv_q(). This does not always</span></div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;<span class="comment">                         * work because:</span></div><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;<span class="comment">                         *</span></div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;<span class="comment">                         *     - standard provisioning code does not deal with</span></div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;<span class="comment">                         *       the busy buffers and</span></div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;<span class="comment">                         *</span></div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;<span class="comment">                         *     - the loop in poller() processes multiple events</span></div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;<span class="comment">                         *       before buffer completions are invoked.</span></div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;<span class="comment">                         *</span></div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;<span class="comment">                         * First, try to provision the receive queue right here</span></div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;<span class="comment">                         * on the spot. This might fail because the try-lock</span></div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;<span class="comment">                         * below fails or because the pool is out of buffers. In</span></div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;<span class="comment">                         * case of failure, return -ENOBUFS all the way up to</span></div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;<span class="comment">                         * sock_event(), which returns true to instruct poller()</span></div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;<span class="comment">                         * to break out of the loop and to re-provision the</span></div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;<span class="comment">                         * queue.</span></div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;<span class="comment">                         */</span></div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../d0/df1/iter__ut_8c.html#a8b1bf9675fb77ab02a105e260477a59b">pool</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp;</div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;                            <a class="code" href="../../d0/d04/group__mutex.html#ga7ee00c46fd81d55f45b1aae736ae792b">m0_mutex_trylock</a>(&amp;<a class="code" href="../../d0/df1/iter__ut_8c.html#a8b1bf9675fb77ab02a105e260477a59b">pool</a>-&gt;nbp_mutex) == 0) {</div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;                                <a class="code" href="../../d0/d50/group__net__pvt.html#ga10b81fec0a61efae5b970c93c8166031">m0_net__tm_provision_buf</a>(tm);</div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;                                <span class="comment">/* Got the lock. Add 2 buffers. */</span></div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;                                <a class="code" href="../../d0/d50/group__net__pvt.html#ga10b81fec0a61efae5b970c93c8166031">m0_net__tm_provision_buf</a>(tm);</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;                                <a class="code" href="../../d8/d01/group__net__buffer__pool.html#ga98cfb317097d1024cca11a4c5af51b9c">m0_net_buffer_pool_unlock</a>(<a class="code" href="../../d0/df1/iter__ut_8c.html#a8b1bf9675fb77ab02a105e260477a59b">pool</a>);</div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;                                <a class="code" href="../../d9/dd0/structbuf.html">buf</a> = <a class="code" href="../../d5/d16/group__netsock.html#ga2ef026fece207711f7b686f95bc6e4ff">ma_recv_buf</a>(<a class="code" href="../../d8/dee/structma.html">ma</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a>-&gt;p_totalsize);</div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;                        }</div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;                }</div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d9/dd0/structbuf.html">buf</a> == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;                        <span class="keywordflow">return</span> -ENOBUFS; <span class="comment">/* Not always a error. */</span></div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;        }</div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gaef26c34c66e8e88befd9b30a9cae179c">buf_accept</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>) ?: <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a943628239c02f3d0241ca831508900b5">R_INTERVAL</a>;</div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;}</div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;</div><div class="line"><a name="l03406"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gabcf3ea8f28ad69325421a0cd066c8537"> 3406</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gabcf3ea8f28ad69325421a0cd066c8537">pk_done</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>)</div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;{</div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d9/dd0/structbuf.html">buf</a>    *<a class="code" href="../../d9/dd0/structbuf.html">buf</a> = <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_buf;</div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../df/de8/structpacket.html">packet</a> *pk  = &amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_pk;</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;</div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(!<a class="code" href="../../df/df3/group__bitmap.html#ga0e2870d0310664efdf37a687856a5605">m0_bitmap_get</a>(&amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a65bbee1059773d953d6c79dd44b04401">b_done</a>, pk-&gt;<a class="code" href="../../df/de8/structpacket.html#a6d94b987cf8b45d98aca1c543fc084f4">p_idx</a>));</div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gad1278e0c872e51530c6943d527e786a3">mover_is_reader</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>));</div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;        <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_buf = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;        <a class="code" href="../../df/df3/group__bitmap.html#gaff8a25aa0c262e35cc2b260b51d2ace0">m0_bitmap_set</a>(&amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a65bbee1059773d953d6c79dd44b04401">b_done</a>, pk-&gt;<a class="code" href="../../df/de8/structpacket.html#a6d94b987cf8b45d98aca1c543fc084f4">p_idx</a>, <span class="keyword">true</span>);</div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../df/df3/group__bitmap.html#ga7a3a03e4b5410c0c7d03179e42957001">m0_bitmap_ffz</a>(&amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a65bbee1059773d953d6c79dd44b04401">b_done</a>) == -1)</div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#ga901a7c7ecafb57cbf6885b57b9272e34">buf_done</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>, 0); <span class="comment">/* If all packets have been received, done. */</span></div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;}</div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;</div><div class="line"><a name="l03419"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga9963c546f67a16058c52e3e7eab7135c"> 3419</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga9963c546f67a16058c52e3e7eab7135c">pk_encdec</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <span class="keyword">enum</span> <a class="code" href="../../dd/d6d/group__xcode.html#ga39540fe756fec0792fdc0cc5cf7ab4b0">m0_xcode_what</a> what)</div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;{</div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d5/d06/structm0__bufvec__cursor.html">m0_bufvec_cursor</a> <a class="code" href="../../d0/d9e/group__addb2.html#ga7be2f145dc9b5b3220c69a52f0409b25">cur</a>;</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;        <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a>             len = <span class="keyword">sizeof</span> <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_pkbuf;</div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;        <span class="keywordtype">void</span>                   *<a class="code" href="../../d9/dd0/structbuf.html">buf</a> = <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_pkbuf;</div><div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;        <span class="keywordtype">int</span>                     <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a>;</div><div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;</div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;        <a class="code" href="../../d0/d7f/group__vec.html#ga25676feab636093b10797af188337efc">m0_bufvec_cursor_init</a>(&amp;<a class="code" href="../../d0/d9e/group__addb2.html#ga7be2f145dc9b5b3220c69a52f0409b25">cur</a>, &amp;<a class="code" href="../../d0/d7f/group__vec.html#gad378d99580b9ef36bb0c266778c67cd0">M0_BUFVEC_INIT_BUF</a>(&amp;<a class="code" href="../../d9/dd0/structbuf.html">buf</a>, &amp;len));</div><div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;        <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> = <a class="code" href="../../dd/d6d/group__xcode.html#ga122dadd35bc9d49194cd6035cb9d50e7">m0_xcode_encdec</a>(&amp;<a class="code" href="../../dd/d6d/group__xcode.html#ga0733e26f11171dd0d95568ca3c104cd1">M0_XCODE_OBJ</a>(packet_xc, &amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_pk), &amp;<a class="code" href="../../d0/d9e/group__addb2.html#ga7be2f145dc9b5b3220c69a52f0409b25">cur</a>, what);</div><div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(<a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> == 0);</div><div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;}</div><div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;</div><div class="line"><a name="l03431"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gae6f42c83bbf4ab42da96adcb1aa02522"> 3431</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gae6f42c83bbf4ab42da96adcb1aa02522">pk_decode</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>)</div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;{</div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga9963c546f67a16058c52e3e7eab7135c">pk_encdec</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <a class="code" href="../../dd/d6d/group__xcode.html#gga39540fe756fec0792fdc0cc5cf7ab4b0a693a7692be6745d64eb42c7715c5d893">M0_XCODE_DECODE</a>);</div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;}</div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;</div><div class="line"><a name="l03436"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gab694a18ebf526a77cfc704584c6a113f"> 3436</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gab694a18ebf526a77cfc704584c6a113f">pk_encode</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>)</div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;{</div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;        <a class="code" href="../../dd/dc1/group__format.html#ga5f05742845abbd56398831e0569c805a">m0_format_footer_update</a>(&amp;<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_pk);</div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga9963c546f67a16058c52e3e7eab7135c">pk_encdec</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <a class="code" href="../../dd/d6d/group__xcode.html#gga39540fe756fec0792fdc0cc5cf7ab4b0afc23e1849575201e0d52ebc191af0107">M0_XCODE_ENCODE</a>);</div><div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;}</div><div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;</div><div class="line"><a name="l03447"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga92af4fb43448938aec447314de63ead1"> 3447</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga92af4fb43448938aec447314de63ead1">stream_idle</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;{</div><div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a16de0923aedc356f652438ff75d553c2">R_PK</a>;</div><div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;}</div><div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;</div><div class="line"><a name="l03455"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gac86b71d05137f15bfeb5d34369b0116c"> 3455</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gac86b71d05137f15bfeb5d34369b0116c">stream_pk</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;{</div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;        <span class="keyword">self</span>-&gt;m_nob = 0;</div><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a>;</div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;}</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;</div><div class="line"><a name="l03466"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga908d163d92427d231903fa6e41a0abac"> 3466</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga908d163d92427d231903fa6e41a0abac">stream_header</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;{</div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;        <span class="keywordtype">int</span> result = <a class="code" href="../../d5/d16/group__netsock.html#ga643216df42cd41316bad263fdcf690ad">pk_io</a>(<span class="keyword">self</span>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <a class="code" href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39a7418706169c4419c7ceb4553a8416673">HAS_READ</a>, <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="keyword">sizeof</span> self-&gt;m_pkbuf);</div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;        <span class="keywordflow">if</span> (result &lt; 0)</div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(result);</div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;        <span class="comment">/* Cannot use pk_state() with unverified header. */</span></div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (self-&gt;m_nob &lt; <span class="keyword">sizeof</span> self-&gt;m_pkbuf)</div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a>;</div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;                <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(self-&gt;m_nob == <span class="keyword">sizeof</span> self-&gt;m_pkbuf);</div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gae0d835e5b33df4f26664af2f5c067f25">pk_header_done</a>(<span class="keyword">self</span>);</div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;        }</div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;}</div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;</div><div class="line"><a name="l03485"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga67b3a394cd9c1d7006a0c7c25282654c"> 3485</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga67b3a394cd9c1d7006a0c7c25282654c">stream_interval</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;{</div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;        <span class="keywordtype">int</span> result = <a class="code" href="../../d5/d16/group__netsock.html#ga643216df42cd41316bad263fdcf690ad">pk_io</a>(<span class="keyword">self</span>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <a class="code" href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39a7418706169c4419c7ceb4553a8416673">HAS_READ</a>, <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/d16/group__netsock.html#ga08a2e9fc0c071a8d9af463180a71fd54">pk_tsize</a>(<span class="keyword">self</span>));</div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;        <span class="keywordflow">return</span> result &gt;= 0 ? <a class="code" href="../../d5/d16/group__netsock.html#gab2a4957b29b0ff2f9b6abec6b37d71a6">pk_state</a>(<span class="keyword">self</span>) : result;</div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;}</div><div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;</div><div class="line"><a name="l03492"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga714f0d57ccf1e2483267c981523a2864"> 3492</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga714f0d57ccf1e2483267c981523a2864">stream_pk_done</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;{</div><div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gabcf3ea8f28ad69325421a0cd066c8537">pk_done</a>(<span class="keyword">self</span>);</div><div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a63581c61e8680cb3c6be0310a4e19e81">R_IDLE</a>;</div><div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;}</div><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;</div><div class="line"><a name="l03504"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga75c3bacd4693a09b670e17916de5f0da"> 3504</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d5/d16/group__netsock.html#ga75c3bacd4693a09b670e17916de5f0da">stream_pk_size</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *w, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;{</div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d9/d49/types_8h.html#a18efc29f05f292310db38a8c7e81dcdaa6b55ae4ed41442026238fc4b5629166e">M0_BSIGNED_MAX</a> / 2;</div><div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;}</div><div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;</div><div class="line"><a name="l03510"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga40ac618bb526e1fb205d17dfe4cc199f"> 3510</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga40ac618bb526e1fb205d17dfe4cc199f">stream_error</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;{</div><div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_sock != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;                <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_sock = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#ga85d8da4dc83ae2334a7422a46b355949">sock_done</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <span class="keyword">true</span>);</div><div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;        }</div><div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;}</div><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;</div><div class="line"><a name="l03523"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaf169bc1171797bdc8c2bb37224838416"> 3523</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gaf169bc1171797bdc8c2bb37224838416">dgram_idle</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;{</div><div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a16de0923aedc356f652438ff75d553c2">R_PK</a>;</div><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;}</div><div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;</div><div class="line"><a name="l03533"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga2eeacc9003a18e21618078440d7b57bb"> 3533</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga2eeacc9003a18e21618078440d7b57bb">dgram_pk</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;{</div><div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;        <span class="keywordflow">if</span> (self-&gt;m_scratch == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;                <span class="keyword">self</span>-&gt;m_scratch = <a class="code" href="../../d7/ded/group__memory.html#ga80e6a4e9d078f93b5917555b7b3d3fec">m0_alloc</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga0783c9a92d6de5ed67d4e9c382001d5d">pk_size</a>(<span class="keyword">self</span>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>));</div><div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;                <span class="keywordflow">if</span> (self-&gt;m_scratch == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-ENOMEM);</div><div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;        }</div><div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a>;</div><div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;}</div><div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;</div><div class="line"><a name="l03552"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga1020d1d4f82dee7a79a9913595fcd030"> 3552</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga1020d1d4f82dee7a79a9913595fcd030">dgram_header</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;{</div><div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;        <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> maxsize = <a class="code" href="../../d5/d16/group__netsock.html#ga0783c9a92d6de5ed67d4e9c382001d5d">pk_size</a>(<span class="keyword">self</span>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;        <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> dsize;</div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../da/d2c/structm0__bufvec.html">m0_bufvec</a> bv = <a class="code" href="../../d0/d7f/group__vec.html#gad378d99580b9ef36bb0c266778c67cd0">M0_BUFVEC_INIT_BUF</a>(&amp;self-&gt;m_scratch, &amp;maxsize);</div><div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d5/d06/structm0__bufvec__cursor.html">m0_bufvec_cursor</a> <a class="code" href="../../d0/d9e/group__addb2.html#ga7be2f145dc9b5b3220c69a52f0409b25">cur</a>;</div><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;        <span class="keywordtype">int</span> result = <a class="code" href="../../d5/d16/group__netsock.html#ga643216df42cd41316bad263fdcf690ad">pk_io</a>(<span class="keyword">self</span>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <a class="code" href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39a7418706169c4419c7ceb4553a8416673">HAS_READ</a>, &amp;bv,</div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;                           <span class="keyword">sizeof</span> self-&gt;m_pkbuf + maxsize);</div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;        <span class="keywordflow">if</span> (result &lt; 0)</div><div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(result);</div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;        <span class="keywordflow">if</span> (self-&gt;m_nob &lt; <span class="keyword">sizeof</span> self-&gt;m_pkbuf)</div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EPROTO);</div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;        result = <a class="code" href="../../d5/d16/group__netsock.html#gae0d835e5b33df4f26664af2f5c067f25">pk_header_done</a>(<span class="keyword">self</span>);</div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;        <span class="keywordflow">if</span> (result &lt; 0)</div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(result);</div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;        dsize = <span class="keyword">self</span>-&gt;m_pk.p_size;</div><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;        <span class="keywordflow">if</span> (self-&gt;m_nob != <span class="keyword">sizeof</span> self-&gt;m_pkbuf + dsize)</div><div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-EMSGSIZE);</div><div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;        <a class="code" href="../../d0/d7f/group__vec.html#ga25676feab636093b10797af188337efc">m0_bufvec_cursor_init</a>(&amp;<a class="code" href="../../d0/d9e/group__addb2.html#ga7be2f145dc9b5b3220c69a52f0409b25">cur</a>, &amp;bv);</div><div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;        <a class="code" href="../../d0/d7f/group__vec.html#ga0519cf756af050c693a2b1ddc67394ef">m0_bufvec_cursor_move</a>(&amp;<a class="code" href="../../d0/d9e/group__addb2.html#ga7be2f145dc9b5b3220c69a52f0409b25">cur</a>, self-&gt;m_pk.p_offset);</div><div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;        <a class="code" href="../../d0/d7f/group__vec.html#ga91b552c4f3207320a242bd099e304883">m0_data_to_bufvec_copy</a>(&amp;<a class="code" href="../../d0/d9e/group__addb2.html#ga7be2f145dc9b5b3220c69a52f0409b25">cur</a>, self-&gt;m_scratch, dsize);</div><div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gab2a4957b29b0ff2f9b6abec6b37d71a6">pk_state</a>(<span class="keyword">self</span>);</div><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;}</div><div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;</div><div class="line"><a name="l03579"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga2fb2b3f17a4539bcf5363d68b7fea102"> 3579</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga2fb2b3f17a4539bcf5363d68b7fea102">dgram_interval</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;{</div><div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gab2a4957b29b0ff2f9b6abec6b37d71a6">pk_state</a>(<span class="keyword">self</span>);</div><div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;}</div><div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;</div><div class="line"><a name="l03587"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gad9fd986ece2d618089cfda4b185ce4ba"> 3587</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gad9fd986ece2d618089cfda4b185ce4ba">dgram_pk_done</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;{</div><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gabcf3ea8f28ad69325421a0cd066c8537">pk_done</a>(<span class="keyword">self</span>);</div><div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a63581c61e8680cb3c6be0310a4e19e81">R_IDLE</a>;</div><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;}</div><div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;</div><div class="line"><a name="l03598"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga8e6066984626295aac1349f675ff830f"> 3598</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d5/d16/group__netsock.html#ga8e6066984626295aac1349f675ff830f">dgram_pk_size</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *w, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;{</div><div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;        <span class="keywordflow">return</span>    65535 <span class="comment">/* 16 bit &quot;total length&quot; in ip header */</span></div><div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;                -     8 <span class="comment">/* UDP header */</span></div><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;                <span class="comment">/* IPv4 or IPV6 header size */</span></div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;                - (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>-&gt;s_ep-&gt;e_a.a_family == AF_INET ? 20 : 40)</div><div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;                - <span class="keyword">sizeof</span> w-&gt;<a class="code" href="../../d1/d99/structmover.html#a4dedef8ceff4a5f475a2de0c5e1a4cc9">m_pkbuf</a>;</div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;}</div><div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;</div><div class="line"><a name="l03607"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaa84a0ba7e9ca103362e6b5a62228daad"> 3607</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gaa84a0ba7e9ca103362e6b5a62228daad">dgram_error</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;{</div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;}</div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;</div><div class="line"><a name="l03612"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaaaa58dcfcdb1cc514329dc50bd3095b4"> 3612</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gaaaa58dcfcdb1cc514329dc50bd3095b4">writer_idle</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *w, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;{</div><div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;        <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> pksize = <a class="code" href="../../d5/d16/group__netsock.html#ga0783c9a92d6de5ed67d4e9c382001d5d">pk_size</a>(w, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;        <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d4/d00/ut_2di_8c.html#a8629956d8c29c6159e411f38f24c140d">size</a>   = w-&gt;<a class="code" href="../../d1/d99/structmover.html#a009dde470277f894204e183285891cca">m_buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a11ed429feb7ad22be45284e8055fe465">b_buf</a>-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a719f71a97b21a0b81358f883d3c5c2cf">nb_length</a>;</div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;</div><div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;        <a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(<a class="code" href="../../d4/d00/ut_2di_8c.html#a8629956d8c29c6159e411f38f24c140d">size</a> &gt; 0);</div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gad7ba5dff1c65580fa18971ea7decf804">pk_header_init</a>(w, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;        w-&gt;<a class="code" href="../../d1/d99/structmover.html#aaaca63f1cdbf4c52c0c81e350ccc5f00">m_pk</a>.<a class="code" href="../../df/de8/structpacket.html#ab6da0d119d7237ef2f5f1aaea9208c27">p_nr</a> = (<a class="code" href="../../d4/d00/ut_2di_8c.html#a8629956d8c29c6159e411f38f24c140d">size</a> + pksize - 1) / pksize;</div><div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;        <a class="code" href="../../dd/dc1/group__format.html#ga4d30f4095392dc864b6ff37123d73fed">m0_format_header_pack</a>(&amp;w-&gt;<a class="code" href="../../d1/d99/structmover.html#aaaca63f1cdbf4c52c0c81e350ccc5f00">m_pk</a>.<a class="code" href="../../df/de8/structpacket.html#ae24cb9793897065fc8fbcf28ebfec797">p_header</a>, &amp;<a class="code" href="../../d5/d16/group__netsock.html#gab9e8dc20b199a933933acfd3a5b0853f">put_tag</a>);</div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a16de0923aedc356f652438ff75d553c2">R_PK</a>;</div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;}</div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;</div><div class="line"><a name="l03629"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gab1deb8e1ba4744c222d7b95ea6d93752"> 3629</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gab1deb8e1ba4744c222d7b95ea6d93752">writer_pk</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *w, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;{</div><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;        <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> pksize = <a class="code" href="../../d5/d16/group__netsock.html#ga0783c9a92d6de5ed67d4e9c382001d5d">pk_size</a>(w, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;        <a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d4/d00/ut_2di_8c.html#a8629956d8c29c6159e411f38f24c140d">size</a>   = w-&gt;<a class="code" href="../../d1/d99/structmover.html#a009dde470277f894204e183285891cca">m_buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a11ed429feb7ad22be45284e8055fe465">b_buf</a>-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a719f71a97b21a0b81358f883d3c5c2cf">nb_length</a>;</div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;</div><div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;        w-&gt;<a class="code" href="../../d1/d99/structmover.html#a4daf9d9599efabce6dcdfb868e2b5a9c">m_nob</a> = 0;</div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;        w-&gt;<a class="code" href="../../d1/d99/structmover.html#aaaca63f1cdbf4c52c0c81e350ccc5f00">m_pk</a>.<a class="code" href="../../df/de8/structpacket.html#a617b29b6e19a9fc3193cb5bcfd78c552">p_size</a> = <a class="code" href="../../db/dc9/group__arith.html#ga3ab271ddef8d2ab1ee331f95138294b5">min64u</a>(pksize, <a class="code" href="../../d4/d00/ut_2di_8c.html#a8629956d8c29c6159e411f38f24c140d">size</a> - <a class="code" href="../../d5/d16/group__netsock.html#gaf7d93c09d009488be1e33a3fb74e45a9">pk_dnob</a>(w));</div><div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gab694a18ebf526a77cfc704584c6a113f">pk_encode</a>(w);</div><div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;        w-&gt;<a class="code" href="../../d1/d99/structmover.html#a1ae1f926434f6a0fa9ce813927773bff">m_sock</a> = <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>; <span class="comment">/* Lock the socket and the writer together. */</span></div><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a>;</div><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;}</div><div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;</div><div class="line"><a name="l03646"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga925c36d21e3c699446204c869a3e521e"> 3646</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga925c36d21e3c699446204c869a3e521e">writer_write</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *w, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;{</div><div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;        <span class="keywordtype">int</span> result = <a class="code" href="../../d5/d16/group__netsock.html#ga643216df42cd41316bad263fdcf690ad">pk_io</a>(w, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <a class="code" href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39afd7faf6c636cbc6f3d3cc0683c0584dc">HAS_WRITE</a>, <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/d16/group__netsock.html#ga08a2e9fc0c071a8d9af463180a71fd54">pk_tsize</a>(w));</div><div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;        <span class="keywordflow">return</span> result &gt;= 0 ? <a class="code" href="../../d5/d16/group__netsock.html#gab2a4957b29b0ff2f9b6abec6b37d71a6">pk_state</a>(w) : result;</div><div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;}</div><div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;</div><div class="line"><a name="l03658"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gab7beaa2515ba0faa730209abea6ed21d"> 3658</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gab7beaa2515ba0faa730209abea6ed21d">writer_pk_done</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *w, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;{</div><div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;        w-&gt;<a class="code" href="../../d1/d99/structmover.html#a1ae1f926434f6a0fa9ce813927773bff">m_sock</a> = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;        <span class="keywordflow">if</span> (++w-&gt;<a class="code" href="../../d1/d99/structmover.html#aaaca63f1cdbf4c52c0c81e350ccc5f00">m_pk</a>.<a class="code" href="../../df/de8/structpacket.html#a6d94b987cf8b45d98aca1c543fc084f4">p_idx</a> == w-&gt;<a class="code" href="../../d1/d99/structmover.html#aaaca63f1cdbf4c52c0c81e350ccc5f00">m_pk</a>.<a class="code" href="../../df/de8/structpacket.html#ab6da0d119d7237ef2f5f1aaea9208c27">p_nr</a>)</div><div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a1bd27bf23812341749c87673d015d3ac">R_DONE</a>;</div><div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;                w-&gt;<a class="code" href="../../d1/d99/structmover.html#aaaca63f1cdbf4c52c0c81e350ccc5f00">m_pk</a>.<a class="code" href="../../df/de8/structpacket.html#af1b549b8b454e86fe6a73f69134c2df9">p_offset</a> += w-&gt;<a class="code" href="../../d1/d99/structmover.html#aaaca63f1cdbf4c52c0c81e350ccc5f00">m_pk</a>.<a class="code" href="../../df/de8/structpacket.html#a617b29b6e19a9fc3193cb5bcfd78c552">p_size</a>;</div><div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a16de0923aedc356f652438ff75d553c2">R_PK</a>;</div><div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;        }</div><div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;}</div><div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;</div><div class="line"><a name="l03670"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga84fc4959018349aa9d99831f5e959505"> 3670</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga84fc4959018349aa9d99831f5e959505">writer_done</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *w, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;{</div><div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gaa0e13143fda3ace8485c788fa68c2655">writer_error</a>(w, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, 0);</div><div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;}</div><div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;</div><div class="line"><a name="l03682"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaa0e13143fda3ace8485c788fa68c2655"> 3682</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gaa0e13143fda3ace8485c788fa68c2655">writer_error</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *w, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, <span class="keywordtype">int</span> <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a>)</div><div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;{</div><div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga29cb5f0cd1ec36cce44a8d9baa6a1746">ep_del</a>(w);</div><div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga901a7c7ecafb57cbf6885b57b9272e34">buf_done</a>(w-&gt;<a class="code" href="../../d1/d99/structmover.html#a009dde470277f894204e183285891cca">m_buf</a>, <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a>);</div><div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;}</div><div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;</div><div class="line"><a name="l03689"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga9cea9b44e270d3cbaf2a5ef16fd653d5"> 3689</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga9cea9b44e270d3cbaf2a5ef16fd653d5">get_idle</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;{</div><div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a16de0923aedc356f652438ff75d553c2">R_PK</a>;</div><div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;}</div><div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;</div><div class="line"><a name="l03695"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaf2365098ff35cf19fc407ec542cf83d2"> 3695</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#gaf2365098ff35cf19fc407ec542cf83d2">get_pk</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *cmd, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;{</div><div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gad7ba5dff1c65580fa18971ea7decf804">pk_header_init</a>(cmd, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;        <a class="code" href="../../dd/dc1/group__format.html#ga4d30f4095392dc864b6ff37123d73fed">m0_format_header_pack</a>(&amp;cmd-&gt;<a class="code" href="../../d1/d99/structmover.html#aaaca63f1cdbf4c52c0c81e350ccc5f00">m_pk</a>.<a class="code" href="../../df/de8/structpacket.html#ae24cb9793897065fc8fbcf28ebfec797">p_header</a>, &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga37552715ad676e57ef041ea8bf86616b">get_tag</a>);</div><div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;        cmd-&gt;<a class="code" href="../../d1/d99/structmover.html#a4daf9d9599efabce6dcdfb868e2b5a9c">m_nob</a> = 0;</div><div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;        cmd-&gt;<a class="code" href="../../d1/d99/structmover.html#aaaca63f1cdbf4c52c0c81e350ccc5f00">m_pk</a>.<a class="code" href="../../df/de8/structpacket.html#ab6da0d119d7237ef2f5f1aaea9208c27">p_nr</a> = 1;</div><div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;        cmd-&gt;<a class="code" href="../../d1/d99/structmover.html#aaaca63f1cdbf4c52c0c81e350ccc5f00">m_pk</a>.<a class="code" href="../../df/de8/structpacket.html#a2f889d4045a0ee242a0f9f75311dcf72">p_totalsize</a> = 0;</div><div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;        cmd-&gt;<a class="code" href="../../d1/d99/structmover.html#aaaca63f1cdbf4c52c0c81e350ccc5f00">m_pk</a>.<a class="code" href="../../df/de8/structpacket.html#a617b29b6e19a9fc3193cb5bcfd78c552">p_size</a> = 0;</div><div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gab694a18ebf526a77cfc704584c6a113f">pk_encode</a>(cmd);</div><div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;        cmd-&gt;<a class="code" href="../../d1/d99/structmover.html#a1ae1f926434f6a0fa9ce813927773bff">m_sock</a> = <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>;</div><div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a>;</div><div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;}</div><div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;</div><div class="line"><a name="l03709"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga02696f30b89d4726a067ea78e2802bea"> 3709</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga02696f30b89d4726a067ea78e2802bea">get_done</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *w, <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>)</div><div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;{</div><div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga29cb5f0cd1ec36cce44a8d9baa6a1746">ep_del</a>(w);</div><div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;}</div><div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;</div><div class="line"><a name="l03714"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gac7538a7758c679505dbbff33552d1a34"> 3714</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../da/d29/structm0__sm__state__descr.html">m0_sm_state_descr</a> <a class="code" href="../../d5/d16/group__netsock.html#gac7538a7758c679505dbbff33552d1a34">sock_conf_state</a>[] = {</div><div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;        [<a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaabb033d58518dadd28210bc74bef6051">S_INIT</a>] = {</div><div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;                .<a class="code" href="../../da/d29/structm0__sm__state__descr.html#aaa4b4ef5c4b7c75b07ddabcb9877008b">sd_name</a> = <span class="stringliteral">&quot;init&quot;</span>,</div><div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;                .sd_flags = <a class="code" href="../../d1/dc1/group__sm.html#gga4f865c6bc4efb56250e807fe86cbe2cda151cd096e558adff06744e177e8487f8">M0_SDF_INITIAL</a>,</div><div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;                .sd_allowed = <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae644c20b9d43e4e0810716647b3d16be">M0_BITS</a>(<a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbae1999ab5c5b6740876a5e8ed025260aa">S_LISTENING</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba9d8566da037aa1256e85c81f275b7805">S_CONNECTING</a>,</div><div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;                                      <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaa86daa3f2c345452a3235108d80ad8aa">S_OPEN</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba57451d0f52d3a8d7604c40753f7dd109">S_DELETED</a>)</div><div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;        },</div><div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;        [<a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbae1999ab5c5b6740876a5e8ed025260aa">S_LISTENING</a>] = {</div><div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;                .sd_name = <span class="stringliteral">&quot;listening&quot;</span>,</div><div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;                .sd_allowed = <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae644c20b9d43e4e0810716647b3d16be">M0_BITS</a>(<a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba57451d0f52d3a8d7604c40753f7dd109">S_DELETED</a>)</div><div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;        },</div><div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;        [<a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba9d8566da037aa1256e85c81f275b7805">S_CONNECTING</a>] = {</div><div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;                .sd_name = <span class="stringliteral">&quot;connecting&quot;</span>,</div><div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;                .sd_allowed = <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae644c20b9d43e4e0810716647b3d16be">M0_BITS</a>(<a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaa86daa3f2c345452a3235108d80ad8aa">S_OPEN</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba57451d0f52d3a8d7604c40753f7dd109">S_DELETED</a>)</div><div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;        },</div><div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;        [<a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaa86daa3f2c345452a3235108d80ad8aa">S_OPEN</a>] = {</div><div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;                .sd_name = <span class="stringliteral">&quot;active&quot;</span>,</div><div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;                .sd_allowed = <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae644c20b9d43e4e0810716647b3d16be">M0_BITS</a>(<a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba57451d0f52d3a8d7604c40753f7dd109">S_DELETED</a>)</div><div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;        },</div><div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;        [<a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba57451d0f52d3a8d7604c40753f7dd109">S_DELETED</a>] = {</div><div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;                .sd_name = <span class="stringliteral">&quot;deleted&quot;</span>,</div><div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;                .sd_flags = <a class="code" href="../../d1/dc1/group__sm.html#gga4f865c6bc4efb56250e807fe86cbe2cda6dd90f440b122b8032dc8613f927083a">M0_SDF_TERMINAL</a></div><div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;        }</div><div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;};</div><div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;</div><div class="line"><a name="l03739"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga6c3740a62f509b306b6906d29caa1918"> 3739</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../df/dd9/structm0__sm__trans__descr.html">m0_sm_trans_descr</a> <a class="code" href="../../d5/d16/group__netsock.html#ga6c3740a62f509b306b6906d29caa1918">sock_conf_trans</a>[] = {</div><div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;        { <span class="stringliteral">&quot;listen&quot;</span>,        <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaabb033d58518dadd28210bc74bef6051">S_INIT</a>,       <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbae1999ab5c5b6740876a5e8ed025260aa">S_LISTENING</a> },</div><div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;        { <span class="stringliteral">&quot;connect&quot;</span>,       <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaabb033d58518dadd28210bc74bef6051">S_INIT</a>,       <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba9d8566da037aa1256e85c81f275b7805">S_CONNECTING</a> },</div><div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;        { <span class="stringliteral">&quot;accept&quot;</span>,        <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaabb033d58518dadd28210bc74bef6051">S_INIT</a>,       <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaa86daa3f2c345452a3235108d80ad8aa">S_OPEN</a> },</div><div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;        { <span class="stringliteral">&quot;init-deleted&quot;</span>,  <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaabb033d58518dadd28210bc74bef6051">S_INIT</a>,       <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba57451d0f52d3a8d7604c40753f7dd109">S_DELETED</a> },</div><div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;        { <span class="stringliteral">&quot;listen-close&quot;</span>,  <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbae1999ab5c5b6740876a5e8ed025260aa">S_LISTENING</a>,  <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba57451d0f52d3a8d7604c40753f7dd109">S_DELETED</a> },</div><div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;        { <span class="stringliteral">&quot;connected&quot;</span>,     <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba9d8566da037aa1256e85c81f275b7805">S_CONNECTING</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaa86daa3f2c345452a3235108d80ad8aa">S_OPEN</a> },</div><div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;        { <span class="stringliteral">&quot;connect-close&quot;</span>, <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba9d8566da037aa1256e85c81f275b7805">S_CONNECTING</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba57451d0f52d3a8d7604c40753f7dd109">S_DELETED</a> },</div><div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;        { <span class="stringliteral">&quot;close&quot;</span>,         <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaa86daa3f2c345452a3235108d80ad8aa">S_OPEN</a>,       <a class="code" href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba57451d0f52d3a8d7604c40753f7dd109">S_DELETED</a> }</div><div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;};</div><div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;</div><div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../de/dbb/structm0__sm__conf.html">m0_sm_conf</a> <a class="code" href="../../d5/d16/group__netsock.html#ga916c31c6b0bf58b1c49128b94079fff8">sock_conf</a> = {</div><div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;        .<a class="code" href="../../de/dbb/structm0__sm__conf.html#a72045b32a59ed51c06d4dfdc321fc654">scf_name</a>      = <span class="stringliteral">&quot;sock&quot;</span>,</div><div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;        .scf_nr_states = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gac7538a7758c679505dbbff33552d1a34">sock_conf_state</a>),</div><div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;        .scf_state     = <a class="code" href="../../d5/d16/group__netsock.html#gac7538a7758c679505dbbff33552d1a34">sock_conf_state</a>,</div><div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;        .scf_trans_nr  = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga6c3740a62f509b306b6906d29caa1918">sock_conf_trans</a>),</div><div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;        .scf_trans     = <a class="code" href="../../d5/d16/group__netsock.html#ga6c3740a62f509b306b6906d29caa1918">sock_conf_trans</a></div><div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;};</div><div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;</div><div class="line"><a name="l03758"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gae4eb491acad8af8a0a1b4013281f26f6"> 3758</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../da/d29/structm0__sm__state__descr.html">m0_sm_state_descr</a> <a class="code" href="../../d5/d16/group__netsock.html#gae4eb491acad8af8a0a1b4013281f26f6">rw_conf_state</a>[] = {</div><div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;        [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a63581c61e8680cb3c6be0310a4e19e81">R_IDLE</a>] = {</div><div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;                .<a class="code" href="../../da/d29/structm0__sm__state__descr.html#aaa4b4ef5c4b7c75b07ddabcb9877008b">sd_name</a> = <span class="stringliteral">&quot;idle&quot;</span>,</div><div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;                .sd_flags = <a class="code" href="../../d1/dc1/group__sm.html#gga4f865c6bc4efb56250e807fe86cbe2cda151cd096e558adff06744e177e8487f8">M0_SDF_INITIAL</a>,</div><div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;                .sd_allowed = <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae644c20b9d43e4e0810716647b3d16be">M0_BITS</a>(<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a16de0923aedc356f652438ff75d553c2">R_PK</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a1bd27bf23812341749c87673d015d3ac">R_DONE</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a575df14f8416f291b63a463ddaa1c37f">R_FAIL</a>)</div><div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;        },</div><div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;        [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a16de0923aedc356f652438ff75d553c2">R_PK</a>] = {</div><div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;                .sd_name = <span class="stringliteral">&quot;datagram&quot;</span>,</div><div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;                .sd_allowed = <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae644c20b9d43e4e0810716647b3d16be">M0_BITS</a>(<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a575df14f8416f291b63a463ddaa1c37f">R_FAIL</a>)</div><div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;        },</div><div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;        [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a>] = {</div><div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;                .sd_name = <span class="stringliteral">&quot;header&quot;</span>,</div><div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;                .sd_allowed = <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae644c20b9d43e4e0810716647b3d16be">M0_BITS</a>(<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a63581c61e8680cb3c6be0310a4e19e81">R_IDLE</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a943628239c02f3d0241ca831508900b5">R_INTERVAL</a>,</div><div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;                                      <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a502dbd83cd4018628e13bcba822ce710">R_PK_DONE</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a1bd27bf23812341749c87673d015d3ac">R_DONE</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a575df14f8416f291b63a463ddaa1c37f">R_FAIL</a>)</div><div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;        },</div><div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;        [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a943628239c02f3d0241ca831508900b5">R_INTERVAL</a>] = {</div><div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;                .sd_name = <span class="stringliteral">&quot;interval&quot;</span>,</div><div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;                .sd_allowed = <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae644c20b9d43e4e0810716647b3d16be">M0_BITS</a>(<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a943628239c02f3d0241ca831508900b5">R_INTERVAL</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a502dbd83cd4018628e13bcba822ce710">R_PK_DONE</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a575df14f8416f291b63a463ddaa1c37f">R_FAIL</a>)</div><div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;        },</div><div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;        [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a502dbd83cd4018628e13bcba822ce710">R_PK_DONE</a>] = {</div><div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;                .sd_name = <span class="stringliteral">&quot;datagram-done&quot;</span>,</div><div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;                .sd_allowed = <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae644c20b9d43e4e0810716647b3d16be">M0_BITS</a>(<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a16de0923aedc356f652438ff75d553c2">R_PK</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a63581c61e8680cb3c6be0310a4e19e81">R_IDLE</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a1bd27bf23812341749c87673d015d3ac">R_DONE</a>, <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a575df14f8416f291b63a463ddaa1c37f">R_FAIL</a>)</div><div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;        },</div><div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;        [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a575df14f8416f291b63a463ddaa1c37f">R_FAIL</a>] = {</div><div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;                .sd_name = <span class="stringliteral">&quot;fail&quot;</span>,</div><div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;                .sd_allowed = <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae644c20b9d43e4e0810716647b3d16be">M0_BITS</a>(<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a1bd27bf23812341749c87673d015d3ac">R_DONE</a>)</div><div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;        },</div><div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;        [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a1bd27bf23812341749c87673d015d3ac">R_DONE</a>] = {</div><div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;                .sd_name = <span class="stringliteral">&quot;done&quot;</span>,</div><div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;                .sd_flags = <a class="code" href="../../d1/dc1/group__sm.html#gga4f865c6bc4efb56250e807fe86cbe2cda6dd90f440b122b8032dc8613f927083a">M0_SDF_TERMINAL</a></div><div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;        }</div><div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;};</div><div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;</div><div class="line"><a name="l03791"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga5d92759bddfd6442631c4423fa310d83"> 3791</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../df/dd9/structm0__sm__trans__descr.html">m0_sm_trans_descr</a> <a class="code" href="../../d5/d16/group__netsock.html#ga5d92759bddfd6442631c4423fa310d83">rw_conf_trans</a>[] = {</div><div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;        { <span class="stringliteral">&quot;pk-start&quot;</span>,       <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a63581c61e8680cb3c6be0310a4e19e81">R_IDLE</a>,       <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a16de0923aedc356f652438ff75d553c2">R_PK</a> },</div><div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;        { <span class="stringliteral">&quot;close&quot;</span>,          <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a63581c61e8680cb3c6be0310a4e19e81">R_IDLE</a>,       <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a1bd27bf23812341749c87673d015d3ac">R_DONE</a> },</div><div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;        { <span class="stringliteral">&quot;error&quot;</span>,          <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a63581c61e8680cb3c6be0310a4e19e81">R_IDLE</a>,       <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a575df14f8416f291b63a463ddaa1c37f">R_FAIL</a> },</div><div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;        { <span class="stringliteral">&quot;header-start&quot;</span>,   <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a16de0923aedc356f652438ff75d553c2">R_PK</a>,         <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a> },</div><div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;        { <span class="stringliteral">&quot;pk-error&quot;</span>,       <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a16de0923aedc356f652438ff75d553c2">R_PK</a>,         <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a575df14f8416f291b63a463ddaa1c37f">R_FAIL</a> },</div><div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;        { <span class="stringliteral">&quot;header-cont&quot;</span>,    <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a>,     <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a> },</div><div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;        { <span class="stringliteral">&quot;get-send-done&quot;</span>,  <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a>,     <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a502dbd83cd4018628e13bcba822ce710">R_PK_DONE</a> },</div><div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;        { <span class="stringliteral">&quot;get-rcvd-done&quot;</span>,  <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a>,     <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a63581c61e8680cb3c6be0310a4e19e81">R_IDLE</a> },</div><div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;        { <span class="stringliteral">&quot;interval-start&quot;</span>, <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a>,     <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a943628239c02f3d0241ca831508900b5">R_INTERVAL</a> },</div><div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;        { <span class="stringliteral">&quot;header-error&quot;</span>,   <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a>,     <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a575df14f8416f291b63a463ddaa1c37f">R_FAIL</a> },</div><div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;        <span class="comment">/* This transition is only possible for a GET command. */</span></div><div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;        { <span class="stringliteral">&quot;cmd-done&quot;</span>,       <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a>,     <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a1bd27bf23812341749c87673d015d3ac">R_DONE</a> },</div><div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;        { <span class="stringliteral">&quot;interval-cont&quot;</span>,  <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a943628239c02f3d0241ca831508900b5">R_INTERVAL</a>,   <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a943628239c02f3d0241ca831508900b5">R_INTERVAL</a> },</div><div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;        { <span class="stringliteral">&quot;interval-done&quot;</span>,  <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a943628239c02f3d0241ca831508900b5">R_INTERVAL</a>,   <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a502dbd83cd4018628e13bcba822ce710">R_PK_DONE</a> },</div><div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;        { <span class="stringliteral">&quot;interval-error&quot;</span>, <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a943628239c02f3d0241ca831508900b5">R_INTERVAL</a>,   <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a575df14f8416f291b63a463ddaa1c37f">R_FAIL</a> },</div><div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;        { <span class="stringliteral">&quot;pk-next&quot;</span>,        <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a502dbd83cd4018628e13bcba822ce710">R_PK_DONE</a>,    <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a16de0923aedc356f652438ff75d553c2">R_PK</a> },</div><div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;        <span class="comment">/* This transition is not possible for a writer. */</span></div><div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;        { <span class="stringliteral">&quot;pk-idle&quot;</span>,        <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a502dbd83cd4018628e13bcba822ce710">R_PK_DONE</a>,    <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a63581c61e8680cb3c6be0310a4e19e81">R_IDLE</a> },</div><div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;        { <span class="stringliteral">&quot;pk-error&quot;</span>,       <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a502dbd83cd4018628e13bcba822ce710">R_PK_DONE</a>,    <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a575df14f8416f291b63a463ddaa1c37f">R_FAIL</a> },</div><div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;        { <span class="stringliteral">&quot;pk-close&quot;</span>,       <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a502dbd83cd4018628e13bcba822ce710">R_PK_DONE</a>,    <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a1bd27bf23812341749c87673d015d3ac">R_DONE</a> },</div><div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;        { <span class="stringliteral">&quot;done&quot;</span>,           <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a575df14f8416f291b63a463ddaa1c37f">R_FAIL</a>,       <a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a1bd27bf23812341749c87673d015d3ac">R_DONE</a> },</div><div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;};</div><div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;</div><div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../de/dbb/structm0__sm__conf.html">m0_sm_conf</a> <a class="code" href="../../d5/d16/group__netsock.html#ga5f25f2a8c8e86982bd9c99b99cb97b4e">rw_conf</a> = {</div><div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;        .<a class="code" href="../../de/dbb/structm0__sm__conf.html#a72045b32a59ed51c06d4dfdc321fc654">scf_name</a>      = <span class="stringliteral">&quot;reader-writer&quot;</span>,</div><div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;        .scf_nr_states = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a>(<a class="code" href="../../d5/d16/group__netsock.html#gae4eb491acad8af8a0a1b4013281f26f6">rw_conf_state</a>),</div><div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;        .scf_state     = <a class="code" href="../../d5/d16/group__netsock.html#gae4eb491acad8af8a0a1b4013281f26f6">rw_conf_state</a>,</div><div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;        .scf_trans_nr  = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga5d92759bddfd6442631c4423fa310d83">rw_conf_trans</a>),</div><div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;        .scf_trans     = <a class="code" href="../../d5/d16/group__netsock.html#ga5d92759bddfd6442631c4423fa310d83">rw_conf_trans</a></div><div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;};</div><div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;</div><div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d3/d91/structmover__op__vec.html">mover_op_vec</a> <a class="code" href="../../d5/d16/group__netsock.html#gae1c39f3887a734f80f90af19db496846">stream_reader_op</a> = {</div><div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;        .<a class="code" href="../../d3/d91/structmover__op__vec.html#a966fde66dc94059be9485d9effb30ea4">v_name</a> = <span class="stringliteral">&quot;stream-reader&quot;</span>,</div><div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;        .v_op   = {</div><div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;                [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a63581c61e8680cb3c6be0310a4e19e81">R_IDLE</a>]     = { [<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca0cb0be5475011ea9319ce55b30e74634">M_READ</a>] = { &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga92af4fb43448938aec447314de63ead1">stream_idle</a>, <span class="keyword">true</span> } },</div><div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;                [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a16de0923aedc356f652438ff75d553c2">R_PK</a>]       = { [<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca0cb0be5475011ea9319ce55b30e74634">M_READ</a>] = { &amp;<a class="code" href="../../d5/d16/group__netsock.html#gac86b71d05137f15bfeb5d34369b0116c">stream_pk</a>, <span class="keyword">false</span> } },</div><div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;                [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a>]   = { [<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca0cb0be5475011ea9319ce55b30e74634">M_READ</a>] = { &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga908d163d92427d231903fa6e41a0abac">stream_header</a>, <span class="keyword">true</span> } },</div><div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;                [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a943628239c02f3d0241ca831508900b5">R_INTERVAL</a>] = { [<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca0cb0be5475011ea9319ce55b30e74634">M_READ</a>] = { &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga67b3a394cd9c1d7006a0c7c25282654c">stream_interval</a>, <span class="keyword">true</span> } },</div><div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;                [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a502dbd83cd4018628e13bcba822ce710">R_PK_DONE</a>]  = { [<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca0cb0be5475011ea9319ce55b30e74634">M_READ</a>] = { &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga714f0d57ccf1e2483267c981523a2864">stream_pk_done</a>, <span class="keyword">false</span> } }</div><div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;        }</div><div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;};</div><div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;</div><div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d3/d91/structmover__op__vec.html">mover_op_vec</a> <a class="code" href="../../d5/d16/group__netsock.html#gaadafef50a110b8e53312f153d1c103d3">dgram_reader_op</a> = {</div><div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;        .<a class="code" href="../../d3/d91/structmover__op__vec.html#a966fde66dc94059be9485d9effb30ea4">v_name</a> = <span class="stringliteral">&quot;dgram-reader&quot;</span>,</div><div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;        .v_op   = {</div><div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;                [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a63581c61e8680cb3c6be0310a4e19e81">R_IDLE</a>]     = { [<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca0cb0be5475011ea9319ce55b30e74634">M_READ</a>] = { &amp;<a class="code" href="../../d5/d16/group__netsock.html#gaf169bc1171797bdc8c2bb37224838416">dgram_idle</a>, <span class="keyword">true</span> } },</div><div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;                [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a16de0923aedc356f652438ff75d553c2">R_PK</a>]       = { [<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca0cb0be5475011ea9319ce55b30e74634">M_READ</a>] = { &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga2eeacc9003a18e21618078440d7b57bb">dgram_pk</a>, <span class="keyword">false</span> } },</div><div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;                [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a>]   = { [<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca0cb0be5475011ea9319ce55b30e74634">M_READ</a>] = { &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga1020d1d4f82dee7a79a9913595fcd030">dgram_header</a>, <span class="keyword">true</span> } },</div><div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;                [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a943628239c02f3d0241ca831508900b5">R_INTERVAL</a>] = { [<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca0cb0be5475011ea9319ce55b30e74634">M_READ</a>] = { &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga2fb2b3f17a4539bcf5363d68b7fea102">dgram_interval</a>, <span class="keyword">false</span> } },</div><div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;                [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a502dbd83cd4018628e13bcba822ce710">R_PK_DONE</a>]  = { [<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca0cb0be5475011ea9319ce55b30e74634">M_READ</a>] = { &amp;<a class="code" href="../../d5/d16/group__netsock.html#gad9fd986ece2d618089cfda4b185ce4ba">dgram_pk_done</a>, <span class="keyword">false</span> } }</div><div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;        }</div><div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;};</div><div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;</div><div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d3/d91/structmover__op__vec.html">mover_op_vec</a> <a class="code" href="../../d5/d16/group__netsock.html#gaaea8f9114f06faf1285bfd1bd5c6da3b">writer_op</a> = {</div><div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;        .<a class="code" href="../../d3/d91/structmover__op__vec.html#a966fde66dc94059be9485d9effb30ea4">v_name</a>  = <span class="stringliteral">&quot;writer&quot;</span>,</div><div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;        .v_done  = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga84fc4959018349aa9d99831f5e959505">writer_done</a>,</div><div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;        .v_error = &amp;<a class="code" href="../../d5/d16/group__netsock.html#gaa0e13143fda3ace8485c788fa68c2655">writer_error</a>,</div><div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;        .v_op    = {</div><div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;              [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a63581c61e8680cb3c6be0310a4e19e81">R_IDLE</a>]     = { [<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca7af369c035a45a9babde5a9443b5ef01">M_WRITE</a>] = { &amp;<a class="code" href="../../d5/d16/group__netsock.html#gaaaa58dcfcdb1cc514329dc50bd3095b4">writer_idle</a>, <span class="keyword">true</span> } },</div><div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;              [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a16de0923aedc356f652438ff75d553c2">R_PK</a>]       = { [<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca7af369c035a45a9babde5a9443b5ef01">M_WRITE</a>] = { &amp;<a class="code" href="../../d5/d16/group__netsock.html#gab1deb8e1ba4744c222d7b95ea6d93752">writer_pk</a>, <span class="keyword">false</span> } },</div><div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;              [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a>]   = { [<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca7af369c035a45a9babde5a9443b5ef01">M_WRITE</a>] = { &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga925c36d21e3c699446204c869a3e521e">writer_write</a> <span class="comment">/* sic. */</span>, <span class="keyword">true</span> } },</div><div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;              [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a943628239c02f3d0241ca831508900b5">R_INTERVAL</a>] = { [<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca7af369c035a45a9babde5a9443b5ef01">M_WRITE</a>] = { &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga925c36d21e3c699446204c869a3e521e">writer_write</a> <span class="comment">/* sic. */</span>, <span class="keyword">true</span> } },</div><div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;              [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a502dbd83cd4018628e13bcba822ce710">R_PK_DONE</a>]  = { [<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca7af369c035a45a9babde5a9443b5ef01">M_WRITE</a>] = { &amp;<a class="code" href="../../d5/d16/group__netsock.html#gab7beaa2515ba0faa730209abea6ed21d">writer_pk_done</a>, <span class="keyword">false</span> } }</div><div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;        }</div><div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;};</div><div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;</div><div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d3/d91/structmover__op__vec.html">mover_op_vec</a> <a class="code" href="../../d5/d16/group__netsock.html#gaa3f97a589c8ebf7495ac65e2efd70f67">get_op</a> = {</div><div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;        .<a class="code" href="../../d3/d91/structmover__op__vec.html#a966fde66dc94059be9485d9effb30ea4">v_name</a>  = <span class="stringliteral">&quot;get&quot;</span>,</div><div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;        .v_done  = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga02696f30b89d4726a067ea78e2802bea">get_done</a>,</div><div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;        .v_error = &amp;<a class="code" href="../../d5/d16/group__netsock.html#gaa0e13143fda3ace8485c788fa68c2655">writer_error</a>,</div><div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;        .v_op    = {</div><div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;                [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a63581c61e8680cb3c6be0310a4e19e81">R_IDLE</a>]     = { [<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca7af369c035a45a9babde5a9443b5ef01">M_WRITE</a>] = { &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga9cea9b44e270d3cbaf2a5ef16fd653d5">get_idle</a>, <span class="keyword">true</span> } },</div><div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;                [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a16de0923aedc356f652438ff75d553c2">R_PK</a>]       = { [<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca7af369c035a45a9babde5a9443b5ef01">M_WRITE</a>] = { &amp;<a class="code" href="../../d5/d16/group__netsock.html#gaf2365098ff35cf19fc407ec542cf83d2">get_pk</a>, <span class="keyword">false</span> } },</div><div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;                [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a>]   = { [<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca7af369c035a45a9babde5a9443b5ef01">M_WRITE</a>] = { &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga925c36d21e3c699446204c869a3e521e">writer_write</a>, <span class="keyword">true</span> } },</div><div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;                [<a class="code" href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a502dbd83cd4018628e13bcba822ce710">R_PK_DONE</a>]  = { [<a class="code" href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca7af369c035a45a9babde5a9443b5ef01">M_WRITE</a>] = { &amp;<a class="code" href="../../d5/d16/group__netsock.html#gab7beaa2515ba0faa730209abea6ed21d">writer_pk_done</a>, <span class="keyword">false</span> } }</div><div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;        }</div><div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;};</div><div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;</div><div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;<span class="keyword">enum</span> {</div><div class="line"><a name="l03871"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gga7d60538bf88b652d40af16a55f8eb39daebd3109dc1fd2d20f080740ed7e4424c"> 3871</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gga7d60538bf88b652d40af16a55f8eb39daebd3109dc1fd2d20f080740ed7e4424c">M0_NET_SOCK_PROTO_VERSION</a> = 1,</div><div class="line"><a name="l03872"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gga7d60538bf88b652d40af16a55f8eb39da6a9c1823b35b1580d68ec6d8475b1a79"> 3872</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gga7d60538bf88b652d40af16a55f8eb39da6a9c1823b35b1580d68ec6d8475b1a79">M0_NET_SOCK_PROTO_PUT</a>     = 0x1,</div><div class="line"><a name="l03873"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gga7d60538bf88b652d40af16a55f8eb39da3400866eb4662e1174dfe9195441f64b"> 3873</a></span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#gga7d60538bf88b652d40af16a55f8eb39da3400866eb4662e1174dfe9195441f64b">M0_NET_SOCK_PROTO_GET</a>     = 0x2</div><div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;};</div><div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;</div><div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d3/d99/structm0__format__tag.html">m0_format_tag</a> <a class="code" href="../../d5/d16/group__netsock.html#gab9e8dc20b199a933933acfd3a5b0853f">put_tag</a> = {</div><div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;        .<a class="code" href="../../d3/d99/structm0__format__tag.html#a41e90e49c1af83c3f87c701b2ec2da92">ot_version</a>       = <a class="code" href="../../d5/d16/group__netsock.html#gga7d60538bf88b652d40af16a55f8eb39daebd3109dc1fd2d20f080740ed7e4424c">M0_NET_SOCK_PROTO_VERSION</a>,</div><div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;        .ot_type          = <a class="code" href="../../d5/d16/group__netsock.html#gga7d60538bf88b652d40af16a55f8eb39da6a9c1823b35b1580d68ec6d8475b1a79">M0_NET_SOCK_PROTO_PUT</a>,</div><div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;        .ot_footer_offset = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#ad4a7496cd704df3829c87864e7dbd703">offsetof</a>(<span class="keyword">struct</span> <a class="code" href="../../df/de8/structpacket.html">packet</a>, <a class="code" href="../../da/da2/net_2sock_2xcode_8h.html#acc2e4347ca127dda560cd82fd5044b2a">p_footer</a>)</div><div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;};</div><div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;</div><div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d3/d99/structm0__format__tag.html">m0_format_tag</a> <a class="code" href="../../d5/d16/group__netsock.html#ga37552715ad676e57ef041ea8bf86616b">get_tag</a> = {</div><div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;        .<a class="code" href="../../d3/d99/structm0__format__tag.html#a41e90e49c1af83c3f87c701b2ec2da92">ot_version</a>       = <a class="code" href="../../d5/d16/group__netsock.html#gga7d60538bf88b652d40af16a55f8eb39daebd3109dc1fd2d20f080740ed7e4424c">M0_NET_SOCK_PROTO_VERSION</a>,</div><div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;        .ot_type          = <a class="code" href="../../d5/d16/group__netsock.html#gga7d60538bf88b652d40af16a55f8eb39da3400866eb4662e1174dfe9195441f64b">M0_NET_SOCK_PROTO_GET</a>,</div><div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;        .ot_footer_offset = <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#ad4a7496cd704df3829c87864e7dbd703">offsetof</a>(<span class="keyword">struct</span> <a class="code" href="../../df/de8/structpacket.html">packet</a>, <a class="code" href="../../da/da2/net_2sock_2xcode_8h.html#acc2e4347ca127dda560cd82fd5044b2a">p_footer</a>)</div><div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;};</div><div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;</div><div class="line"><a name="l03888"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga02454243093b2104abbb1b183c2223a8"> 3888</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../da/dca/structm0__net__xprt__ops.html">m0_net_xprt_ops</a> <a class="code" href="../../d5/d16/group__netsock.html#ga02454243093b2104abbb1b183c2223a8">xprt_ops</a> = {</div><div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;        .<a class="code" href="../../da/dca/structm0__net__xprt__ops.html#aa5186beef994323cdf64433f2062f570">xo_dom_init</a>                    = &amp;<a class="code" href="../../d5/d16/group__netsock.html#gaa548b4086af9f91b36c2c97493d2345c">dom_init</a>,</div><div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;        .xo_dom_fini                    = &amp;<a class="code" href="../../d5/d16/group__netsock.html#gac94eaec48aa0330f08aad1dac30716f5">dom_fini</a>,</div><div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;        .xo_tm_init                     = &amp;<a class="code" href="../../d5/d16/group__netsock.html#gaeb8ce0b9e88d70b11be23556bbe3a7f8">ma_init</a>,</div><div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;        .xo_tm_confine                  = &amp;<a class="code" href="../../d5/d16/group__netsock.html#gae71a95ee2475544498101a69c50b50e0">ma_confine</a>,</div><div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;        .xo_tm_start                    = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga659f364dd5da411dc3961db0fb7de77e">ma_start</a>,</div><div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;        .xo_tm_stop                     = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga2db0d962bdf2f6c2bcdc183f1a44592f">ma_stop</a>,</div><div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;        .xo_tm_fini                     = &amp;<a class="code" href="../../d5/d16/group__netsock.html#gaf8c51d155d8cf0609ffee4056167686b">ma_fini</a>,</div><div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;        .xo_end_point_create            = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga7d7e64eb8e44b6ffc187727ae565f1c4">end_point_create</a>,</div><div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;        .xo_buf_register                = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga57bdbf76bd38811d51a9e332f2e9aea0">buf_register</a>,</div><div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;        .xo_buf_deregister              = &amp;<a class="code" href="../../d5/d16/group__netsock.html#gaa35d272e8d4f283958b86460800e24cd">buf_deregister</a>,</div><div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;        .xo_buf_add                     = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga9cdacdb6229f7becd262087bcefc9715">buf_add</a>,</div><div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;        .xo_buf_del                     = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga53079337909bf84060a165ba7eb1fc5d">buf_del</a>,</div><div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;        .xo_bev_deliver_sync            = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga37e31a2f36872125309e4bcb50a89e33">bev_deliver_sync</a>,</div><div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;        .xo_bev_deliver_all             = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga08bbaf5a7ac6a88d11c356fc7bcd34ef">bev_deliver_all</a>,</div><div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;        .xo_bev_pending                 = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga88373be29952aeec9a2de84b52257efe">bev_pending</a>,</div><div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;        .xo_bev_notify                  = &amp;<a class="code" href="../../d5/d16/group__netsock.html#gad87cb84510da3568b658ee9e4c9592d1">bev_notify</a>,</div><div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;        .xo_get_max_buffer_size         = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga42954f73b21f92d35c9cc7cdafdf0cc6">get_max_buffer_size</a>,</div><div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;        .xo_get_max_buffer_segment_size = &amp;<a class="code" href="../../d5/d16/group__netsock.html#gad243458e06517a7a34f083a6f226fb90">get_max_buffer_segment_size</a>,</div><div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;        .xo_get_max_buffer_segments     = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga95a9ed0a5357022173b96f24d664374d">get_max_buffer_segments</a>,</div><div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;        .xo_get_max_buffer_desc_size    = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga06ffa7bbccaa76fcccf8f02aa9c785b6">get_max_buffer_desc_size</a>,</div><div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;</div><div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;        .xo_rpc_max_seg_size            = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga02a03579ff3f069899aab4182f6540e7">get_rpc_max_seg_size</a>,</div><div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;        .xo_rpc_max_segs_nr             = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga65f17ccc7d00545d9f55335529fcc01c">get_rpc_max_segs_nr</a>,</div><div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;        .xo_rpc_max_msg_size            = <a class="code" href="../../d9/dd2/group__net.html#ga29917e953c2dd969f833226b1296fa0b">default_xo_rpc_max_msg_size</a>,</div><div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;        .xo_rpc_max_recv_msgs           = <a class="code" href="../../d9/dd2/group__net.html#gadecee388788921c2db60adc0cffe5db9">default_xo_rpc_max_recv_msgs</a>,</div><div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;</div><div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;};</div><div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;</div><div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;<span class="preprocessor">#if MOCK_LNET</span></div><div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d5/da0/structm0__net__xprt.html">m0_net_xprt</a> <a class="code" href="../../d5/d16/group__netsock.html#ga2d36be05d2b181e0e76ed02e4fe16b6e">m0_net_lnet_xprt</a> = {</div><div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;        .<a class="code" href="../../d5/da0/structm0__net__xprt.html#a16cd28307c3a7159cd8c808a1c59224e">nx_name</a> = <span class="stringliteral">&quot;lnet&quot;</span>,</div><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;        .nx_ops  = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga02454243093b2104abbb1b183c2223a8">xprt_ops</a></div><div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;};</div><div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;M0_EXPORTED(<a class="code" href="../../d5/d16/group__netsock.html#ga2d36be05d2b181e0e76ed02e4fe16b6e">m0_net_lnet_xprt</a>);</div><div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;<span class="keyword">extern</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d5/da0/structm0__net__xprt.html">m0_net_xprt</a> <a class="code" href="../../d5/d16/group__netsock.html#ga2d36be05d2b181e0e76ed02e4fe16b6e">m0_net_lnet_xprt</a>;</div><div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;</div><div class="line"><a name="l03927"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gacdf002b8647126915a19d1a0dfa6027d"> 3927</a></span>&#160;<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d5/da0/structm0__net__xprt.html">m0_net_xprt</a> <a class="code" href="../../d5/d16/group__netsock.html#gacdf002b8647126915a19d1a0dfa6027d">m0_net_sock_xprt</a> = {</div><div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;        .<a class="code" href="../../d5/da0/structm0__net__xprt.html#a16cd28307c3a7159cd8c808a1c59224e">nx_name</a> = <span class="stringliteral">&quot;sock&quot;</span>,</div><div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;        .nx_ops  = &amp;<a class="code" href="../../d5/d16/group__netsock.html#ga02454243093b2104abbb1b183c2223a8">xprt_ops</a></div><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;};</div><div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;M0_EXPORTED(<a class="code" href="../../d5/d16/group__netsock.html#gacdf002b8647126915a19d1a0dfa6027d">m0_net_sock_xprt</a>);</div><div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;</div><div class="line"><a name="l03933"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga235a0794b76fd2426301e957c36dfc9c"> 3933</a></span>&#160;M0_INTERNAL <span class="keywordtype">int</span> <a class="code" href="../../d5/d16/group__netsock.html#ga235a0794b76fd2426301e957c36dfc9c">m0_net_sock_mod_init</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;{</div><div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;        <span class="keywordtype">int</span> result;</div><div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;</div><div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d16/group__netsock.html#ga204a3875802e9f8ff4b75db13dda46d3">MOCK_LNET</a>) {</div><div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;                <a class="code" href="../../d9/dd2/group__net.html#gab5569eded06d8e55513fe46e5add4ac8">m0_net_xprt_register</a>(&amp;<a class="code" href="../../d5/d16/group__netsock.html#ga2d36be05d2b181e0e76ed02e4fe16b6e">m0_net_lnet_xprt</a>);</div><div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../da/d66/string_8h.html#a0079aa9054e46c8034188e468fdb79f4">m0_streq</a>(<a class="code" href="../../db/d16/config_8h.html#a675b855bd376c0fb7a9fca952de435ab">M0_DEFAULT_NETWORK</a>, <span class="stringliteral">&quot;LNET&quot;</span>))</div><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;                        <a class="code" href="../../d9/dd2/group__net.html#ga810f62fdcaf6ab41add4f828a03a8aab">m0_net_xprt_default_set</a>(&amp;<a class="code" href="../../d5/d16/group__netsock.html#ga2d36be05d2b181e0e76ed02e4fe16b6e">m0_net_lnet_xprt</a>);</div><div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;                <a class="code" href="../../d9/dd2/group__net.html#gab5569eded06d8e55513fe46e5add4ac8">m0_net_xprt_register</a>(&amp;<a class="code" href="../../d5/d16/group__netsock.html#gacdf002b8647126915a19d1a0dfa6027d">m0_net_sock_xprt</a>);</div><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../da/d66/string_8h.html#a0079aa9054e46c8034188e468fdb79f4">m0_streq</a>(<a class="code" href="../../db/d16/config_8h.html#a675b855bd376c0fb7a9fca952de435ab">M0_DEFAULT_NETWORK</a>, <span class="stringliteral">&quot;SOCK&quot;</span>))</div><div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;                        <a class="code" href="../../d9/dd2/group__net.html#ga810f62fdcaf6ab41add4f828a03a8aab">m0_net_xprt_default_set</a>(&amp;<a class="code" href="../../d5/d16/group__netsock.html#gacdf002b8647126915a19d1a0dfa6027d">m0_net_sock_xprt</a>);</div><div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;        }</div><div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;<span class="comment">         * Ignore SIGPIPE that a write to socket gets when RST is received.</span></div><div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;<span class="comment">         * A more elegant approach is to use sendmsg(2) with MSG_NOSIGNAL flag</span></div><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;<span class="comment">         * instead of writev(2).</span></div><div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;        result = sigaction(SIGPIPE,</div><div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;                           &amp;(<span class="keyword">struct</span> sigaction){ .sa_handler = SIG_IGN }, <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;        <span class="keywordflow">return</span> result != 0 ? <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a>(-errno) : 0;</div><div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;}</div><div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;</div><div class="line"><a name="l03957"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga1352bb10167f7b9c749707b10b082a9f"> 3957</a></span>&#160;M0_INTERNAL <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga1352bb10167f7b9c749707b10b082a9f">m0_net_sock_mod_fini</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;{</div><div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d16/group__netsock.html#ga204a3875802e9f8ff4b75db13dda46d3">MOCK_LNET</a>)</div><div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;                <a class="code" href="../../d9/dd2/group__net.html#ga468b777c12c7bb86bb1952d827bd52ce">m0_net_xprt_deregister</a>(&amp;<a class="code" href="../../d5/d16/group__netsock.html#ga2d36be05d2b181e0e76ed02e4fe16b6e">m0_net_lnet_xprt</a>);</div><div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;                <a class="code" href="../../d9/dd2/group__net.html#ga468b777c12c7bb86bb1952d827bd52ce">m0_net_xprt_deregister</a>(&amp;<a class="code" href="../../d5/d16/group__netsock.html#gacdf002b8647126915a19d1a0dfa6027d">m0_net_sock_xprt</a>);</div><div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;}</div><div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;</div><div class="line"><a name="l03965"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaab4a37d9eee8ab85cade8e0a0c877efd"> 3965</a></span>&#160;M0_INTERNAL <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gaab4a37d9eee8ab85cade8e0a0c877efd">mover__print</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d1/d99/structmover.html">mover</a> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>)</div><div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;{</div><div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;        printf(<span class="stringliteral">&quot;\t%p: %s sock: %p state: %i buf: %p\n&quot;</span>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>,</div><div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;               <a class="code" href="../../d5/d16/group__netsock.html#gad1278e0c872e51530c6943d527e786a3">mover_is_reader</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>) ? <span class="stringliteral">&quot;R&quot;</span> : (<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_op == &amp;<a class="code" href="../../d5/d16/group__netsock.html#gaaea8f9114f06faf1285bfd1bd5c6da3b">writer_op</a> ? <span class="stringliteral">&quot;W&quot;</span> : <span class="stringliteral">&quot;G&quot;</span>),</div><div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;               <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_sock, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_sm.sm_state, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>-&gt;m_buf);</div><div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;}</div><div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;</div><div class="line"><a name="l03972"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#gaed2f4c86687ccc0b2a70013f35019b46"> 3972</a></span>&#160;M0_INTERNAL <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#gaed2f4c86687ccc0b2a70013f35019b46">addr__print</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/db9/structaddr.html">addr</a> *<a class="code" href="../../d9/db9/structaddr.html">addr</a>)</div><div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;{</div><div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;        <span class="keywordtype">char</span> *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a> = <a class="code" href="../../d5/d16/group__netsock.html#ga1346d46974aa7185fed3b07d84480295">addr_print</a>(<a class="code" href="../../d9/db9/structaddr.html">addr</a>);</div><div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;        printf(<span class="stringliteral">&quot;\t%s\n&quot;</span>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;        <a class="code" href="../../d7/ded/group__memory.html#ga0b8533a3024754008602759e71337eb3">m0_free</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;}</div><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;</div><div class="line"><a name="l03979"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga93db8e0a1b6257b6658f0b76a245bc52"> 3979</a></span>&#160;M0_INTERNAL <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga93db8e0a1b6257b6658f0b76a245bc52">sock__print</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../dd/d74/structsock.html">sock</a> *<a class="code" href="../../dd/d74/structsock.html">sock</a>)</div><div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;{</div><div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;        printf(<span class="stringliteral">&quot;\t\tfd: %i, flags: %&quot;</span> <a class="code" href="../../d2/de1/linux__kernel_2types_8h.html#aba38357387a474f439428dee1984fc5a">PRIx64</a> <span class="stringliteral">&quot;, state: %i\n&quot;</span>,</div><div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;               <a class="code" href="../../dd/d74/structsock.html">sock</a>-&gt;<a class="code" href="../../dd/d74/structsock.html#a9f16c5c31b0670702bd2d4bf0ac9cc81">s_fd</a>, <a class="code" href="../../dd/d74/structsock.html">sock</a>-&gt;<a class="code" href="../../dd/d74/structsock.html#a4f142f45799c6f3ad8de534340993083">s_flags</a>, <a class="code" href="../../dd/d74/structsock.html">sock</a>-&gt;<a class="code" href="../../dd/d74/structsock.html#a5766c3b04a967df4143cd23bff6f83e5">s_sm</a>.<a class="code" href="../../db/d49/structm0__sm.html#a15f271ddbf3fecd39f2711f07f40b76e">sm_state</a>);</div><div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;}</div><div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;</div><div class="line"><a name="l03985"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga0e3ad3a7a46dc2e839552650c5489cf4"> 3985</a></span>&#160;M0_INTERNAL <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga0e3ad3a7a46dc2e839552650c5489cf4">ep__print</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../da/da7/structep.html">ep</a> *<a class="code" href="../../da/da7/structep.html">ep</a>)</div><div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;{</div><div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../dd/d74/structsock.html">sock</a>  *<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>;</div><div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d1/d99/structmover.html">mover</a> *w;</div><div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../da/da7/structep.html">ep</a> == <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;                printf(<span class="stringliteral">&quot;NULL ep\n&quot;</span>);</div><div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;                printf(<span class="stringliteral">&quot;\t%p: &quot;</span>, <a class="code" href="../../da/da7/structep.html">ep</a>);</div><div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#gaed2f4c86687ccc0b2a70013f35019b46">addr__print</a>(&amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#a7fa38028a1ed8e0d494fc3d2f179a890">e_a</a>);</div><div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;                <a class="code" href="../../d7/d08/group__tlist.html#ga6c73104b68112bed660165c64164fadf">m0_tl_for</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>, &amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#aa56814b0282f4d2f416fad8bda1da592">e_sock</a>, <a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>) {</div><div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;                        <a class="code" href="../../d5/d16/group__netsock.html#ga93db8e0a1b6257b6658f0b76a245bc52">sock__print</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a>);</div><div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;                } <a class="code" href="../../d7/d08/group__tlist.html#gaef8bbd93c23f12be0bfbb16ced9ad206">m0_tl_endfor</a>;</div><div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;                <a class="code" href="../../d7/d08/group__tlist.html#ga6c73104b68112bed660165c64164fadf">m0_tl_for</a>(<a class="code" href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a>, &amp;<a class="code" href="../../da/da7/structep.html">ep</a>-&gt;<a class="code" href="../../da/da7/structep.html#ac2bafd27a0e0c46e6cc7791b1a33ebcb">e_writer</a>, w) {</div><div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;                        <a class="code" href="../../d5/d16/group__netsock.html#gaab4a37d9eee8ab85cade8e0a0c877efd">mover__print</a>(w);</div><div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;                } <a class="code" href="../../d7/d08/group__tlist.html#gaef8bbd93c23f12be0bfbb16ced9ad206">m0_tl_endfor</a>;</div><div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;        }</div><div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;}</div><div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;</div><div class="line"><a name="l04003"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga29a5f8a13daa1ed86c1646aa28b5cae8"> 4003</a></span>&#160;M0_INTERNAL <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga29a5f8a13daa1ed86c1646aa28b5cae8">buf__print</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/dd0/structbuf.html">buf</a> *<a class="code" href="../../d9/dd0/structbuf.html">buf</a>)</div><div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;{</div><div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;        printf(<span class="stringliteral">&quot;\t%p: %&quot;</span> <a class="code" href="../../d2/de1/linux__kernel_2types_8h.html#aba38357387a474f439428dee1984fc5a">PRIx64</a> <span class="stringliteral">&quot; bitmap: %&quot;</span><a class="code" href="../../d2/de1/linux__kernel_2types_8h.html#aba38357387a474f439428dee1984fc5a">PRIx64</a></div><div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;               <span class="stringliteral">&quot; peer: %&quot;</span> <a class="code" href="../../d2/de1/linux__kernel_2types_8h.html#aba38357387a474f439428dee1984fc5a">PRIx64</a> <span class="stringliteral">&quot;:%&quot;</span> <a class="code" href="../../d2/de1/linux__kernel_2types_8h.html#aba38357387a474f439428dee1984fc5a">PRIx64</a> <span class="stringliteral">&quot;\n&quot;</span>, <a class="code" href="../../d9/dd0/structbuf.html">buf</a>,</div><div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;               <a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a29fb49838c5d9685aa56e9c32c0dab54">b_cookie</a>,</div><div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;               <a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a65bbee1059773d953d6c79dd44b04401">b_done</a>.<a class="code" href="../../d9/d78/structm0__bitmap.html#a0a00837f749849ca259b96b56f3c6d46">b_words</a> != <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ? <a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a65bbee1059773d953d6c79dd44b04401">b_done</a>.<a class="code" href="../../d9/d78/structm0__bitmap.html#a0a00837f749849ca259b96b56f3c6d46">b_words</a>[0] : 0,</div><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;               <a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#aebfa795c2499f9ffbb7391dbfc94981e">b_peer</a>.<a class="code" href="../../d5/d0e/structbdesc.html#a34dcb14937ab90ea7bd8ae288a9418d2">bd_cookie</a>.<a class="code" href="../../d7/d20/structm0__cookie.html#a5d4f5edddf9a8c03a372655cf460577c">co_addr</a>,</div><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;               <a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#aebfa795c2499f9ffbb7391dbfc94981e">b_peer</a>.<a class="code" href="../../d5/d0e/structbdesc.html#a34dcb14937ab90ea7bd8ae288a9418d2">bd_cookie</a>.<a class="code" href="../../d7/d20/structm0__cookie.html#ae5970df1092738c774de9d877adfaec7">co_generation</a>);</div><div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;        <a class="code" href="../../d5/d16/group__netsock.html#ga0e3ad3a7a46dc2e839552650c5489cf4">ep__print</a>(<a class="code" href="../../d9/dd0/structbuf.html">buf</a>-&gt;<a class="code" href="../../d9/dd0/structbuf.html#a38f9df430deb5db9891b42147ef7a69e">b_other</a>);</div><div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;}</div><div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;</div><div class="line"><a name="l04014"></a><span class="lineno"><a class="line" href="../../d5/d16/group__netsock.html#ga12472db46680c17ed17df5f93e5d4094"> 4014</a></span>&#160;M0_INTERNAL <span class="keywordtype">void</span> <a class="code" href="../../d5/d16/group__netsock.html#ga12472db46680c17ed17df5f93e5d4094">ma__print</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/dee/structma.html">ma</a> *<a class="code" href="../../d8/dee/structma.html">ma</a>)</div><div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;{</div><div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d2/d80/structm0__net__end__point.html">m0_net_end_point</a> *ne;</div><div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d9/d7e/structm0__net__buffer.html">m0_net_buffer</a> *nb;</div><div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a> *tm = <a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>;</div><div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>;</div><div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;</div><div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;        printf(<span class="stringliteral">&quot;%p, state: %x\n&quot;</span>, <a class="code" href="../../d8/dee/structma.html">ma</a>, <a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#a4fde71affafb898e2a3f4d8153cea8d1">ntm_state</a>);</div><div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;        <a class="code" href="../../d7/d08/group__tlist.html#ga6c73104b68112bed660165c64164fadf">m0_tl_for</a>(m0_nep, &amp;<a class="code" href="../../d8/dee/structma.html">ma</a>-&gt;<a class="code" href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">t_ma</a>-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#a4d20259926d66ad4922f26d196260c97">ntm_end_points</a>, ne) {</div><div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;                <a class="code" href="../../d5/d16/group__netsock.html#ga0e3ad3a7a46dc2e839552650c5489cf4">ep__print</a>(<a class="code" href="../../d5/d16/group__netsock.html#ga7d9e1d49b40b58dcb0d60a64aa70c4aa">ep_net</a>(ne));</div><div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;        } <a class="code" href="../../d7/d08/group__tlist.html#gaef8bbd93c23f12be0bfbb16ced9ad206">m0_tl_endfor</a>;</div><div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> = 0; <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> &lt; <a class="code" href="../../db/df8/lib_2user__space_2misc_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a>(tm-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#a142b6d767fee3f0ae250a85a0e6f968a">ntm_q</a>); ++<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>) {</div><div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;                printf(<span class="stringliteral">&quot;\t ---%i[]---\n&quot;</span>, <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>);</div><div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;                <a class="code" href="../../d7/d08/group__tlist.html#ga6c73104b68112bed660165c64164fadf">m0_tl_for</a>(m0_net_tm, &amp;tm-&gt;<a class="code" href="../../d4/d78/structm0__net__transfer__mc.html#a142b6d767fee3f0ae250a85a0e6f968a">ntm_q</a>[<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>], nb) {</div><div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;                        <a class="code" href="../../d5/d16/group__netsock.html#ga29a5f8a13daa1ed86c1646aa28b5cae8">buf__print</a>(nb-&gt;<a class="code" href="../../d9/d7e/structm0__net__buffer.html#a01eabeb5b66a8de67b2a7514563e1893">nb_xprt_private</a>);</div><div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;                } <a class="code" href="../../d7/d08/group__tlist.html#gaef8bbd93c23f12be0bfbb16ced9ad206">m0_tl_endfor</a>;</div><div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;        }</div><div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;}</div><div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;<span class="preprocessor">#undef M0_TRACE_SUBSYSTEM</span></div><div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;</div><div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;<span class="comment"> *  Local variables:</span></div><div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;<span class="comment"> *  c-indentation-style: &quot;K&amp;R&quot;</span></div><div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;<span class="comment"> *  c-basic-offset: 8</span></div><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;<span class="comment"> *  tab-width: 8</span></div><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;<span class="comment"> *  fill-column: 80</span></div><div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;<span class="comment"> *  scroll-step: 1</span></div><div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;<span class="comment"> *  End:</span></div><div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;<span class="comment"> * vim: tabstop=8 shiftwidth=8 noexpandtab textwidth=80 nowrap</span></div><div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;<span class="comment"> */</span></div><div class="ttc" id="group__netsock_html_gga2a989014423ee897a1d4314f292babdbaa86daa3f2c345452a3235108d80ad8aa"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaa86daa3f2c345452a3235108d80ad8aa">S_OPEN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00685">sock.c:685</a></div></div>
<div class="ttc" id="group__netsock_html_gaad5bbb2a3b9939c8f2b9ee3cdb43849a"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaad5bbb2a3b9939c8f2b9ee3cdb43849a">buf_complete</a></div><div class="ttdeci">static void buf_complete(struct buf *buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02925">sock.c:2925</a></div></div>
<div class="ttc" id="net_2net_8h_html"><div class="ttname"><a href="../../db/db3/net_2net_8h.html">net.h</a></div></div>
<div class="ttc" id="group__vec_html_gad378d99580b9ef36bb0c266778c67cd0"><div class="ttname"><a href="../../d0/d7f/group__vec.html#gad378d99580b9ef36bb0c266778c67cd0">M0_BUFVEC_INIT_BUF</a></div><div class="ttdeci">#define M0_BUFVEC_INIT_BUF(addr_ptr, count_ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d65/vec_8h_source.html#l00165">vec.h:165</a></div></div>
<div class="ttc" id="structpacket_html_a617b29b6e19a9fc3193cb5bcfd78c552"><div class="ttname"><a href="../../df/de8/structpacket.html#a617b29b6e19a9fc3193cb5bcfd78c552">packet::p_size</a></div><div class="ttdeci">m0_bcount_t p_size</div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/net_2sock_2xcode_8h_source.html#l00110">xcode.h:110</a></div></div>
<div class="ttc" id="group__xcode_html_ga122dadd35bc9d49194cd6035cb9d50e7"><div class="ttname"><a href="../../dd/d6d/group__xcode.html#ga122dadd35bc9d49194cd6035cb9d50e7">m0_xcode_encdec</a></div><div class="ttdeci">M0_INTERNAL int m0_xcode_encdec(struct m0_xcode_obj *obj, struct m0_bufvec_cursor *cur, enum m0_xcode_what what)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db2/xcode_8c_source.html#l00416">xcode.c:416</a></div></div>
<div class="ttc" id="structmover_html_aa5b6c92647fb63fda90ff44a83eee117"><div class="ttname"><a href="../../d1/d99/structmover.html#aa5b6c92647fb63fda90ff44a83eee117">mover::m_linkage</a></div><div class="ttdeci">struct m0_tlink m_linkage</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00865">sock.c:865</a></div></div>
<div class="ttc" id="structbuf_html_ae21aab4029adf5ae3070f4379195d157"><div class="ttname"><a href="../../d9/dd0/structbuf.html#ae21aab4029adf5ae3070f4379195d157">buf::b_writer</a></div><div class="ttdeci">struct mover b_writer</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00894">sock.c:894</a></div></div>
<div class="ttc" id="group__mutex_html_ga7ee00c46fd81d55f45b1aae736ae792b"><div class="ttname"><a href="../../d0/d04/group__mutex.html#ga7ee00c46fd81d55f45b1aae736ae792b">m0_mutex_trylock</a></div><div class="ttdeci">M0_INTERNAL int m0_mutex_trylock(struct m0_mutex *mutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d62/mutex_8c_source.html#l00084">mutex.c:84</a></div></div>
<div class="ttc" id="group__netsock_html_ga40ac618bb526e1fb205d17dfe4cc199f"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga40ac618bb526e1fb205d17dfe4cc199f">stream_error</a></div><div class="ttdeci">static void stream_error(struct mover *m, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03510">sock.c:3510</a></div></div>
<div class="ttc" id="group__netsock_html_ga1020d1d4f82dee7a79a9913595fcd030"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga1020d1d4f82dee7a79a9913595fcd030">dgram_header</a></div><div class="ttdeci">static int dgram_header(struct mover *self, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03552">sock.c:3552</a></div></div>
<div class="ttc" id="group__netsock_html_gaf8c51d155d8cf0609ffee4056167686b"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaf8c51d155d8cf0609ffee4056167686b">ma_fini</a></div><div class="ttdeci">static void ma_fini(struct m0_net_transfer_mc *ma)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01530">sock.c:1530</a></div></div>
<div class="ttc" id="ut_2consumer_8c_html_a90c4daaf3129aaae65ab8d94cf128570"><div class="ttname"><a href="../../d6/d7d/ut_2consumer_8c.html#a90c4daaf3129aaae65ab8d94cf128570">p</a></div><div class="ttdeci">static struct m0_addb2_philter p</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d7d/ut_2consumer_8c_source.html#l00040">consumer.c:40</a></div></div>
<div class="ttc" id="group__addb2_html_ga5b89fe130d0e27d86bd6b4d92141a87e"><div class="ttname"><a href="../../d0/d9e/group__addb2.html#ga5b89fe130d0e27d86bd6b4d92141a87e">nr</a></div><div class="ttdeci">static size_t nr</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d75/dump_8c_source.html#l01505">dump.c:1505</a></div></div>
<div class="ttc" id="group__netsock_html_ga8de83c5591e35a816141fffb1ae24e7f"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga8de83c5591e35a816141fffb1ae24e7f">ip6_decode</a></div><div class="ttdeci">static void ip6_decode(struct addr *a, const struct sockaddr *sa)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02738">sock.c:2738</a></div></div>
<div class="ttc" id="group__netsock_html_gaca062f63e8a27154bb6e046504692bc9"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaca062f63e8a27154bb6e046504692bc9">buf_invariant</a></div><div class="ttdeci">static bool buf_invariant(const struct buf *buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01260">sock.c:1260</a></div></div>
<div class="ttc" id="group__netsock_html_ga2ef026fece207711f7b686f95bc6e4ff"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga2ef026fece207711f7b686f95bc6e4ff">ma_recv_buf</a></div><div class="ttdeci">static struct buf * ma_recv_buf(struct ma *ma, m0_bcount_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01703">sock.c:1703</a></div></div>
<div class="ttc" id="net__internal_8h_html"><div class="ttname"><a href="../../d5/d7c/net__internal_8h.html">net_internal.h</a></div></div>
<div class="ttc" id="structm0__net__buffer_html_a81bdb16b1858bd23bc6ad680aec0d816"><div class="ttname"><a href="../../d9/d7e/structm0__net__buffer.html#a81bdb16b1858bd23bc6ad680aec0d816">m0_net_buffer::nb_tm</a></div><div class="ttdeci">struct m0_net_transfer_mc * nb_tm</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01357">net.h:1357</a></div></div>
<div class="ttc" id="assert_8h_html_a1c063bd08f7e1ab3a6e6008ef825d471"><div class="ttname"><a href="../../dc/da7/assert_8h.html#a1c063bd08f7e1ab3a6e6008ef825d471">M0_PRE</a></div><div class="ttdeci">#define M0_PRE(cond)</div></div>
<div class="ttc" id="group__netsock_html_gga6c152f6e1ae044464fc6f6655a5ae35ca0cb0be5475011ea9319ce55b30e74634"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca0cb0be5475011ea9319ce55b30e74634">M_READ</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00699">sock.c:699</a></div></div>
<div class="ttc" id="group__netsock_html_gga7d60538bf88b652d40af16a55f8eb39da3400866eb4662e1174dfe9195441f64b"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gga7d60538bf88b652d40af16a55f8eb39da3400866eb4662e1174dfe9195441f64b">M0_NET_SOCK_PROTO_GET</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03873">sock.c:3873</a></div></div>
<div class="ttc" id="group__netsock_html_ga9ba243c1f191db3785f0c9950e95266a"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga9ba243c1f191db3785f0c9950e95266a">autotm</a></div><div class="ttdeci">static char autotm[1024]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02578">sock.c:2578</a></div></div>
<div class="ttc" id="structmover_html_a4daf9d9599efabce6dcdfb868e2b5a9c"><div class="ttname"><a href="../../d1/d99/structmover.html#a4daf9d9599efabce6dcdfb868e2b5a9c">mover::m_nob</a></div><div class="ttdeci">m0_bcount_t m_nob</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00876">sock.c:876</a></div></div>
<div class="ttc" id="group__bitmap_html_ga0f9db6f3dbbce95cfc769ea48843d3f2"><div class="ttname"><a href="../../df/df3/group__bitmap.html#ga0f9db6f3dbbce95cfc769ea48843d3f2">m0_bitmap_init</a></div><div class="ttdeci">M0_INTERNAL int m0_bitmap_init(struct m0_bitmap *map, size_t nr)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9a/bitmap_8c_source.html#l00086">bitmap.c:86</a></div></div>
<div class="ttc" id="group__netsock_html_ga1cd83a8f97b7d63bd601f3d1fe184d67"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga1cd83a8f97b7d63bd601f3d1fe184d67">B_P</a></div><div class="ttdeci">#define B_P(b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00989">sock.c:989</a></div></div>
<div class="ttc" id="group__netsock_html_gaa44e650cf8e69290b8b265d8e706c7f4"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaa44e650cf8e69290b8b265d8e706c7f4">addr_eq</a></div><div class="ttdeci">static bool addr_eq(const struct addr *a0, const struct addr *a1)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02806">sock.c:2806</a></div></div>
<div class="ttc" id="sm_8h_html"><div class="ttname"><a href="../../d7/d56/sm_8h.html">sm.h</a></div></div>
<div class="ttc" id="group__mutex_html_ga18963570792098f5ab3cf3e8ede8046a"><div class="ttname"><a href="../../d0/d04/group__mutex.html#ga18963570792098f5ab3cf3e8ede8046a">m0_mutex_unlock</a></div><div class="ttdeci">M0_INTERNAL void m0_mutex_unlock(struct m0_mutex *mutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d62/mutex_8c_source.html#l00066">mutex.c:66</a></div></div>
<div class="ttc" id="group__netsock_html_gad243458e06517a7a34f083a6f226fb90"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gad243458e06517a7a34f083a6f226fb90">get_max_buffer_segment_size</a></div><div class="ttdeci">static m0_bcount_t get_max_buffer_segment_size(const struct m0_net_domain *)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01905">sock.c:1905</a></div></div>
<div class="ttc" id="group__netsock_html_ga85d8da4dc83ae2334a7422a46b355949"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga85d8da4dc83ae2334a7422a46b355949">sock_done</a></div><div class="ttdeci">static void sock_done(struct sock *s, bool balance)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02035">sock.c:2035</a></div></div>
<div class="ttc" id="trace_8h_html"><div class="ttname"><a href="../../d1/d1b/trace_8h.html">trace.h</a></div></div>
<div class="ttc" id="types_8h_html"><div class="ttname"><a href="../../d9/d49/types_8h.html">types.h</a></div></div>
<div class="ttc" id="string_8h_html_a2dc1ae82475e3a33c9e62abefd40fc73"><div class="ttname"><a href="../../da/d66/string_8h.html#a2dc1ae82475e3a33c9e62abefd40fc73">m0_strdup</a></div><div class="ttdeci">#define m0_strdup(s)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d66/string_8h_source.html#l00043">string.h:43</a></div></div>
<div class="ttc" id="group__netsock_html_ga29cb5f0cd1ec36cce44a8d9baa6a1746"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga29cb5f0cd1ec36cce44a8d9baa6a1746">ep_del</a></div><div class="ttdeci">static void ep_del(struct mover *w)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02431">sock.c:2431</a></div></div>
<div class="ttc" id="structmover__op_html_ab8beda65eddc61a5164c51e31768d1bb"><div class="ttname"><a href="../../d9/da1/structmover__op.html#ab8beda65eddc61a5164c51e31768d1bb">mover_op::o_op</a></div><div class="ttdeci">int(* o_op)(struct mover *self, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00808">sock.c:808</a></div></div>
<div class="ttc" id="structaddrdata_html_a640ae27554cd6f225fa8440610ea239e"><div class="ttname"><a href="../../df/dd9/structaddrdata.html#a640ae27554cd6f225fa8440610ea239e">addrdata::v_data</a></div><div class="ttdeci">char v_data[WADDR_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/net_2sock_2xcode_8h_source.html#l00069">xcode.h:69</a></div></div>
<div class="ttc" id="group__format_html_ga4d30f4095392dc864b6ff37123d73fed"><div class="ttname"><a href="../../dd/dc1/group__format.html#ga4d30f4095392dc864b6ff37123d73fed">m0_format_header_pack</a></div><div class="ttdeci">M0_INTERNAL void m0_format_header_pack(struct m0_format_header *dest, const struct m0_format_tag *src)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00040">format.c:40</a></div></div>
<div class="ttc" id="memory_8h_html"><div class="ttname"><a href="../../dc/d18/memory_8h.html">memory.h</a></div></div>
<div class="ttc" id="net_2sock_2xcode_8h_html_acc2e4347ca127dda560cd82fd5044b2a"><div class="ttname"><a href="../../da/da2/net_2sock_2xcode_8h.html#acc2e4347ca127dda560cd82fd5044b2a">p_footer</a></div><div class="ttdeci">struct m0_format_footer p_footer</div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/net_2sock_2xcode_8h_source.html#l00086">xcode.h:86</a></div></div>
<div class="ttc" id="group__netsock_html_gaaaa58dcfcdb1cc514329dc50bd3095b4"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaaaa58dcfcdb1cc514329dc50bd3095b4">writer_idle</a></div><div class="ttdeci">static int writer_idle(struct mover *self, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03612">sock.c:3612</a></div></div>
<div class="ttc" id="group__format_html_gaa8c1621ce128fe346c8e6bb5bd91c282"><div class="ttname"><a href="../../dd/dc1/group__format.html#gaa8c1621ce128fe346c8e6bb5bd91c282">m0_format_header_unpack</a></div><div class="ttdeci">M0_INTERNAL void m0_format_header_unpack(struct m0_format_tag *dest, const struct m0_format_header *src)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00049">format.c:49</a></div></div>
<div class="ttc" id="m0t1fs_2linux__kernel_2dir_8c_html_a1e4cb2455f92782546a91bf8b5953aca"><div class="ttname"><a href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a1e4cb2455f92782546a91bf8b5953aca">flags</a></div><div class="ttdeci">int const char const void size_t int flags</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c_source.html#l00328">dir.c:328</a></div></div>
<div class="ttc" id="group__netsock_html_gaae7a60c600aecff6e08ebb32cf387475"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaae7a60c600aecff6e08ebb32cf387475">sock_close</a></div><div class="ttdeci">static void sock_close(struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01989">sock.c:1989</a></div></div>
<div class="ttc" id="ut_2rwlock_8c_html_a1d2a9f68c117ca7f7fdcb220f4c08fa4"><div class="ttname"><a href="../../d1/d41/ut_2rwlock_8c.html#a1d2a9f68c117ca7f7fdcb220f4c08fa4">q</a></div><div class="ttdeci">static struct m0_semaphore q</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/ut_2rwlock_8c_source.html#l00055">rwlock.c:55</a></div></div>
<div class="ttc" id="structm0__net__buffer_html"><div class="ttname"><a href="../../d9/d7e/structm0__net__buffer.html">m0_net_buffer</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01316">net.h:1316</a></div></div>
<div class="ttc" id="group__netsock_html_ga69b566f47f16edf4094db7e7794ddac7"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga69b566f47f16edf4094db7e7794ddac7">ma_invariant</a></div><div class="ttdeci">static bool ma_invariant(const struct ma *ma)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01216">sock.c:1216</a></div></div>
<div class="ttc" id="lib_2user__space_2misc_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../db/df8/lib_2user__space_2misc_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../db/df8/lib_2user__space_2misc_8h_source.html#l00038">misc.h:38</a></div></div>
<div class="ttc" id="structm0__net__buffer_html_a82a78a85f6bfa614dfad3da5ad714dd0"><div class="ttname"><a href="../../d9/d7e/structm0__net__buffer.html#a82a78a85f6bfa614dfad3da5ad714dd0">m0_net_buffer::nb_offset</a></div><div class="ttdeci">m0_bindex_t nb_offset</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01344">net.h:1344</a></div></div>
<div class="ttc" id="group__netsock_html_ga8a644fbe7fd0461e873a5a65f8d7d7ab"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga8a644fbe7fd0461e873a5a65f8d7d7ab">poller</a></div><div class="ttdeci">static void poller(struct ma *ma)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01360">sock.c:1360</a></div></div>
<div class="ttc" id="group__bitmap_html_ga0bd81180cdf7ef9abfb814a99fd9377a"><div class="ttname"><a href="../../df/df3/group__bitmap.html#ga0bd81180cdf7ef9abfb814a99fd9377a">m0_bitmap_fini</a></div><div class="ttdeci">M0_INTERNAL void m0_bitmap_fini(struct m0_bitmap *map)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9a/bitmap_8c_source.html#l00097">bitmap.c:97</a></div></div>
<div class="ttc" id="group__netsock_html_ga407a665abe98d73380b1333c033f6d63"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga407a665abe98d73380b1333c033f6d63">ip4_decode</a></div><div class="ttdeci">static void ip4_decode(struct addr *a, const struct sockaddr *sa)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02715">sock.c:2715</a></div></div>
<div class="ttc" id="group__netsock_html_ga3e46e3a9fe0688a77c21473c9b1a3dde"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga3e46e3a9fe0688a77c21473c9b1a3dde">sock_init</a></div><div class="ttdeci">static int sock_init(int fd, struct ep *src, struct ep *tgt, uint32_t flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02079">sock.c:2079</a></div></div>
<div class="ttc" id="ut_2consumer_8c_html_a68d1e4577870933f97f6909f74b31e29"><div class="ttname"><a href="../../d6/d7d/ut_2consumer_8c.html#a68d1e4577870933f97f6909f74b31e29">m</a></div><div class="ttdeci">static struct m0_addb2_mach * m</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d7d/ut_2consumer_8c_source.html#l00038">consumer.c:38</a></div></div>
<div class="ttc" id="magic_8h_html_a82bffe7189227eff068dab27a6040119a30b904fff35185374fee40103e5c1541"><div class="ttname"><a href="../../dd/d08/magic_8h.html#a82bffe7189227eff068dab27a6040119a30b904fff35185374fee40103e5c1541">M0_NET_SOCK_MOVER_HEAD_MAGIC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/magic_8h_source.html#l00696">magic.h:696</a></div></div>
<div class="ttc" id="group__netsock_html_ga2158d30690db2c9459c9a9226d9d15aa"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga2158d30690db2c9459c9a9226d9d15aa">pk_iov_prep</a></div><div class="ttdeci">static int pk_iov_prep(struct mover *m, struct iovec *iv, int nr, struct m0_bufvec *bv, m0_bcount_t size, int *count)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03177">sock.c:3177</a></div></div>
<div class="ttc" id="structmover_html_abd473b0a325187c40e68d6d4b325c739"><div class="ttname"><a href="../../d1/d99/structmover.html#abd473b0a325187c40e68d6d4b325c739">mover::m_magix</a></div><div class="ttdeci">uint64_t m_magix</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00847">sock.c:847</a></div></div>
<div class="ttc" id="group__addb2_html_ga7be2f145dc9b5b3220c69a52f0409b25"><div class="ttname"><a href="../../d0/d9e/group__addb2.html#ga7be2f145dc9b5b3220c69a52f0409b25">cur</a></div><div class="ttdeci">static struct buffer * cur(struct m0_addb2_mach *mach, m0_bcount_t space)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da1/addb2_8c_source.html#l00791">addb2.c:791</a></div></div>
<div class="ttc" id="group__netsock_html_ga916c31c6b0bf58b1c49128b94079fff8"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga916c31c6b0bf58b1c49128b94079fff8">sock_conf</a></div><div class="ttdeci">static const struct m0_sm_conf sock_conf</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01147">sock.c:1147</a></div></div>
<div class="ttc" id="structm0__net__buffer_html_a19d709b59dd6fd480b660cbe8217b0b2"><div class="ttname"><a href="../../d9/d7e/structm0__net__buffer.html#a19d709b59dd6fd480b660cbe8217b0b2">m0_net_buffer::nb_buffer</a></div><div class="ttdeci">struct m0_bufvec nb_buffer</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01322">net.h:1322</a></div></div>
<div class="ttc" id="string_8h_html"><div class="ttname"><a href="../../da/d66/string_8h.html">string.h</a></div></div>
<div class="ttc" id="namespaceerror__injection_html_a61569f2965b7a369eb10b6d75d410d11"><div class="ttname"><a href="../../d6/dca/namespaceerror__injection.html#a61569f2965b7a369eb10b6d75d410d11">error_injection.int</a></div><div class="ttdeci">int</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d20/error__injection_8py_source.html#l00051">error_injection.py:51</a></div></div>
<div class="ttc" id="group__netsock_html_gaf169bc1171797bdc8c2bb37224838416"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaf169bc1171797bdc8c2bb37224838416">dgram_idle</a></div><div class="ttdeci">static int dgram_idle(struct mover *self, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03523">sock.c:3523</a></div></div>
<div class="ttc" id="lib_2misc_8h_html_a7f75ab6839d468f4d23480a9c65724c5"><div class="ttname"><a href="../../df/d2a/lib_2misc_8h.html#a7f75ab6839d468f4d23480a9c65724c5">ergo</a></div><div class="ttdeci">#define ergo(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d2a/lib_2misc_8h_source.html#l00293">misc.h:293</a></div></div>
<div class="ttc" id="group__net__pvt_html_gaf0b898c77dcf888cc05e3493df2a6910"><div class="ttname"><a href="../../d0/d50/group__net__pvt.html#gaf0b898c77dcf888cc05e3493df2a6910">m0_net__tm_cancel</a></div><div class="ttdeci">M0_INTERNAL void m0_net__tm_cancel(struct m0_net_transfer_mc *tm)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd0/tm_8c_source.html#l00145">tm.c:145</a></div></div>
<div class="ttc" id="group__kthread_html_ga250c810f6cc1aad898687f5282314713"><div class="ttname"><a href="../../db/d41/group__kthread.html#ga250c810f6cc1aad898687f5282314713">m0_thread_join</a></div><div class="ttdeci">int m0_thread_join(struct m0_thread *q)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d05/kthread_8c_source.html#l00169">kthread.c:169</a></div></div>
<div class="ttc" id="structm0__net__buf__desc_html_ae6384407df6be15e382ed78aa0e15473"><div class="ttname"><a href="../../d0/db8/structm0__net__buf__desc.html#ae6384407df6be15e382ed78aa0e15473">m0_net_buf_desc::nbd_len</a></div><div class="ttdeci">uint32_t nbd_len</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d78/net__otw__types_8h_source.html#l00037">net_otw_types.h:37</a></div></div>
<div class="ttc" id="structm0__net__xprt_html"><div class="ttname"><a href="../../d5/da0/structm0__net__xprt.html">m0_net_xprt</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00124">net.h:124</a></div></div>
<div class="ttc" id="group__netsock_html_ga78251ee15fee7c0c5da7f01379891e47"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga78251ee15fee7c0c5da7f01379891e47">ep_ma</a></div><div class="ttdeci">static struct ma * ep_ma(struct ep *ep)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02387">sock.c:2387</a></div></div>
<div class="ttc" id="group__netsock_html_ga235a0794b76fd2426301e957c36dfc9c"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga235a0794b76fd2426301e957c36dfc9c">m0_net_sock_mod_init</a></div><div class="ttdeci">M0_INTERNAL int m0_net_sock_mod_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03933">sock.c:3933</a></div></div>
<div class="ttc" id="structmover_html"><div class="ttname"><a href="../../d1/d99/structmover.html">mover</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00846">sock.c:846</a></div></div>
<div class="ttc" id="errno_8h_html"><div class="ttname"><a href="../../d8/dc2/errno_8h.html">errno.h</a></div></div>
<div class="ttc" id="structm0__sm__conf_html"><div class="ttname"><a href="../../de/dbb/structm0__sm__conf.html">m0_sm_conf</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d56/sm_8h_source.html#l00350">sm.h:350</a></div></div>
<div class="ttc" id="magic_8h_html_a82bffe7189227eff068dab27a6040119a32d28878571141d2702fa633e19f7956"><div class="ttname"><a href="../../dd/d08/magic_8h.html#a82bffe7189227eff068dab27a6040119a32d28878571141d2702fa633e19f7956">M0_NET_SOCK_MOVER_MAGIC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/magic_8h_source.html#l00693">magic.h:693</a></div></div>
<div class="ttc" id="structbuf_html_a29fb49838c5d9685aa56e9c32c0dab54"><div class="ttname"><a href="../../d9/dd0/structbuf.html#a29fb49838c5d9685aa56e9c32c0dab54">buf::b_cookie</a></div><div class="ttdeci">uint64_t b_cookie</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00890">sock.c:890</a></div></div>
<div class="ttc" id="group__stob_html_ga3efb0e1a16208deecbd84c15401f7cf8"><div class="ttname"><a href="../../d9/d6a/group__stob.html#ga3efb0e1a16208deecbd84c15401f7cf8">f</a></div><div class="ttdeci">static FILE * f</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d14/adieu_8c_source.html#l00080">adieu.c:80</a></div></div>
<div class="ttc" id="group__addb2_html_ga3dd636d15d8f375bf0f0fb3c0505231f"><div class="ttname"><a href="../../d0/d9e/group__addb2.html#ga3dd636d15d8f375bf0f0fb3c0505231f">tag</a></div><div class="ttdeci">static uint64_t tag(uint8_t code, uint64_t id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da1/addb2_8c_source.html#l01047">addb2.c:1047</a></div></div>
<div class="ttc" id="group__netsock_html_ga714f0d57ccf1e2483267c981523a2864"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga714f0d57ccf1e2483267c981523a2864">stream_pk_done</a></div><div class="ttdeci">static int stream_pk_done(struct mover *self, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03492">sock.c:3492</a></div></div>
<div class="ttc" id="time_8h_html"><div class="ttname"><a href="../../de/df7/time_8h.html">time.h</a></div></div>
<div class="ttc" id="structma_html_a8d69a44fe8c21a67f1e6c63253a7824e"><div class="ttname"><a href="../../d8/dee/structma.html#a8d69a44fe8c21a67f1e6c63253a7824e">ma::t_poller</a></div><div class="ttdeci">struct m0_thread t_poller</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00793">sock.c:793</a></div></div>
<div class="ttc" id="group__time_html_ga3e0d20573b53285374bbd0c65a7a42eb"><div class="ttname"><a href="../../d9/d7d/group__time.html#ga3e0d20573b53285374bbd0c65a7a42eb">m0_time_t</a></div><div class="ttdeci">uint64_t m0_time_t</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00037">time.h:37</a></div></div>
<div class="ttc" id="group__netsock_html_ga08a2e9fc0c071a8d9af463180a71fd54"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga08a2e9fc0c071a8d9af463180a71fd54">pk_tsize</a></div><div class="ttdeci">static m0_bcount_t pk_tsize(const struct mover *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03132">sock.c:3132</a></div></div>
<div class="ttc" id="group__trace_html_gabf13f904bc760a195c4e3b75fa471f58"><div class="ttname"><a href="../../d8/d98/group__trace.html#gabf13f904bc760a195c4e3b75fa471f58">M0_LOG</a></div><div class="ttdeci">#define M0_LOG(level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d1b/trace_8h_source.html#l00167">trace.h:167</a></div></div>
<div class="ttc" id="m0t1fs_2linux__kernel_2dir_8c_html_ad1c2b8b0cf1cc0d319e690c0bef9569e"><div class="ttname"><a href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#ad1c2b8b0cf1cc0d319e690c0bef9569e">M0_LEAVE</a></div><div class="ttdeci">M0_LEAVE()</div></div>
<div class="ttc" id="m0hsm__api_8c_html_aa52ea6a123f47db5e6b145e5fc5e369aa8d8e435ab97a976436593ad9c058ec4a"><div class="ttname"><a href="../../d0/d8c/m0hsm__api_8c.html#aa52ea6a123f47db5e6b145e5fc5e369aa8d8e435ab97a976436593ad9c058ec4a">MAX_LEN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8c/m0hsm__api_8c_source.html#l00093">m0hsm_api.c:93</a></div></div>
<div class="ttc" id="group__net__buffer__pool_html_ga98cfb317097d1024cca11a4c5af51b9c"><div class="ttname"><a href="../../d8/d01/group__net__buffer__pool.html#ga98cfb317097d1024cca11a4c5af51b9c">m0_net_buffer_pool_unlock</a></div><div class="ttdeci">M0_INTERNAL void m0_net_buffer_pool_unlock(struct m0_net_buffer_pool *pool)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d83/buffer__pool_8c_source.html#l00203">buffer_pool.c:203</a></div></div>
<div class="ttc" id="group__netsock_html_ga14e6c41476564f25463e5b82fb17454f"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga14e6c41476564f25463e5b82fb17454f">ma_lock</a></div><div class="ttdeci">static void ma_lock(struct ma *ma)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01342">sock.c:1342</a></div></div>
<div class="ttc" id="structaddr_html_a5f0f751a9bdbdd75feadad5803d13285"><div class="ttname"><a href="../../d9/db9/structaddr.html#a5f0f751a9bdbdd75feadad5803d13285">addr::a_socktype</a></div><div class="ttdeci">uint32_t a_socktype</div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/net_2sock_2xcode_8h_source.html#l00075">xcode.h:75</a></div></div>
<div class="ttc" id="structm0__net__transfer__mc_html_a65dc683b82f708154ef6debc8b2a7629"><div class="ttname"><a href="../../d4/d78/structm0__net__transfer__mc.html#a65dc683b82f708154ef6debc8b2a7629">m0_net_transfer_mc::ntm_group</a></div><div class="ttdeci">struct m0_sm_group ntm_group</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00821">net.h:821</a></div></div>
<div class="ttc" id="group__net_html_gga4a25e727e622f7aaaedfe8ffa01fa005a6d67ad80a2bedad4348a39bc2282cd1c"><div class="ttname"><a href="../../d9/dd2/group__net.html#gga4a25e727e622f7aaaedfe8ffa01fa005a6d67ad80a2bedad4348a39bc2282cd1c">M0_NET_QT_MSG_SEND</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00596">net.h:596</a></div></div>
<div class="ttc" id="group__netsock_html_ga92af4fb43448938aec447314de63ead1"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga92af4fb43448938aec447314de63ead1">stream_idle</a></div><div class="ttdeci">static int stream_idle(struct mover *self, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03447">sock.c:3447</a></div></div>
<div class="ttc" id="group__netsock_html_ga429999edeace62099ef3af8bd784d97d"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga429999edeace62099ef3af8bd784d97d">mover_init</a></div><div class="ttdeci">static void mover_init(struct mover *m, struct ma *ma, const struct mover_op_vec *vop)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02999">sock.c:2999</a></div></div>
<div class="ttc" id="structm0__net__buf__desc_html_a78814b06c233d6ed4e5f933f4c444cd7"><div class="ttname"><a href="../../d0/db8/structm0__net__buf__desc.html#a78814b06c233d6ed4e5f933f4c444cd7">m0_net_buf_desc::nbd_data</a></div><div class="ttdeci">uint8_t * nbd_data</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d78/net__otw__types_8h_source.html#l00038">net_otw_types.h:38</a></div></div>
<div class="ttc" id="magic_8h_html_a82bffe7189227eff068dab27a6040119ac62a4c66a91e970592f239e3f4f9f312"><div class="ttname"><a href="../../dd/d08/magic_8h.html#a82bffe7189227eff068dab27a6040119ac62a4c66a91e970592f239e3f4f9f312">M0_NET_SOCK_SOCK_MAGIC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/magic_8h_source.html#l00687">magic.h:687</a></div></div>
<div class="ttc" id="structbuf_html_a1fad047c5710429941a570879286459f"><div class="ttname"><a href="../../d9/dd0/structbuf.html#a1fad047c5710429941a570879286459f">buf::b_length</a></div><div class="ttdeci">m0_bindex_t b_length</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00909">sock.c:909</a></div></div>
<div class="ttc" id="structm0__bufvec_html_ad790ff2243358efb3defea0a266a4503"><div class="ttname"><a href="../../da/d2c/structm0__bufvec.html#ad790ff2243358efb3defea0a266a4503">m0_bufvec::ov_vec</a></div><div class="ttdeci">struct m0_vec ov_vec</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d65/vec_8h_source.html#l00147">vec.h:147</a></div></div>
<div class="ttc" id="group__netsock_html_gaf1d3252cd239283ea83af68fed6f78ca"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaf1d3252cd239283ea83af68fed6f78ca">ma__fini</a></div><div class="ttdeci">static void ma__fini(struct ma *ma)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01484">sock.c:1484</a></div></div>
<div class="ttc" id="structm0__net__transfer__mc_html_a4fde71affafb898e2a3f4d8153cea8d1"><div class="ttname"><a href="../../d4/d78/structm0__net__transfer__mc.html#a4fde71affafb898e2a3f4d8153cea8d1">m0_net_transfer_mc::ntm_state</a></div><div class="ttdeci">enum m0_net_tm_state ntm_state</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00819">net.h:819</a></div></div>
<div class="ttc" id="structma_html"><div class="ttname"><a href="../../d8/dee/structma.html">ma</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00772">sock.c:772</a></div></div>
<div class="ttc" id="structm0__net__buffer_html_a719f71a97b21a0b81358f883d3c5c2cf"><div class="ttname"><a href="../../d9/d7e/structm0__net__buffer.html#a719f71a97b21a0b81358f883d3c5c2cf">m0_net_buffer::nb_length</a></div><div class="ttdeci">m0_bcount_t nb_length</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01334">net.h:1334</a></div></div>
<div class="ttc" id="structm0__net__buffer_html_a812faa986d50d32e318c06cc330cf195"><div class="ttname"><a href="../../d9/d7e/structm0__net__buffer.html#a812faa986d50d32e318c06cc330cf195">m0_net_buffer::nb_flags</a></div><div class="ttdeci">uint64_t nb_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01489">net.h:1489</a></div></div>
<div class="ttc" id="group__netsock_html_gae71a95ee2475544498101a69c50b50e0"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gae71a95ee2475544498101a69c50b50e0">ma_confine</a></div><div class="ttdeci">static int ma_confine(struct m0_net_transfer_mc *ma, const struct m0_bitmap *processors)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01619">sock.c:1619</a></div></div>
<div class="ttc" id="structmover_html_a4dedef8ceff4a5f475a2de0c5e1a4cc9"><div class="ttname"><a href="../../d1/d99/structmover.html#a4dedef8ceff4a5f475a2de0c5e1a4cc9">mover::m_pkbuf</a></div><div class="ttdeci">char m_pkbuf[sizeof(struct packet)]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00871">sock.c:871</a></div></div>
<div class="ttc" id="structm0__net__transfer__mc_html"><div class="ttname"><a href="../../d4/d78/structm0__net__transfer__mc.html">m0_net_transfer_mc</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00811">net.h:811</a></div></div>
<div class="ttc" id="group__net_html_ggaec9cfded6bc6b9349030aaa4567ba007adc299d95655914620169514c19683107"><div class="ttname"><a href="../../d9/dd2/group__net.html#ggaec9cfded6bc6b9349030aaa4567ba007adc299d95655914620169514c19683107">M0_NET_TEV_STATE_CHANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00643">net.h:643</a></div></div>
<div class="ttc" id="structmover__op__vec_html_a966fde66dc94059be9485d9effb30ea4"><div class="ttname"><a href="../../d3/d91/structmover__op__vec.html#a966fde66dc94059be9485d9effb30ea4">mover_op_vec::v_name</a></div><div class="ttdeci">const char * v_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00827">sock.c:827</a></div></div>
<div class="ttc" id="group__net_html_ga810f62fdcaf6ab41add4f828a03a8aab"><div class="ttname"><a href="../../d9/dd2/group__net.html#ga810f62fdcaf6ab41add4f828a03a8aab">m0_net_xprt_default_set</a></div><div class="ttdeci">M0_INTERNAL void m0_net_xprt_default_set(const struct m0_net_xprt *xprt)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/da5/net_2net_8c_source.html#l00143">net.c:143</a></div></div>
<div class="ttc" id="group__xcode_html_gga39540fe756fec0792fdc0cc5cf7ab4b0afc23e1849575201e0d52ebc191af0107"><div class="ttname"><a href="../../dd/d6d/group__xcode.html#gga39540fe756fec0792fdc0cc5cf7ab4b0afc23e1849575201e0d52ebc191af0107">M0_XCODE_ENCODE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d12/xcode_2xcode_8h_source.html#l00648">xcode.h:648</a></div></div>
<div class="ttc" id="group__net_html_ga2232890cb77bcf9969b217df250eab63"><div class="ttname"><a href="../../d9/dd2/group__net.html#ga2232890cb77bcf9969b217df250eab63">m0_net__ep_invariant</a></div><div class="ttdeci">M0_INTERNAL bool m0_net__ep_invariant(struct m0_net_end_point *ep, struct m0_net_transfer_mc *tm, bool under_tm_mutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d44/ep_8c_source.html#l00042">ep.c:42</a></div></div>
<div class="ttc" id="group__netsock_html_ga37552715ad676e57ef041ea8bf86616b"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga37552715ad676e57ef041ea8bf86616b">get_tag</a></div><div class="ttdeci">static const struct m0_format_tag get_tag</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01159">sock.c:1159</a></div></div>
<div class="ttc" id="net_2sock_2xcode_8h_html"><div class="ttname"><a href="../../da/da2/net_2sock_2xcode_8h.html">xcode.h</a></div></div>
<div class="ttc" id="group__netsock_html_ga87fd9494dc7688b4f4cddb2bc5bfbaaa"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga87fd9494dc7688b4f4cddb2bc5bfbaaa">ep_create</a></div><div class="ttdeci">static int ep_create(struct ma *ma, struct addr *addr, const char *name, struct ep **out)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02333">sock.c:2333</a></div></div>
<div class="ttc" id="group__netsock_html_ga87024d181bcdab57ece0bc28a5aaa0fd"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga87024d181bcdab57ece0bc28a5aaa0fd">SOCK_P</a></div><div class="ttdeci">#define SOCK_P(s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00984">sock.c:984</a></div></div>
<div class="ttc" id="types_8h_html_a4f7930f80649d778aee0bd974ff16645"><div class="ttname"><a href="../../d9/d49/types_8h.html#a4f7930f80649d778aee0bd974ff16645">m0_bindex_t</a></div><div class="ttdeci">uint64_t m0_bindex_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d49/types_8h_source.html#l00080">types.h:80</a></div></div>
<div class="ttc" id="lib_2misc_8h_html_a1446f7688b06ecc811aed5f93a4a7b43"><div class="ttname"><a href="../../df/d2a/lib_2misc_8h.html#a1446f7688b06ecc811aed5f93a4a7b43">m0_exists</a></div><div class="ttdeci">#define m0_exists(var, nr,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d2a/lib_2misc_8h_source.html#l00134">misc.h:134</a></div></div>
<div class="ttc" id="group__netsock_html_ga45a84b5062bc213795304baca5b13f74"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga45a84b5062bc213795304baca5b13f74">ep_add</a></div><div class="ttdeci">static int ep_add(struct ep *ep, struct mover *w)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02414">sock.c:2414</a></div></div>
<div class="ttc" id="structmover_html_a1ae1f926434f6a0fa9ce813927773bff"><div class="ttname"><a href="../../d1/d99/structmover.html#a1ae1f926434f6a0fa9ce813927773bff">mover::m_sock</a></div><div class="ttdeci">struct sock * m_sock</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00859">sock.c:859</a></div></div>
<div class="ttc" id="group__netsock_html_gafe00935b90da1e6a5c7315945de225c4"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gafe00935b90da1e6a5c7315945de225c4">addr_invariant</a></div><div class="ttdeci">static bool addr_invariant(const struct addr *addr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01275">sock.c:1275</a></div></div>
<div class="ttc" id="lib_2misc_8h_html_ae644c20b9d43e4e0810716647b3d16be"><div class="ttname"><a href="../../df/d2a/lib_2misc_8h.html#ae644c20b9d43e4e0810716647b3d16be">M0_BITS</a></div><div class="ttdeci">#define M0_BITS(...)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d2a/lib_2misc_8h_source.html#l00236">misc.h:236</a></div></div>
<div class="ttc" id="group__vec_html_gae76766a88069edeffeb892b1efe79d09"><div class="ttname"><a href="../../d0/d7f/group__vec.html#gae76766a88069edeffeb892b1efe79d09">m0_bufvec_cursor_addr</a></div><div class="ttdeci">M0_INTERNAL void * m0_bufvec_cursor_addr(struct m0_bufvec_cursor *cur)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/vec_8c_source.html#l00597">vec.c:597</a></div></div>
<div class="ttc" id="types_8h_html_a754ca36f0e1fff3edef4f267024b1a1f"><div class="ttname"><a href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a></div><div class="ttdeci">uint64_t m0_bcount_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d49/types_8h_source.html#l00077">types.h:77</a></div></div>
<div class="ttc" id="structsock_html_abebb1e2d51bd6b3b68ea4bfd8653eba3"><div class="ttname"><a href="../../dd/d74/structsock.html#abebb1e2d51bd6b3b68ea4bfd8653eba3">sock::s_linkage</a></div><div class="ttdeci">struct m0_tlink s_linkage</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00925">sock.c:925</a></div></div>
<div class="ttc" id="group__thread_html_gadfa88d6ec630f9ef157f5ac6fd3cb778"><div class="ttname"><a href="../../da/dd8/group__thread.html#gadfa88d6ec630f9ef157f5ac6fd3cb778">M0_THREAD_INIT</a></div><div class="ttdeci">#define M0_THREAD_INIT(thread, TYPE, init, func, arg, namefmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dd5/thread_8h_source.html#l00139">thread.h:139</a></div></div>
<div class="ttc" id="group__netsock_html_gae6f42c83bbf4ab42da96adcb1aa02522"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gae6f42c83bbf4ab42da96adcb1aa02522">pk_decode</a></div><div class="ttdeci">static void pk_decode(struct mover *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03431">sock.c:3431</a></div></div>
<div class="ttc" id="group__netsock_html_ga0f4c6f587f5574e2334e62b7c6ce9551"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga0f4c6f587f5574e2334e62b7c6ce9551">SOCK_F</a></div><div class="ttdeci">#define SOCK_F</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00983">sock.c:983</a></div></div>
<div class="ttc" id="refs_8h_html"><div class="ttname"><a href="../../d5/df7/refs_8h.html">refs.h</a></div></div>
<div class="ttc" id="structbuf_html_a01f42002dae28fb693128ce02d8d0c9f"><div class="ttname"><a href="../../d9/dd0/structbuf.html#a01f42002dae28fb693128ce02d8d0c9f">buf::b_linkage</a></div><div class="ttdeci">struct m0_tlink b_linkage</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00902">sock.c:902</a></div></div>
<div class="ttc" id="m0t1fs_2linux__kernel_2dir_8c_html_a4b9218d5c001301e593c59b2f36f9d17"><div class="ttname"><a href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a4b9218d5c001301e593c59b2f36f9d17">buf</a></div><div class="ttdeci">static int void * buf</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c_source.html#l01019">dir.c:1019</a></div></div>
<div class="ttc" id="structbdesc_html_a34dcb14937ab90ea7bd8ae288a9418d2"><div class="ttname"><a href="../../d5/d0e/structbdesc.html#a34dcb14937ab90ea7bd8ae288a9418d2">bdesc::bd_cookie</a></div><div class="ttdeci">struct m0_cookie bd_cookie</div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/net_2sock_2xcode_8h_source.html#l00091">xcode.h:91</a></div></div>
<div class="ttc" id="structpacket_html_ae24cb9793897065fc8fbcf28ebfec797"><div class="ttname"><a href="../../df/de8/structpacket.html#ae24cb9793897065fc8fbcf28ebfec797">packet::p_header</a></div><div class="ttdeci">struct m0_format_header p_header</div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/net_2sock_2xcode_8h_source.html#l00097">xcode.h:97</a></div></div>
<div class="ttc" id="structm0__net__end__point_html_a737da65a4b01c33c2014c861e38f7398"><div class="ttname"><a href="../../d2/d80/structm0__net__end__point.html#a737da65a4b01c33c2014c861e38f7398">m0_net_end_point::nep_addr</a></div><div class="ttdeci">const char * nep_addr</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00503">net.h:503</a></div></div>
<div class="ttc" id="structm0__net__buffer__event_html_a51e035eb76ce452d07baba911e6b969d"><div class="ttname"><a href="../../db/d0c/structm0__net__buffer__event.html#a51e035eb76ce452d07baba911e6b969d">m0_net_buffer_event::nbe_offset</a></div><div class="ttdeci">m0_bindex_t nbe_offset</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01238">net.h:1238</a></div></div>
<div class="ttc" id="lib_2user__space_2misc_8h_html_af8c317a42292b61c93aae91e59118a46"><div class="ttname"><a href="../../db/df8/lib_2user__space_2misc_8h.html#af8c317a42292b61c93aae91e59118a46">container_of</a></div><div class="ttdeci">#define container_of(ptr, type, member)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/df8/lib_2user__space_2misc_8h_source.html#l00033">misc.h:33</a></div></div>
<div class="ttc" id="group__xcode_html_ga39540fe756fec0792fdc0cc5cf7ab4b0"><div class="ttname"><a href="../../dd/d6d/group__xcode.html#ga39540fe756fec0792fdc0cc5cf7ab4b0">m0_xcode_what</a></div><div class="ttdeci">m0_xcode_what</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d12/xcode_2xcode_8h_source.html#l00647">xcode.h:647</a></div></div>
<div class="ttc" id="lib_2misc_8h_html_ae0d2e870ac085d7b16c48c2c52765009"><div class="ttname"><a href="../../df/d2a/lib_2misc_8h.html#ae0d2e870ac085d7b16c48c2c52765009">M0_SET0</a></div><div class="ttdeci">#define M0_SET0(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d2a/lib_2misc_8h_source.html#l00064">misc.h:64</a></div></div>
<div class="ttc" id="group__netsock_html_ga0e3ad3a7a46dc2e839552650c5489cf4"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga0e3ad3a7a46dc2e839552650c5489cf4">ep__print</a></div><div class="ttdeci">M0_INTERNAL void ep__print(const struct ep *ep)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03985">sock.c:3985</a></div></div>
<div class="ttc" id="group__mutex_html_gae26efdb3a765f750c5992041d6ee2336"><div class="ttname"><a href="../../d0/d04/group__mutex.html#gae26efdb3a765f750c5992041d6ee2336">m0_mutex_lock</a></div><div class="ttdeci">M0_INTERNAL void m0_mutex_lock(struct m0_mutex *mutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d62/mutex_8c_source.html#l00049">mutex.c:49</a></div></div>
<div class="ttc" id="magic_8h_html"><div class="ttname"><a href="../../dd/d08/magic_8h.html">magic.h</a></div></div>
<div class="ttc" id="group__netsock_html_ga2ca93efdb493d25d0eabb1d9722070c0"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga2ca93efdb493d25d0eabb1d9722070c0">EP_PUT</a></div><div class="ttdeci">#define EP_PUT(e, f)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01209">sock.c:1209</a></div></div>
<div class="ttc" id="structbuf_html_a85f97c6e705fc8e0e25da5b8b7ef2824"><div class="ttname"><a href="../../d9/dd0/structbuf.html#a85f97c6e705fc8e0e25da5b8b7ef2824">buf::b_offset</a></div><div class="ttdeci">m0_bindex_t b_offset</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00904">sock.c:904</a></div></div>
<div class="ttc" id="structep_html_aa1c8901cba3b2ad15bcb1599772f8e96"><div class="ttname"><a href="../../da/da7/structep.html#aa1c8901cba3b2ad15bcb1599772f8e96">ep::e_r_mover</a></div><div class="ttdeci">int e_r_mover</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00764">sock.c:764</a></div></div>
<div class="ttc" id="group__netsock_html_ga1352bb10167f7b9c749707b10b082a9f"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga1352bb10167f7b9c749707b10b082a9f">m0_net_sock_mod_fini</a></div><div class="ttdeci">M0_INTERNAL void m0_net_sock_mod_fini(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03957">sock.c:3957</a></div></div>
<div class="ttc" id="group__xcode_html_gga39540fe756fec0792fdc0cc5cf7ab4b0a693a7692be6745d64eb42c7715c5d893"><div class="ttname"><a href="../../dd/d6d/group__xcode.html#gga39540fe756fec0792fdc0cc5cf7ab4b0a693a7692be6745d64eb42c7715c5d893">M0_XCODE_DECODE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d12/xcode_2xcode_8h_source.html#l00649">xcode.h:649</a></div></div>
<div class="ttc" id="structm0__net__buffer__event_html_aca84768232b6c1bee823c636806391fe"><div class="ttname"><a href="../../db/d0c/structm0__net__buffer__event.html#aca84768232b6c1bee823c636806391fe">m0_net_buffer_event::nbe_length</a></div><div class="ttdeci">m0_bcount_t nbe_length</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01226">net.h:1226</a></div></div>
<div class="ttc" id="group__vec_html_ga91b552c4f3207320a242bd099e304883"><div class="ttname"><a href="../../d0/d7f/group__vec.html#ga91b552c4f3207320a242bd099e304883">m0_data_to_bufvec_copy</a></div><div class="ttdeci">M0_INTERNAL int m0_data_to_bufvec_copy(struct m0_bufvec_cursor *cur, void *data, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/vec_8c_source.html#l00946">vec.c:946</a></div></div>
<div class="ttc" id="structm0__net__buffer__event_html_a148f11166aa7f66f018aaf3d75dad81f"><div class="ttname"><a href="../../db/d0c/structm0__net__buffer__event.html#a148f11166aa7f66f018aaf3d75dad81f">m0_net_buffer_event::nbe_buffer</a></div><div class="ttdeci">struct m0_net_buffer * nbe_buffer</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01194">net.h:1194</a></div></div>
<div class="ttc" id="group__netsock_html_gac11937bd71bc58ad75da8f7973aa3ddf"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gac11937bd71bc58ad75da8f7973aa3ddf">ma_unlock</a></div><div class="ttdeci">static void ma_unlock(struct ma *ma)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01347">sock.c:1347</a></div></div>
<div class="ttc" id="structbuf_html_aebfa795c2499f9ffbb7391dbfc94981e"><div class="ttname"><a href="../../d9/dd0/structbuf.html#aebfa795c2499f9ffbb7391dbfc94981e">buf::b_peer</a></div><div class="ttdeci">struct bdesc b_peer</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00898">sock.c:898</a></div></div>
<div class="ttc" id="group__netsock_html_ga643216df42cd41316bad263fdcf690ad"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga643216df42cd41316bad263fdcf690ad">pk_io</a></div><div class="ttdeci">static int pk_io(struct mover *w, struct sock *s, uint64_t flag, struct m0_bufvec *bv, m0_bcount_t size)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03222">sock.c:3222</a></div></div>
<div class="ttc" id="group__netsock_html_gab7beaa2515ba0faa730209abea6ed21d"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gab7beaa2515ba0faa730209abea6ed21d">writer_pk_done</a></div><div class="ttdeci">static int writer_pk_done(struct mover *self, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03658">sock.c:3658</a></div></div>
<div class="ttc" id="group__netsock_html_gab1deb8e1ba4744c222d7b95ea6d93752"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gab1deb8e1ba4744c222d7b95ea6d93752">writer_pk</a></div><div class="ttdeci">static int writer_pk(struct mover *self, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03629">sock.c:3629</a></div></div>
<div class="ttc" id="group__net_html_gaff7a97dce21f4689aba444caaf0dc00b"><div class="ttname"><a href="../../d9/dd2/group__net.html#gaff7a97dce21f4689aba444caaf0dc00b">m0_net_buffer_event_post</a></div><div class="ttdeci">M0_INTERNAL void m0_net_buffer_event_post(const struct m0_net_buffer_event *ev)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dff/net_2buf_8c_source.html#l00314">buf.c:314</a></div></div>
<div class="ttc" id="group__netsock_html_ga9963c546f67a16058c52e3e7eab7135c"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga9963c546f67a16058c52e3e7eab7135c">pk_encdec</a></div><div class="ttdeci">static void pk_encdec(struct mover *m, enum m0_xcode_what what)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03419">sock.c:3419</a></div></div>
<div class="ttc" id="structm0__net__buffer__event_html_a58518ab93e41d0d78e75ca97305f05e6"><div class="ttname"><a href="../../db/d0c/structm0__net__buffer__event.html#a58518ab93e41d0d78e75ca97305f05e6">m0_net_buffer_event::nbe_ep</a></div><div class="ttdeci">struct m0_net_end_point * nbe_ep</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01251">net.h:1251</a></div></div>
<div class="ttc" id="structsock_html_a4f142f45799c6f3ad8de534340993083"><div class="ttname"><a href="../../dd/d74/structsock.html#a4f142f45799c6f3ad8de534340993083">sock::s_flags</a></div><div class="ttdeci">uint64_t s_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00918">sock.c:918</a></div></div>
<div class="ttc" id="linux__kernel_2types_8h_html_aba38357387a474f439428dee1984fc5a"><div class="ttname"><a href="../../d2/de1/linux__kernel_2types_8h.html#aba38357387a474f439428dee1984fc5a">PRIx64</a></div><div class="ttdeci">#define PRIx64</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de1/linux__kernel_2types_8h_source.html#l00061">types.h:61</a></div></div>
<div class="ttc" id="structma_html_abdee7b3d9f72fefb859aaae81d4731d8"><div class="ttname"><a href="../../d8/dee/structma.html#abdee7b3d9f72fefb859aaae81d4731d8">ma::t_shutdown</a></div><div class="ttdeci">bool t_shutdown</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00796">sock.c:796</a></div></div>
<div class="ttc" id="structmover_html_aaaca63f1cdbf4c52c0c81e350ccc5f00"><div class="ttname"><a href="../../d1/d99/structmover.html#aaaca63f1cdbf4c52c0c81e350ccc5f00">mover::m_pk</a></div><div class="ttdeci">struct packet m_pk</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00869">sock.c:869</a></div></div>
<div class="ttc" id="structbuf_html"><div class="ttname"><a href="../../d9/dd0/structbuf.html">buf</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00887">sock.c:887</a></div></div>
<div class="ttc" id="ut_2xcode_8c_html_a5f7d24ded17bf1ab44fdadf38c54a8b5"><div class="ttname"><a href="../../d6/d0c/ut_2xcode_8c.html#a5f7d24ded17bf1ab44fdadf38c54a8b5">count</a></div><div class="ttdeci">static m0_bcount_t count</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d0c/ut_2xcode_8c_source.html#l00167">xcode.c:167</a></div></div>
<div class="ttc" id="group__net_html_ga93051c2ca6262088898f15dc82d4008d"><div class="ttname"><a href="../../d9/dd2/group__net.html#ga93051c2ca6262088898f15dc82d4008d">default_xo_rpc_max_segs_nr</a></div><div class="ttdeci">M0_INTERNAL uint32_t default_xo_rpc_max_segs_nr(struct m0_net_domain *ndom)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/da5/net_2net_8c_source.html#l00247">net.c:247</a></div></div>
<div class="ttc" id="structm0__net__transfer__mc_html_a4d20259926d66ad4922f26d196260c97"><div class="ttname"><a href="../../d4/d78/structm0__net__transfer__mc.html#a4d20259926d66ad4922f26d196260c97">m0_net_transfer_mc::ntm_end_points</a></div><div class="ttdeci">struct m0_tl ntm_end_points</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00856">net.h:856</a></div></div>
<div class="ttc" id="group__net_html_gga4a25e727e622f7aaaedfe8ffa01fa005a17e109851881bbe14310ace19d6335d1"><div class="ttname"><a href="../../d9/dd2/group__net.html#gga4a25e727e622f7aaaedfe8ffa01fa005a17e109851881bbe14310ace19d6335d1">M0_NET_QT_PASSIVE_BULK_SEND</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00610">net.h:610</a></div></div>
<div class="ttc" id="structpacket_html_af1b549b8b454e86fe6a73f69134c2df9"><div class="ttname"><a href="../../df/de8/structpacket.html#af1b549b8b454e86fe6a73f69134c2df9">packet::p_offset</a></div><div class="ttdeci">m0_bindex_t p_offset</div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/net_2sock_2xcode_8h_source.html#l00112">xcode.h:112</a></div></div>
<div class="ttc" id="group__tlist_html_gaef8bbd93c23f12be0bfbb16ced9ad206"><div class="ttname"><a href="../../d7/d08/group__tlist.html#gaef8bbd93c23f12be0bfbb16ced9ad206">m0_tl_endfor</a></div><div class="ttdeci">#define m0_tl_endfor</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d30/tlist_8h_source.html#l00700">tlist.h:700</a></div></div>
<div class="ttc" id="structpacket_html_a6d94b987cf8b45d98aca1c543fc084f4"><div class="ttname"><a href="../../df/de8/structpacket.html#a6d94b987cf8b45d98aca1c543fc084f4">packet::p_idx</a></div><div class="ttdeci">uint32_t p_idx</div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/net_2sock_2xcode_8h_source.html#l00103">xcode.h:103</a></div></div>
<div class="ttc" id="group__net_html_gga1936206a7485cc1c14e35c6e0d348a38aedcce3f60d38c656f02ff5e483e147bc"><div class="ttname"><a href="../../d9/dd2/group__net.html#gga1936206a7485cc1c14e35c6e0d348a38aedcce3f60d38c656f02ff5e483e147bc">M0_NET_BUF_REGISTERED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01278">net.h:1278</a></div></div>
<div class="ttc" id="structbuf_html_a65bbee1059773d953d6c79dd44b04401"><div class="ttname"><a href="../../d9/dd0/structbuf.html#a65bbee1059773d953d6c79dd44b04401">buf::b_done</a></div><div class="ttdeci">struct m0_bitmap b_done</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00896">sock.c:896</a></div></div>
<div class="ttc" id="m0t1fs_2linux__kernel_2dir_8c_html_a9a02a790ad457506f9f3bc12121e6079"><div class="ttname"><a href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a9a02a790ad457506f9f3bc12121e6079">M0_RC</a></div><div class="ttdeci">return M0_RC(rc)</div></div>
<div class="ttc" id="libdemo_8c_html_a99a30df0f2488360cdd46b4b88e5f5f0"><div class="ttname"><a href="../../d3/d1b/libdemo_8c.html#a99a30df0f2488360cdd46b4b88e5f5f0">op</a></div><div class="ttdeci">op</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d1b/libdemo_8c_source.html#l00064">libdemo.c:64</a></div></div>
<div class="ttc" id="structep_html"><div class="ttname"><a href="../../da/da7/structep.html">ep</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00754">sock.c:754</a></div></div>
<div class="ttc" id="group__netsock_html_ga02f3f80057e9c21bfbdf4993dc6ba169"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga02f3f80057e9c21bfbdf4993dc6ba169">mover_is_writer</a></div><div class="ttdeci">static bool mover_is_writer(const struct mover *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03115">sock.c:3115</a></div></div>
<div class="ttc" id="tlist_8h_html"><div class="ttname"><a href="../../d2/d30/tlist_8h.html">tlist.h</a></div></div>
<div class="ttc" id="structm0__net__transfer__mc_html_a2754c804d4265d5dd78c6ea474b2becb"><div class="ttname"><a href="../../d4/d78/structm0__net__transfer__mc.html#a2754c804d4265d5dd78c6ea474b2becb">m0_net_transfer_mc::ntm_chan</a></div><div class="ttdeci">struct m0_chan ntm_chan</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00874">net.h:874</a></div></div>
<div class="ttc" id="group__netsock_html_gga6c152f6e1ae044464fc6f6655a5ae35ca2d8a44ef484e0c3387f049bf8778987e"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca2d8a44ef484e0c3387f049bf8778987e">M_NR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00703">sock.c:703</a></div></div>
<div class="ttc" id="group__netsock_html_ga4d04d2d80f14221e812b0d455d4639c9"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga4d04d2d80f14221e812b0d455d4639c9">mover_invariant</a></div><div class="ttdeci">static bool mover_invariant(const struct mover *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01320">sock.c:1320</a></div></div>
<div class="ttc" id="group__trace_html_ga6548fb7186df5dbebd72d1bcbce1cbc3"><div class="ttname"><a href="../../d8/d98/group__trace.html#ga6548fb7186df5dbebd72d1bcbce1cbc3">M0_ENTRY</a></div><div class="ttdeci">#define M0_ENTRY(...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d1b/trace_8h_source.html#l00170">trace.h:170</a></div></div>
<div class="ttc" id="group__netsock_html_ga925c36d21e3c699446204c869a3e521e"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga925c36d21e3c699446204c869a3e521e">writer_write</a></div><div class="ttdeci">static int writer_write(struct mover *self, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03646">sock.c:3646</a></div></div>
<div class="ttc" id="group__netsock_html_gadbe2464eb0dd92b5b19e5f2cfe21b715"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gadbe2464eb0dd92b5b19e5f2cfe21b715">sock_invariant</a></div><div class="ttdeci">static bool sock_invariant(const struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01250">sock.c:1250</a></div></div>
<div class="ttc" id="structpacket_html_a2f889d4045a0ee242a0f9f75311dcf72"><div class="ttname"><a href="../../df/de8/structpacket.html#a2f889d4045a0ee242a0f9f75311dcf72">packet::p_totalsize</a></div><div class="ttdeci">m0_bcount_t p_totalsize</div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/net_2sock_2xcode_8h_source.html#l00114">xcode.h:114</a></div></div>
<div class="ttc" id="group__netsock_html_ga98d09139fd60f6dd4f1200e42646b498"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga98d09139fd60f6dd4f1200e42646b498">ep_balance</a></div><div class="ttdeci">static int ep_balance(struct ep *ep)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02456">sock.c:2456</a></div></div>
<div class="ttc" id="group__netsock_html_ga7da4b8d0066b704056c040ddd9845aa7"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga7da4b8d0066b704056c040ddd9845aa7">EP_GET</a></div><div class="ttdeci">#define EP_GET(e, f)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01207">sock.c:1207</a></div></div>
<div class="ttc" id="group__net__pvt_html_ga10b81fec0a61efae5b970c93c8166031"><div class="ttname"><a href="../../d0/d50/group__net__pvt.html#ga10b81fec0a61efae5b970c93c8166031">m0_net__tm_provision_buf</a></div><div class="ttdeci">M0_INTERNAL int m0_net__tm_provision_buf(struct m0_net_transfer_mc *tm)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d82/tm__provision_8c_source.html#l00414">tm_provision.c:414</a></div></div>
<div class="ttc" id="group__netsock_html_ga75c3bacd4693a09b670e17916de5f0da"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga75c3bacd4693a09b670e17916de5f0da">stream_pk_size</a></div><div class="ttdeci">static m0_bcount_t stream_pk_size(const struct mover *w, const struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03504">sock.c:3504</a></div></div>
<div class="ttc" id="group__vec_html_ga0519cf756af050c693a2b1ddc67394ef"><div class="ttname"><a href="../../d0/d7f/group__vec.html#ga0519cf756af050c693a2b1ddc67394ef">m0_bufvec_cursor_move</a></div><div class="ttdeci">M0_INTERNAL bool m0_bufvec_cursor_move(struct m0_bufvec_cursor *cur, m0_bcount_t count)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/vec_8c_source.html#l00574">vec.c:574</a></div></div>
<div class="ttc" id="group__netsock_html_gaa35d272e8d4f283958b86460800e24cd"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaa35d272e8d4f283958b86460800e24cd">buf_deregister</a></div><div class="ttdeci">static void buf_deregister(struct m0_net_buffer *nb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01770">sock.c:1770</a></div></div>
<div class="ttc" id="node__k_8c_html_aa0e04e47800a4ae6a856f0fdb5426215"><div class="ttname"><a href="../../d6/dd4/node__k_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a></div><div class="ttdeci">static char * addr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd4/node__k_8c_source.html#l00037">node_k.c:37</a></div></div>
<div class="ttc" id="group__netsock_html_gab2a4957b29b0ff2f9b6abec6b37d71a6"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gab2a4957b29b0ff2f9b6abec6b37d71a6">pk_state</a></div><div class="ttdeci">static int pk_state(const struct mover *w)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03151">sock.c:3151</a></div></div>
<div class="ttc" id="m0t1fs_2linux__kernel_2dir_8c_html_a7e98b8a17c0aad30ba64d47b74e2a6c1"><div class="ttname"><a href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c_source.html#l01033">dir.c:1033</a></div></div>
<div class="ttc" id="format_8h_html"><div class="ttname"><a href="../../d0/d0a/format_8h.html">format.h</a></div></div>
<div class="ttc" id="group__netsock_html_ga69b44214debab83060d1387e07cebade"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga69b44214debab83060d1387e07cebade">ip4_encode</a></div><div class="ttdeci">static void ip4_encode(const struct addr *a, struct sockaddr *sa)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02702">sock.c:2702</a></div></div>
<div class="ttc" id="group__netsock_html_gac94eaec48aa0330f08aad1dac30716f5"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gac94eaec48aa0330f08aad1dac30716f5">dom_fini</a></div><div class="ttdeci">static void dom_fini(struct m0_net_domain *dom)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01336">sock.c:1336</a></div></div>
<div class="ttc" id="group__net_html_gga1936206a7485cc1c14e35c6e0d348a38addfdd273e0a3eeb2f63aded3cea7e61d"><div class="ttname"><a href="../../d9/dd2/group__net.html#gga1936206a7485cc1c14e35c6e0d348a38addfdd273e0a3eeb2f63aded3cea7e61d">M0_NET_BUF_TIMED_OUT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01286">net.h:1286</a></div></div>
<div class="ttc" id="structm0__format__tag_html_a41e90e49c1af83c3f87c701b2ec2da92"><div class="ttname"><a href="../../d3/d99/structm0__format__tag.html#a41e90e49c1af83c3f87c701b2ec2da92">m0_format_tag::ot_version</a></div><div class="ttdeci">uint16_t ot_version</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0a/format_8h_source.html#l00063">format.h:63</a></div></div>
<div class="ttc" id="group__netsock_html_ggafb7c011cf74bbdbc6d54539a53224c39a7418706169c4419c7ceb4553a8416673"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39a7418706169c4419c7ceb4553a8416673">HAS_READ</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00709">sock.c:709</a></div></div>
<div class="ttc" id="group__netsock_html_gga65022b439e12c2b69863bb55134dd9a9a575df14f8416f291b63a463ddaa1c37f"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a575df14f8416f291b63a463ddaa1c37f">R_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00746">sock.c:746</a></div></div>
<div class="ttc" id="group__net_html_gab5569eded06d8e55513fe46e5add4ac8"><div class="ttname"><a href="../../d9/dd2/group__net.html#gab5569eded06d8e55513fe46e5add4ac8">m0_net_xprt_register</a></div><div class="ttdeci">M0_INTERNAL void m0_net_xprt_register(const struct m0_net_xprt *xprt)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/da5/net_2net_8c_source.html#l00182">net.c:182</a></div></div>
<div class="ttc" id="structmover__op_html_af280ae6a9e633322df0554bfdda29ad7"><div class="ttname"><a href="../../d9/da1/structmover__op.html#af280ae6a9e633322df0554bfdda29ad7">mover_op::o_doesio</a></div><div class="ttdeci">bool o_doesio</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00815">sock.c:815</a></div></div>
<div class="ttc" id="group__arith_html_gaf09a62ac732850ebc8fb6c6e997a1ed7"><div class="ttname"><a href="../../db/dc9/group__arith.html#gaf09a62ac732850ebc8fb6c6e997a1ed7">max64</a></div><div class="ttdeci">static int64_t max64(int64_t a, int64_t b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/deb/arith_8h_source.html#l00051">arith.h:51</a></div></div>
<div class="ttc" id="structm0__net__buffer__event_html_a7776fd9f3f2ce6d0635e571ccf7374d4"><div class="ttname"><a href="../../db/d0c/structm0__net__buffer__event.html#a7776fd9f3f2ce6d0635e571ccf7374d4">m0_net_buffer_event::nbe_status</a></div><div class="ttdeci">int32_t nbe_status</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01218">net.h:1218</a></div></div>
<div class="ttc" id="structpfamily_html_a0d651171d046e2dff23fa92afd2a44ba"><div class="ttname"><a href="../../d3/d5d/structpfamily.html#a0d651171d046e2dff23fa92afd2a44ba">pfamily::f_name</a></div><div class="ttdeci">const char * f_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00957">sock.c:957</a></div></div>
<div class="ttc" id="structbdesc_html_a3c935369999fdd23bd11054c19df4703"><div class="ttname"><a href="../../d5/d0e/structbdesc.html#a3c935369999fdd23bd11054c19df4703">bdesc::bd_addr</a></div><div class="ttdeci">struct addr bd_addr</div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/net_2sock_2xcode_8h_source.html#l00090">xcode.h:90</a></div></div>
<div class="ttc" id="refs_8c_html_a96dc9c89402bf6a5782c951d9de8285b"><div class="ttname"><a href="../../d4/de4/refs_8c.html#a96dc9c89402bf6a5782c951d9de8285b">m0_ref_put</a></div><div class="ttdeci">M0_INTERNAL void m0_ref_put(struct m0_ref *ref)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/de4/refs_8c_source.html#l00038">refs.c:38</a></div></div>
<div class="ttc" id="group__trace_html_gadcff472fb398402105feb7fa41add0a5"><div class="ttname"><a href="../../d8/d98/group__trace.html#gadcff472fb398402105feb7fa41add0a5">M0_ERR_INFO</a></div><div class="ttdeci">#define M0_ERR_INFO(rc, fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d1b/trace_8h_source.html#l00215">trace.h:215</a></div></div>
<div class="ttc" id="group__netsock_html_ga7d9e1d49b40b58dcb0d60a64aa70c4aa"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga7d9e1d49b40b58dcb0d60a64aa70c4aa">ep_net</a></div><div class="ttdeci">static struct ep * ep_net(struct m0_net_end_point *net)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02393">sock.c:2393</a></div></div>
<div class="ttc" id="refs_8c_html_a5d62779a5f7a71f16a43727e524117e0"><div class="ttname"><a href="../../d4/de4/refs_8c.html#a5d62779a5f7a71f16a43727e524117e0">m0_ref_init</a></div><div class="ttdeci">void m0_ref_init(struct m0_ref *ref, int init_num, void(*release)(struct m0_ref *ref))</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/de4/refs_8c_source.html#l00024">refs.c:24</a></div></div>
<div class="ttc" id="namespaceinflux__test__data_html_af8fb0f45ee0195c7422a49e6a8d72369"><div class="ttname"><a href="../../d4/d54/namespaceinflux__test__data.html#af8fb0f45ee0195c7422a49e6a8d72369">influx_test_data.port</a></div><div class="ttdeci">port</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/influx__test__data_8py_source.html#l00085">influx_test_data.py:85</a></div></div>
<div class="ttc" id="m0t1fs_2linux__kernel_2dir_8c_html_a01283f6c481bc4a3d0f204e957179d6e"><div class="ttname"><a href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e">M0_ERR</a></div><div class="ttdeci">return M0_ERR(-EOPNOTSUPP)</div></div>
<div class="ttc" id="group__netsock_html_ga02454243093b2104abbb1b183c2223a8"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga02454243093b2104abbb1b183c2223a8">xprt_ops</a></div><div class="ttdeci">static const struct m0_net_xprt_ops xprt_ops</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03888">sock.c:3888</a></div></div>
<div class="ttc" id="group__netsock_html_ga53079337909bf84060a165ba7eb1fc5d"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga53079337909bf84060a165ba7eb1fc5d">buf_del</a></div><div class="ttdeci">static void buf_del(struct m0_net_buffer *nb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01853">sock.c:1853</a></div></div>
<div class="ttc" id="refs_8c_html_ad4ed148978270f86b1af2ea8697f8aae"><div class="ttname"><a href="../../d4/de4/refs_8c.html#ad4ed148978270f86b1af2ea8697f8aae">m0_ref_get</a></div><div class="ttdeci">M0_INTERNAL void m0_ref_get(struct m0_ref *ref)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/de4/refs_8c_source.html#l00032">refs.c:32</a></div></div>
<div class="ttc" id="thread_8h_html"><div class="ttname"><a href="../../db/dd5/thread_8h.html">thread.h</a></div></div>
<div class="ttc" id="structsock_html_a9f16c5c31b0670702bd2d4bf0ac9cc81"><div class="ttname"><a href="../../dd/d74/structsock.html#a9f16c5c31b0670702bd2d4bf0ac9cc81">sock::s_fd</a></div><div class="ttdeci">int s_fd</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00916">sock.c:916</a></div></div>
<div class="ttc" id="structm0__net__transfer__mc_html_a8b18058969fa6fe0a12df59639accbe2"><div class="ttname"><a href="../../d4/d78/structm0__net__transfer__mc.html#a8b18058969fa6fe0a12df59639accbe2">m0_net_transfer_mc::ntm_xprt_private</a></div><div class="ttdeci">void * ntm_xprt_private</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00886">net.h:886</a></div></div>
<div class="ttc" id="group__netsock_html_gab9e8dc20b199a933933acfd3a5b0853f"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gab9e8dc20b199a933933acfd3a5b0853f">put_tag</a></div><div class="ttdeci">static const struct m0_format_tag put_tag</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01158">sock.c:1158</a></div></div>
<div class="ttc" id="group__netsock_html_ga12fee080a96fe0bee1c5bf5ccb564ac8"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga12fee080a96fe0bee1c5bf5ccb564ac8">ep_free</a></div><div class="ttdeci">static void ep_free(struct ep *ep)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02493">sock.c:2493</a></div></div>
<div class="ttc" id="group__netsock_html_gga7d60538bf88b652d40af16a55f8eb39da6a9c1823b35b1580d68ec6d8475b1a79"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gga7d60538bf88b652d40af16a55f8eb39da6a9c1823b35b1580d68ec6d8475b1a79">M0_NET_SOCK_PROTO_PUT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03872">sock.c:3872</a></div></div>
<div class="ttc" id="group__netsock_html_gaea9acfa0baa7ea23380d77247e9894d6"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaea9acfa0baa7ea23380d77247e9894d6">ma_is_locked</a></div><div class="ttdeci">static bool ma_is_locked(const struct ma *ma)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01352">sock.c:1352</a></div></div>
<div class="ttc" id="group__netsock_html_ga41bd19654c4aa2b6f9cbfb78c32b953a"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga41bd19654c4aa2b6f9cbfb78c32b953a">sock_event</a></div><div class="ttdeci">static bool sock_event(struct sock *s, uint32_t ev)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02201">sock.c:2201</a></div></div>
<div class="ttc" id="trace_8c_html_a2ad9738f50c0af6e81d06c44de813d98"><div class="ttname"><a href="../../d8/ddc/trace_8c.html#a2ad9738f50c0af6e81d06c44de813d98">name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddc/trace_8c_source.html#l00110">trace.c:110</a></div></div>
<div class="ttc" id="magic_8h_html_a82bffe7189227eff068dab27a6040119a2a4fc13216e88ce327872fb39eccedd3"><div class="ttname"><a href="../../dd/d08/magic_8h.html#a82bffe7189227eff068dab27a6040119a2a4fc13216e88ce327872fb39eccedd3">M0_NET_SOCK_SOCK_HEAD_MAGIC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/magic_8h_source.html#l00690">magic.h:690</a></div></div>
<div class="ttc" id="structmover_html_a009dde470277f894204e183285891cca"><div class="ttname"><a href="../../d1/d99/structmover.html#a009dde470277f894204e183285891cca">mover::m_buf</a></div><div class="ttdeci">struct buf * m_buf</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00867">sock.c:867</a></div></div>
<div class="ttc" id="structm0__ref_html"><div class="ttname"><a href="../../dd/d3f/structm0__ref.html">m0_ref</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/df7/refs_8h_source.html#l00034">refs.h:34</a></div></div>
<div class="ttc" id="group__netsock_html_ga2c304ecfc57668f0196522601f103071"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga2c304ecfc57668f0196522601f103071">stype</a></div><div class="ttdeci">static const struct socktype stype[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01156">sock.c:1156</a></div></div>
<div class="ttc" id="structm0__net__buffer_html_afacc91b5275a95609cdf10a1568f9a19"><div class="ttname"><a href="../../d9/d7e/structm0__net__buffer.html#afacc91b5275a95609cdf10a1568f9a19">m0_net_buffer::nb_qtype</a></div><div class="ttdeci">enum m0_net_queue_type nb_qtype</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01363">net.h:1363</a></div></div>
<div class="ttc" id="group__netsock_html_gga65022b439e12c2b69863bb55134dd9a9a63581c61e8680cb3c6be0310a4e19e81"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a63581c61e8680cb3c6be0310a4e19e81">R_IDLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00741">sock.c:741</a></div></div>
<div class="ttc" id="group__netsock_html_gafea137fe2248694702f66bd158c45022"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gafea137fe2248694702f66bd158c45022">buf_ma</a></div><div class="ttdeci">static struct ma * buf_ma(struct buf *buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02823">sock.c:2823</a></div></div>
<div class="ttc" id="group__netsock_html_ga7b11e10d73d8c362dcc9575556eae75a"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga7b11e10d73d8c362dcc9575556eae75a">EP_PL</a></div><div class="ttdeci">#define EP_PL(e)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00981">sock.c:981</a></div></div>
<div class="ttc" id="structsock_html_a6b4cebb106f36737b769484fa3f280df"><div class="ttname"><a href="../../dd/d74/structsock.html#a6b4cebb106f36737b769484fa3f280df">sock::s_last</a></div><div class="ttdeci">m0_time_t s_last</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00927">sock.c:927</a></div></div>
<div class="ttc" id="group__vec_html_gad481d7c4ffe49912e0cca7c0262baa0b"><div class="ttname"><a href="../../d0/d7f/group__vec.html#gad481d7c4ffe49912e0cca7c0262baa0b">m0_bufvec_cursor_step</a></div><div class="ttdeci">M0_INTERNAL m0_bcount_t m0_bufvec_cursor_step(const struct m0_bufvec_cursor *cur)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/vec_8c_source.html#l00581">vec.c:581</a></div></div>
<div class="ttc" id="structm0__net__domain_html"><div class="ttname"><a href="../../db/d78/structm0__net__domain.html">m0_net_domain</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00376">net.h:376</a></div></div>
<div class="ttc" id="group__net_html_ggaaa9dbf6c20e7f07dfe6fc3746f6183e2abbe89cdedac94d27fe1eeb53c4a82ffe"><div class="ttname"><a href="../../d9/dd2/group__net.html#ggaaa9dbf6c20e7f07dfe6fc3746f6183e2abbe89cdedac94d27fe1eeb53c4a82ffe">M0_NET_TM_STARTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00634">net.h:634</a></div></div>
<div class="ttc" id="group__memory_html_ga09f97acbce99e3114130a74a59062b2c"><div class="ttname"><a href="../../d7/ded/group__memory.html#ga09f97acbce99e3114130a74a59062b2c">m0_free0</a></div><div class="ttdeci">#define m0_free0(pptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/memory_8h_source.html#l00077">memory.h:77</a></div></div>
<div class="ttc" id="structm0__format__tag_html"><div class="ttname"><a href="../../d3/d99/structm0__format__tag.html">m0_format_tag</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0a/format_8h_source.html#l00062">format.h:62</a></div></div>
<div class="ttc" id="structm0__net__xprt__ops_html"><div class="ttname"><a href="../../da/dca/structm0__net__xprt__ops.html">m0_net_xprt_ops</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00133">net.h:133</a></div></div>
<div class="ttc" id="group__netsock_html_ga6c152f6e1ae044464fc6f6655a5ae35c"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga6c152f6e1ae044464fc6f6655a5ae35c">mover_opcode</a></div><div class="ttdeci">mover_opcode</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00698">sock.c:698</a></div></div>
<div class="ttc" id="assert_8h_html_ac8bebb1ebb72c1dae891a1a1c24e7aec"><div class="ttname"><a href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a></div><div class="ttdeci">#define M0_ASSERT(cond)</div></div>
<div class="ttc" id="structm0__net__buffer_html_a497bfb73d57da600b22403a389003815"><div class="ttname"><a href="../../d9/d7e/structm0__net__buffer.html#a497bfb73d57da600b22403a389003815">m0_net_buffer::nb_timeout</a></div><div class="ttdeci">m0_time_t nb_timeout</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01387">net.h:1387</a></div></div>
<div class="ttc" id="structm0__sm__conf_html_a72045b32a59ed51c06d4dfdc321fc654"><div class="ttname"><a href="../../de/dbb/structm0__sm__conf.html#a72045b32a59ed51c06d4dfdc321fc654">m0_sm_conf::scf_name</a></div><div class="ttdeci">const char * scf_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d56/sm_8h_source.html#l00352">sm.h:352</a></div></div>
<div class="ttc" id="group__netsock_html_gac7538a7758c679505dbbff33552d1a34"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gac7538a7758c679505dbbff33552d1a34">sock_conf_state</a></div><div class="ttdeci">static struct m0_sm_state_descr sock_conf_state[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03714">sock.c:3714</a></div></div>
<div class="ttc" id="group__mutex_html_ga0c96633d90ccf7e2ed6ffee75d983975"><div class="ttname"><a href="../../d0/d04/group__mutex.html#ga0c96633d90ccf7e2ed6ffee75d983975">m0_mutex_is_locked</a></div><div class="ttdeci">M0_INTERNAL bool m0_mutex_is_locked(const struct m0_mutex *mutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d62/mutex_8c_source.html#l00095">mutex.c:95</a></div></div>
<div class="ttc" id="magic_8h_html_a82bffe7189227eff068dab27a6040119a015d48412488befb0ddf1c4db9d2e8d2"><div class="ttname"><a href="../../dd/d08/magic_8h.html#a82bffe7189227eff068dab27a6040119a015d48412488befb0ddf1c4db9d2e8d2">M0_NET_SOCK_BUF_HEAD_MAGIC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/magic_8h_source.html#l00702">magic.h:702</a></div></div>
<div class="ttc" id="group__netsock_html_ga908d163d92427d231903fa6e41a0abac"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga908d163d92427d231903fa6e41a0abac">stream_header</a></div><div class="ttdeci">static int stream_header(struct mover *self, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03466">sock.c:3466</a></div></div>
<div class="ttc" id="lib_2cookie_8h_html"><div class="ttname"><a href="../../d5/d85/lib_2cookie_8h.html">cookie.h</a></div></div>
<div class="ttc" id="group__netsock_html_ga2db0d962bdf2f6c2bcdc183f1a44592f"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga2db0d962bdf2f6c2bcdc183f1a44592f">ma_stop</a></div><div class="ttdeci">static int ma_stop(struct m0_net_transfer_mc *ma, bool cancel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01603">sock.c:1603</a></div></div>
<div class="ttc" id="group__netsock_html_gga65022b439e12c2b69863bb55134dd9a9a16de0923aedc356f652438ff75d553c2"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a16de0923aedc356f652438ff75d553c2">R_PK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00742">sock.c:742</a></div></div>
<div class="ttc" id="group__time_html_ga793cbf6341b841b090d83d0dea2993fa"><div class="ttname"><a href="../../d9/d7d/group__time.html#ga793cbf6341b841b090d83d0dea2993fa">m0_time_now</a></div><div class="ttdeci">m0_time_t m0_time_now(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d73/time_8c_source.html#l00134">time.c:134</a></div></div>
<div class="ttc" id="group__sm_html_ga44ae6c237c23107f3a9c5b9202582416"><div class="ttname"><a href="../../d1/dc1/group__sm.html#ga44ae6c237c23107f3a9c5b9202582416">m0_sm_state_set</a></div><div class="ttdeci">void m0_sm_state_set(struct m0_sm *mach, int state)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1f/sm_8c_source.html#l00478">sm.c:478</a></div></div>
<div class="ttc" id="structma_html_a628f89b20b4000abc13078fc9ccf2354"><div class="ttname"><a href="../../d8/dee/structma.html#a628f89b20b4000abc13078fc9ccf2354">ma::t_deathrow</a></div><div class="ttdeci">struct m0_tl t_deathrow</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00798">sock.c:798</a></div></div>
<div class="ttc" id="config_8h_html_a675b855bd376c0fb7a9fca952de435ab"><div class="ttname"><a href="../../db/d16/config_8h.html#a675b855bd376c0fb7a9fca952de435ab">M0_DEFAULT_NETWORK</a></div><div class="ttdeci">#define M0_DEFAULT_NETWORK</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/config_8h_source.html#l00281">config.h:281</a></div></div>
<div class="ttc" id="structbdesc_html"><div class="ttname"><a href="../../d5/d0e/structbdesc.html">bdesc</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/net_2sock_2xcode_8h_source.html#l00089">xcode.h:89</a></div></div>
<div class="ttc" id="structm0__tl_html"><div class="ttname"><a href="../../d4/d8a/structm0__tl.html">m0_tl</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d30/tlist_8h_source.html#l00251">tlist.h:251</a></div></div>
<div class="ttc" id="group__netsock_html_ga7189084138c48f66266d05c5bd6e1fdb"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga7189084138c48f66266d05c5bd6e1fdb">addr_parse_lnet</a></div><div class="ttdeci">static int addr_parse_lnet(struct addr *addr, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02580">sock.c:2580</a></div></div>
<div class="ttc" id="structpacket_html"><div class="ttname"><a href="../../df/de8/structpacket.html">packet</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/net_2sock_2xcode_8h_source.html#l00095">xcode.h:95</a></div></div>
<div class="ttc" id="structm0__net__buffer__event_html"><div class="ttname"><a href="../../db/d0c/structm0__net__buffer__event.html">m0_net_buffer_event</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01192">net.h:1192</a></div></div>
<div class="ttc" id="group__netsock_html_ga0551d085ef008b4fac533739771a1eb7"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga0551d085ef008b4fac533739771a1eb7">addr_encode</a></div><div class="ttdeci">static void addr_encode(const struct addr *addr, struct sockaddr *sa)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02797">sock.c:2797</a></div></div>
<div class="ttc" id="group__net_html_gaaa9dbf6c20e7f07dfe6fc3746f6183e2"><div class="ttname"><a href="../../d9/dd2/group__net.html#gaaa9dbf6c20e7f07dfe6fc3746f6183e2">m0_net_tm_state</a></div><div class="ttdeci">m0_net_tm_state</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00630">net.h:630</a></div></div>
<div class="ttc" id="group__netsock_html_ga7d7e64eb8e44b6ffc187727ae565f1c4"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga7d7e64eb8e44b6ffc187727ae565f1c4">end_point_create</a></div><div class="ttdeci">static int end_point_create(struct m0_net_end_point **epp, struct m0_net_transfer_mc *ma, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01728">sock.c:1728</a></div></div>
<div class="ttc" id="string_8h_html_a0079aa9054e46c8034188e468fdb79f4"><div class="ttname"><a href="../../da/d66/string_8h.html#a0079aa9054e46c8034188e468fdb79f4">m0_streq</a></div><div class="ttdeci">#define m0_streq(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d66/string_8h_source.html#l00034">string.h:34</a></div></div>
<div class="ttc" id="group__netsock_html_gaab4a37d9eee8ab85cade8e0a0c877efd"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaab4a37d9eee8ab85cade8e0a0c877efd">mover__print</a></div><div class="ttdeci">M0_INTERNAL void mover__print(const struct mover *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03965">sock.c:3965</a></div></div>
<div class="ttc" id="group__netsock_html_ga8ee1bd6f751a2a078fc04723d6e88d33"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga8ee1bd6f751a2a078fc04723d6e88d33">pf</a></div><div class="ttdeci">static const struct pfamily pf[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01155">sock.c:1155</a></div></div>
<div class="ttc" id="group__netsock_html_ga5f25f2a8c8e86982bd9c99b99cb97b4e"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga5f25f2a8c8e86982bd9c99b99cb97b4e">rw_conf</a></div><div class="ttdeci">static const struct m0_sm_conf rw_conf</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01148">sock.c:1148</a></div></div>
<div class="ttc" id="group__netsock_html_gab694a18ebf526a77cfc704584c6a113f"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gab694a18ebf526a77cfc704584c6a113f">pk_encode</a></div><div class="ttdeci">static void pk_encode(struct mover *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03436">sock.c:3436</a></div></div>
<div class="ttc" id="structpfamily_html_abd6fbc18f045b5408003c90e81fab0c9"><div class="ttname"><a href="../../d3/d5d/structpfamily.html#abd6fbc18f045b5408003c90e81fab0c9">pfamily::f_decode</a></div><div class="ttdeci">void(* f_decode)(struct addr *a, const struct sockaddr *sa)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00969">sock.c:969</a></div></div>
<div class="ttc" id="group__thread_html_ga2a9d1d0b44cfa91b6fd83f66d2f4fc00"><div class="ttname"><a href="../../da/dd8/group__thread.html#ga2a9d1d0b44cfa91b6fd83f66d2f4fc00">m0_thread_fini</a></div><div class="ttdeci">void m0_thread_fini(struct m0_thread *q)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de7/thread_8c_source.html#l00092">thread.c:92</a></div></div>
<div class="ttc" id="group__netsock_html_ga204a3875802e9f8ff4b75db13dda46d3"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga204a3875802e9f8ff4b75db13dda46d3">MOCK_LNET</a></div><div class="ttdeci">#define MOCK_LNET</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00647">sock.c:647</a></div></div>
<div class="ttc" id="group__netsock_html_ga9cdacdb6229f7becd262087bcefc9715"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga9cdacdb6229f7becd262087bcefc9715">buf_add</a></div><div class="ttdeci">static int buf_add(struct m0_net_buffer *nb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01787">sock.c:1787</a></div></div>
<div class="ttc" id="addb2_2ut_2storage_8c_html_a6b9f7e6115c241d0a8ea3087490f1043"><div class="ttname"><a href="../../dc/d74/addb2_2ut_2storage_8c.html#a6b9f7e6115c241d0a8ea3087490f1043">dom</a></div><div class="ttdeci">static struct m0_stob_domain * dom</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d74/addb2_2ut_2storage_8c_source.html#l00038">storage.c:38</a></div></div>
<div class="ttc" id="structbuf_html_a11ed429feb7ad22be45284e8055fe465"><div class="ttname"><a href="../../d9/dd0/structbuf.html#a11ed429feb7ad22be45284e8055fe465">buf::b_buf</a></div><div class="ttdeci">struct m0_net_buffer * b_buf</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00892">sock.c:892</a></div></div>
<div class="ttc" id="structmover__op_html"><div class="ttname"><a href="../../d9/da1/structmover__op.html">mover_op</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00806">sock.c:806</a></div></div>
<div class="ttc" id="group__netsock_html_gacdf002b8647126915a19d1a0dfa6027d"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gacdf002b8647126915a19d1a0dfa6027d">m0_net_sock_xprt</a></div><div class="ttdeci">const struct m0_net_xprt m0_net_sock_xprt</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03927">sock.c:3927</a></div></div>
<div class="ttc" id="group__vec_html_ga25676feab636093b10797af188337efc"><div class="ttname"><a href="../../d0/d7f/group__vec.html#ga25676feab636093b10797af188337efc">m0_bufvec_cursor_init</a></div><div class="ttdeci">M0_INTERNAL void m0_bufvec_cursor_init(struct m0_bufvec_cursor *cur, const struct m0_bufvec *bvec)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/vec_8c_source.html#l00563">vec.c:563</a></div></div>
<div class="ttc" id="structma_html_a7fac31b01cd71bf3b8c7f6f4746adc1b"><div class="ttname"><a href="../../d8/dee/structma.html#a7fac31b01cd71bf3b8c7f6f4746adc1b">ma::t_epollfd</a></div><div class="ttdeci">int t_epollfd</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00795">sock.c:795</a></div></div>
<div class="ttc" id="group__xcode_html_ga5a25acd32d709d7f330cecebb563217e"><div class="ttname"><a href="../../dd/d6d/group__xcode.html#ga5a25acd32d709d7f330cecebb563217e">m0_xcode_obj_enc_to_buf</a></div><div class="ttdeci">M0_INTERNAL int m0_xcode_obj_enc_to_buf(struct m0_xcode_obj *obj, void **buf, m0_bcount_t *len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db2/xcode_8c_source.html#l00832">xcode.c:832</a></div></div>
<div class="ttc" id="group__netsock_html_gae9390c6a48f66a887e7e0929bd089c25"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gae9390c6a48f66a887e7e0929bd089c25">ep_invariant</a></div><div class="ttdeci">static bool ep_invariant(const struct ep *ep)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01286">sock.c:1286</a></div></div>
<div class="ttc" id="group__bitmap_html_ga7a3a03e4b5410c0c7d03179e42957001"><div class="ttname"><a href="../../df/df3/group__bitmap.html#ga7a3a03e4b5410c0c7d03179e42957001">m0_bitmap_ffz</a></div><div class="ttdeci">M0_INTERNAL int m0_bitmap_ffz(const struct m0_bitmap *map)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9a/bitmap_8c_source.html#l00126">bitmap.c:126</a></div></div>
<div class="ttc" id="structep_html_a10fa53c9fb4b7c26d14f7af762878d6c"><div class="ttname"><a href="../../da/da7/structep.html#a10fa53c9fb4b7c26d14f7af762878d6c">ep::e_r_buf</a></div><div class="ttdeci">int e_r_buf</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00766">sock.c:766</a></div></div>
<div class="ttc" id="structm0__net__transfer__mc_html_ac25a898a8ec2a7d4876cdd9ee7e5a19d"><div class="ttname"><a href="../../d4/d78/structm0__net__transfer__mc.html#ac25a898a8ec2a7d4876cdd9ee7e5a19d">m0_net_transfer_mc::ntm_callback_counter</a></div><div class="ttdeci">uint32_t ntm_callback_counter</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00850">net.h:850</a></div></div>
<div class="ttc" id="group__netsock_html_gga65022b439e12c2b69863bb55134dd9a9a943628239c02f3d0241ca831508900b5"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a943628239c02f3d0241ca831508900b5">R_INTERVAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00744">sock.c:744</a></div></div>
<div class="ttc" id="group__netsock_html_gga2a989014423ee897a1d4314f292babdba9d8566da037aa1256e85c81f275b7805"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba9d8566da037aa1256e85c81f275b7805">S_CONNECTING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00680">sock.c:680</a></div></div>
<div class="ttc" id="group__net_html_gaee2caeb05b63fb6fa403ba4d38034443"><div class="ttname"><a href="../../d9/dd2/group__net.html#gaee2caeb05b63fb6fa403ba4d38034443">default_xo_rpc_max_seg_size</a></div><div class="ttdeci">M0_INTERNAL m0_bcount_t default_xo_rpc_max_seg_size(struct m0_net_domain *ndom)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/da5/net_2net_8c_source.html#l00239">net.c:239</a></div></div>
<div class="ttc" id="structmover_html_adfeaac1889973a845e1674735bf1a625"><div class="ttname"><a href="../../d1/d99/structmover.html#adfeaac1889973a845e1674735bf1a625">mover::m_scratch</a></div><div class="ttdeci">void * m_scratch</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00881">sock.c:881</a></div></div>
<div class="ttc" id="group__netsock_html_ga023f04699c602a061ce4d4353e71c78a"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga023f04699c602a061ce4d4353e71c78a">mover_fini</a></div><div class="ttdeci">static void mover_fini(struct mover *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03010">sock.c:3010</a></div></div>
<div class="ttc" id="structmover__op__vec_html_a7eccb74f14ac85b2def28fe7951c8bb2"><div class="ttname"><a href="../../d3/d91/structmover__op__vec.html#a7eccb74f14ac85b2def28fe7951c8bb2">mover_op_vec::v_done</a></div><div class="ttdeci">void(* v_done)(struct mover *self, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00837">sock.c:837</a></div></div>
<div class="ttc" id="group__netsock_html_gad41ec2097710f43c74d3114562b8a48a"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gad41ec2097710f43c74d3114562b8a48a">addr_parse_native</a></div><div class="ttdeci">static int addr_parse_native(struct addr *addr, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02643">sock.c:2643</a></div></div>
<div class="ttc" id="group__netsock_html_ga2482df25ee4d73a2fcdfe64fdadd7079"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga2482df25ee4d73a2fcdfe64fdadd7079">sock_writer</a></div><div class="ttdeci">static struct mover * sock_writer(struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01999">sock.c:1999</a></div></div>
<div class="ttc" id="structpacket_html_ab6da0d119d7237ef2f5f1aaea9208c27"><div class="ttname"><a href="../../df/de8/structpacket.html#ab6da0d119d7237ef2f5f1aaea9208c27">packet::p_nr</a></div><div class="ttdeci">uint32_t p_nr</div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/net_2sock_2xcode_8h_source.html#l00108">xcode.h:108</a></div></div>
<div class="ttc" id="group__memory_html_ga80e6a4e9d078f93b5917555b7b3d3fec"><div class="ttname"><a href="../../d7/ded/group__memory.html#ga80e6a4e9d078f93b5917555b7b3d3fec">m0_alloc</a></div><div class="ttdeci">void * m0_alloc(size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd5/memory_8c_source.html#l00126">memory.c:126</a></div></div>
<div class="ttc" id="group__net_html_gaf4918bd635674075138b44a33c9044ef"><div class="ttname"><a href="../../d9/dd2/group__net.html#gaf4918bd635674075138b44a33c9044ef">m0_net_tm_event_post</a></div><div class="ttdeci">M0_INTERNAL void m0_net_tm_event_post(const struct m0_net_tm_event *ev)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd0/tm_8c_source.html#l00084">tm.c:84</a></div></div>
<div class="ttc" id="structm0__cookie_html_ae5970df1092738c774de9d877adfaec7"><div class="ttname"><a href="../../d7/d20/structm0__cookie.html#ae5970df1092738c774de9d877adfaec7">m0_cookie::co_generation</a></div><div class="ttdeci">uint64_t co_generation</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d85/lib_2cookie_8h_source.html#l00059">cookie.h:59</a></div></div>
<div class="ttc" id="group__net_html_gga1936206a7485cc1c14e35c6e0d348a38ae86d2cc38dc70add00f2614e05ff58f4"><div class="ttname"><a href="../../d9/dd2/group__net.html#gga1936206a7485cc1c14e35c6e0d348a38ae86d2cc38dc70add00f2614e05ff58f4">M0_NET_BUF_CANCELLED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01284">net.h:1284</a></div></div>
<div class="ttc" id="group__netsock_html_ga42954f73b21f92d35c9cc7cdafdf0cc6"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga42954f73b21f92d35c9cc7cdafdf0cc6">get_max_buffer_size</a></div><div class="ttdeci">static m0_bcount_t get_max_buffer_size(const struct m0_net_domain *dom)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01889">sock.c:1889</a></div></div>
<div class="ttc" id="structsocktype_html_a631f5466b3b1bd950fe9cb9391648272"><div class="ttname"><a href="../../d7/d2a/structsocktype.html#a631f5466b3b1bd950fe9cb9391648272">socktype::st_proto</a></div><div class="ttdeci">int st_proto</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00948">sock.c:948</a></div></div>
<div class="ttc" id="structm0__bufvec__cursor_html"><div class="ttname"><a href="../../d5/d06/structm0__bufvec__cursor.html">m0_bufvec_cursor</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d65/vec_8h_source.html#l00319">vec.h:319</a></div></div>
<div class="ttc" id="group__netsock_html_ga02696f30b89d4726a067ea78e2802bea"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga02696f30b89d4726a067ea78e2802bea">get_done</a></div><div class="ttdeci">static void get_done(struct mover *w, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03709">sock.c:3709</a></div></div>
<div class="ttc" id="group__netsock_html_ga57bdbf76bd38811d51a9e332f2e9aea0"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga57bdbf76bd38811d51a9e332f2e9aea0">buf_register</a></div><div class="ttdeci">static int buf_register(struct m0_net_buffer *nb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01749">sock.c:1749</a></div></div>
<div class="ttc" id="group__netsock_html_gga2a989014423ee897a1d4314f292babdba57451d0f52d3a8d7604c40753f7dd109"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdba57451d0f52d3a8d7604c40753f7dd109">S_DELETED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00690">sock.c:690</a></div></div>
<div class="ttc" id="group__netsock_html_ga47e5eb47dbd6e7dcaac7b58e6fc7e5b1"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga47e5eb47dbd6e7dcaac7b58e6fc7e5b1">sock_fini</a></div><div class="ttdeci">static void sock_fini(struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02011">sock.c:2011</a></div></div>
<div class="ttc" id="structsocktype_html_a0cbbaff8fcbc9fc999d25b371502fc3f"><div class="ttname"><a href="../../d7/d2a/structsocktype.html#a0cbbaff8fcbc9fc999d25b371502fc3f">socktype::st_pk_size</a></div><div class="ttdeci">m0_bcount_t(* st_pk_size)(const struct mover *w, const struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00940">sock.c:940</a></div></div>
<div class="ttc" id="structsocktype_html_a7694a7e62d9bb040c50f65a840633725"><div class="ttname"><a href="../../d7/d2a/structsocktype.html#a7694a7e62d9bb040c50f65a840633725">socktype::st_reader</a></div><div class="ttdeci">const struct mover_op_vec * st_reader</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00938">sock.c:938</a></div></div>
<div class="ttc" id="assert_8h_html_aea86d55595126b703b9e619887f09a22"><div class="ttname"><a href="../../dc/da7/assert_8h.html#aea86d55595126b703b9e619887f09a22">M0_POST</a></div><div class="ttdeci">#define M0_POST(cond)</div></div>
<div class="ttc" id="structaddr_html"><div class="ttname"><a href="../../d9/db9/structaddr.html">addr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/net_2sock_2xcode_8h_source.html#l00073">xcode.h:73</a></div></div>
<div class="ttc" id="group__netsock_html_gaa05d2431e69de06adf149afa0903de7b"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaa05d2431e69de06adf149afa0903de7b">sock_in</a></div><div class="ttdeci">static int sock_in(struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01959">sock.c:1959</a></div></div>
<div class="ttc" id="structm0__cookie_html_a5d4f5edddf9a8c03a372655cf460577c"><div class="ttname"><a href="../../d7/d20/structm0__cookie.html#a5d4f5edddf9a8c03a372655cf460577c">m0_cookie::co_addr</a></div><div class="ttdeci">uint64_t co_addr</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d85/lib_2cookie_8h_source.html#l00058">cookie.h:58</a></div></div>
<div class="ttc" id="structmover_html_a212cefc7f5b7749302619a3c811bd7e7"><div class="ttname"><a href="../../d1/d99/structmover.html#a212cefc7f5b7749302619a3c811bd7e7">mover::m_ep</a></div><div class="ttdeci">struct ep * m_ep</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00861">sock.c:861</a></div></div>
<div class="ttc" id="group__netsock_html_ga08bbaf5a7ac6a88d11c356fc7bcd34ef"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga08bbaf5a7ac6a88d11c356fc7bcd34ef">bev_deliver_all</a></div><div class="ttdeci">static void bev_deliver_all(struct m0_net_transfer_mc *ma)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01869">sock.c:1869</a></div></div>
<div class="ttc" id="group__sm_html_gga4f865c6bc4efb56250e807fe86cbe2cda6dd90f440b122b8032dc8613f927083a"><div class="ttname"><a href="../../d1/dc1/group__sm.html#gga4f865c6bc4efb56250e807fe86cbe2cda6dd90f440b122b8032dc8613f927083a">M0_SDF_TERMINAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d56/sm_8h_source.html#l00471">sm.h:471</a></div></div>
<div class="ttc" id="group__cookie_html_ga289890e8cb6e9317bf3b0ed7dc44076b"><div class="ttname"><a href="../../da/dd3/group__cookie.html#ga289890e8cb6e9317bf3b0ed7dc44076b">m0_cookie_init</a></div><div class="ttdeci">M0_INTERNAL void m0_cookie_init(struct m0_cookie *cookie, const uint64_t *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d41/lib_2cookie_8c_source.html#l00090">cookie.c:90</a></div></div>
<div class="ttc" id="group__bitmap_html_gaff8a25aa0c262e35cc2b260b51d2ace0"><div class="ttname"><a href="../../df/df3/group__bitmap.html#gaff8a25aa0c262e35cc2b260b51d2ace0">m0_bitmap_set</a></div><div class="ttdeci">M0_INTERNAL void m0_bitmap_set(struct m0_bitmap *map, size_t idx, bool val)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9a/bitmap_8c_source.html#l00139">bitmap.c:139</a></div></div>
<div class="ttc" id="group__netsock_html_ga659f364dd5da411dc3961db0fb7de77e"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga659f364dd5da411dc3961db0fb7de77e">ma_start</a></div><div class="ttdeci">static int ma_start(struct m0_net_transfer_mc *ma, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01551">sock.c:1551</a></div></div>
<div class="ttc" id="structm0__thread_html"><div class="ttname"><a href="../../d1/d67/structm0__thread.html">m0_thread</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dd5/thread_8h_source.html#l00110">thread.h:110</a></div></div>
<div class="ttc" id="structm0__sm_html_aae17393da3a8b1f9d299b515a73cd954"><div class="ttname"><a href="../../db/d49/structm0__sm.html#aae17393da3a8b1f9d299b515a73cd954">m0_sm::sm_rc</a></div><div class="ttdeci">int32_t sm_rc</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d56/sm_8h_source.html#l00336">sm.h:336</a></div></div>
<div class="ttc" id="group__netsock_html_gaf7d93c09d009488be1e33a3fb74e45a9"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaf7d93c09d009488be1e33a3fb74e45a9">pk_dnob</a></div><div class="ttdeci">static m0_bcount_t pk_dnob(const struct mover *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03140">sock.c:3140</a></div></div>
<div class="ttc" id="group__netsock_html_gga65022b439e12c2b69863bb55134dd9a9a5d340199a21a4f8b0934eda7e17efb79"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a5d340199a21a4f8b0934eda7e17efb79">STATE_NR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00750">sock.c:750</a></div></div>
<div class="ttc" id="structm0__chan_html"><div class="ttname"><a href="../../d0/d12/structm0__chan.html">m0_chan</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dcf/chan_8h_source.html#l00229">chan.h:229</a></div></div>
<div class="ttc" id="group__net_html_gga1936206a7485cc1c14e35c6e0d348a38a83ca4bce210bde991f2794ea9d5e54e8"><div class="ttname"><a href="../../d9/dd2/group__net.html#gga1936206a7485cc1c14e35c6e0d348a38a83ca4bce210bde991f2794ea9d5e54e8">M0_NET_BUF_RETAIN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01291">net.h:1291</a></div></div>
<div class="ttc" id="group__netsock_html_ga2d36be05d2b181e0e76ed02e4fe16b6e"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga2d36be05d2b181e0e76ed02e4fe16b6e">m0_net_lnet_xprt</a></div><div class="ttdeci">const struct m0_net_xprt m0_net_lnet_xprt</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dfa/lnet__xo_8c_source.html#l00679">lnet_xo.c:679</a></div></div>
<div class="ttc" id="structm0__net__end__point_html_a37cfc5c61a742cc97c8013820988dfa2"><div class="ttname"><a href="../../d2/d80/structm0__net__end__point.html#a37cfc5c61a742cc97c8013820988dfa2">m0_net_end_point::nep_tm</a></div><div class="ttdeci">struct m0_net_transfer_mc * nep_tm</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00493">net.h:493</a></div></div>
<div class="ttc" id="types_8h_html_a18efc29f05f292310db38a8c7e81dcdaa6b55ae4ed41442026238fc4b5629166e"><div class="ttname"><a href="../../d9/d49/types_8h.html#a18efc29f05f292310db38a8c7e81dcdaa6b55ae4ed41442026238fc4b5629166e">M0_BSIGNED_MAX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d49/types_8h_source.html#l00085">types.h:85</a></div></div>
<div class="ttc" id="group__netsock_html_ga87f26fc0b5e6e27c0130d1c1bd877ff8"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga87f26fc0b5e6e27c0130d1c1bd877ff8">ma_buf_done</a></div><div class="ttdeci">static void ma_buf_done(struct ma *ma)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01683">sock.c:1683</a></div></div>
<div class="ttc" id="chan_8h_html"><div class="ttname"><a href="../../d2/dcf/chan_8h.html">chan.h</a></div></div>
<div class="ttc" id="group__netsock_html_ga1378244d34c151c34550cddb28441154"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga1378244d34c151c34550cddb28441154">ep_get</a></div><div class="ttdeci">static void ep_get(struct ep *ep)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02507">sock.c:2507</a></div></div>
<div class="ttc" id="group__arith_html_ga3ab271ddef8d2ab1ee331f95138294b5"><div class="ttname"><a href="../../db/dc9/group__arith.html#ga3ab271ddef8d2ab1ee331f95138294b5">min64u</a></div><div class="ttdeci">static uint64_t min64u(uint64_t a, uint64_t b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/deb/arith_8h_source.html#l00066">arith.h:66</a></div></div>
<div class="ttc" id="group__net_html_gga4a25e727e622f7aaaedfe8ffa01fa005ae7cb093e47fc16794e9639d47a19a300"><div class="ttname"><a href="../../d9/dd2/group__net.html#gga4a25e727e622f7aaaedfe8ffa01fa005ae7cb093e47fc16794e9639d47a19a300">M0_NET_QT_ACTIVE_BULK_RECV</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00617">net.h:617</a></div></div>
<div class="ttc" id="structaddr_html_ad8ca990694d5e0a6cef86dd67ba2e6b7"><div class="ttname"><a href="../../d9/db9/structaddr.html#ad8ca990694d5e0a6cef86dd67ba2e6b7">addr::a_family</a></div><div class="ttdeci">uint32_t a_family</div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/net_2sock_2xcode_8h_source.html#l00074">xcode.h:74</a></div></div>
<div class="ttc" id="group__netsock_html_ga97fcfe2ab24d7ddf0d1a4e1d144cb94a"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga97fcfe2ab24d7ddf0d1a4e1d144cb94a">addr_resolve</a></div><div class="ttdeci">static int addr_resolve(struct addr *addr, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02518">sock.c:2518</a></div></div>
<div class="ttc" id="structsock_html_a6b1c16e61cb1a9524341d304929fe7d7"><div class="ttname"><a href="../../dd/d74/structsock.html#a6b1c16e61cb1a9524341d304929fe7d7">sock::s_ep</a></div><div class="ttdeci">struct ep * s_ep</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00921">sock.c:921</a></div></div>
<div class="ttc" id="group__netsock_html_ga37e31a2f36872125309e4bcb50a89e33"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga37e31a2f36872125309e4bcb50a89e33">bev_deliver_sync</a></div><div class="ttdeci">static int bev_deliver_sync(struct m0_net_transfer_mc *ma)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01864">sock.c:1864</a></div></div>
<div class="ttc" id="structm0__net__transfer__mc_html_a142b6d767fee3f0ae250a85a0e6f968a"><div class="ttname"><a href="../../d4/d78/structm0__net__transfer__mc.html#a142b6d767fee3f0ae250a85a0e6f968a">m0_net_transfer_mc::ntm_q</a></div><div class="ttdeci">struct m0_tl ntm_q[M0_NET_QT_NR]</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00877">net.h:877</a></div></div>
<div class="ttc" id="group__netsock_html_gga65022b439e12c2b69863bb55134dd9a9a502dbd83cd4018628e13bcba822ce710"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a502dbd83cd4018628e13bcba822ce710">R_PK_DONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00745">sock.c:745</a></div></div>
<div class="ttc" id="group__format_html_ga855348e7fffce05eb9b2ce54891f0f9d"><div class="ttname"><a href="../../dd/dc1/group__format.html#ga855348e7fffce05eb9b2ce54891f0f9d">m0_format_footer_verify</a></div><div class="ttdeci">M0_INTERNAL int m0_format_footer_verify(const void *buffer, bool iem)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00149">format.c:149</a></div></div>
<div class="ttc" id="group__netsock_html_ga901a7c7ecafb57cbf6885b57b9272e34"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga901a7c7ecafb57cbf6885b57b9272e34">buf_done</a></div><div class="ttdeci">static void buf_done(struct buf *buf, int rc)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02900">sock.c:2900</a></div></div>
<div class="ttc" id="group__vec_html_ga9c79d9e7b339acaf8b46ac0a813f064d"><div class="ttname"><a href="../../d0/d7f/group__vec.html#ga9c79d9e7b339acaf8b46ac0a813f064d">m0_vec_count</a></div><div class="ttdeci">M0_INTERNAL m0_bcount_t m0_vec_count(const struct m0_vec *vec)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/vec_8c_source.html#l00053">vec.c:53</a></div></div>
<div class="ttc" id="group__netsock_html_gafe6b9b0c71898374d7d07b83666fae36"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gafe6b9b0c71898374d7d07b83666fae36">sock_out</a></div><div class="ttdeci">static void sock_out(struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01968">sock.c:1968</a></div></div>
<div class="ttc" id="group__netsock_html_ga1346d46974aa7185fed3b07d84480295"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga1346d46974aa7185fed3b07d84480295">addr_print</a></div><div class="ttdeci">static char * addr_print(const struct addr *addr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02748">sock.c:2748</a></div></div>
<div class="ttc" id="group__netsock_html_ga87fceeb0675eca3bdc635f0be855673f"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga87fceeb0675eca3bdc635f0be855673f">ma_buf_timeout</a></div><div class="ttdeci">static void ma_buf_timeout(struct ma *ma)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01656">sock.c:1656</a></div></div>
<div class="ttc" id="structaddr_html_a684be829a8f7d0ee1367fed2fb93b501"><div class="ttname"><a href="../../d9/db9/structaddr.html#a684be829a8f7d0ee1367fed2fb93b501">addr::a_port</a></div><div class="ttdeci">uint32_t a_port</div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/net_2sock_2xcode_8h_source.html#l00077">xcode.h:77</a></div></div>
<div class="ttc" id="group__netsock_html_ga906821f5f2486bc82055c4e23550f9b9"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga906821f5f2486bc82055c4e23550f9b9">sock_init_fd</a></div><div class="ttdeci">static int sock_init_fd(int fd, struct sock *s, struct ep *ep, uint32_t flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02154">sock.c:2154</a></div></div>
<div class="ttc" id="structep_html_ad800a8d736e37f9934761bfe00b1d4cc"><div class="ttname"><a href="../../da/da7/structep.html#ad800a8d736e37f9934761bfe00b1d4cc">ep::e_r_find</a></div><div class="ttdeci">int e_r_find</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00767">sock.c:767</a></div></div>
<div class="ttc" id="structm0__net__end__point_html_ac6f6a62f57f3af00ab1d86dfa5278f2c"><div class="ttname"><a href="../../d2/d80/structm0__net__end__point.html#ac6f6a62f57f3af00ab1d86dfa5278f2c">m0_net_end_point::nep_ref</a></div><div class="ttdeci">struct m0_ref nep_ref</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00491">net.h:491</a></div></div>
<div class="ttc" id="group__net_html_gga1936206a7485cc1c14e35c6e0d348a38a432c1776f408487b2150a80c70f64307"><div class="ttname"><a href="../../d9/dd2/group__net.html#gga1936206a7485cc1c14e35c6e0d348a38a432c1776f408487b2150a80c70f64307">M0_NET_BUF_QUEUED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01280">net.h:1280</a></div></div>
<div class="ttc" id="structaddr_html_a830ec069f03642982b29f2b596d3e133"><div class="ttname"><a href="../../d9/db9/structaddr.html#a830ec069f03642982b29f2b596d3e133">addr::a_protocol</a></div><div class="ttdeci">uint32_t a_protocol</div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/net_2sock_2xcode_8h_source.html#l00076">xcode.h:76</a></div></div>
<div class="ttc" id="iter__ut_8c_html_a8b1bf9675fb77ab02a105e260477a59b"><div class="ttname"><a href="../../d0/df1/iter__ut_8c.html#a8b1bf9675fb77ab02a105e260477a59b">pool</a></div><div class="ttdeci">static struct m0_pool pool</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df1/iter__ut_8c_source.html#l00058">iter_ut.c:58</a></div></div>
<div class="ttc" id="structm0__tlink_html"><div class="ttname"><a href="../../d9/de0/structm0__tlink.html">m0_tlink</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d30/tlist_8h_source.html#l00264">tlist.h:264</a></div></div>
<div class="ttc" id="structma_html_ac99334eddbdd3038853049e49ba745dd"><div class="ttname"><a href="../../d8/dee/structma.html#ac99334eddbdd3038853049e49ba745dd">ma::t_done</a></div><div class="ttdeci">struct m0_tl t_done</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00800">sock.c:800</a></div></div>
<div class="ttc" id="structsock_html_ace549a57906dd4da1361177d42b38e2a"><div class="ttname"><a href="../../dd/d74/structsock.html#ace549a57906dd4da1361177d42b38e2a">sock::s_magix</a></div><div class="ttdeci">uint64_t s_magix</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00914">sock.c:914</a></div></div>
<div class="ttc" id="group__netsock_html_ga84fc4959018349aa9d99831f5e959505"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga84fc4959018349aa9d99831f5e959505">writer_done</a></div><div class="ttdeci">static void writer_done(struct mover *self, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03670">sock.c:3670</a></div></div>
<div class="ttc" id="lib_2misc_8h_html_a70993fc357f576c5a7d2ac4b7f4f35c5"><div class="ttname"><a href="../../df/d2a/lib_2misc_8h.html#a70993fc357f576c5a7d2ac4b7f4f35c5">m0_forall</a></div><div class="ttdeci">#define m0_forall(var, nr,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d2a/lib_2misc_8h_source.html#l00112">misc.h:112</a></div></div>
<div class="ttc" id="group__netsock_html_ga8e6066984626295aac1349f675ff830f"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga8e6066984626295aac1349f675ff830f">dgram_pk_size</a></div><div class="ttdeci">static m0_bcount_t dgram_pk_size(const struct mover *w, const struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03598">sock.c:3598</a></div></div>
<div class="ttc" id="group__netsock_html_gad87cb84510da3568b658ee9e4c9592d1"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gad87cb84510da3568b658ee9e4c9592d1">bev_notify</a></div><div class="ttdeci">static void bev_notify(struct m0_net_transfer_mc *ma, struct m0_chan *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01878">sock.c:1878</a></div></div>
<div class="ttc" id="group__xcode_html_ga44f0d2ee812fb0647c72314b571f9d0d"><div class="ttname"><a href="../../dd/d6d/group__xcode.html#ga44f0d2ee812fb0647c72314b571f9d0d">at</a></div><div class="ttdeci">static bool at(struct ff2c_context *ctx, char c)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/deb/lex_8c_source.html#l00077">lex.c:77</a></div></div>
<div class="ttc" id="structmover__op__vec_html_a707b7e830f22652f532e197bd262b00f"><div class="ttname"><a href="../../d3/d91/structmover__op__vec.html#a707b7e830f22652f532e197bd262b00f">mover_op_vec::v_error</a></div><div class="ttdeci">void(* v_error)(struct mover *self, struct sock *s, int rc)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00833">sock.c:833</a></div></div>
<div class="ttc" id="structep_html_ae4872a5d9413746fc1332b2a766dab29"><div class="ttname"><a href="../../da/da7/structep.html#ae4872a5d9413746fc1332b2a766dab29">ep::e_r_sock</a></div><div class="ttdeci">int e_r_sock</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00765">sock.c:765</a></div></div>
<div class="ttc" id="group__net_html_gga4a25e727e622f7aaaedfe8ffa01fa005aa95a74f1b59dffb048013e381c4f6733"><div class="ttname"><a href="../../d9/dd2/group__net.html#gga4a25e727e622f7aaaedfe8ffa01fa005aa95a74f1b59dffb048013e381c4f6733">M0_NET_QT_MSG_RECV</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00593">net.h:593</a></div></div>
<div class="ttc" id="types_8h_html_a18efc29f05f292310db38a8c7e81dcdaa83ee4dc69be6e419ad4b3a5c80f81b2a"><div class="ttname"><a href="../../d9/d49/types_8h.html#a18efc29f05f292310db38a8c7e81dcdaa83ee4dc69be6e419ad4b3a5c80f81b2a">M0_BCOUNT_MAX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d49/types_8h_source.html#l00083">types.h:83</a></div></div>
<div class="ttc" id="ut_2fd_8c_html_a71c20dda6f28285e2e67284efccaf3dc"><div class="ttname"><a href="../../df/ded/ut_2fd_8c.html#a71c20dda6f28285e2e67284efccaf3dc">tgt</a></div><div class="ttdeci">struct m0_pdclust_tgt_addr tgt</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/ut_2fd_8c_source.html#l00110">fd.c:110</a></div></div>
<div class="ttc" id="group__netsock_html_ga2fb2b3f17a4539bcf5363d68b7fea102"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga2fb2b3f17a4539bcf5363d68b7fea102">dgram_interval</a></div><div class="ttdeci">static int dgram_interval(struct mover *self, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03579">sock.c:3579</a></div></div>
<div class="ttc" id="group__netsock_html_ga9cea9b44e270d3cbaf2a5ef16fd653d5"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga9cea9b44e270d3cbaf2a5ef16fd653d5">get_idle</a></div><div class="ttdeci">static int get_idle(struct mover *self, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03689">sock.c:3689</a></div></div>
<div class="ttc" id="structm0__sm__state__descr_html_aaa4b4ef5c4b7c75b07ddabcb9877008b"><div class="ttname"><a href="../../da/d29/structm0__sm__state__descr.html#aaa4b4ef5c4b7c75b07ddabcb9877008b">m0_sm_state_descr::sd_name</a></div><div class="ttdeci">const char * sd_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d56/sm_8h_source.html#l00383">sm.h:383</a></div></div>
<div class="ttc" id="group__netsock_html_gga6c152f6e1ae044464fc6f6655a5ae35ca207d824841acf342e7184b3d3fc5996b"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca207d824841acf342e7184b3d3fc5996b">M_CLOSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00701">sock.c:701</a></div></div>
<div class="ttc" id="group__netsock_html_gaeb8ce0b9e88d70b11be23556bbe3a7f8"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaeb8ce0b9e88d70b11be23556bbe3a7f8">ma_init</a></div><div class="ttdeci">static int ma_init(struct m0_net_transfer_mc *ma)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01445">sock.c:1445</a></div></div>
<div class="ttc" id="structm0__bitmap_html_a0a00837f749849ca259b96b56f3c6d46"><div class="ttname"><a href="../../d9/d78/structm0__bitmap.html#a0a00837f749849ca259b96b56f3c6d46">m0_bitmap::b_words</a></div><div class="ttdeci">uint64_t * b_words</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dcb/bitmap_8h_source.html#l00046">bitmap.h:46</a></div></div>
<div class="ttc" id="group__netsock_html_gga6c152f6e1ae044464fc6f6655a5ae35ca7af369c035a45a9babde5a9443b5ef01"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gga6c152f6e1ae044464fc6f6655a5ae35ca7af369c035a45a9babde5a9443b5ef01">M_WRITE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00700">sock.c:700</a></div></div>
<div class="ttc" id="group__netsock_html_ggafb7c011cf74bbdbc6d54539a53224c39afd7faf6c636cbc6f3d3cc0683c0584dc"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39afd7faf6c636cbc6f3d3cc0683c0584dc">HAS_WRITE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00711">sock.c:711</a></div></div>
<div class="ttc" id="sw_8h_html_a2f37eff18c7fc0bdbe63c3e2020932ed"><div class="ttname"><a href="../../d4/de8/sw_8h.html#a2f37eff18c7fc0bdbe63c3e2020932ed">ep</a></div><div class="ttdeci">char * ep</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/de8/sw_8h_source.html#l00132">sw.h:132</a></div></div>
<div class="ttc" id="group__netsock_html_gab2d8ecc7d9da047c0d42124b1dfbc332"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gab2d8ecc7d9da047c0d42124b1dfbc332">EP_FL</a></div><div class="ttdeci">#define EP_FL</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00980">sock.c:980</a></div></div>
<div class="ttc" id="group__arith_html_gabcb07645e2a6233c6ce958784aaf9fe3"><div class="ttname"><a href="../../db/dc9/group__arith.html#gabcb07645e2a6233c6ce958784aaf9fe3">M0_CNT_INC</a></div><div class="ttdeci">#define M0_CNT_INC(cnt)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/deb/arith_8h_source.html#l00226">arith.h:226</a></div></div>
<div class="ttc" id="group__netsock_html_ggafb7c011cf74bbdbc6d54539a53224c39a5b03f1e8c060b7325973da921d99df5b"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ggafb7c011cf74bbdbc6d54539a53224c39a5b03f1e8c060b7325973da921d99df5b">WRITE_POLL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00713">sock.c:713</a></div></div>
<div class="ttc" id="group__netsock_html_ga5c9c81b5351fd8f6692c7069bc8d30ce"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga5c9c81b5351fd8f6692c7069bc8d30ce">ep_put</a></div><div class="ttdeci">static void ep_put(struct ep *ep)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02502">sock.c:2502</a></div></div>
<div class="ttc" id="group__netsock_html_gaadafef50a110b8e53312f153d1c103d3"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaadafef50a110b8e53312f153d1c103d3">dgram_reader_op</a></div><div class="ttdeci">static const struct mover_op_vec dgram_reader_op</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01151">sock.c:1151</a></div></div>
<div class="ttc" id="structsock_html_a1c1ad6e6c23a3d0ee6495ceffcf0387a"><div class="ttname"><a href="../../dd/d74/structsock.html#a1c1ad6e6c23a3d0ee6495ceffcf0387a">sock::s_reader</a></div><div class="ttdeci">struct mover s_reader</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00923">sock.c:923</a></div></div>
<div class="ttc" id="group__net_html_gade3c99118f605e1975055c935cf806d6"><div class="ttname"><a href="../../d9/dd2/group__net.html#gade3c99118f605e1975055c935cf806d6">m0_net__buffer_invariant</a></div><div class="ttdeci">M0_INTERNAL bool m0_net__buffer_invariant(const struct m0_net_buffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dff/net_2buf_8c_source.html#l00046">buf.c:46</a></div></div>
<div class="ttc" id="bitmap_8h_html"><div class="ttname"><a href="../../da/dcb/bitmap_8h.html">bitmap.h</a></div></div>
<div class="ttc" id="rdwr__test__bench_8c_html_a75b25076e6274990c36afcf04b70a53c"><div class="ttname"><a href="../../d8/d57/rdwr__test__bench_8c.html#a75b25076e6274990c36afcf04b70a53c">chan</a></div><div class="ttdeci">static struct m0_chan chan[RDWR_REQUEST_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d57/rdwr__test__bench_8c_source.html#l00063">rdwr_test_bench.c:63</a></div></div>
<div class="ttc" id="structqt_html"><div class="ttname"><a href="../../dd/dc1/structqt.html">qt</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dc7/lib_2ut_2queue_8c_source.html#l00027">queue.c:27</a></div></div>
<div class="ttc" id="structm0__net__transfer__mc_html_adaf6dbd711e031c0a236d31364f63d1e"><div class="ttname"><a href="../../d4/d78/structm0__net__transfer__mc.html#adaf6dbd711e031c0a236d31364f63d1e">m0_net_transfer_mc::ntm_ep</a></div><div class="ttdeci">struct m0_net_end_point * ntm_ep</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00868">net.h:868</a></div></div>
<div class="ttc" id="group__netsock_html_ga5d22cfa334f2d6feb81248e6cd840562"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga5d22cfa334f2d6feb81248e6cd840562">ep_release</a></div><div class="ttdeci">static void ep_release(struct m0_ref *ref)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02404">sock.c:2404</a></div></div>
<div class="ttc" id="group__sm_html_gga4f865c6bc4efb56250e807fe86cbe2cda151cd096e558adff06744e177e8487f8"><div class="ttname"><a href="../../d1/dc1/group__sm.html#gga4f865c6bc4efb56250e807fe86cbe2cda151cd096e558adff06744e177e8487f8">M0_SDF_INITIAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d56/sm_8h_source.html#l00450">sm.h:450</a></div></div>
<div class="ttc" id="group__format_html_ga5f05742845abbd56398831e0569c805a"><div class="ttname"><a href="../../dd/dc1/group__format.html#ga5f05742845abbd56398831e0569c805a">m0_format_footer_update</a></div><div class="ttdeci">M0_INTERNAL void m0_format_footer_update(const void *buffer)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00095">format.c:95</a></div></div>
<div class="ttc" id="group__sm_html_gada087b0429614bfb575369ff95deb31b"><div class="ttname"><a href="../../d1/dc1/group__sm.html#gada087b0429614bfb575369ff95deb31b">m0_sm_init</a></div><div class="ttdeci">M0_INTERNAL void m0_sm_init(struct m0_sm *mach, const struct m0_sm_conf *conf, uint32_t state, struct m0_sm_group *grp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1f/sm_8c_source.html#l00313">sm.c:313</a></div></div>
<div class="ttc" id="lib_2misc_8h_html_a5cdb9ee800461bf21629461944cc9cc1"><div class="ttname"><a href="../../df/d2a/lib_2misc_8h.html#a5cdb9ee800461bf21629461944cc9cc1">M0_IS0</a></div><div class="ttdeci">#define M0_IS0(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d2a/lib_2misc_8h_source.html#l00070">misc.h:70</a></div></div>
<div class="ttc" id="group__netsock_html_gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a17ef7d2c523f3c3576ade612a4d53247">R_HEADER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00743">sock.c:743</a></div></div>
<div class="ttc" id="lib_2misc_8h_html"><div class="ttname"><a href="../../df/d2a/lib_2misc_8h.html">misc.h</a></div></div>
<div class="ttc" id="group__netsock_html_gga7d60538bf88b652d40af16a55f8eb39daebd3109dc1fd2d20f080740ed7e4424c"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gga7d60538bf88b652d40af16a55f8eb39daebd3109dc1fd2d20f080740ed7e4424c">M0_NET_SOCK_PROTO_VERSION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03871">sock.c:3871</a></div></div>
<div class="ttc" id="structm0__bitmap_html"><div class="ttname"><a href="../../d9/d78/structm0__bitmap.html">m0_bitmap</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dcb/bitmap_8h_source.html#l00042">bitmap.h:42</a></div></div>
<div class="ttc" id="structm0__thread_html_a4f2462d0260378ce98d6ba0ab1b18a45"><div class="ttname"><a href="../../d1/d67/structm0__thread.html#a4f2462d0260378ce98d6ba0ab1b18a45">m0_thread::t_func</a></div><div class="ttdeci">void(* t_func)(void *)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dd5/thread_8h_source.html#l00114">thread.h:114</a></div></div>
<div class="ttc" id="structm0__sm__state__descr_html"><div class="ttname"><a href="../../da/d29/structm0__sm__state__descr.html">m0_sm_state_descr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d56/sm_8h_source.html#l00373">sm.h:373</a></div></div>
<div class="ttc" id="group__netsock_html_gaa548b4086af9f91b36c2c97493d2345c"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaa548b4086af9f91b36c2c97493d2345c">dom_init</a></div><div class="ttdeci">static int dom_init(const struct m0_net_xprt *xprt, struct m0_net_domain *dom)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01329">sock.c:1329</a></div></div>
<div class="ttc" id="group__memory_html_ga2dd26426583fa272fa2061075e2dcf57"><div class="ttname"><a href="../../d7/ded/group__memory.html#ga2dd26426583fa272fa2061075e2dcf57">M0_ALLOC_PTR</a></div><div class="ttdeci">#define M0_ALLOC_PTR(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/memory_8h_source.html#l00086">memory.h:86</a></div></div>
<div class="ttc" id="group__netsock_html_gga2a989014423ee897a1d4314f292babdbaabb033d58518dadd28210bc74bef6051"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbaabb033d58518dadd28210bc74bef6051">S_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00666">sock.c:666</a></div></div>
<div class="ttc" id="group__net__pvt_html_gaaab2835349be6b88fe5230b89c779608"><div class="ttname"><a href="../../d0/d50/group__net__pvt.html#gaaab2835349be6b88fe5230b89c779608">m0_net__tm_invariant</a></div><div class="ttdeci">M0_INTERNAL bool m0_net__tm_invariant(const struct m0_net_transfer_mc *tm)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd0/tm_8c_source.html#l00067">tm.c:67</a></div></div>
<div class="ttc" id="linux__kernel_2types_8h_html_ab8d0c29be4a0623c3de58011991e86e9"><div class="ttname"><a href="../../d2/de1/linux__kernel_2types_8h.html#ab8d0c29be4a0623c3de58011991e86e9">PRIi64</a></div><div class="ttdeci">#define PRIi64</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de1/linux__kernel_2types_8h_source.html#l00059">types.h:59</a></div></div>
<div class="ttc" id="group__arith_html_ga5fb15c6777f74e8ef6ed68098fb73606"><div class="ttname"><a href="../../db/dc9/group__arith.html#ga5fb15c6777f74e8ef6ed68098fb73606">min64</a></div><div class="ttdeci">static int64_t min64(int64_t a, int64_t b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/deb/arith_8h_source.html#l00046">arith.h:46</a></div></div>
<div class="ttc" id="structpfamily_html"><div class="ttname"><a href="../../d3/d5d/structpfamily.html">pfamily</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00956">sock.c:956</a></div></div>
<div class="ttc" id="group__xcode_html_ga15975ac0389baacc96abf5cb25c61d6d"><div class="ttname"><a href="../../dd/d6d/group__xcode.html#ga15975ac0389baacc96abf5cb25c61d6d">m0_xcode_obj_dec_from_buf</a></div><div class="ttdeci">M0_INTERNAL int m0_xcode_obj_dec_from_buf(struct m0_xcode_obj *obj, void *buf, m0_bcount_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db2/xcode_8c_source.html#l00850">xcode.c:850</a></div></div>
<div class="ttc" id="group__thread_html_ga85ed595f0d7052f5db6639321564161b"><div class="ttname"><a href="../../da/dd8/group__thread.html#ga85ed595f0d7052f5db6639321564161b">m0_thread_self</a></div><div class="ttdeci">M0_INTERNAL struct m0_thread * m0_thread_self(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de7/thread_8c_source.html#l00122">thread.c:122</a></div></div>
<div class="ttc" id="structm0__sm__trans__descr_html"><div class="ttname"><a href="../../df/dd9/structm0__sm__trans__descr.html">m0_sm_trans_descr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d56/sm_8h_source.html#l00486">sm.h:486</a></div></div>
<div class="ttc" id="group__net_html_ggaaa9dbf6c20e7f07dfe6fc3746f6183e2a47cc9cefcc503559a55be5c92786547a"><div class="ttname"><a href="../../d9/dd2/group__net.html#ggaaa9dbf6c20e7f07dfe6fc3746f6183e2a47cc9cefcc503559a55be5c92786547a">M0_NET_TM_STOPPED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00636">net.h:636</a></div></div>
<div class="ttc" id="group__netsock_html_ga0783c9a92d6de5ed67d4e9c382001d5d"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga0783c9a92d6de5ed67d4e9c382001d5d">pk_size</a></div><div class="ttdeci">static m0_bcount_t pk_size(const struct mover *m, const struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03126">sock.c:3126</a></div></div>
<div class="ttc" id="group__net_html_gga4a25e727e622f7aaaedfe8ffa01fa005a333d129741296b1e7280906adb4b097e"><div class="ttname"><a href="../../d9/dd2/group__net.html#gga4a25e727e622f7aaaedfe8ffa01fa005a333d129741296b1e7280906adb4b097e">M0_NET_QT_PASSIVE_BULK_RECV</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00603">net.h:603</a></div></div>
<div class="ttc" id="group__dtm_html_ga8b3ab54ed3e81c69863d65e4e6c424a0"><div class="ttname"><a href="../../d2/d66/group__dtm.html#ga8b3ab54ed3e81c69863d65e4e6c424a0">flag</a></div><div class="ttdeci">static bool flag</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0b/ut_2nucleus_8c_source.html#l00266">nucleus.c:266</a></div></div>
<div class="ttc" id="structep_html_aa56814b0282f4d2f416fad8bda1da592"><div class="ttname"><a href="../../da/da7/structep.html#aa56814b0282f4d2f416fad8bda1da592">ep::e_sock</a></div><div class="ttdeci">struct m0_tl e_sock</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00760">sock.c:760</a></div></div>
<div class="ttc" id="group__netsock_html_ga12472db46680c17ed17df5f93e5d4094"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga12472db46680c17ed17df5f93e5d4094">ma__print</a></div><div class="ttdeci">M0_INTERNAL void ma__print(const struct ma *ma)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l04014">sock.c:4014</a></div></div>
<div class="ttc" id="group__netsock_html_ga765e88256787793065e7620d01449d4d"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga765e88256787793065e7620d01449d4d">bdesc_decode</a></div><div class="ttdeci">static int bdesc_decode(const struct m0_net_buf_desc *nbd, struct bdesc *out)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02993">sock.c:2993</a></div></div>
<div class="ttc" id="structm0__sm_html"><div class="ttname"><a href="../../db/d49/structm0__sm.html">m0_sm</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d56/sm_8h_source.html#l00301">sm.h:301</a></div></div>
<div class="ttc" id="group__trace_html_gga222dfe20eda8c002fbab0ebbb2a7848ba8d2169c7a189138ea53e05ce2c558d4f"><div class="ttname"><a href="../../d8/d98/group__trace.html#gga222dfe20eda8c002fbab0ebbb2a7848ba8d2169c7a189138ea53e05ce2c558d4f">M0_DEBUG</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d1b/trace_8h_source.html#l00487">trace.h:487</a></div></div>
<div class="ttc" id="group__netsock_html_ga06ffa7bbccaa76fcccf8f02aa9c785b6"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga06ffa7bbccaa76fcccf8f02aa9c785b6">get_max_buffer_desc_size</a></div><div class="ttdeci">static m0_bcount_t get_max_buffer_desc_size(const struct m0_net_domain *)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01937">sock.c:1937</a></div></div>
<div class="ttc" id="structep_html_ac2bafd27a0e0c46e6cc7791b1a33ebcb"><div class="ttname"><a href="../../da/da7/structep.html#ac2bafd27a0e0c46e6cc7791b1a33ebcb">ep::e_writer</a></div><div class="ttdeci">struct m0_tl e_writer</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00762">sock.c:762</a></div></div>
<div class="ttc" id="structmover__op__vec_html_ab40f2a603ffa58f56082c18410af1855"><div class="ttname"><a href="../../d3/d91/structmover__op__vec.html#ab40f2a603ffa58f56082c18410af1855">mover_op_vec::v_op</a></div><div class="ttdeci">struct mover_op v_op[STATE_NR][M_NR]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00828">sock.c:828</a></div></div>
<div class="ttc" id="group__netsock_html_gafb7c011cf74bbdbc6d54539a53224c39"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gafb7c011cf74bbdbc6d54539a53224c39">sock_flags</a></div><div class="ttdeci">sock_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00707">sock.c:707</a></div></div>
<div class="ttc" id="group__cookie_html_ga70e6219c7f5302e50b667d2d614f0e1f"><div class="ttname"><a href="../../da/dd3/group__cookie.html#ga70e6219c7f5302e50b667d2d614f0e1f">m0_cookie_new</a></div><div class="ttdeci">M0_INTERNAL void m0_cookie_new(uint64_t *gen)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d41/lib_2cookie_8c_source.html#l00083">cookie.c:83</a></div></div>
<div class="ttc" id="group__bitmap_html_ga0e2870d0310664efdf37a687856a5605"><div class="ttname"><a href="../../df/df3/group__bitmap.html#ga0e2870d0310664efdf37a687856a5605">m0_bitmap_get</a></div><div class="ttdeci">M0_INTERNAL bool m0_bitmap_get(const struct m0_bitmap *map, size_t idx)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9a/bitmap_8c_source.html#l00105">bitmap.c:105</a></div></div>
<div class="ttc" id="ut_2di_8c_html_a8629956d8c29c6159e411f38f24c140d"><div class="ttname"><a href="../../d4/d00/ut_2di_8c.html#a8629956d8c29c6159e411f38f24c140d">size</a></div><div class="ttdeci">m0_bcount_t size</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d00/ut_2di_8c_source.html#l00039">di.c:39</a></div></div>
<div class="ttc" id="group__assert_html_gaa830530062e2cf2e3f619985e59881a6"><div class="ttname"><a href="../../db/dca/group__assert.html#gaa830530062e2cf2e3f619985e59881a6">_0C</a></div><div class="ttdeci">#define _0C(exp)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da7/assert_8h_source.html#l00311">assert.h:311</a></div></div>
<div class="ttc" id="structep_html_a7fa38028a1ed8e0d494fc3d2f179a890"><div class="ttname"><a href="../../da/da7/structep.html#a7fa38028a1ed8e0d494fc3d2f179a890">ep::e_a</a></div><div class="ttdeci">struct addr e_a</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00758">sock.c:758</a></div></div>
<div class="ttc" id="group__netsock_html_gaf2365098ff35cf19fc407ec542cf83d2"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaf2365098ff35cf19fc407ec542cf83d2">get_pk</a></div><div class="ttdeci">static int get_pk(struct mover *self, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03695">sock.c:3695</a></div></div>
<div class="ttc" id="group__netsock_html_gaed2f4c86687ccc0b2a70013f35019b46"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaed2f4c86687ccc0b2a70013f35019b46">addr__print</a></div><div class="ttdeci">M0_INTERNAL void addr__print(const struct addr *addr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03972">sock.c:3972</a></div></div>
<div class="ttc" id="group__netsock_html_ga1e7c2252df38be7469c526b95eb574d7"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga1e7c2252df38be7469c526b95eb574d7">M0_TL_DESCR_DEFINE</a></div><div class="ttdeci">M0_TL_DESCR_DEFINE(s, &quot;sockets&quot;, static, struct sock, s_linkage, s_magix, M0_NET_SOCK_SOCK_MAGIC, M0_NET_SOCK_SOCK_HEAD_MAGIC)</div></div>
<div class="ttc" id="group__netsock_html_ga5d92759bddfd6442631c4423fa310d83"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga5d92759bddfd6442631c4423fa310d83">rw_conf_trans</a></div><div class="ttdeci">static struct m0_sm_trans_descr rw_conf_trans[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03791">sock.c:3791</a></div></div>
<div class="ttc" id="structbuf_html_a38f9df430deb5db9891b42147ef7a69e"><div class="ttname"><a href="../../d9/dd0/structbuf.html#a38f9df430deb5db9891b42147ef7a69e">buf::b_other</a></div><div class="ttdeci">struct ep * b_other</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00900">sock.c:900</a></div></div>
<div class="ttc" id="group__netsock_html_gaab89d3e82371dfcccd5807a8762c2baa"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaab89d3e82371dfcccd5807a8762c2baa">ma_src</a></div><div class="ttdeci">static struct ep * ma_src(struct ma *ma)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01716">sock.c:1716</a></div></div>
<div class="ttc" id="group__netsock_html_gga65022b439e12c2b69863bb55134dd9a9a1bd27bf23812341749c87673d015d3ac"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a1bd27bf23812341749c87673d015d3ac">R_DONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00747">sock.c:747</a></div></div>
<div class="ttc" id="group__netsock_html_ga2a989014423ee897a1d4314f292babdb"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga2a989014423ee897a1d4314f292babdb">sock_state</a></div><div class="ttdeci">sock_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00662">sock.c:662</a></div></div>
<div class="ttc" id="structm0__net__xprt_html_a16cd28307c3a7159cd8c808a1c59224e"><div class="ttname"><a href="../../d5/da0/structm0__net__xprt.html#a16cd28307c3a7159cd8c808a1c59224e">m0_net_xprt::nx_name</a></div><div class="ttdeci">const char * nx_name</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00125">net.h:125</a></div></div>
<div class="ttc" id="lib_2misc_8h_html_a3a6a6708976cdeb3aec96b1d2545bd8d"><div class="ttname"><a href="../../df/d2a/lib_2misc_8h.html#a3a6a6708976cdeb3aec96b1d2545bd8d">IS_IN_ARRAY</a></div><div class="ttdeci">#define IS_IN_ARRAY(idx, array)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d2a/lib_2misc_8h_source.html#l00311">misc.h:311</a></div></div>
<div class="ttc" id="group__netsock_html_ga1ccbabd9aaf069d324a4bba8a258ceb3"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga1ccbabd9aaf069d324a4bba8a258ceb3">ma_event_post</a></div><div class="ttdeci">static void ma_event_post(struct ma *ma, enum m0_net_tm_state state)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01628">sock.c:1628</a></div></div>
<div class="ttc" id="group__netsock_html_gade75dddfcbfe49fe6ac9fca3c97457e3"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gade75dddfcbfe49fe6ac9fca3c97457e3">addr_parse</a></div><div class="ttdeci">static int addr_parse(struct addr *addr, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02554">sock.c:2554</a></div></div>
<div class="ttc" id="structm0__net__buffer__pool_html"><div class="ttname"><a href="../../d4/d52/structm0__net__buffer__pool.html">m0_net_buffer_pool</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d03/buffer__pool_8h_source.html#l00245">buffer_pool.h:245</a></div></div>
<div class="ttc" id="group__netsock_html_ga6c3740a62f509b306b6906d29caa1918"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga6c3740a62f509b306b6906d29caa1918">sock_conf_trans</a></div><div class="ttdeci">static struct m0_sm_trans_descr sock_conf_trans[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03739">sock.c:3739</a></div></div>
<div class="ttc" id="m0t1fs_2linux__kernel_2dir_8c_html_a44f21d5190b5a6df8089f54799628d7e"><div class="ttname"><a href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a></div><div class="ttdeci">struct m0t1fs_filedata * fd</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c_source.html#l01030">dir.c:1030</a></div></div>
<div class="ttc" id="group__netsock_html_gad1278e0c872e51530c6943d527e786a3"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gad1278e0c872e51530c6943d527e786a3">mover_is_reader</a></div><div class="ttdeci">static bool mover_is_reader(const struct mover *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03110">sock.c:3110</a></div></div>
<div class="ttc" id="group__net_html_ga468b777c12c7bb86bb1952d827bd52ce"><div class="ttname"><a href="../../d9/dd2/group__net.html#ga468b777c12c7bb86bb1952d827bd52ce">m0_net_xprt_deregister</a></div><div class="ttdeci">M0_INTERNAL void m0_net_xprt_deregister(const struct m0_net_xprt *xprt)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/da5/net_2net_8c_source.html#l00197">net.c:197</a></div></div>
<div class="ttc" id="group__netsock_html_gadc31941bba50c68b4c51483468b7acd4"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gadc31941bba50c68b4c51483468b7acd4">sock_ctl</a></div><div class="ttdeci">static int sock_ctl(struct sock *s, int op, uint32_t flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02305">sock.c:2305</a></div></div>
<div class="ttc" id="buffer__pool_8h_html"><div class="ttname"><a href="../../d2/d03/buffer__pool_8h.html">buffer_pool.h</a></div></div>
<div class="ttc" id="group__arith_html_ga6ba808bd9de059edf42ab1d70c4c8964"><div class="ttname"><a href="../../db/dc9/group__arith.html#ga6ba808bd9de059edf42ab1d70c4c8964">M0_CNT_DEC</a></div><div class="ttdeci">#define M0_CNT_DEC(cnt)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/deb/arith_8h_source.html#l00219">arith.h:219</a></div></div>
<div class="ttc" id="group__netsock_html_ga275ae63e03470896123e2a44fbd06c1d"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga275ae63e03470896123e2a44fbd06c1d">B_F</a></div><div class="ttdeci">#define B_F</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00988">sock.c:988</a></div></div>
<div class="ttc" id="structsock_html"><div class="ttname"><a href="../../dd/d74/structsock.html">sock</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00913">sock.c:913</a></div></div>
<div class="ttc" id="structm0__net__xprt__ops_html_aa5186beef994323cdf64433f2062f570"><div class="ttname"><a href="../../da/dca/structm0__net__xprt__ops.html#aa5186beef994323cdf64433f2062f570">m0_net_xprt_ops::xo_dom_init</a></div><div class="ttdeci">int(* xo_dom_init)(const struct m0_net_xprt *xprt, struct m0_net_domain *dom)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00139">net.h:139</a></div></div>
<div class="ttc" id="group__xcode_html_ga0733e26f11171dd0d95568ca3c104cd1"><div class="ttname"><a href="../../dd/d6d/group__xcode.html#ga0733e26f11171dd0d95568ca3c104cd1">M0_XCODE_OBJ</a></div><div class="ttdeci">#define M0_XCODE_OBJ(type, ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d12/xcode_2xcode_8h_source.html#l00962">xcode.h:962</a></div></div>
<div class="ttc" id="structsock_html_a5766c3b04a967df4143cd23bff6f83e5"><div class="ttname"><a href="../../dd/d74/structsock.html#a5766c3b04a967df4143cd23bff6f83e5">sock::s_sm</a></div><div class="ttdeci">struct m0_sm s_sm</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00919">sock.c:919</a></div></div>
<div class="ttc" id="group__netsock_html_ga65f17ccc7d00545d9f55335529fcc01c"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga65f17ccc7d00545d9f55335529fcc01c">get_rpc_max_segs_nr</a></div><div class="ttdeci">static uint32_t get_rpc_max_segs_nr(struct m0_net_domain *ndom)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01950">sock.c:1950</a></div></div>
<div class="ttc" id="structmover_html_a92dce5c08e4c69047f6eed9aa16b4d34"><div class="ttname"><a href="../../d1/d99/structmover.html#a92dce5c08e4c69047f6eed9aa16b4d34">mover::m_sm</a></div><div class="ttdeci">struct m0_sm m_sm</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00862">sock.c:862</a></div></div>
<div class="ttc" id="addb2_2ut_2net_8c_html_ac0a994e0e36865c40c2e0488204f1580"><div class="ttname"><a href="../../d0/da5/addb2_2ut_2net_8c.html#ac0a994e0e36865c40c2e0488204f1580">net</a></div><div class="ttdeci">static struct m0_addb2_net * net</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da5/addb2_2ut_2net_8c_source.html#l00027">net.c:27</a></div></div>
<div class="ttc" id="group__netsock_html_ga88373be29952aeec9a2de84b52257efe"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga88373be29952aeec9a2de84b52257efe">bev_pending</a></div><div class="ttdeci">static bool bev_pending(struct m0_net_transfer_mc *ma)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01873">sock.c:1873</a></div></div>
<div class="ttc" id="structm0__net__buffer_html_a237f51e9559c38a64897ddfc5620ee73"><div class="ttname"><a href="../../d9/d7e/structm0__net__buffer.html#a237f51e9559c38a64897ddfc5620ee73">m0_net_buffer::nb_desc</a></div><div class="ttdeci">struct m0_net_buf_desc nb_desc</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01412">net.h:1412</a></div></div>
<div class="ttc" id="structbuf_html_a98e68f2754cbb2b3c318029356595862"><div class="ttname"><a href="../../d9/dd0/structbuf.html#a98e68f2754cbb2b3c318029356595862">buf::b_magix</a></div><div class="ttdeci">uint64_t b_magix</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00888">sock.c:888</a></div></div>
<div class="ttc" id="group__trace_html_gga222dfe20eda8c002fbab0ebbb2a7848baa28fc2108a650f33c5b984b7ce5e852b"><div class="ttname"><a href="../../d8/d98/group__trace.html#gga222dfe20eda8c002fbab0ebbb2a7848baa28fc2108a650f33c5b984b7ce5e852b">M0_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d1b/trace_8h_source.html#l00473">trace.h:473</a></div></div>
<div class="ttc" id="group__netsock_html_ga6f158d48c8168947b0fef56f8bc52747"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga6f158d48c8168947b0fef56f8bc52747">ep_eq</a></div><div class="ttdeci">static bool ep_eq(const struct ep *ep, const struct addr *addr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02816">sock.c:2816</a></div></div>
<div class="ttc" id="group__netsock_html_ga27438def5d2ab354391ff1e2bd182c61"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga27438def5d2ab354391ff1e2bd182c61">ep_find</a></div><div class="ttdeci">static int ep_find(struct ma *ma, const char *name, struct ep **out)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02379">sock.c:2379</a></div></div>
<div class="ttc" id="magic_8h_html_a82bffe7189227eff068dab27a6040119a6df0c239fb1ce74f3a1aca3bff2c4a32"><div class="ttname"><a href="../../dd/d08/magic_8h.html#a82bffe7189227eff068dab27a6040119a6df0c239fb1ce74f3a1aca3bff2c4a32">M0_NET_SOCK_BUF_MAGIC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/magic_8h_source.html#l00699">magic.h:699</a></div></div>
<div class="ttc" id="group__netsock_html_ga02a03579ff3f069899aab4182f6540e7"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga02a03579ff3f069899aab4182f6540e7">get_rpc_max_seg_size</a></div><div class="ttdeci">static m0_bcount_t get_rpc_max_seg_size(struct m0_net_domain *ndom)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01942">sock.c:1942</a></div></div>
<div class="ttc" id="group__netsock_html_ga69dcfba03c6d43734c25d912a4f2288c"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga69dcfba03c6d43734c25d912a4f2288c">TLOG</a></div><div class="ttdeci">#define TLOG(...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00991">sock.c:991</a></div></div>
<div class="ttc" id="group__netsock_html_ga7b643699db61d5c148110d150136c16a"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga7b643699db61d5c148110d150136c16a">mover_op</a></div><div class="ttdeci">static int mover_op(struct mover *m, struct sock *s, int op)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03056">sock.c:3056</a></div></div>
<div class="ttc" id="group__netsock_html_ga31831f32963572f54a3bc7d9fbe848cc"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga31831f32963572f54a3bc7d9fbe848cc">buf_fini</a></div><div class="ttdeci">static void buf_fini(struct buf *buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02883">sock.c:2883</a></div></div>
<div class="ttc" id="group__netsock_html_gaa0e13143fda3ace8485c788fa68c2655"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaa0e13143fda3ace8485c788fa68c2655">writer_error</a></div><div class="ttdeci">static void writer_error(struct mover *w, struct sock *s, int rc)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03682">sock.c:3682</a></div></div>
<div class="ttc" id="group__xcode_html_ga50fe33eaae68b43814656f241a6ac907"><div class="ttname"><a href="../../dd/d6d/group__xcode.html#ga50fe33eaae68b43814656f241a6ac907">out</a></div><div class="ttdeci">#define out(...)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d31/gen_8c_source.html#l00041">gen.c:41</a></div></div>
<div class="ttc" id="group__netsock_html_gaaea8f9114f06faf1285bfd1bd5c6da3b"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaaea8f9114f06faf1285bfd1bd5c6da3b">writer_op</a></div><div class="ttdeci">static const struct mover_op_vec writer_op</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01152">sock.c:1152</a></div></div>
<div class="ttc" id="structm0__bitmap_html_ad28a5fb566aee29804413733338cfe60"><div class="ttname"><a href="../../d9/d78/structm0__bitmap.html#ad28a5fb566aee29804413733338cfe60">m0_bitmap::b_nr</a></div><div class="ttdeci">size_t b_nr</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dcb/bitmap_8h_source.html#l00044">bitmap.h:44</a></div></div>
<div class="ttc" id="net_2module_8c_html_a1435da8b61a16e2cfe821bca92347237"><div class="ttname"><a href="../../dc/de2/net_2module_8c.html#a1435da8b61a16e2cfe821bca92347237">xprt</a></div><div class="ttdeci">struct m0_net_xprt * xprt</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/de2/net_2module_8c_source.html#l00061">module.c:61</a></div></div>
<div class="ttc" id="group__netsock_html_gae0d835e5b33df4f26664af2f5c067f25"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gae0d835e5b33df4f26664af2f5c067f25">pk_header_done</a></div><div class="ttdeci">static int pk_header_done(struct mover *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03283">sock.c:3283</a></div></div>
<div class="ttc" id="structsocktype_html_a6f6622bd6a97e172f6100f47386bdfcf"><div class="ttname"><a href="../../d7/d2a/structsocktype.html#a6f6622bd6a97e172f6100f47386bdfcf">socktype::st_name</a></div><div class="ttdeci">const char * st_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00936">sock.c:936</a></div></div>
<div class="ttc" id="structsocktype_html_a1e8391986d046d379abbba78f51fd2eb"><div class="ttname"><a href="../../d7/d2a/structsocktype.html#a1e8391986d046d379abbba78f51fd2eb">socktype::st_error</a></div><div class="ttdeci">void(* st_error)(struct mover *m, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00946">sock.c:946</a></div></div>
<div class="ttc" id="group__netsock_html_ga29a5f8a13daa1ed86c1646aa28b5cae8"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga29a5f8a13daa1ed86c1646aa28b5cae8">buf__print</a></div><div class="ttdeci">M0_INTERNAL void buf__print(const struct buf *buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l04003">sock.c:4003</a></div></div>
<div class="ttc" id="structm0__net__tm__event_html"><div class="ttname"><a href="../../d3/d91/structm0__net__tm__event.html">m0_net_tm_event</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00686">net.h:686</a></div></div>
<div class="ttc" id="group__netsock_html_ga9ed54523c05b17d045c4e884d7d0cc8a"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga9ed54523c05b17d045c4e884d7d0cc8a">ma_prune</a></div><div class="ttdeci">static void ma_prune(struct ma *ma)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01467">sock.c:1467</a></div></div>
<div class="ttc" id="group__netsock_html_gaa3f97a589c8ebf7495ac65e2efd70f67"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaa3f97a589c8ebf7495ac65e2efd70f67">get_op</a></div><div class="ttdeci">static const struct mover_op_vec get_op</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01153">sock.c:1153</a></div></div>
<div class="ttc" id="group__netsock_html_gaa84a0ba7e9ca103362e6b5a62228daad"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaa84a0ba7e9ca103362e6b5a62228daad">dgram_error</a></div><div class="ttdeci">static void dgram_error(struct mover *m, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03607">sock.c:3607</a></div></div>
<div class="ttc" id="group__netsock_html_ga67b3a394cd9c1d7006a0c7c25282654c"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga67b3a394cd9c1d7006a0c7c25282654c">stream_interval</a></div><div class="ttdeci">static int stream_interval(struct mover *self, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03485">sock.c:3485</a></div></div>
<div class="ttc" id="group__netsock_html_gabcf3ea8f28ad69325421a0cd066c8537"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gabcf3ea8f28ad69325421a0cd066c8537">pk_done</a></div><div class="ttdeci">static void pk_done(struct mover *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03406">sock.c:3406</a></div></div>
<div class="ttc" id="structm0__net__buf__desc_html"><div class="ttname"><a href="../../d0/db8/structm0__net__buf__desc.html">m0_net_buf_desc</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d78/net__otw__types_8h_source.html#l00036">net_otw_types.h:36</a></div></div>
<div class="ttc" id="group__tlist_html_ga7b79fdd8d7679c6a9255581f90afd016"><div class="ttname"><a href="../../d7/d08/group__tlist.html#ga7b79fdd8d7679c6a9255581f90afd016">m0_tl_find</a></div><div class="ttdeci">#define m0_tl_find(name, var, head,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d30/tlist_8h_source.html#l00757">tlist.h:757</a></div></div>
<div class="ttc" id="group__netsock_html_ga93db8e0a1b6257b6658f0b76a245bc52"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga93db8e0a1b6257b6658f0b76a245bc52">sock__print</a></div><div class="ttdeci">M0_INTERNAL void sock__print(const struct sock *sock)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03979">sock.c:3979</a></div></div>
<div class="ttc" id="group__netsock_html_ga13c610ec12e0a3b29cec26487f5651ab"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga13c610ec12e0a3b29cec26487f5651ab">bdesc_encode</a></div><div class="ttdeci">static int bdesc_encode(const struct bdesc *bd, struct m0_net_buf_desc *out)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02978">sock.c:2978</a></div></div>
<div class="ttc" id="structma_html_ad1d13c98c6fbcf8472bdc0014af6c15e"><div class="ttname"><a href="../../d8/dee/structma.html#ad1d13c98c6fbcf8472bdc0014af6c15e">ma::t_ma</a></div><div class="ttdeci">struct m0_net_transfer_mc * t_ma</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00774">sock.c:774</a></div></div>
<div class="ttc" id="group__tlist_html_ga6c73104b68112bed660165c64164fadf"><div class="ttname"><a href="../../d7/d08/group__tlist.html#ga6c73104b68112bed660165c64164fadf">m0_tl_for</a></div><div class="ttdeci">#define m0_tl_for(name, head, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d30/tlist_8h_source.html#l00695">tlist.h:695</a></div></div>
<div class="ttc" id="group__net_html_gadecee388788921c2db60adc0cffe5db9"><div class="ttname"><a href="../../d9/dd2/group__net.html#gadecee388788921c2db60adc0cffe5db9">default_xo_rpc_max_recv_msgs</a></div><div class="ttdeci">M0_INTERNAL uint32_t default_xo_rpc_max_recv_msgs(struct m0_net_domain *ndom, m0_bcount_t rpc_size)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/da5/net_2net_8c_source.html#l00267">net.c:267</a></div></div>
<div class="ttc" id="group__netsock_html_gaef26c34c66e8e88befd9b30a9cae179c"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gaef26c34c66e8e88befd9b30a9cae179c">buf_accept</a></div><div class="ttdeci">static int buf_accept(struct buf *buf, struct mover *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02835">sock.c:2835</a></div></div>
<div class="ttc" id="group__net_html_ggaaa9dbf6c20e7f07dfe6fc3746f6183e2aec060e2edf58c654f83989d5635bf0a6"><div class="ttname"><a href="../../d9/dd2/group__net.html#ggaaa9dbf6c20e7f07dfe6fc3746f6183e2aec060e2edf58c654f83989d5635bf0a6">M0_NET_TM_STARTING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00633">net.h:633</a></div></div>
<div class="ttc" id="group__memory_html_ga0b8533a3024754008602759e71337eb3"><div class="ttname"><a href="../../d7/ded/group__memory.html#ga0b8533a3024754008602759e71337eb3">m0_free</a></div><div class="ttdeci">void m0_free(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd5/memory_8c_source.html#l00146">memory.c:146</a></div></div>
<div class="ttc" id="ut_2consumer_8c_html_aee6e517d35e5b77a829ee476518f6a5d"><div class="ttname"><a href="../../d6/d7d/ut_2consumer_8c.html#aee6e517d35e5b77a829ee476518f6a5d">s</a></div><div class="ttdeci">static struct m0_addb2_source * s</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d7d/ut_2consumer_8c_source.html#l00039">consumer.c:39</a></div></div>
<div class="ttc" id="group__netsock_html_gae1c39f3887a734f80f90af19db496846"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gae1c39f3887a734f80f90af19db496846">stream_reader_op</a></div><div class="ttdeci">static const struct mover_op_vec stream_reader_op</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01150">sock.c:1150</a></div></div>
<div class="ttc" id="group__netsock_html_gae4eb491acad8af8a0a1b4013281f26f6"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gae4eb491acad8af8a0a1b4013281f26f6">rw_conf_state</a></div><div class="ttdeci">static struct m0_sm_state_descr rw_conf_state[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03758">sock.c:3758</a></div></div>
<div class="ttc" id="structsocktype_html"><div class="ttname"><a href="../../d7/d2a/structsocktype.html">socktype</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00935">sock.c:935</a></div></div>
<div class="ttc" id="structm0__net__end__point_html"><div class="ttname"><a href="../../d2/d80/structm0__net__end__point.html">m0_net_end_point</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00487">net.h:487</a></div></div>
<div class="ttc" id="group__net_html_gga4a25e727e622f7aaaedfe8ffa01fa005a1f1b9d40dde28be93c6787f597ebaa2d"><div class="ttname"><a href="../../d9/dd2/group__net.html#gga4a25e727e622f7aaaedfe8ffa01fa005a1f1b9d40dde28be93c6787f597ebaa2d">M0_NET_QT_ACTIVE_BULK_SEND</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00624">net.h:624</a></div></div>
<div class="ttc" id="group__netsock_html_gac86b71d05137f15bfeb5d34369b0116c"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gac86b71d05137f15bfeb5d34369b0116c">stream_pk</a></div><div class="ttdeci">static int stream_pk(struct mover *self, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03455">sock.c:3455</a></div></div>
<div class="ttc" id="structm0__sm_html_a15f271ddbf3fecd39f2711f07f40b76e"><div class="ttname"><a href="../../db/d49/structm0__sm.html#a15f271ddbf3fecd39f2711f07f40b76e">m0_sm::sm_state</a></div><div class="ttdeci">uint32_t sm_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d56/sm_8h_source.html#l00307">sm.h:307</a></div></div>
<div class="ttc" id="group__netsock_html_ga95a9ed0a5357022173b96f24d664374d"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga95a9ed0a5357022173b96f24d664374d">get_max_buffer_segments</a></div><div class="ttdeci">static int32_t get_max_buffer_segments(const struct m0_net_domain *dom)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l01921">sock.c:1921</a></div></div>
<div class="ttc" id="group__net_html_ga29917e953c2dd969f833226b1296fa0b"><div class="ttname"><a href="../../d9/dd2/group__net.html#ga29917e953c2dd969f833226b1296fa0b">default_xo_rpc_max_msg_size</a></div><div class="ttdeci">M0_INTERNAL m0_bcount_t default_xo_rpc_max_msg_size(struct m0_net_domain *ndom, m0_bcount_t rpc_size)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/da5/net_2net_8c_source.html#l00255">net.c:255</a></div></div>
<div class="ttc" id="structm0__net__buffer_html_a01eabeb5b66a8de67b2a7514563e1893"><div class="ttname"><a href="../../d9/d7e/structm0__net__buffer.html#a01eabeb5b66a8de67b2a7514563e1893">m0_net_buffer::nb_xprt_private</a></div><div class="ttdeci">void * nb_xprt_private</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01461">net.h:1461</a></div></div>
<div class="ttc" id="ut_2fd_8c_html_aac62f57bd247b8b9b145f09eef0e6e09"><div class="ttname"><a href="../../df/ded/ut_2fd_8c.html#aac62f57bd247b8b9b145f09eef0e6e09">src</a></div><div class="ttdeci">struct m0_pdclust_src_addr src</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/ut_2fd_8c_source.html#l00108">fd.c:108</a></div></div>
<div class="ttc" id="group__chan_html_gad1968f64b50443b0c89881a2471321da"><div class="ttname"><a href="../../df/da0/group__chan.html#gad1968f64b50443b0c89881a2471321da">m0_chan_broadcast</a></div><div class="ttdeci">M0_INTERNAL void m0_chan_broadcast(struct m0_chan *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/da2/chan_8c_source.html#l00172">chan.c:172</a></div></div>
<div class="ttc" id="structaddr_html_a8abdba8b976548e55d92fc17d4a5111c"><div class="ttname"><a href="../../d9/db9/structaddr.html#a8abdba8b976548e55d92fc17d4a5111c">addr::a_data</a></div><div class="ttdeci">struct addrdata a_data</div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/net_2sock_2xcode_8h_source.html#l00078">xcode.h:78</a></div></div>
<div class="ttc" id="cm_2repreb_2trigger__fop_8h_html_ac6509c6fe4cbf7bde170597172f8a288"><div class="ttname"><a href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a></div><div class="ttdeci">int32_t rc</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db8/cm_2repreb_2trigger__fop_8h_source.html#l00047">trigger_fop.h:47</a></div></div>
<div class="ttc" id="structmover__op__vec_html"><div class="ttname"><a href="../../d3/d91/structmover__op__vec.html">mover_op_vec</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00825">sock.c:825</a></div></div>
<div class="ttc" id="lib_2user__space_2misc_8h_html_a25f003de16c08a4888b69f619d70f427"><div class="ttname"><a href="../../db/df8/lib_2user__space_2misc_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a></div><div class="ttdeci">#define ARRAY_SIZE(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/df8/lib_2user__space_2misc_8h_source.html#l00045">misc.h:45</a></div></div>
<div class="ttc" id="lib_2user__space_2misc_8h_html_ad4a7496cd704df3829c87864e7dbd703"><div class="ttname"><a href="../../db/df8/lib_2user__space_2misc_8h.html#ad4a7496cd704df3829c87864e7dbd703">offsetof</a></div><div class="ttdeci">#define offsetof(typ, memb)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/df8/lib_2user__space_2misc_8h_source.html#l00029">misc.h:29</a></div></div>
<div class="ttc" id="structm0__sm_html_ade11f5baac8ba43d50a4e069e2743cb7"><div class="ttname"><a href="../../db/d49/structm0__sm.html#ade11f5baac8ba43d50a4e069e2743cb7">m0_sm::sm_conf</a></div><div class="ttdeci">const struct m0_sm_conf * sm_conf</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d56/sm_8h_source.html#l00320">sm.h:320</a></div></div>
<div class="ttc" id="group__netsock_html_gad555af4464b2da0aef4a71bedbf10cb8"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gad555af4464b2da0aef4a71bedbf10cb8">M0_TL_DEFINE</a></div><div class="ttdeci">M0_TL_DEFINE(s, static, struct sock)</div></div>
<div class="ttc" id="group__tlist_html_gaff792c7170b8ef517d40f1a37eb5340d"><div class="ttname"><a href="../../d7/d08/group__tlist.html#gaff792c7170b8ef517d40f1a37eb5340d">m0_tl_exists</a></div><div class="ttdeci">#define m0_tl_exists(name, var, head,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d30/tlist_8h_source.html#l00774">tlist.h:774</a></div></div>
<div class="ttc" id="group__netsock_html_gac04519716eaedbe76c2c3cc947eff2f6"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gac04519716eaedbe76c2c3cc947eff2f6">bdesc_create</a></div><div class="ttdeci">static int bdesc_create(struct addr *addr, struct buf *buf, struct m0_net_buf_desc *out)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02969">sock.c:2969</a></div></div>
<div class="ttc" id="group__netsock_html_ga65022b439e12c2b69863bb55134dd9a9"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga65022b439e12c2b69863bb55134dd9a9">rw_state</a></div><div class="ttdeci">rw_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00740">sock.c:740</a></div></div>
<div class="ttc" id="group__netsock_html_ga41ef6a6d745f5cf282ab2a42c1eeb09d"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga41ef6a6d745f5cf282ab2a42c1eeb09d">ip6_encode</a></div><div class="ttdeci">static void ip6_encode(const struct addr *a, struct sockaddr *sa)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02724">sock.c:2724</a></div></div>
<div class="ttc" id="group__netsock_html_gga65022b439e12c2b69863bb55134dd9a9a5858564d816c4f9e1cd1218b6b350330"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gga65022b439e12c2b69863bb55134dd9a9a5858564d816c4f9e1cd1218b6b350330">R_NR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00749">sock.c:749</a></div></div>
<div class="ttc" id="structep_html_a3851e3d045cfdff109ee4c7c69b1e9b8"><div class="ttname"><a href="../../da/da7/structep.html#a3851e3d045cfdff109ee4c7c69b1e9b8">ep::e_ep</a></div><div class="ttdeci">struct m0_net_end_point e_ep</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00756">sock.c:756</a></div></div>
<div class="ttc" id="group__netsock_html_gad7ba5dff1c65580fa18971ea7decf804"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gad7ba5dff1c65580fa18971ea7decf804">pk_header_init</a></div><div class="ttdeci">static void pk_header_init(struct mover *m, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03261">sock.c:3261</a></div></div>
<div class="ttc" id="structmover_html_a0d1d6b88abb201c5a587cf638ebe19e8"><div class="ttname"><a href="../../d1/d99/structmover.html#a0d1d6b88abb201c5a587cf638ebe19e8">mover::m_op</a></div><div class="ttdeci">const struct mover_op_vec * m_op</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00863">sock.c:863</a></div></div>
<div class="ttc" id="group__netsock_html_ga2eeacc9003a18e21618078440d7b57bb"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga2eeacc9003a18e21618078440d7b57bb">dgram_pk</a></div><div class="ttdeci">static int dgram_pk(struct mover *self, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03533">sock.c:3533</a></div></div>
<div class="ttc" id="structm0__bufvec_html"><div class="ttname"><a href="../../da/d2c/structm0__bufvec.html">m0_bufvec</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d65/vec_8h_source.html#l00145">vec.h:145</a></div></div>
<div class="ttc" id="structm0__net__buffer_html_a43fdc44f1f8f5d5e0be28c07e054160a"><div class="ttname"><a href="../../d9/d7e/structm0__net__buffer.html#a43fdc44f1f8f5d5e0be28c07e054160a">m0_net_buffer::nb_ep</a></div><div class="ttdeci">struct m0_net_end_point * nb_ep</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l01424">net.h:1424</a></div></div>
<div class="ttc" id="linux__kernel_2types_8h_html_a181807730d4a375f848ba139813ce04f"><div class="ttname"><a href="../../d2/de1/linux__kernel_2types_8h.html#a181807730d4a375f848ba139813ce04f">INT32_MAX</a></div><div class="ttdeci">#define INT32_MAX</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de1/linux__kernel_2types_8h_source.html#l00043">types.h:43</a></div></div>
<div class="ttc" id="group__tlist_html_gaff6f93b3ca67a19e8460cc469f5eabda"><div class="ttname"><a href="../../d7/d08/group__tlist.html#gaff6f93b3ca67a19e8460cc469f5eabda">m0_tl_forall</a></div><div class="ttdeci">#define m0_tl_forall(name, var, head,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d30/tlist_8h_source.html#l00735">tlist.h:735</a></div></div>
<div class="ttc" id="group__netsock_html_ga88e81fbd6443046da02ec3cb446fa705"><div class="ttname"><a href="../../d5/d16/group__netsock.html#ga88e81fbd6443046da02ec3cb446fa705">addr_decode</a></div><div class="ttdeci">static void addr_decode(struct addr *addr, const struct sockaddr *sa)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l02788">sock.c:2788</a></div></div>
<div class="ttc" id="group__netsock_html_gga2a989014423ee897a1d4314f292babdbae1999ab5c5b6740876a5e8ed025260aa"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gga2a989014423ee897a1d4314f292babdbae1999ab5c5b6740876a5e8ed025260aa">S_LISTENING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00673">sock.c:673</a></div></div>
<div class="ttc" id="structpfamily_html_a47da420cb14c4c92a1e09df6913ec690"><div class="ttname"><a href="../../d3/d5d/structpfamily.html#a47da420cb14c4c92a1e09df6913ec690">pfamily::f_encode</a></div><div class="ttdeci">void(* f_encode)(const struct addr *a, struct sockaddr *sa)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l00963">sock.c:963</a></div></div>
<div class="ttc" id="assert_8h_html_a3c39879398f6b8e4a2ed005fbf2e79c1"><div class="ttname"><a href="../../dc/da7/assert_8h.html#a3c39879398f6b8e4a2ed005fbf2e79c1">M0_IMPOSSIBLE</a></div><div class="ttdeci">#define M0_IMPOSSIBLE(fmt,...)</div></div>
<div class="ttc" id="group__netsock_html_gad9fd986ece2d618089cfda4b185ce4ba"><div class="ttname"><a href="../../d5/d16/group__netsock.html#gad9fd986ece2d618089cfda4b185ce4ba">dgram_pk_done</a></div><div class="ttdeci">static int dgram_pk_done(struct mover *self, struct sock *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1a/sock_8c_source.html#l03587">sock.c:3587</a></div></div>
<div class="ttc" id="group__sm_html_ga22cf05c6937b3cea98367c6c8fc85600"><div class="ttname"><a href="../../d1/dc1/group__sm.html#ga22cf05c6937b3cea98367c6c8fc85600">m0_sm_fini</a></div><div class="ttdeci">M0_INTERNAL void m0_sm_fini(struct m0_sm *mach)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1f/sm_8c_source.html#l00331">sm.c:331</a></div></div>
<div class="ttc" id="group__cookie_html_ga253606578697058d01448d06fdf5547c"><div class="ttname"><a href="../../da/dd3/group__cookie.html#ga253606578697058d01448d06fdf5547c">m0_cookie_dereference</a></div><div class="ttdeci">M0_INTERNAL int m0_cookie_dereference(const struct m0_cookie *cookie, uint64_t **addr)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d41/lib_2cookie_8c_source.html#l00109">cookie.c:109</a></div></div>
<div class="ttc" id="structm0__net__transfer__mc_html_ac16e5b955b5bfa853933e1784b57cac3"><div class="ttname"><a href="../../d4/d78/structm0__net__transfer__mc.html#ac16e5b955b5bfa853933e1784b57cac3">m0_net_transfer_mc::ntm_recv_pool</a></div><div class="ttdeci">struct m0_net_buffer_pool * ntm_recv_pool</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00896">net.h:896</a></div></div>
<div class="ttc" id="group__net_html_ggaaa9dbf6c20e7f07dfe6fc3746f6183e2a39b6318d195085ad1ec281a72d6cc70d"><div class="ttname"><a href="../../d9/dd2/group__net.html#ggaaa9dbf6c20e7f07dfe6fc3746f6183e2a39b6318d195085ad1ec281a72d6cc70d">M0_NET_TM_STOPPING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db3/net_2net_8h_source.html#l00635">net.h:635</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_427baa8a9a5be237f298d4545d0d1ce2.html">net</a></li><li class="navelem"><a class="el" href="../../dir_f96b4a0e4cfb099f02f403884922d7a4.html">sock</a></li><li class="navelem"><a class="el" href="../../d4/d1a/sock_8c.html">sock.c</a></li>
    <li class="footer">Generated on Fri May 20 2022 10:35:02 for Motr by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
