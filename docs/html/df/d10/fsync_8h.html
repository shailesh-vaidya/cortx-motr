<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Motr: m0t1fs/linux_kernel/fsync.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Motr
   &#160;<span id="projectnumber">M0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('df/d10/fsync_8h.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">fsync.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;linux/version.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d8/dd5/fsync__fops_8h_source.html">mdservice/fsync_fops.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d9/d51/fop_2fop_8h_source.html">fop/fop.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for fsync.h:</div>
<div class="dyncontent">
<div class="center"><img src="../../d4/dd5/fsync_8h__incl.png" border="0" usemap="#m0t1fs_2linux__kernel_2fsync_8h" alt=""/></div>
<map name="m0t1fs_2linux__kernel_2fsync_8h" id="m0t1fs_2linux__kernel_2fsync_8h">
<area shape="rect" id="node3" href="../../d8/dd5/fsync__fops_8h.html" title="mdservice/fsync_fops.h" alt="" coords="137,95,298,121"/>
<area shape="rect" id="node4" href="../../d9/d51/fop_2fop_8h.html" title="fop/fop.h" alt="" coords="322,95,395,121"/>
</map>
</div>
</div>
<p><a href="../../df/d10/fsync_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/de7/structm0t1fs__fsync__fop__wrapper.html">m0t1fs_fsync_fop_wrapper</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d33/structm0t1fs__fsync__interactions.html">m0t1fs_fsync_interactions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a6a28786dd7b8ee361380e9c4d2504d11"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d10/fsync_8h.html#a6a28786dd7b8ee361380e9c4d2504d11">__MOTR_M0T1FS_FSYNC_H__</a></td></tr>
<tr class="separator:a6a28786dd7b8ee361380e9c4d2504d11"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a389eff049efbd0e1d797f17d94739ff6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d10/fsync_8h.html#a389eff049efbd0e1d797f17d94739ff6">m0t1fs_fsync</a> (struct <a class="el" href="../../de/dd4/ut_2fsync_8c.html#a6c3cd9b35b621234e7802ad78fea5473">file</a> *<a class="el" href="../../de/dd4/ut_2fsync_8c.html#a6c3cd9b35b621234e7802ad78fea5473">file</a>, loff_t <a class="el" href="../../d0/da4/group___c_m.html#ga6cb82f8d34f54e75f0f7089da2b00433">start</a>, loff_t end, int datasync)</td></tr>
<tr class="separator:a389eff049efbd0e1d797f17d94739ff6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77a4ac0fb72541ef4318b35538ae18e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d10/fsync_8h.html#a77a4ac0fb72541ef4318b35538ae18e9">m0t1fs_fsync_record_update</a> (struct <a class="el" href="../../d7/dd6/structm0__reqh__service__ctx.html">m0_reqh_service_ctx</a> *<a class="el" href="../../d1/d9b/flock_8c.html#ad4b84b0614a9a5e8a262bf9fc68c0a10">service</a>, struct m0t1fs_sb *<a class="el" href="../../de/dd4/ut_2fsync_8c.html#a86b33e7d051e6fbd578210372b5cbe4a">csb</a>, struct m0t1fs_inode *<a class="el" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a4378d6e2c48ff3495d7197693b589a36">inode</a>, struct <a class="el" href="../../d6/d2f/structm0__be__tx__remid.html">m0_be_tx_remid</a> *btr)</td></tr>
<tr class="separator:a77a4ac0fb72541ef4318b35538ae18e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab04eddb722b1afb68cf9593c8ef9c72e"><td class="memItemLeft" align="right" valign="top">M0_INTERNAL int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d10/fsync_8h.html#ab04eddb722b1afb68cf9593c8ef9c72e">m0t1fs_fsync_request_create</a> (struct <a class="el" href="../../d8/d0d/structm0__reqh__service__txid.html">m0_reqh_service_txid</a> *<a class="el" href="../../d8/d6f/ut_2sync_8c.html#a03e174c746f1bd0a323b8e2dc8bde2b3">stx</a>, struct <a class="el" href="../../d3/de7/structm0t1fs__fsync__fop__wrapper.html">m0t1fs_fsync_fop_wrapper</a> **ffw, enum <a class="el" href="../../d8/dd5/fsync__fops_8h.html#aa107388ab23b4f8c45866be89d396cae">m0_fsync_mode</a> <a class="el" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a5c10aac132be10054364e8c6dab6e3bc">mode</a>)</td></tr>
<tr class="separator:ab04eddb722b1afb68cf9593c8ef9c72e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb666f11fb63de51e91bda42de88b4b8"><td class="memItemLeft" align="right" valign="top">M0_INTERNAL int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d10/fsync_8h.html#acb666f11fb63de51e91bda42de88b4b8">m0t1fs_fsync_reply_process</a> (struct m0t1fs_sb *<a class="el" href="../../de/dd4/ut_2fsync_8c.html#a86b33e7d051e6fbd578210372b5cbe4a">csb</a>, struct m0t1fs_inode *<a class="el" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a4378d6e2c48ff3495d7197693b589a36">inode</a>, struct <a class="el" href="../../d3/de7/structm0t1fs__fsync__fop__wrapper.html">m0t1fs_fsync_fop_wrapper</a> *ffw)</td></tr>
<tr class="separator:acb666f11fb63de51e91bda42de88b4b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7e50baca982f09f65ce414593d94eaa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d10/fsync_8h.html#ae7e50baca982f09f65ce414593d94eaa">m0t1fs_sync_fs</a> (struct <a class="el" href="../../de/dd4/ut_2fsync_8c.html#a538b868fa6b042b6633783cd96ebae33">super_block</a> *<a class="el" href="../../da/d03/m0t1fs_2linux__kernel_2ut_2file_8c.html#a75bc9e5b35af599710e65a2c6d8d6bf5">sb</a>, int <a class="el" href="../../d0/d5d/ut_2sm_8c.html#a07a39296118825b8d4387af2b8531ab4">wait</a>)</td></tr>
<tr class="separator:ae7e50baca982f09f65ce414593d94eaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada6c5d1357d9fdcb85436caa9150599b"><td class="memItemLeft" align="right" valign="top">M0_INTERNAL int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d10/fsync_8h.html#ada6c5d1357d9fdcb85436caa9150599b">m0t1fs_fsync_core</a> (struct m0t1fs_inode *<a class="el" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a4378d6e2c48ff3495d7197693b589a36">inode</a>, enum <a class="el" href="../../d8/dd5/fsync__fops_8h.html#aa107388ab23b4f8c45866be89d396cae">m0_fsync_mode</a> <a class="el" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a5c10aac132be10054364e8c6dab6e3bc">mode</a>)</td></tr>
<tr class="separator:ada6c5d1357d9fdcb85436caa9150599b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a6a28786dd7b8ee361380e9c4d2504d11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a28786dd7b8ee361380e9c4d2504d11">&#9670;&nbsp;</a></span>__MOTR_M0T1FS_FSYNC_H__</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __MOTR_M0T1FS_FSYNC_H__</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/d10/fsync_8h_source.html#l00032">32</a> of file <a class="el" href="../../df/d10/fsync_8h_source.html">fsync.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a389eff049efbd0e1d797f17d94739ff6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a389eff049efbd0e1d797f17d94739ff6">&#9670;&nbsp;</a></span>m0t1fs_fsync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int m0t1fs_fsync </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/dd4/ut_2fsync_8c.html#a6c3cd9b35b621234e7802ad78fea5473">file</a> *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">loff_t&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">loff_t&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>datasync</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>m0t1fs fsync entry point</p>
<p>Entry point for fsync, calls m0t1fs_fsync_core with mode=active</p>
<p>parameter dentry is unused as we don't need it - it is removed in later kernel versions</p>
<p>parameter datasync is unused, as we only ever sync data. To sync metadata would require a sync against the super-block, as all metadata currently lives in container-zero. </p>
<p>Failure </p><dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000140">Todo:</a></b></dt><dd>: Generate some addb here. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d8f/fsync_8c_source.html#l00354">354</a> of file <a class="el" href="../../d2/d8f/fsync_8c_source.html">fsync.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d10/fsync_8h_a389eff049efbd0e1d797f17d94739ff6_cgraph.png" border="0" usemap="#df/d10/fsync_8h_a389eff049efbd0e1d797f17d94739ff6_cgraph" alt=""/></div>
<map name="df/d10/fsync_8h_a389eff049efbd0e1d797f17d94739ff6_cgraph" id="df/d10/fsync_8h_a389eff049efbd0e1d797f17d94739ff6_cgraph">
<area shape="rect" id="node2" href="../../d0/dec/m0t1fs_2linux__kernel_2file_8c.html#a9da36324ab093dc664947a583ea15876" title="m0t1fs_file_to_m0inode" alt="" coords="155,5,315,32"/>
<area shape="rect" id="node3" href="../../d0/da4/group___c_m.html#ga6cb82f8d34f54e75f0f7089da2b00433" title="start" alt="" coords="211,56,259,83"/>
<area shape="rect" id="node4" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#ad1c2b8b0cf1cc0d319e690c0bef9569e" title="M0_LEAVE" alt="" coords="363,132,452,159"/>
<area shape="rect" id="node5" href="../../d2/d8f/fsync_8c.html#a7ef11034b9a9e2b3403d29bf493657fa" title="m0t1fs_fsync_core" alt="" coords="168,157,301,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d10/fsync_8h_a389eff049efbd0e1d797f17d94739ff6_icgraph.png" border="0" usemap="#df/d10/fsync_8h_a389eff049efbd0e1d797f17d94739ff6_icgraph" alt=""/></div>
<map name="df/d10/fsync_8h_a389eff049efbd0e1d797f17d94739ff6_icgraph" id="df/d10/fsync_8h_a389eff049efbd0e1d797f17d94739ff6_icgraph">
<area shape="rect" id="node2" href="../../de/dd4/ut_2fsync_8c.html#ae99c72124faa1285c4f2aca570bce50e" title="call_m0t1fs_fsync" alt="" coords="155,5,283,32"/>
</map>
</div>

</div>
</div>
<a id="ada6c5d1357d9fdcb85436caa9150599b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada6c5d1357d9fdcb85436caa9150599b">&#9670;&nbsp;</a></span>m0t1fs_fsync_core()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">M0_INTERNAL int m0t1fs_fsync_core </td>
          <td>(</td>
          <td class="paramtype">struct m0t1fs_inode *&#160;</td>
          <td class="paramname"><em>inode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d8/dd5/fsync__fops_8h.html#aa107388ab23b4f8c45866be89d396cae">m0_fsync_mode</a>&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>m0t1fs fsync core sends an fsync-fop to a list of services, then blocks, waiting for replies. This is implemented as two loops. The 'fop sending loop', generates and posts fops, adding them to a list of pending fops. This is all done while holding the m0t1fs_indode::ci_pending_txid_lock. The 'reply receiving loop' works over the list of pending fops, waiting for a reply for each one. It acquires the m0t1fs_indode::ci_pending_txid_lock only when necessary.</p>
<p>m0t1fs fsync core sends an fsync-fop to a list of services, then blocks, waiting for replies. This is implemented as two loops. The 'fop sending loop', generates and posts fops, adding them to a list of pending fops. This is all done while holding the m0t1fs_indode::ci_service_pending_txid_map_lock. The 'reply receiving loop' works over the list of pending fops, waiting for a reply for each one. It acquires the m0t1fs_indode::ci_service_pending_txid_map_lock only when necessary. </p>

<p class="definition">Definition at line <a class="el" href="../../d2/d8f/fsync_8c_source.html#l00281">281</a> of file <a class="el" href="../../d2/d8f/fsync_8c_source.html">fsync.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d10/fsync_8h_ada6c5d1357d9fdcb85436caa9150599b_cgraph.png" border="0" usemap="#df/d10/fsync_8h_ada6c5d1357d9fdcb85436caa9150599b_cgraph" alt=""/></div>
<map name="df/d10/fsync_8h_ada6c5d1357d9fdcb85436caa9150599b_cgraph" id="df/d10/fsync_8h_ada6c5d1357d9fdcb85436caa9150599b_cgraph">
<area shape="rect" id="node2" href="../../d7/d08/group__tlist.html#ga9c212eaa932cc6814b36529981a18de4" title="m0_tlist_init" alt="" coords="216,5,308,32"/>
<area shape="rect" id="node3" href="../../d0/d04/group__mutex.html#gae26efdb3a765f750c5992041d6ee2336" title="m0_mutex_lock" alt="" coords="205,56,319,83"/>
<area shape="rect" id="node4" href="../../d2/d8f/fsync_8c.html#aed78c5355fe89f76e01dbb0ce18a47e3" title="m0t1fs_fsync_request\l_create" alt="" coords="187,107,337,149"/>
<area shape="rect" id="node5" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#ad1c2b8b0cf1cc0d319e690c0bef9569e" title="M0_LEAVE" alt="" coords="385,144,475,171"/>
<area shape="rect" id="node6" href="../../d0/d04/group__mutex.html#ga18963570792098f5ab3cf3e8ede8046a" title="m0_mutex_unlock" alt="" coords="198,224,326,251"/>
<area shape="rect" id="node7" href="../../d2/d8f/fsync_8c.html#ab9d0c601233a60e1a032d6d41fe75e50" title="m0t1fs_fsync_reply\l_process" alt="" coords="194,275,330,317"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d10/fsync_8h_ada6c5d1357d9fdcb85436caa9150599b_icgraph.png" border="0" usemap="#df/d10/fsync_8h_ada6c5d1357d9fdcb85436caa9150599b_icgraph" alt=""/></div>
<map name="df/d10/fsync_8h_ada6c5d1357d9fdcb85436caa9150599b_icgraph" id="df/d10/fsync_8h_ada6c5d1357d9fdcb85436caa9150599b_icgraph">
<area shape="rect" id="node2" href="../../df/d10/fsync_8h.html#a389eff049efbd0e1d797f17d94739ff6" title="m0t1fs_fsync" alt="" coords="216,5,317,32"/>
<area shape="rect" id="node3" href="../../de/dd4/ut_2fsync_8c.html#ad13fe16abbc6e636af2977dbc9dcddc1" title="call_m0t1fs_fsync_core" alt="" coords="187,56,347,83"/>
<area shape="rect" id="node4" href="../../dc/d32/ioctl_8c.html#ad01673c6ae4c9fc4139dedbf1dd593e6" title="m0t1fs_ioctl" alt="" coords="220,107,313,133"/>
</map>
</div>

</div>
</div>
<a id="a77a4ac0fb72541ef4318b35538ae18e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77a4ac0fb72541ef4318b35538ae18e9">&#9670;&nbsp;</a></span>m0t1fs_fsync_record_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void m0t1fs_fsync_record_update </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/dd6/structm0__reqh__service__ctx.html">m0_reqh_service_ctx</a> *&#160;</td>
          <td class="paramname"><em>service</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct m0t1fs_sb *&#160;</td>
          <td class="paramname"><em>csb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct m0t1fs_inode *&#160;</td>
          <td class="paramname"><em>inode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d2f/structm0__be__tx__remid.html">m0_be_tx_remid</a> *&#160;</td>
          <td class="paramname"><em>btr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Updates fsync records in fop callbacks. Service must be specified, one or both of csb/inode should be specified. new_txid may be null.</p>
<p>Update a <a class="el" href="../../d8/d0d/structm0__reqh__service__txid.html">m0_reqh_service_txid</a> with the specified be_tx_remid if the struct <a class="el" href="../../d6/d2f/structm0__be__tx__remid.html#ab209d850a9de7f8da21507854811e85e">m0_be_tx_remid::tri_txid</a> &gt; the stored value inode may be NULL if the update has no associated inode. csb may be NULL, iff inode is specified. </p>

<p class="definition">Definition at line <a class="el" href="../../d2/d8f/fsync_8c_source.html#l00397">397</a> of file <a class="el" href="../../d2/d8f/fsync_8c_source.html">fsync.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d10/fsync_8h_a77a4ac0fb72541ef4318b35538ae18e9_cgraph.png" border="0" usemap="#df/d10/fsync_8h_a77a4ac0fb72541ef4318b35538ae18e9_cgraph" alt=""/></div>
<map name="df/d10/fsync_8h_a77a4ac0fb72541ef4318b35538ae18e9_cgraph" id="df/d10/fsync_8h_a77a4ac0fb72541ef4318b35538ae18e9_cgraph">
<area shape="rect" id="node2" href="../../d0/dec/m0t1fs_2linux__kernel_2file_8c.html#afbe650fedc6e2fe4fa20fe191bce5b88" title="m0inode_to_sb" alt="" coords="206,5,317,32"/>
<area shape="rect" id="node3" href="../../d0/d04/group__mutex.html#gae26efdb3a765f750c5992041d6ee2336" title="m0_mutex_lock" alt="" coords="204,56,319,83"/>
<area shape="rect" id="node4" href="../../d0/d04/group__mutex.html#ga18963570792098f5ab3cf3e8ede8046a" title="m0_mutex_unlock" alt="" coords="197,107,325,133"/>
<area shape="rect" id="node5" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#ad1c2b8b0cf1cc0d319e690c0bef9569e" title="M0_LEAVE" alt="" coords="217,157,306,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d10/fsync_8h_a77a4ac0fb72541ef4318b35538ae18e9_icgraph.png" border="0" usemap="#df/d10/fsync_8h_a77a4ac0fb72541ef4318b35538ae18e9_icgraph" alt=""/></div>
<map name="df/d10/fsync_8h_a77a4ac0fb72541ef4318b35538ae18e9_icgraph" id="df/d10/fsync_8h_a77a4ac0fb72541ef4318b35538ae18e9_icgraph">
<area shape="rect" id="node2" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a439ab2e1f721fb44a64b33d2b8de7feb" title="m0t1fs_mds_cob_op" alt="" coords="213,5,355,32"/>
<area shape="rect" id="node3" href="../../d0/dec/m0t1fs_2linux__kernel_2file_8c.html#ab71e27c7d8d75e2858f8f53deed8fe14" title="io_bottom_half" alt="" coords="231,56,337,83"/>
<area shape="rect" id="node4" href="../../de/dd4/ut_2fsync_8c.html#a0297c06b185c688920dffba4cfce52d0" title="test_m0t1fs_fsync_record\l_update" alt="" coords="197,107,371,149"/>
</map>
</div>

</div>
</div>
<a id="acb666f11fb63de51e91bda42de88b4b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb666f11fb63de51e91bda42de88b4b8">&#9670;&nbsp;</a></span>m0t1fs_fsync_reply_process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">M0_INTERNAL int m0t1fs_fsync_reply_process </td>
          <td>(</td>
          <td class="paramtype">struct m0t1fs_sb *&#160;</td>
          <td class="paramname"><em>csb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct m0t1fs_inode *&#160;</td>
          <td class="paramname"><em>inode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d3/de7/structm0t1fs__fsync__fop__wrapper.html">m0t1fs_fsync_fop_wrapper</a> *&#160;</td>
          <td class="paramname"><em>ffw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Wait for a reply to an fsync fop and process it. Cleans-up the fop allocated in m0t1fs_fsync_request_create.</p>
<p>inode may be NULL if the reply is only likely to touch the super block. csb may be NULL, iff inode is specified.</p>
<p>Waits for a reply to an fsync fop and process it. Cleans-up the fop allocated in m0t1fs_fsync_request_create.</p>
<p>inode may be NULL if the reply is only likely to touch the super block. csb may be NULL, iff inode is specified. </p>

<p class="definition">Definition at line <a class="el" href="../../d2/d8f/fsync_8c_source.html#l00206">206</a> of file <a class="el" href="../../d2/d8f/fsync_8c_source.html">fsync.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d10/fsync_8h_acb666f11fb63de51e91bda42de88b4b8_cgraph.png" border="0" usemap="#df/d10/fsync_8h_acb666f11fb63de51e91bda42de88b4b8_cgraph" alt=""/></div>
<map name="df/d10/fsync_8h_acb666f11fb63de51e91bda42de88b4b8_cgraph" id="df/d10/fsync_8h_acb666f11fb63de51e91bda42de88b4b8_cgraph">
<area shape="rect" id="node2" href="../../d0/dec/m0t1fs_2linux__kernel_2file_8c.html#afbe650fedc6e2fe4fa20fe191bce5b88" title="m0inode_to_sb" alt="" coords="204,5,315,32"/>
<area shape="rect" id="node3" href="../../d9/d7d/group__time.html#ga6cb802eb5e4cee7f6e5efc86da091145" title="m0_time_from_now" alt="" coords="191,56,327,83"/>
<area shape="rect" id="node4" href="../../d6/d39/group__fop.html#ga514d8cd13fb698f7498be1147831f5b0" title="m0_fop_data" alt="" coords="211,107,308,133"/>
<area shape="rect" id="node5" href="../../d6/d39/group__fop.html#ga8544e1edf0cb8a03920ecf624c72c971" title="m0_rpc_item_to_fop" alt="" coords="189,157,329,184"/>
<area shape="rect" id="node6" href="../../d2/d8f/fsync_8c.html#a42c615b4cf31d26b4fa16eb314072019" title="fsync_stx_update" alt="" coords="197,208,322,235"/>
<area shape="rect" id="node7" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a9a02a790ad457506f9f3bc12121e6079" title="M0_RC" alt="" coords="226,259,293,285"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d10/fsync_8h_acb666f11fb63de51e91bda42de88b4b8_icgraph.png" border="0" usemap="#df/d10/fsync_8h_acb666f11fb63de51e91bda42de88b4b8_icgraph" alt=""/></div>
<map name="df/d10/fsync_8h_acb666f11fb63de51e91bda42de88b4b8_icgraph" id="df/d10/fsync_8h_acb666f11fb63de51e91bda42de88b4b8_icgraph">
<area shape="rect" id="node2" href="../../df/d10/fsync_8h.html#ada6c5d1357d9fdcb85436caa9150599b" title="m0t1fs_fsync_core" alt="" coords="204,5,337,32"/>
<area shape="rect" id="node3" href="../../df/d10/fsync_8h.html#ae7e50baca982f09f65ce414593d94eaa" title="m0t1fs_sync_fs" alt="" coords="213,56,328,83"/>
<area shape="rect" id="node4" href="../../de/dd4/ut_2fsync_8c.html#a85d14312715526f0000848dbe7ccc451" title="call_m0t1fs_fsync_reply\l_process" alt="" coords="189,107,352,149"/>
</map>
</div>

</div>
</div>
<a id="ab04eddb722b1afb68cf9593c8ef9c72e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab04eddb722b1afb68cf9593c8ef9c72e">&#9670;&nbsp;</a></span>m0t1fs_fsync_request_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">M0_INTERNAL int m0t1fs_fsync_request_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d0d/structm0__reqh__service__txid.html">m0_reqh_service_txid</a> *&#160;</td>
          <td class="paramname"><em>stx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d3/de7/structm0t1fs__fsync__fop__wrapper.html">m0t1fs_fsync_fop_wrapper</a> **&#160;</td>
          <td class="paramname"><em>ffw_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d8/dd5/fsync__fops_8h.html#aa107388ab23b4f8c45866be89d396cae">m0_fsync_mode</a>&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create and send an fsync fop from the provided <a class="el" href="../../d8/d0d/structm0__reqh__service__txid.html">m0_reqh_service_txid</a>.</p>
<p>Creates and sends an fsync fop from the provided <a class="el" href="../../d8/d0d/structm0__reqh__service__txid.html">m0_reqh_service_txid</a>. Allocates and returns the fop wrapper at  on success, which is freed on the last <a class="el" href="../../d6/d39/group__fop.html#gacd879a192974d7f0d92ee1601658d436">m0_fop_put()</a>. </p>

<p class="definition">Definition at line <a class="el" href="../../d2/d8f/fsync_8c_source.html#l00105">105</a> of file <a class="el" href="../../d2/d8f/fsync_8c_source.html">fsync.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d10/fsync_8h_ab04eddb722b1afb68cf9593c8ef9c72e_cgraph.png" border="0" usemap="#df/d10/fsync_8h_ab04eddb722b1afb68cf9593c8ef9c72e_cgraph" alt=""/></div>
<map name="df/d10/fsync_8h_ab04eddb722b1afb68cf9593c8ef9c72e_cgraph" id="df/d10/fsync_8h_ab04eddb722b1afb68cf9593c8ef9c72e_cgraph">
<area shape="rect" id="node2" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a01283f6c481bc4a3d0f204e957179d6e" title="M0_ERR" alt="" coords="255,5,331,32"/>
<area shape="rect" id="node3" href="../../df/db4/group__rpc__session.html#gae04549341ae7838ea697d669b2f161ec" title="m0_rpc_session_validate" alt="" coords="209,56,378,83"/>
<area shape="rect" id="node4" href="../../d7/ded/group__memory.html#ga0b8533a3024754008602759e71337eb3" title="m0_free" alt="" coords="441,132,510,159"/>
<area shape="rect" id="node5" href="../../d6/d39/group__fop.html#ga3b6bdaa5eab42c940169cdb96cb2f7fc" title="m0_fop_init" alt="" coords="249,208,338,235"/>
<area shape="rect" id="node6" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#ad1c2b8b0cf1cc0d319e690c0bef9569e" title="M0_LEAVE" alt="" coords="431,208,520,235"/>
<area shape="rect" id="node7" href="../../d2/d8f/fsync_8c.html#a5e3de19e6352d6dc35dae264b59940ce" title="m0t1fs_fsync_fop_cleanup" alt="" coords="204,157,383,184"/>
<area shape="rect" id="node8" href="../../d6/d39/group__fop.html#gab530babf8dcb440aaecdd9ebb67a4c7a" title="m0_fop_data_alloc" alt="" coords="228,309,359,336"/>
<area shape="rect" id="node9" href="../../d6/d39/group__fop.html#ga514d8cd13fb698f7498be1147831f5b0" title="m0_fop_data" alt="" coords="245,360,342,387"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d10/fsync_8h_ab04eddb722b1afb68cf9593c8ef9c72e_icgraph.png" border="0" usemap="#df/d10/fsync_8h_ab04eddb722b1afb68cf9593c8ef9c72e_icgraph" alt=""/></div>
<map name="df/d10/fsync_8h_ab04eddb722b1afb68cf9593c8ef9c72e_icgraph" id="df/d10/fsync_8h_ab04eddb722b1afb68cf9593c8ef9c72e_icgraph">
<area shape="rect" id="node2" href="../../df/d10/fsync_8h.html#ada6c5d1357d9fdcb85436caa9150599b" title="m0t1fs_fsync_core" alt="" coords="227,5,361,32"/>
<area shape="rect" id="node3" href="../../df/d10/fsync_8h.html#ae7e50baca982f09f65ce414593d94eaa" title="m0t1fs_sync_fs" alt="" coords="237,56,351,83"/>
<area shape="rect" id="node4" href="../../de/dd4/ut_2fsync_8c.html#a69606724d5712445ba7f184a7b000af2" title="test_m0t1fs_fsync_request\l_create" alt="" coords="204,107,384,149"/>
</map>
</div>

</div>
</div>
<a id="ae7e50baca982f09f65ce414593d94eaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7e50baca982f09f65ce414593d94eaa">&#9670;&nbsp;</a></span>m0t1fs_sync_fs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int m0t1fs_sync_fs </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/dd4/ut_2fsync_8c.html#a538b868fa6b042b6633783cd96ebae33">super_block</a> *&#160;</td>
          <td class="paramname"><em>sb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wait</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>m0t1fs sync_fs entry point</p>
<p>Entry point for sync_fs, sends fsync-fops for each pending transaction the super block is aware off. Unlike m0t1fs_fsync_core this function acquires the sc_max_pending_tx_lock for each service, as there is not a larger-granularity lock. </p>

<p class="definition">Definition at line <a class="el" href="../../d2/d8f/fsync_8c_source.html#l00462">462</a> of file <a class="el" href="../../d2/d8f/fsync_8c_source.html">fsync.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d10/fsync_8h_ae7e50baca982f09f65ce414593d94eaa_cgraph.png" border="0" usemap="#df/d10/fsync_8h_ae7e50baca982f09f65ce414593d94eaa_cgraph" alt=""/></div>
<map name="df/d10/fsync_8h_ae7e50baca982f09f65ce414593d94eaa_cgraph" id="df/d10/fsync_8h_ae7e50baca982f09f65ce414593d94eaa_cgraph">
<area shape="rect" id="node2" href="../../d7/d08/group__tlist.html#ga9c212eaa932cc6814b36529981a18de4" title="m0_tlist_init" alt="" coords="197,5,289,32"/>
<area shape="rect" id="node3" href="../../d0/d04/group__mutex.html#gae26efdb3a765f750c5992041d6ee2336" title="m0_mutex_lock" alt="" coords="186,56,301,83"/>
<area shape="rect" id="node4" href="../../d0/d04/group__mutex.html#ga18963570792098f5ab3cf3e8ede8046a" title="m0_mutex_unlock" alt="" coords="179,107,307,133"/>
<area shape="rect" id="node5" href="../../d2/d8f/fsync_8c.html#aed78c5355fe89f76e01dbb0ce18a47e3" title="m0t1fs_fsync_request\l_create" alt="" coords="168,158,319,199"/>
<area shape="rect" id="node6" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#ad1c2b8b0cf1cc0d319e690c0bef9569e" title="M0_LEAVE" alt="" coords="367,195,456,221"/>
<area shape="rect" id="node7" href="../../d2/d8f/fsync_8c.html#ab9d0c601233a60e1a032d6d41fe75e50" title="m0t1fs_fsync_reply\l_process" alt="" coords="175,275,311,317"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_b2b6f6521c7873dd5433a04717b65521.html">m0t1fs</a></li><li class="navelem"><a class="el" href="../../dir_0a7efa8fb7adb1798b6a55fd8ee67dd5.html">linux_kernel</a></li><li class="navelem"><a class="el" href="../../df/d10/fsync_8h.html">fsync.h</a></li>
    <li class="footer">Generated on Fri May 20 2022 10:35:20 for Motr by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
