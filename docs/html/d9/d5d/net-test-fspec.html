<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Motr: Functional Specification</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Motr
   &#160;<span id="projectnumber">M0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d9/d5d/net-test-fspec.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Functional Specification </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li><a class="el" href="../../d9/d5d/net-test-fspec.html#net-test-fspec-ds">Data Structures</a></li>
<li><a class="el" href="../../d9/d5d/net-test-fspec.html#net-test-fspec-sub">Subroutines</a></li>
<li><a class="el" href="../../d9/d5d/net-test-fspec.html#net-test-fspec-cli">Command Usage</a><ul>
<li><a class="el" href="../../d9/d5d/net-test-fspec.html#net-test-fspec-cli-node-kernel">Kernel module options</a></li>
<li><a class="el" href="../../d6/d26/net-test-fspec-cli-node-user.html">Userspace node</a></li>
<li><a class="el" href="../../d6/d7b/net-test-fspec-cli-console.html">Console</a></li>
</ul>
</li>
<li><a class="el" href="../../d9/d5d/net-test-fspec.html#net-test-fspec-usecases">Recipes</a><ul>
<li><a class="el" href="../../d9/d5d/net-test-fspec.html#net-test-fspec-usecases-bd">Using bulk buffer network descriptors</a></li>
<li><a class="el" href="../../d9/d5d/net-test-fspec.html#net-test-fspec-usecases-serialize">Complex serialization</a></li>
<li><a class="el" href="../../d9/d5d/net-test-fspec.html#net-test-fspec-usecases-kernel">Kernel module parameters example</a></li>
<li><a class="el" href="../../d6/d7b/net-test-fspec-cli-console.html#net-test-fspec-usecases-console">Console</a></li>
</ul>
</li>
<li><a class="el" href="../../de/d45/group___net_test_d_f_s.html">Detailed Functional Specification</a></li>
<li><a class="el" href="../../d4/d9f/group___net_test_internals.html">Internals</a></li>
</ul>
<h1><a class="anchor" id="net-test-fspec-ds"></a>
Data Structures</h1>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="../../de/d45/group___net_test_d_f_s.html">Network Benchmark</a></dd></dl>
<h1><a class="anchor" id="net-test-fspec-sub"></a>
Subroutines</h1>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="../../de/d45/group___net_test_d_f_s.html">Network Benchmark</a></dd></dl>
<h2><a class="anchor" id="net-test-fspec-sub-cons"></a>
Constructors and Destructors</h2>
<h2><a class="anchor" id="net-test-fspec-sub-acc"></a>
Accessors and Invariants</h2>
<h2><a class="anchor" id="net-test-fspec-sub-opi"></a>
Operational Interfaces</h2>
<h1><a class="anchor" id="net-test-fspec-cli"></a>
Command Usage</h1>
<h2><a class="anchor" id="net-test-fspec-cli-node-kernel"></a>
Kernel module options</h2>
<ul>
<li><b>node_role</b> Node role. Mandatory option.<ul>
<li><b>client</b> Program will act as test client.</li>
<li><b>server</b> Program will act as test server.</li>
</ul>
</li>
<li><b>test_type</b> Test type. Mandatory option.<ul>
<li><b>ping</b> Ping test will be executed.</li>
<li><b>bulk</b> Bulk test will be executed.</li>
</ul>
</li>
<li><b>count</b> Number of test messages to exchange between test client and test server. Makes sense for test client only. Default value is 16.</li>
<li><b>size</b> Size of bulk messages, bytes. Makes sense for bulk test only. Default value is 1048576 (1Mb). Standard suffixes (kKmMgG) can be added to the number.</li>
<li><b>target</b> Test servers list for the test client and vice versa. Items in list are comma-separated. Mandatory option. Test clients list for server is used for preallocating endpoint structures.</li>
<li><b>console</b> Console hostname. Mandatory option.</li>
</ul>
<h1><a class="anchor" id="net-test-fspec-usecases"></a>
Recipes</h1>
<h2><a class="anchor" id="net-test-fspec-usecases-bd"></a>
Using bulk buffer network descriptors</h2>
<p>Usage pattern for passive side: </p><div class="fragment"><div class="line"><a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d0/d9e/group__addb2.html#ga0e28f0d2e846f9ae37ef12de8cad22aa">offset</a> = 0;</div><div class="line"><a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> len;</div><div class="line">&lt;...&gt;</div><div class="line"><span class="keywordflow">for</span> (bulk buffers) {</div><div class="line">     &lt;<a class="code" href="../../d0/d9e/group__addb2.html#ga371e6a13078ef21cb73504994ffd7e0d">add</a> bulk <a class="code" href="../../dd/da2/structbuffer.html">buffer</a> to passive bulk <a class="code" href="../../d2/d36/structqueue.html">queue</a>&gt;</div><div class="line">     <span class="keyword">using</span> <a class="code" href="../../df/d38/group___net_test_network_internals.html#ga78369f73170e101746c33bb936505fde">m0_net_test_network_bulk_enqueue</a>()&gt;</div><div class="line">     len = <a class="code" href="../../df/d38/group___net_test_network_internals.html#gae34773d318d4e5ae959892e2b7d0f819">m0_net_test_network_bd_serialize</a>(<a class="code" href="../../d1/d19/group___net_test_serialize_d_f_s.html#ggaed3be74684dc8989910ed1f94cf642e0ac4b312eeae6d02ae14def41742758ff5">M0_NET_TEST_SERIALIZE</a>,</div><div class="line">                                       <a class="code" href="../../d5/d06/structctx.html">ctx</a>, &lt;buf_bulk_index&gt;,</div><div class="line">                                       buf_ping_index, <a class="code" href="../../d0/d9e/group__addb2.html#ga0e28f0d2e846f9ae37ef12de8cad22aa">offset</a>);</div><div class="line">     &lt;<a class="code" href="../../d1/dc0/group__crate__utils.html#gabb1188ce2b2c11467b2301f7eb93030e">check</a> <span class="keywordflow">for</span> len == 0&gt;</div><div class="line">     <a class="code" href="../../d0/d9e/group__addb2.html#ga0e28f0d2e846f9ae37ef12de8cad22aa">offset</a> += len;</div><div class="line">}</div></div><!-- fragment --><p> Usage pattern for active side: </p><div class="fragment"><div class="line"><a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> <a class="code" href="../../d0/d9e/group__addb2.html#ga0e28f0d2e846f9ae37ef12de8cad22aa">offset</a> = 0;</div><div class="line"><a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> len;</div><div class="line"><span class="keywordtype">size_t</span> desc_nr;</div><div class="line">&lt;...&gt;</div><div class="line">desc_nr = <a class="code" href="../../df/d38/group___net_test_network_internals.html#gad5aea5787656cd4b29d94769bc8a91e0">m0_net_test_network_bd_nr</a>(<a class="code" href="../../d5/d06/structctx.html">ctx</a>, buf_ping_index);</div><div class="line"><span class="keywordflow">for</span> (<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> = 0; <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> &lt; desc_nr; ++<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>) {</div><div class="line">     len = <a class="code" href="../../df/d38/group___net_test_network_internals.html#gae34773d318d4e5ae959892e2b7d0f819">m0_net_test_network_bd_serialize</a>(<a class="code" href="../../d1/d19/group___net_test_serialize_d_f_s.html#ggaed3be74684dc8989910ed1f94cf642e0a34874694d687227ca9b594d17603598e">M0_NET_TEST_DESERIALIZE</a>,</div><div class="line">                                       <a class="code" href="../../d5/d06/structctx.html">ctx</a>, &lt;buf_bulk_index&gt;,</div><div class="line">                                       buf_ping_index, <a class="code" href="../../d0/d9e/group__addb2.html#ga0e28f0d2e846f9ae37ef12de8cad22aa">offset</a>);</div><div class="line">     &lt;<a class="code" href="../../d1/dc0/group__crate__utils.html#gabb1188ce2b2c11467b2301f7eb93030e">check</a> <span class="keywordflow">for</span> len == 0&gt;</div><div class="line">     <a class="code" href="../../d0/d9e/group__addb2.html#ga0e28f0d2e846f9ae37ef12de8cad22aa">offset</a> += len;</div><div class="line">     &lt;<a class="code" href="../../d0/d9e/group__addb2.html#ga371e6a13078ef21cb73504994ffd7e0d">add</a> bulk <a class="code" href="../../dd/da2/structbuffer.html">buffer</a> to active bulk <a class="code" href="../../d2/d36/structqueue.html">queue</a>&gt;</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="net-test-fspec-usecases-serialize"></a>
Complex serialization</h2>
<p>Usage pattern: </p><div class="fragment"><div class="line"><a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> len;</div><div class="line"><a class="code" href="../../d9/d49/types_8h.html#a754ca36f0e1fff3edef4f267024b1a1f">m0_bcount_t</a> len_total;</div><div class="line"></div><div class="line">len = serialize_first_part(...);</div><div class="line"><span class="keywordflow">if</span> (len == 0)</div><div class="line">   <span class="keywordflow">return</span> 0;</div><div class="line">len_total = <a class="code" href="../../d1/d19/group___net_test_serialize_d_f_s.html#gadc27b5a418767cd9732f8abd1b3f9fd9">net_test_len_accumulate</a>(0, len);</div><div class="line">len = serialize_second_part(...);</div><div class="line"><span class="keywordflow">if</span> (len == 0)</div><div class="line">   <span class="keywordflow">return</span> 0;</div><div class="line">len_total = <a class="code" href="../../d1/d19/group___net_test_serialize_d_f_s.html#gadc27b5a418767cd9732f8abd1b3f9fd9">net_test_len_accumulate</a>(len_total, len);</div><div class="line">...</div><div class="line">for (<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> = 0; <a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> &lt; number_of_items &amp;&amp; len_total != 0; ++<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>) {</div><div class="line">   len = serialize_item(<a class="code" href="../../db/dcd/m0t1fs_2linux__kernel_2dir_8c.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>, ...);</div><div class="line">   len_total = <a class="code" href="../../d1/d19/group___net_test_serialize_d_f_s.html#gadc27b5a418767cd9732f8abd1b3f9fd9">net_test_len_accumulate</a>(len_total, len);</div><div class="line">}</div><div class="line"><span class="keywordflow">if</span> (len_total == 0)</div><div class="line">   <span class="keywordflow">return</span> 0;</div><div class="line">...</div><div class="line">len = serialize_last_part(...);</div><div class="line">len_total = <a class="code" href="../../d1/d19/group___net_test_serialize_d_f_s.html#gadc27b5a418767cd9732f8abd1b3f9fd9">net_test_len_accumulate</a>(len_total, len);</div><div class="line"><span class="keywordflow">return</span> len_total;</div></div><!-- fragment --><h2><a class="anchor" id="net-test-fspec-usecases-kernel"></a>
Kernel module parameters example</h2>
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000193">Todo:</a></b></dt><dd>Outdated and not used now</dd></dl>
<div class="fragment"><div class="line">node_role=<a class="code" href="../../d3/db7/structclient.html">client</a> <a class="code" href="../../dd/d39/ut_2rm__foms_8c.html#aac4452a7487c189982bfeaca04a1326f">test_type</a>=ping <a class="code" href="../../d6/d0c/ut_2xcode_8c.html#a5f7d24ded17bf1ab44fdadf38c54a8b5">count</a>=10 target=s1,s2,s3</div></div><!-- fragment --><p> Run ping test as test client with 10 test messages to servers s1, s2 and s3.</p>
<div class="fragment"><div class="line">node_role=server <a class="code" href="../../dd/d39/ut_2rm__foms_8c.html#aac4452a7487c189982bfeaca04a1326f">test_type</a>=bulk target=c1,<a class="code" href="../../d5/d1b/structm0.html">m0</a> <a class="code" href="../../d4/d00/ut_2di_8c.html#a8629956d8c29c6159e411f38f24c140d">size</a>=128k</div></div><!-- fragment --><p> Run bulk test as test server with 128kB (=131072 bytes) bulk message size and test clients c1 and <a class="el" href="../../d5/d1b/structm0.html">m0</a>.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="../../dd/df4/net-test.html">Motr Network Benchmark</a> </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d3/dd6/_d_l_d_i_x.html">Detailed Designs</a></li><li class="navelem"><a class="el" href="../../dd/df4/net-test.html">Motr Network Benchmark</a></li>
    <li class="footer">Generated on Fri May 20 2022 10:35:35 for Motr by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
