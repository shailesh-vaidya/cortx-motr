<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Motr: m0_rpc_session Struct Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Motr
   &#160;<span id="projectnumber">M0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dd/d65/structm0__rpc__session.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle">
<div class="title">m0_rpc_session Struct Reference<div class="ingroups"><a class="el" href="../../df/db4/group__rpc__session.html">RPC Sessions</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../da/d46/session_8h_source.html">session.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for m0_rpc_session:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/db7/structm0__rpc__session__coll__graph.png" border="0" usemap="#m0__rpc__session_coll__map" alt="Collaboration graph"/></div>
<map name="m0__rpc__session_coll__map" id="m0__rpc__session_coll__map">
<area shape="rect" id="node2" href="../../d2/de3/structm0__rpc__conn.html" title="{m0_rpc_conn\n||}" alt="" coords="455,329,555,407"/>
<area shape="rect" id="node6" href="../../d4/d8a/structm0__tl.html" title="{m0_tl\n||}" alt="" coords="197,160,252,237"/>
<area shape="rect" id="node7" href="../../db/d49/structm0__sm.html" title="{m0_sm\n||}" alt="" coords="681,160,747,237"/>
<area shape="rect" id="node4" href="../../d9/de0/structm0__tlink.html" title="{m0_tlink\n||}" alt="" coords="276,160,347,237"/>
<area shape="rect" id="node9" href="../../d0/dab/structm0__rpc__item__cache.html" title="{m0_rpc_item_cache\n||}" alt="" coords="38,329,177,407"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:af2e686c38764797620d4c892b3f9aca2"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d65/structm0__rpc__session.html#af2e686c38764797620d4c892b3f9aca2">s_session_id</a></td></tr>
<tr class="separator:af2e686c38764797620d4c892b3f9aca2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a63f21d3f333ac07d0f5704cc0a7b3d"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d2/de3/structm0__rpc__conn.html">m0_rpc_conn</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d65/structm0__rpc__session.html#a6a63f21d3f333ac07d0f5704cc0a7b3d">s_conn</a></td></tr>
<tr class="separator:a6a63f21d3f333ac07d0f5704cc0a7b3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59f889cdd52fe131a1a3b1b3c2db49bb"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/de0/structm0__tlink.html">m0_tlink</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d65/structm0__rpc__session.html#a59f889cdd52fe131a1a3b1b3c2db49bb">s_link</a></td></tr>
<tr class="separator:a59f889cdd52fe131a1a3b1b3c2db49bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7682a12c793aca35313befd3b9277dd1"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d65/structm0__rpc__session.html#a7682a12c793aca35313befd3b9277dd1">s_hold_cnt</a></td></tr>
<tr class="separator:a7682a12c793aca35313befd3b9277dd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5766c3b04a967df4143cd23bff6f83e5"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../db/d49/structm0__sm.html">m0_sm</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d65/structm0__rpc__session.html#a5766c3b04a967df4143cd23bff6f83e5">s_sm</a></td></tr>
<tr class="separator:a5766c3b04a967df4143cd23bff6f83e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d336873e4726882c19a27eb73aacd78"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d65/structm0__rpc__session.html#a1d336873e4726882c19a27eb73aacd78">s_magic</a></td></tr>
<tr class="separator:a1d336873e4726882c19a27eb73aacd78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad180cb69f2332d72844eb9baa902425d"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d65/structm0__rpc__session.html#ad180cb69f2332d72844eb9baa902425d">s_xid</a></td></tr>
<tr class="separator:ad180cb69f2332d72844eb9baa902425d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2887eda43357a86c79b6826e040948d"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/d8a/structm0__tl.html">m0_tl</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d65/structm0__rpc__session.html#ae2887eda43357a86c79b6826e040948d">s_xid_list</a></td></tr>
<tr class="separator:ae2887eda43357a86c79b6826e040948d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25104433df20f8ff01c999ba879f82d3"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d0/dab/structm0__rpc__item__cache.html">m0_rpc_item_cache</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d65/structm0__rpc__session.html#a25104433df20f8ff01c999ba879f82d3">s_reply_cache</a></td></tr>
<tr class="separator:a25104433df20f8ff01c999ba879f82d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a198ae87ba4d6616647105f40ed3a9296"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d0/dab/structm0__rpc__item__cache.html">m0_rpc_item_cache</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d65/structm0__rpc__session.html#a198ae87ba4d6616647105f40ed3a9296">s_req_cache</a></td></tr>
<tr class="separator:a198ae87ba4d6616647105f40ed3a9296"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4883c15ffe86fa66c43c0a775dc96310"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d65/structm0__rpc__session.html#a4883c15ffe86fa66c43c0a775dc96310">s_cancelled</a></td></tr>
<tr class="separator:a4883c15ffe86fa66c43c0a775dc96310"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33e9a5449ed2e239fc8aaf4f0b61f22a"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/d8a/structm0__tl.html">m0_tl</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d65/structm0__rpc__session.html#a33e9a5449ed2e239fc8aaf4f0b61f22a">s_pending_cache</a></td></tr>
<tr class="separator:a33e9a5449ed2e239fc8aaf4f0b61f22a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Rpc connection can be shared by multiple entities (e.g. users) by creating their own "session" on the connection. A session can be used to maintain authentication information or QoS parameters.</p>
<p><b> Liveness: </b></p>
<p>On sender side, allocation and deallocation of <a class="el" href="../../dd/d65/structm0__rpc__session.html">m0_rpc_session</a> is entirely managed by user except for SESSION 0. SESSION 0 is allocated and deallocated by rpc-layer internally along with <a class="el" href="../../d2/de3/structm0__rpc__conn.html">m0_rpc_conn</a>. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="../../d2/de3/structm0__rpc__conn.html">m0_rpc_conn</a> for <a class="el" href="../../d0/d5d/ut_2sm_8c.html#a462318a97be8f41d7970bd97f3276852">more</a> information on creation and use of SESSION 0.</dd></dl>
<p>On receiver side, <a class="el" href="../../dd/d65/structm0__rpc__session.html">m0_rpc_session</a> object will be allocated and deallocated by rpc-layer internally, in response to session create and session terminate requests respectively.</p>
<p><b> Concurrency:</b></p>
<p>Users of rpc-layer are never expected to take lock on session. Rpc layer will internally synchronise access to <a class="el" href="../../dd/d65/structm0__rpc__session.html">m0_rpc_session</a>.</p>
<p>All access to session are synchronized using session-&gt;s_conn-&gt;c_rpc_machine-&gt;rm_sm_grp.s_lock.</p>
<p>When session is in one of INITIALISED, TERMINATED, FINALISED and FAILED state, user is expected to serialise access to the session object. (It is assumed that session, in one of {INITIALISED, TERMINATED, FAILED, FINALISED} states, does not have concurrent users).</p>
<pre class="fragment">                                    |
                                    |m0_rpc_session_init()
m0_rpc_session_establish() != 0     V
        +----------------------INITIALISED
        |                           |
        |                           | m0_rpc_session_establish()
        |                           |
        |     timed-out             V
        +-----------------------ESTABLISHING
        |   create_failed           | create successful/n = 0
        V                           |
      FAILED &lt;------+               |   n == 0
        |           |               +-----------------+
        |           |               |                 | +-----+
        |           |failed         |                 | |     | item add/n++
        |           |               V  item add/n++   | V     | reply rcvd/n--
        |           +-------------IDLE---------------&gt;BUSY----+
        |           |               |
        | fini()    |               | m0_rpc_session_terminate()
        |           |               V
        |           +----------TERMINATING
        |                           |
        |                           |
        |                           |
        |                           |session_terminated
        |                           V
        |                       TERMINATED
        |                           |
        |                           | fini()
        |                           V
        +----------------------&gt; FINALISED</pre><p>Typical sequence of execution of APIs on sender side. Error checking is omitted.</p>
<div class="fragment"><div class="line"><span class="comment">// ALLOCATE SESSION</span></div><div class="line"></div><div class="line"><span class="keyword">struct </span><a class="code" href="../../dd/d65/structm0__rpc__session.html">m0_rpc_session</a> *<a class="code" href="../../d6/d63/ut_2formation2_8c.html#ad8d209aebb4ac645b00e2017364dc00b">session</a>;</div><div class="line"><a class="code" href="../../d7/ded/group__memory.html#ga2dd26426583fa272fa2061075e2dcf57">M0_ALLOC_PTR</a>(<a class="code" href="../../d6/d63/ut_2formation2_8c.html#ad8d209aebb4ac645b00e2017364dc00b">session</a>);</div><div class="line"></div><div class="line"><span class="comment">// INITIALISE SESSION</span></div><div class="line"></div><div class="line"><a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> = <a class="code" href="../../df/db4/group__rpc__session.html#gae3f0e9a8ffe872f98d2bdbf2f037b397">m0_rpc_session_init</a>(<a class="code" href="../../d6/d63/ut_2formation2_8c.html#ad8d209aebb4ac645b00e2017364dc00b">session</a>, <a class="code" href="../../de/dd4/ut_2fsync_8c.html#abe670c6267f607b175189ec0c92551c8">conn</a>);</div><div class="line"><a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(<a class="code" href="../../df/d2a/lib_2misc_8h.html#a7f75ab6839d468f4d23480a9c65724c5">ergo</a>(<a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> == 0, <a class="code" href="../../df/db4/group__rpc__session.html#gac7defa123e02f9a610a8d4afc9cc5d70">session_state</a>(<a class="code" href="../../d6/d63/ut_2formation2_8c.html#ad8d209aebb4ac645b00e2017364dc00b">session</a>) ==</div><div class="line">                        <a class="code" href="../../df/db4/group__rpc__session.html#gga39ae379375a3b234605f0264c3c21d02a77a55d723b5986eda15e2748e344a82d">M0_RPC_SESSION_INITIALISED</a>));</div><div class="line"></div><div class="line"><span class="comment">// ESTABLISH SESSION</span></div><div class="line"></div><div class="line"><a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> = <a class="code" href="../../df/db4/group__rpc__session.html#gaf9335bb6847b8de2d2b8f22db154525c">m0_rpc_session_establish</a>(<a class="code" href="../../d6/d63/ut_2formation2_8c.html#ad8d209aebb4ac645b00e2017364dc00b">session</a>);</div><div class="line"></div><div class="line"><a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> = <a class="code" href="../../df/db4/group__rpc__session.html#ga117296ddaea9e3c4a6a8071722ea6db4">m0_rpc_session_timedwait</a>(<a class="code" href="../../d6/d63/ut_2formation2_8c.html#ad8d209aebb4ac645b00e2017364dc00b">session</a>, <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae644c20b9d43e4e0810716647b3d16be">M0_BITS</a>(<a class="code" href="../../df/db4/group__rpc__session.html#gga39ae379375a3b234605f0264c3c21d02a65bae7069cfd716248a86821f5217322">M0_RPC_SESSION_IDLE</a>,</div><div class="line">                                         <a class="code" href="../../df/db4/group__rpc__session.html#gga39ae379375a3b234605f0264c3c21d02a30a145ad42f4f91d67a6bacbcdcb6146">M0_RPC_SESSION_FAILED</a>),</div><div class="line">                        <a class="code" href="../../d9/de6/group__console.html#gab5627d8d8b095c198e2523c44ca380ac">timeout</a>);</div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (<a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> == 0 &amp;&amp; <a class="code" href="../../df/db4/group__rpc__session.html#gac7defa123e02f9a610a8d4afc9cc5d70">session_state</a>(<a class="code" href="../../d6/d63/ut_2formation2_8c.html#ad8d209aebb4ac645b00e2017364dc00b">session</a>) == <a class="code" href="../../df/db4/group__rpc__session.html#gga39ae379375a3b234605f0264c3c21d02a65bae7069cfd716248a86821f5217322">M0_RPC_SESSION_IDLE</a>) {</div><div class="line">     <span class="comment">// Session is successfully established</span></div><div class="line">} <span class="keywordflow">else</span> {</div><div class="line">     <span class="comment">// timeout has happened or session establish failed</span></div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// Assuming session is successfully established.</span></div><div class="line"><span class="comment">// post unbound items using m0_rpc_post(item)</span></div><div class="line"></div><div class="line"><a class="code" href="../../d9/dbf/ut_2item_8c.html#ae944bcb72fdcfcfb06a9a27759eb347a">item</a>-&gt;<a class="code" href="../../de/d21/structm0__rpc__item.html#a505c9c0c553b7745fc7ecc467d44044f">ri_session</a> = <a class="code" href="../../d6/d63/ut_2formation2_8c.html#ad8d209aebb4ac645b00e2017364dc00b">session</a>;</div><div class="line"><a class="code" href="../../d9/dbf/ut_2item_8c.html#ae944bcb72fdcfcfb06a9a27759eb347a">item</a>-&gt;<a class="code" href="../../de/d21/structm0__rpc__item.html#a3ae39f060959ad6caee5989955861cbb">ri_prio</a> = <a class="code" href="../../db/de9/group__rpc.html#ggace6ab9ea5bf2bf1e8f6daf1dd28c0c4ba5892cf0cd3f216d4a8fd8a2a2c8947b3">M0_RPC_ITEM_PRIO_MAX</a>;</div><div class="line"><a class="code" href="../../d9/dbf/ut_2item_8c.html#ae944bcb72fdcfcfb06a9a27759eb347a">item</a>-&gt;<a class="code" href="../../de/d21/structm0__rpc__item.html#ae0dbfba148f0dc5c9e19da9528dd2f43">ri_deadline</a> = absolute_time;</div><div class="line"><a class="code" href="../../d9/dbf/ut_2item_8c.html#ae944bcb72fdcfcfb06a9a27759eb347a">item</a>-&gt;<a class="code" href="../../de/d21/structm0__rpc__item.html#a6aa5edcd589a8e8b25d32c0c54fe6536">ri_ops</a> = <a class="code" href="../../dc/d83/io__req__fop_8c.html#a183fc4d3e35534000db49a736e281436">item_ops</a>;   <span class="comment">// item_ops contains -&gt;replied() callback which</span></div><div class="line">                     <span class="comment">// will be called when reply to this item is</span></div><div class="line">                     <span class="comment">// received. DO NOT FREE THIS ITEM.</span></div><div class="line"></div><div class="line"><a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> = <a class="code" href="../../db/de9/group__rpc.html#gab6406484e4b73d1c6a270d88083b7fc9">m0_rpc_post</a>(<a class="code" href="../../d9/dbf/ut_2item_8c.html#ae944bcb72fdcfcfb06a9a27759eb347a">item</a>);</div><div class="line"></div><div class="line"><span class="comment">// TERMINATING SESSION</span></div><div class="line"><span class="comment">// Wait until all the items that were posted on this session, are sent and</span></div><div class="line"><span class="comment">// for all those items either reply is received or reply_timeout has</span></div><div class="line"><span class="comment">// triggered.</span></div><div class="line"><a class="code" href="../../df/db4/group__rpc__session.html#ga117296ddaea9e3c4a6a8071722ea6db4">m0_rpc_session_timedwait</a>(<a class="code" href="../../d6/d63/ut_2formation2_8c.html#ad8d209aebb4ac645b00e2017364dc00b">session</a>, <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae644c20b9d43e4e0810716647b3d16be">M0_BITS</a>(<a class="code" href="../../df/db4/group__rpc__session.html#gga39ae379375a3b234605f0264c3c21d02a65bae7069cfd716248a86821f5217322">M0_RPC_SESSION_IDLE</a>), <a class="code" href="../../d9/de6/group__console.html#gab5627d8d8b095c198e2523c44ca380ac">timeout</a>);</div><div class="line"><a class="code" href="../../dc/da7/assert_8h.html#ac8bebb1ebb72c1dae891a1a1c24e7aec">M0_ASSERT</a>(<a class="code" href="../../df/db4/group__rpc__session.html#gac7defa123e02f9a610a8d4afc9cc5d70">session_state</a> == <a class="code" href="../../df/db4/group__rpc__session.html#gga39ae379375a3b234605f0264c3c21d02a65bae7069cfd716248a86821f5217322">M0_RPC_SESSION_IDLE</a>);</div><div class="line"><a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> = <a class="code" href="../../df/db4/group__rpc__session.html#ga32f9dfc4fd17ee95f26877ae7350cb9c">m0_rpc_session_terminate</a>(<a class="code" href="../../d6/d63/ut_2formation2_8c.html#ad8d209aebb4ac645b00e2017364dc00b">session</a>);</div><div class="line"><span class="keywordflow">if</span> (<a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> == 0) {</div><div class="line">     <span class="comment">// Wait until session is terminated.</span></div><div class="line">     <a class="code" href="../../d7/db8/cm_2repreb_2trigger__fop_8h.html#ac6509c6fe4cbf7bde170597172f8a288">rc</a> = <a class="code" href="../../df/db4/group__rpc__session.html#ga117296ddaea9e3c4a6a8071722ea6db4">m0_rpc_session_timedwait</a>(<a class="code" href="../../d6/d63/ut_2formation2_8c.html#ad8d209aebb4ac645b00e2017364dc00b">session</a>,</div><div class="line">                             <a class="code" href="../../df/d2a/lib_2misc_8h.html#ae644c20b9d43e4e0810716647b3d16be">M0_BITS</a>(<a class="code" href="../../df/db4/group__rpc__session.html#gga39ae379375a3b234605f0264c3c21d02a3686bb476cd0fc0c3993f3839d12e8d2">M0_RPC_SESSION_TERMINATED</a>,</div><div class="line">                                     <a class="code" href="../../df/db4/group__rpc__session.html#gga39ae379375a3b234605f0264c3c21d02a30a145ad42f4f91d67a6bacbcdcb6146">M0_RPC_SESSION_FAILED</a>),</div><div class="line">                             <a class="code" href="../../d9/de6/group__console.html#gab5627d8d8b095c198e2523c44ca380ac">timeout</a>);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// FINALISE SESSION</span></div><div class="line"></div><div class="line"><a class="code" href="../../df/db4/group__rpc__session.html#ga4791c259b0df215a07f9bd5b8a2949cb">m0_rpc_session_fini</a>(<a class="code" href="../../d6/d63/ut_2formation2_8c.html#ad8d209aebb4ac645b00e2017364dc00b">session</a>);</div><div class="line"><a class="code" href="../../d7/ded/group__memory.html#ga0b8533a3024754008602759e71337eb3">m0_free</a>(<a class="code" href="../../d6/d63/ut_2formation2_8c.html#ad8d209aebb4ac645b00e2017364dc00b">session</a>);</div></div><!-- fragment --><p>Receiver is not expected to call any of these APIs. Receiver side session structures will be set-up while handling fops m0_rpc_fop_[conn|session]_[establish|terminate].</p>
<p>When receiver needs to post reply, it uses <a class="el" href="../../db/de9/group__rpc.html#gacbfe74a884f1912395ef2a9bde8ad927">m0_rpc_reply_post()</a>.</p>
<div class="fragment"><div class="line"><a class="code" href="../../db/de9/group__rpc.html#gacbfe74a884f1912395ef2a9bde8ad927">m0_rpc_reply_post</a>(request_item, reply_item);</div></div><!-- fragment --><p><a class="el" href="../../db/de9/group__rpc.html#gacbfe74a884f1912395ef2a9bde8ad927">m0_rpc_reply_post()</a> will copy all the session related information from request item to reply item and process reply item.</p>
<p>Note: rpc connection is a two-way communication channel. There are requests and corresponding reply items, on the same connection. Receiver NEED NOT have to establish other separate connection with sender, to be able to send replies. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d46/session_8h_source.html#l00305">305</a> of file <a class="el" href="../../da/d46/session_8h_source.html">session.h</a>.</p>
</div><h2 class="groupheader">Field Documentation</h2>
<a id="a4883c15ffe86fa66c43c0a775dc96310"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4883c15ffe86fa66c43c0a775dc96310">&#9670;&nbsp;</a></span>s_cancelled</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool s_cancelled</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag to indicate if this session has been cancelled. This flag is set to TRUE at the beginning of <a class="el" href="../../df/db4/group__rpc__session.html#gaeddb3439ca8c8339e207af5c4688cb17">m0_rpc_session_cancel()</a> execution. Once this flag is set to TRUE, subsequent <a class="el" href="../../db/de9/group__rpc.html#gab6406484e4b73d1c6a270d88083b7fc9">m0_rpc_post()</a> against the same session returns -ECANCELED error. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d46/session_8h_source.html#l00360">360</a> of file <a class="el" href="../../da/d46/session_8h_source.html">session.h</a>.</p>

</div>
</div>
<a id="a6a63f21d3f333ac07d0f5704cc0a7b3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a63f21d3f333ac07d0f5704cc0a7b3d">&#9670;&nbsp;</a></span>s_conn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d2/de3/structm0__rpc__conn.html">m0_rpc_conn</a>* s_conn</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>rpc connection on which this session is created </p>

<p class="definition">Definition at line <a class="el" href="../../da/d46/session_8h_source.html#l00312">312</a> of file <a class="el" href="../../da/d46/session_8h_source.html">session.h</a>.</p>

</div>
</div>
<a id="a7682a12c793aca35313befd3b9277dd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7682a12c793aca35313befd3b9277dd1">&#9670;&nbsp;</a></span>s_hold_cnt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t s_hold_cnt</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>if &gt; 0, then session is in BUSY state </p>

<p class="definition">Definition at line <a class="el" href="../../da/d46/session_8h_source.html#l00320">320</a> of file <a class="el" href="../../da/d46/session_8h_source.html">session.h</a>.</p>

</div>
</div>
<a id="a59f889cdd52fe131a1a3b1b3c2db49bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59f889cdd52fe131a1a3b1b3c2db49bb">&#9670;&nbsp;</a></span>s_link</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/de0/structm0__tlink.html">m0_tlink</a> s_link</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Link in RPC conn. <a class="el" href="../../d2/de3/structm0__rpc__conn.html#ab1f522923e5cbd1baec7d22ab8144d60">m0_rpc_conn::c_sessions</a> List descriptor: session </p>

<p class="definition">Definition at line <a class="el" href="../../da/d46/session_8h_source.html#l00317">317</a> of file <a class="el" href="../../da/d46/session_8h_source.html">session.h</a>.</p>

</div>
</div>
<a id="a1d336873e4726882c19a27eb73aacd78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d336873e4726882c19a27eb73aacd78">&#9670;&nbsp;</a></span>s_magic</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t s_magic</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>M0_RPC_SESSION_MAGIC </p>

<p class="definition">Definition at line <a class="el" href="../../da/d46/session_8h_source.html#l00328">328</a> of file <a class="el" href="../../da/d46/session_8h_source.html">session.h</a>.</p>

</div>
</div>
<a id="a33e9a5449ed2e239fc8aaf4f0b61f22a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33e9a5449ed2e239fc8aaf4f0b61f22a">&#9670;&nbsp;</a></span>s_pending_cache</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/d8a/structm0__tl.html">m0_tl</a> s_pending_cache</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Items submitted to formation. Required in case RPC session is to be cancelled so as to cancel all such items. This cache is protected with rpc machine lock. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d46/session_8h_source.html#l00368">368</a> of file <a class="el" href="../../da/d46/session_8h_source.html">session.h</a>.</p>

</div>
</div>
<a id="a25104433df20f8ff01c999ba879f82d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25104433df20f8ff01c999ba879f82d3">&#9670;&nbsp;</a></span>s_reply_cache</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d0/dab/structm0__rpc__item__cache.html">m0_rpc_item_cache</a> s_reply_cache</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Replies to resend if needed. This cache is protected with rpc machine lock. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d46/session_8h_source.html#l00345">345</a> of file <a class="el" href="../../da/d46/session_8h_source.html">session.h</a>.</p>

</div>
</div>
<a id="a198ae87ba4d6616647105f40ed3a9296"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a198ae87ba4d6616647105f40ed3a9296">&#9670;&nbsp;</a></span>s_req_cache</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d0/dab/structm0__rpc__item__cache.html">m0_rpc_item_cache</a> s_req_cache</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Requests which are handled already. This cache is protected with rpc machine lock. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d46/session_8h_source.html#l00351">351</a> of file <a class="el" href="../../da/d46/session_8h_source.html">session.h</a>.</p>

</div>
</div>
<a id="af2e686c38764797620d4c892b3f9aca2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2e686c38764797620d4c892b3f9aca2">&#9670;&nbsp;</a></span>s_session_id</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t s_session_id</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>identifies a particular session. Unique in all sessions belonging to same <a class="el" href="../../d2/de3/structm0__rpc__conn.html">m0_rpc_conn</a> </p>

<p class="definition">Definition at line <a class="el" href="../../da/d46/session_8h_source.html#l00309">309</a> of file <a class="el" href="../../da/d46/session_8h_source.html">session.h</a>.</p>

</div>
</div>
<a id="a5766c3b04a967df4143cd23bff6f83e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5766c3b04a967df4143cd23bff6f83e5">&#9670;&nbsp;</a></span>s_sm</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../db/d49/structm0__sm.html">m0_sm</a> s_sm</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>RPC session state machine </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="../../df/db4/group__rpc__session.html#ga39ae379375a3b234605f0264c3c21d02">m0_rpc_session_state</a>, <a class="el" href="../../df/db4/group__rpc__session.html#ga72ef91adc2a2e709c4724a1556b0488d">session_conf</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/d46/session_8h_source.html#l00325">325</a> of file <a class="el" href="../../da/d46/session_8h_source.html">session.h</a>.</p>

</div>
</div>
<a id="ad180cb69f2332d72844eb9baa902425d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad180cb69f2332d72844eb9baa902425d">&#9670;&nbsp;</a></span>s_xid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t s_xid</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Unique item identifier counter </p>

<p class="definition">Definition at line <a class="el" href="../../da/d46/session_8h_source.html#l00331">331</a> of file <a class="el" href="../../da/d46/session_8h_source.html">session.h</a>.</p>

</div>
</div>
<a id="ae2887eda43357a86c79b6826e040948d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2887eda43357a86c79b6826e040948d">&#9670;&nbsp;</a></span>s_xid_list</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/d8a/structm0__tl.html">m0_tl</a> s_xid_list</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>List of all rpc items in the session that have xid and are going to be sent. Items in the list are in osr_xid increasing order. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="../../de/d21/structm0__rpc__item.html">m0_rpc_item</a>:ri_xid_link, <a class="el" href="../../db/de9/group__rpc.html#ga91060fe381595e9dd3855d5741e64992">m0_rpc_item_xid_min_update()</a>, xidl. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/d46/session_8h_source.html#l00339">339</a> of file <a class="el" href="../../da/d46/session_8h_source.html">session.h</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>rpc/<a class="el" href="../../da/d46/session_8h_source.html">session.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dd/d65/structm0__rpc__session.html">m0_rpc_session</a></li>
    <li class="footer">Generated on Fri May 20 2022 10:36:15 for Motr by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
