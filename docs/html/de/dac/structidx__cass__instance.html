<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Motr: idx_cass_instance Struct Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Motr
   &#160;<span id="projectnumber">M0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('de/dac/structidx__cass__instance.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle">
<div class="title">idx_cass_instance Struct Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for idx_cass_instance:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/d8a/structidx__cass__instance__coll__graph.png" border="0" usemap="#idx__cass__instance_coll__map" alt="Collaboration graph"/></div>
<map name="idx__cass__instance_coll__map" id="idx__cass__instance_coll__map">
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a6507731c49ebce617fdeb1bedab71da7"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dac/structidx__cass__instance.html#a6507731c49ebce617fdeb1bedab71da7">ci_keyspace</a></td></tr>
<tr class="separator:a6507731c49ebce617fdeb1bedab71da7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cb83063a1fb6f251086c4200ef54e3c"><td class="memItemLeft" align="right" valign="top">CassCluster *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dac/structidx__cass__instance.html#a9cb83063a1fb6f251086c4200ef54e3c">ci_cluster</a></td></tr>
<tr class="separator:a9cb83063a1fb6f251086c4200ef54e3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a685b111992190db453a6e098c44d8760"><td class="memItemLeft" align="right" valign="top">CassSession *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dac/structidx__cass__instance.html#a685b111992190db453a6e098c44d8760">ci_session</a></td></tr>
<tr class="separator:a685b111992190db453a6e098c44d8760"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A few notes on data model for Cassandra index service.</p>
<p>Motr index API defines a Key-Value interface supporting only a few simple operations (GET/PUT/DEL/NEXT). When implementing the driver for Cassandra index service, Cassandra driver should be able to make good use of its advance features to achive good performance, load balance, scalability and HA, we have the following requirements in mind: (1) Motr index interface requires K-V pairs are sorted in order by keys, particularly for NEXT operation.</p>
<p>(2) A Motr application may use the index API in different ways, taking S3 server, an application which uses Motr index API and Cassandra as a backend index service, as example:</p>
<p>(a) There may be a large number of indices (for example, one index for each S3 bucket), and the number of K-V pairs in an index may vary from 100s pairs to hundres of thousands. If an index is mapped to a column family directly, this large number of CF can cause heavy memory usage. 10s or 100s CF is sugussted.</p>
<p>(b) Cassandra is naturally optimised for write heavy workload, while S3 server exihbits a read dominant workload. This requires the Cassandra data model has to be optimized for read.</p>
<p>(3) Atomic modifications on index.</p>
<p>(4) Use BATCH and PREPARED queries whenever it is possible.</p>
<p>Motr defines the following schema for Cassandra index service:</p>
<p>CREATE TABLE cass_index_store { index_fid TEXT, key BLOB, vale BLOB, PRIMARY KEY(index_fid, key) };</p>
<p>A few things for this schema: (1) As shown in the schema definition, the row key is index fid which spreads rows into nodes(machines) by indices. (2) 'Key' is clustering key so keys are physically sorted in disks (to efficiently support NEXT query). 'Key' is of BLOB type to allow applications customise their keys and values. (3) The schema implies wide row is used, a few limitations on wide rows: max <a class="el" href="../../d6/d35/structkey.html">key(name)</a> size: 64KB, max size for a column value: 2GB, max number of cells in a row: 2 billions (4) A mapping layer is introduced to translate Motr index to a physical Cassandra keyspace/column families. By wisely using the index FID, it is also possible to group indices into different keyspace/CF's. For example, Motr can map S3 bucket indices(object list) into one or more CF's, while mapping indices of object id to object metadata into another keyspace/CF. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d65/idx__cass_8c_source.html#l00093">93</a> of file <a class="el" href="../../d5/d65/idx__cass_8c_source.html">idx_cass.c</a>.</p>
</div><h2 class="groupheader">Field Documentation</h2>
<a id="a9cb83063a1fb6f251086c4200ef54e3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cb83063a1fb6f251086c4200ef54e3c">&#9670;&nbsp;</a></span>ci_cluster</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CassCluster* ci_cluster</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d65/idx__cass_8c_source.html#l00095">95</a> of file <a class="el" href="../../d5/d65/idx__cass_8c_source.html">idx_cass.c</a>.</p>

</div>
</div>
<a id="a6507731c49ebce617fdeb1bedab71da7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6507731c49ebce617fdeb1bedab71da7">&#9670;&nbsp;</a></span>ci_keyspace</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* ci_keyspace</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d65/idx__cass_8c_source.html#l00094">94</a> of file <a class="el" href="../../d5/d65/idx__cass_8c_source.html">idx_cass.c</a>.</p>

</div>
</div>
<a id="a685b111992190db453a6e098c44d8760"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a685b111992190db453a6e098c44d8760">&#9670;&nbsp;</a></span>ci_session</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CassSession* ci_session</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d65/idx__cass_8c_source.html#l00096">96</a> of file <a class="el" href="../../d5/d65/idx__cass_8c_source.html">idx_cass.c</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>motr/<a class="el" href="../../d5/d65/idx__cass_8c_source.html">idx_cass.c</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../de/dac/structidx__cass__instance.html">idx_cass_instance</a></li>
    <li class="footer">Generated on Fri May 20 2022 10:36:11 for Motr by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
